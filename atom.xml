<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>Stack&#39;s Blog</title>
  <icon>https://www.gravatar.com/avatar/abf5fa6a2be7383851034d050d667f61</icon>
  <subtitle>The spreading wide of narrow hands To gather paradise-</subtitle>
  <link href="https://stack2005.github.io/atom.xml" rel="self"/>
  
  <link href="https://stack2005.github.io/"/>
  <updated>2025-07-08T16:00:00.000Z</updated>
  <id>https://stack2005.github.io/</id>
  
  <author>
    <name>Stack</name>
    <email>liuruiqi2005@yeah.net</email>
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>js学习</title>
    <link href="https://stack2005.github.io/posts/128df006.html"/>
    <id>https://stack2005.github.io/posts/128df006.html</id>
    <published>2025-07-08T16:00:00.000Z</published>
    <updated>2025-07-08T16:00:00.000Z</updated>
    
    <content type="html"><![CDATA[<h2 id="基础"><a href="#基础" class="headerlink" title="基础"></a>基础</h2><h3 id="数据类型和变量"><a href="#数据类型和变量" class="headerlink" title="数据类型和变量"></a>数据类型和变量</h3><h4 id="Number"><a href="#Number" class="headerlink" title="Number"></a>Number</h4><p>JavaScript不区分整数和浮点数，统一用Number表示，以下都是合法的Number类型：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">123</span>; <span class="comment">// 整数123</span></span><br><span class="line"><span class="number">0.456</span>; <span class="comment">// 浮点数0.456</span></span><br><span class="line"><span class="number">1.2345e3</span>; <span class="comment">// 科学计数法表示1.2345x1000，等同于1234.5</span></span><br><span class="line">-<span class="number">99</span>; <span class="comment">// 负数</span></span><br><span class="line"><span class="title class_">NaN</span>; <span class="comment">// NaN表示Not a Number，当无法计算结果时用NaN表示</span></span><br><span class="line"><span class="title class_">Infinity</span>; <span class="comment">// Infinity表示无限大，当数值超过了JavaScript的Number所能表示的最大值时，就表示为Infinity</span></span><br></pre></td></tr></table></figure><div class="note info simple"><p>要注意，JavaScript的Number不区分整数和浮点数，也就是说，<code>12.00 === 12</code>。（在大多数其他语言中，整数和浮点数不能直接比较）并且，JavaScript的整数最大范围不是±263，而是±253，因此，超过253的整数就可能无法精确表示</p></div><h4 id="字符串"><a href="#字符串" class="headerlink" title="字符串"></a>字符串</h4><p>字符串是以单引号’或双引号”括起来的任意文本，比如<code>&#39;abc&#39;</code>，<code>&quot;xyz&quot;</code>等等。请注意，<code>&#39;&#39;</code>或<code>&quot;&quot;</code>本身只是一种表示方式，不是字符串的一部分，因此，字符串<code>&#39;abc&#39;</code>只有<code>a</code>，<code>b</code>，<code>c</code>这3个字符。</p><h4 id="布尔值"><a href="#布尔值" class="headerlink" title="布尔值"></a>布尔值</h4><p>布尔值和布尔代数的表示完全一致，一个布尔值只有<code>true</code>、<code>false</code>两种值，要么是<code>true</code>，要么是<code>false</code>，可以直接用<code>true</code>、<code>false</code>表示布尔值，也可以通过布尔运算计算出来</p><h4 id="比较运算符"><a href="#比较运算符" class="headerlink" title="比较运算符"></a>比较运算符</h4><p>当我们对Number做比较时，可以通过比较运算符得到一个布尔值：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">2</span> &gt; <span class="number">5</span>; <span class="comment">// false</span></span><br></pre></td></tr></table></figure><p>实际上，JavaScript允许对任意数据类型做比较：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="literal">false</span> == <span class="number">0</span>; <span class="comment">// true</span></span><br><span class="line"><span class="literal">false</span> === <span class="number">0</span>; <span class="comment">// false</span></span><br></pre></td></tr></table></figure><p>要特别注意相等运算符<code>==</code>。JavaScript在设计时，有两种比较运算符：</p><p>第一种是<code>==</code>比较，它会自动转换数据类型再比较，很多时候，会得到非常诡异的结果；</p><p>第二种是<code>===</code>比较，它不会自动转换数据类型，如果数据类型不一致，返回<code>false</code>，如果一致，再比较。</p><div class="note warning simple"><p><strong>由于JavaScript这个设计缺陷，<em>不要</em>使用<code>==</code>比较，始终坚持使用<code>===</code>比较。</strong></p></div><p>另一个例外是<code>NaN</code>这个特殊的Number与所有其他值都不相等，包括它自己：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="title class_">NaN</span> === <span class="title class_">NaN</span>; <span class="comment">// false</span></span><br></pre></td></tr></table></figure><p>唯一能判断<code>NaN</code>的方法是通过<code>isNaN()</code>函数：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">isNaN</span>(<span class="title class_">NaN</span>); <span class="comment">// true</span></span><br></pre></td></tr></table></figure><p>最后要注意浮点数的相等比较：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span> / <span class="number">3</span> === (<span class="number">1</span> - <span class="number">2</span> / <span class="number">3</span>); <span class="comment">// false</span></span><br></pre></td></tr></table></figure><p>这不是JavaScript的设计缺陷。浮点数在运算过程中会产生误差，因为计算机无法精确表示无限循环小数。要比较两个浮点数是否相等，只能计算它们之差的绝对值，看是否小于某个阈值：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="title class_">Math</span>.<span class="title function_">abs</span>(<span class="number">1</span> / <span class="number">3</span> - (<span class="number">1</span> - <span class="number">2</span> / <span class="number">3</span>)) &lt; <span class="number">0.0000001</span>; <span class="comment">// true</span></span><br></pre></td></tr></table></figure><h4 id="BigInt"><a href="#BigInt" class="headerlink" title="BigInt"></a>BigInt</h4><p>要精确表示比253还大的整数，可以使用内置的BigInt类型，它的表示方法是在整数后加一个<code>n</code>，例如<code>9223372036854775808n</code>，也可以使用<code>BigInt()</code>把Number和字符串转换成BigInt：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 使用BigInt:</span></span><br><span class="line"><span class="keyword">var</span> bi1 = <span class="number">9223372036854775807n</span>;</span><br><span class="line"><span class="keyword">var</span> bi2 = <span class="title class_">BigInt</span>(<span class="number">12345</span>);</span><br><span class="line"><span class="keyword">var</span> bi3 = <span class="title class_">BigInt</span>(<span class="string">&quot;0x7fffffffffffffff&quot;</span>);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(bi1 === bi2); <span class="comment">// false</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(bi1 === bi3); <span class="comment">// true</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(bi1 + bi2);</span><br></pre></td></tr></table></figure><p>使用BigInt可以正常进行加减乘除等运算，结果仍然是一个BigInt，但不能把一个BigInt和一个Number放在一起运算</p><h4 id="null和undefined"><a href="#null和undefined" class="headerlink" title="null和undefined"></a>null和undefined</h4><p><code>null</code>表示一个“空”的值，它和<code>0</code>以及空字符串<code>&#39;&#39;</code>不同，<code>0</code>是一个数值，<code>&#39;&#39;</code>表示长度为0的字符串，而<code>null</code>表示“空”。</p><p>在其他语言中，也有类似JavaScript的<code>null</code>的表示，例如Java也用<code>null</code>，Swift用<code>nil</code>，Python用<code>None</code>表示。但是，在JavaScript中，还有一个和<code>null</code>类似的<code>undefined</code>，它表示“未定义”。</p><p>JavaScript的设计者希望用<code>null</code>表示一个空的值，而<code>undefined</code>表示值未定义。事实证明，这并没有什么卵用，区分两者的意义不大。大多数情况下，我们都应该用<code>null</code>。<code>undefined</code>仅仅在判断函数参数是否传递的情况下有用。</p><h4 id="数组"><a href="#数组" class="headerlink" title="数组"></a>数组</h4><p>数组是一组按顺序排列的集合，集合的每个值称为元素。JavaScript的数组可以包括<strong>任意数据类型</strong>。例如：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3.14</span>, <span class="string">&#x27;Hello&#x27;</span>, <span class="literal">null</span>, <span class="literal">true</span>];</span><br></pre></td></tr></table></figure><p>上述数组包含6个元素。数组用<code>[]</code>表示，元素之间用<code>,</code>分隔。</p><p>另一种创建数组的方法是通过<code>Array()</code>函数实现：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">new</span> <span class="title class_">Array</span>(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>); <span class="comment">// 创建了数组[1, 2, 3]</span></span><br></pre></td></tr></table></figure><p>然而，出于代码的可读性考虑，强烈建议直接使用<code>[]</code>。</p><h4 id="对象"><a href="#对象" class="headerlink" title="对象"></a>对象</h4><p>JavaScript的对象是一组由键-值组成的无序集合，例如：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> person = &#123;</span><br><span class="line">    <span class="attr">name</span>: <span class="string">&#x27;Bob&#x27;</span>,</span><br><span class="line">    <span class="attr">age</span>: <span class="number">20</span>,</span><br><span class="line">    <span class="attr">tags</span>: [<span class="string">&#x27;js&#x27;</span>, <span class="string">&#x27;web&#x27;</span>, <span class="string">&#x27;mobile&#x27;</span>],</span><br><span class="line">    <span class="attr">city</span>: <span class="string">&#x27;Beijing&#x27;</span>,</span><br><span class="line">    <span class="attr">hasCar</span>: <span class="literal">true</span>,</span><br><span class="line">    <span class="attr">zipcode</span>: <span class="literal">null</span></span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>JavaScript对象的键都是字符串类型，值可以是任意数据类型。上述<code>person</code>对象一共定义了6个键值对，其中每个键又称为对象的属性，例如，<code>person</code>的<code>name</code>属性为<code>&#39;Bob&#39;</code>，<code>zipcode</code>属性为<code>null</code>。</p><p>要获取一个对象的属性，我们用<code>对象变量.属性名</code>的方式：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">person.<span class="property">name</span>; <span class="comment">// &#x27;Bob&#x27;</span></span><br><span class="line">person.<span class="property">zipcode</span>; <span class="comment">// null</span></span><br></pre></td></tr></table></figure><h4 id="变量"><a href="#变量" class="headerlink" title="变量"></a>变量</h4><p>变量的概念基本上和初中代数的方程变量是一致的，只是在计算机程序中，变量不仅可以是数字，还可以是任意数据类型。</p><p>变量在JavaScript中就是用一个变量名表示，变量名是大小写英文、数字、<code>$</code>和<code>_</code>的组合，且不能用数字开头。变量名也不能是JavaScript的关键字，如<code>if</code>、<code>while</code>等。申明一个变量用<code>var</code>语句，比如：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> a; <span class="comment">// 申明了变量a，此时a的值为undefined</span></span><br><span class="line"><span class="keyword">var</span> $b = <span class="number">1</span>; <span class="comment">// 申明了变量$b，同时给$b赋值，此时$b的值为1</span></span><br><span class="line"><span class="keyword">var</span> s_007 = <span class="string">&#x27;007&#x27;</span>; <span class="comment">// s_007是一个字符串</span></span><br><span class="line"><span class="keyword">var</span> <span class="title class_">Answer</span> = <span class="literal">true</span>; <span class="comment">// Answer是一个布尔值true</span></span><br><span class="line"><span class="keyword">var</span> t = <span class="literal">null</span>; <span class="comment">// t的值是null</span></span><br></pre></td></tr></table></figure><p>变量名也可以用中文，但是，请不要给自己找麻烦。</p><p>在JavaScript中，使用等号<code>=</code>对变量进行赋值。可以把任意数据类型赋值给变量，同一个变量可以反复赋值，而且可以是不同类型的变量，但是要注意只能用<code>var</code>申明一次，例如：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> a = <span class="number">123</span>; <span class="comment">// a的值是整数123</span></span><br><span class="line">a = <span class="string">&#x27;ABC&#x27;</span>; <span class="comment">// a变为字符串</span></span><br></pre></td></tr></table></figure><p>要显示变量的内容，可以用<code>console.log(x)</code>，打开Chrome的控制台就可以看到结果。</p><h4 id="strict模式"><a href="#strict模式" class="headerlink" title="strict模式"></a>strict模式</h4><p>JavaScript在设计之初，为了方便初学者学习，并不强制要求用<code>var</code>申明变量。这个设计错误带来了严重的后果：如果一个变量没有通过<code>var</code>申明就被使用，那么该变量就自动被申明为全局变量：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">i = <span class="number">10</span>; <span class="comment">// i现在是全局变量</span></span><br></pre></td></tr></table></figure><p>在同一个页面的不同的JavaScript文件中，如果都不用<code>var</code>申明，恰好都使用了变量<code>i</code>，将造成变量<code>i</code>互相影响，产生难以调试的错误结果。</p><p>使用<code>var</code>申明的变量则不是全局变量，它的范围被限制在该变量被申明的函数体内（函数的概念将稍后讲解），同名变量在不同的函数体内互不冲突。</p><p>为了修补JavaScript这一严重设计缺陷，ECMA在后续规范中推出了strict模式，在strict模式下运行的JavaScript代码，强制通过<code>var</code>申明变量，未使用<code>var</code>申明变量就使用的，将导致运行错误。</p><p>启用strict模式的方法是在JavaScript代码的第一行写上：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&#x27;use strict&#x27;</span>;</span><br></pre></td></tr></table></figure><p>这是一个字符串，不支持strict模式的浏览器会把它当做一个字符串语句执行，支持strict模式的浏览器将开启strict模式运行JavaScript。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">hello</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="string">&#x27;use strict&#x27;</span>;</span><br><span class="line">    <span class="comment">// 如果浏览器支持strict模式，</span></span><br><span class="line">    <span class="comment">// 下面的代码将报ReferenceError错误:</span></span><br><span class="line">    helloStr = <span class="string">&#x27;hello&#x27;</span>;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(helloStr);</span><br><span class="line">&#125;</span><br><span class="line"><span class="title function_">hello</span>();</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>运行结果：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="title class_">ReferenceError</span>: helloStr is not defined</span><br></pre></td></tr></table></figure><p>另一种申明变量的方式是<code>let</code>，这也是现代JavaScript推荐的方式：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 用let申明变量:</span></span><br><span class="line"><span class="keyword">let</span> s = <span class="string">&#x27;hello&#x27;</span>;</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(s);</span><br></pre></td></tr></table></figure><h3 id="字符串-1"><a href="#字符串-1" class="headerlink" title="字符串"></a>字符串</h3><p>JavaScript的字符串就是用<code>&#39;&#39;</code>或<code>&quot;&quot;</code>括起来的字符表示。</p><p>如果<code>&#39;</code>本身也是一个字符，那就可以用<code>&quot;&quot;</code>括起来，比如<code>&quot;I&#39;m OK&quot;</code>包含的字符是<code>I</code>，<code>&#39;</code>，<code>m</code>，空格，<code>O</code>，<code>K</code>这6个字符。</p><p>如果字符串内部既包含<code>&#39;</code>又包含<code>&quot;</code>怎么办？可以用转义字符<code>\</code>来标识，比如：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&#x27;I\&#x27;m \&quot;OK\&quot;!&#x27;</span>; <span class="comment">// I&#x27;m &quot;OK&quot;!</span></span><br></pre></td></tr></table></figure><p>表示的字符串内容是：<code>I&#39;m &quot;OK&quot;!</code></p><p>转义字符<code>\</code>可以转义很多字符，比如<code>\n</code>表示换行，<code>\t</code>表示制表符，字符<code>\</code>本身也要转义，所以<code>\\</code>表示的字符就是<code>\</code>。</p><p>ASCII字符可以以<code>\x##</code>形式的十六进制表示，例如：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&#x27;\x41&#x27;</span>; <span class="comment">// 完全等同于 &#x27;A&#x27;</span></span><br></pre></td></tr></table></figure><p>还可以用<code>\u####</code>表示一个Unicode字符：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&#x27;\u4e2d\u6587&#x27;</span>; <span class="comment">// 完全等同于 &#x27;中文&#x27;</span></span><br></pre></td></tr></table></figure><h4 id="多行字符串"><a href="#多行字符串" class="headerlink" title="多行字符串"></a>多行字符串</h4><p>由于多行字符串用<code>\n</code>写起来比较费事，所以最新的ES6标准新增了一种多行字符串的表示方法，用反引号<code>...</code>表示：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">`这是一个</span></span><br><span class="line"><span class="string">多行</span></span><br><span class="line"><span class="string">字符串`</span>;</span><br></pre></td></tr></table></figure><h4 id="模板字符串"><a href="#模板字符串" class="headerlink" title="模板字符串"></a>模板字符串</h4><p>要把多个字符串连接起来，可以用<code>+</code>号连接：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> name = <span class="string">&#x27;小明&#x27;</span>;</span><br><span class="line"><span class="keyword">let</span> age = <span class="number">20</span>;</span><br><span class="line"><span class="keyword">let</span> message = <span class="string">&#x27;你好, &#x27;</span> + name + <span class="string">&#x27;, 你今年&#x27;</span> + age + <span class="string">&#x27;岁了!&#x27;</span>;</span><br><span class="line"><span class="title function_">alert</span>(message);</span><br></pre></td></tr></table></figure><p>如果有很多变量需要连接，用<code>+</code>号就比较麻烦。ES6新增了一种模板字符串，表示方法和上面的多行字符串一样，但是它会自动替换字符串中的变量：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> name = <span class="string">&#x27;小明&#x27;</span>;</span><br><span class="line"><span class="keyword">let</span> age = <span class="number">20</span>;</span><br><span class="line"><span class="keyword">let</span> message = <span class="string">`你好, <span class="subst">$&#123;name&#125;</span>, 你今年<span class="subst">$&#123;age&#125;</span>岁了!`</span>;</span><br><span class="line"><span class="title function_">alert</span>(message);</span><br></pre></td></tr></table></figure><div class="note warning simple"><p><strong>模板字符串必须用反引号,使用单引号，模板字符串不生效</strong></p></div><h4 id="操作字符串"><a href="#操作字符串" class="headerlink" title="操作字符串"></a>操作字符串</h4><p>字符串常见的操作如下：</p><p>获取字符串长度：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> s = <span class="string">&#x27;Hello, world!&#x27;</span>;</span><br><span class="line">s.<span class="property">length</span>; <span class="comment">// 13</span></span><br></pre></td></tr></table></figure><p>要获取字符串某个指定位置的字符，使用类似Array的下标操作，索引号从0开始：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> s = <span class="string">&#x27;Hello, world!&#x27;</span>;</span><br><span class="line"></span><br><span class="line">s[<span class="number">0</span>]; <span class="comment">// &#x27;H&#x27;</span></span><br><span class="line">s[<span class="number">6</span>]; <span class="comment">// &#x27; &#x27;</span></span><br><span class="line">s[<span class="number">7</span>]; <span class="comment">// &#x27;w&#x27;</span></span><br><span class="line">s[<span class="number">12</span>]; <span class="comment">// &#x27;!&#x27;</span></span><br><span class="line">s[<span class="number">13</span>]; <span class="comment">// undefined 超出范围的索引不会报错，但一律返回undefined</span></span><br></pre></td></tr></table></figure><p><em>需要特别注意的是</em>，字符串是不可变的，如果对字符串的某个索引赋值，不会有任何错误，但是，也没有任何效果：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> s = <span class="string">&#x27;Test&#x27;</span>;</span><br><span class="line">s[<span class="number">0</span>] = <span class="string">&#x27;X&#x27;</span>;</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(s); <span class="comment">// s仍然为&#x27;Test&#x27;</span></span><br></pre></td></tr></table></figure><p>JavaScript为字符串提供了一些常用方法，注意，<strong>调用这些方法本身不会改变原有字符串的内容，而是返回一个新字符串</strong>：</p><h5 id="toUpperCase"><a href="#toUpperCase" class="headerlink" title="toUpperCase"></a>toUpperCase</h5><p><code>toUpperCase()</code>把一个字符串全部变为大写：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> s = <span class="string">&#x27;Hello&#x27;</span>;</span><br><span class="line">s.<span class="title function_">toUpperCase</span>(); <span class="comment">// 返回&#x27;HELLO&#x27;</span></span><br></pre></td></tr></table></figure><h5 id="toLowerCase"><a href="#toLowerCase" class="headerlink" title="toLowerCase"></a>toLowerCase</h5><p><code>toLowerCase()</code>把一个字符串全部变为小写：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> s = <span class="string">&#x27;Hello&#x27;</span>;</span><br><span class="line"><span class="keyword">let</span> lower = s.<span class="title function_">toLowerCase</span>(); <span class="comment">// 返回&#x27;hello&#x27;并赋值给变量lower</span></span><br><span class="line">lower; <span class="comment">// &#x27;hello&#x27;</span></span><br></pre></td></tr></table></figure><h5 id="indexOf"><a href="#indexOf" class="headerlink" title="indexOf"></a>indexOf</h5><p><code>indexOf()</code>会搜索指定字符串出现的位置：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> s = <span class="string">&#x27;hello, world&#x27;</span>;</span><br><span class="line">s.<span class="title function_">indexOf</span>(<span class="string">&#x27;world&#x27;</span>); <span class="comment">// 返回7</span></span><br><span class="line">s.<span class="title function_">indexOf</span>(<span class="string">&#x27;World&#x27;</span>); <span class="comment">// 没有找到指定的子串，返回-1</span></span><br></pre></td></tr></table></figure><h5 id="substring"><a href="#substring" class="headerlink" title="substring"></a>substring</h5><p><code>substring()</code>返回指定索引区间的子串：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> s = <span class="string">&#x27;hello, world&#x27;</span></span><br><span class="line">s.<span class="title function_">substring</span>(<span class="number">0</span>, <span class="number">5</span>); <span class="comment">// 从索引0开始到5（不包括5），返回&#x27;hello&#x27;</span></span><br><span class="line">s.<span class="title function_">substring</span>(<span class="number">7</span>); <span class="comment">// 从索引7开始到结束，返回&#x27;world&#x27;</span></span><br></pre></td></tr></table></figure><h3 id="数组-1"><a href="#数组-1" class="headerlink" title="数组"></a>数组</h3><p>JavaScript的<code>Array</code>可以包含任意数据类型，并通过索引来访问每个元素。</p><p>要取得<code>Array</code>的长度，直接访问<code>length</code>属性：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Array.length:</span></span><br><span class="line"><span class="keyword">let</span> arr = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3.14</span>, <span class="string">&#x27;Hello&#x27;</span>, <span class="literal">null</span>, <span class="literal">true</span>];</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(arr.<span class="property">length</span>); <span class="comment">// 6</span></span><br></pre></td></tr></table></figure><p><em>请注意</em>，直接给<code>Array</code>的<code>length</code>赋一个新的值会导致<code>Array</code>大小的变化：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> arr = [<span class="string">&#x27;A&#x27;</span>, <span class="string">&#x27;B&#x27;</span>, <span class="string">&#x27;C&#x27;</span>];</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(arr.<span class="property">length</span>); <span class="comment">// 3</span></span><br><span class="line"><span class="comment">// 调整数组大小:</span></span><br><span class="line">arr.<span class="property">length</span> = <span class="number">6</span>;</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(arr); <span class="comment">// arr变为[&#x27;A&#x27;, &#x27;B&#x27;, &#x27;C&#x27;, undefined, undefined, undefined]</span></span><br><span class="line"><span class="comment">// 调整数组大小:</span></span><br><span class="line">arr.<span class="property">length</span> = <span class="number">2</span>;</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(arr); <span class="comment">// arr变为[&#x27;A&#x27;, &#x27;B&#x27;]</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><p>运行结果：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">3</span></span><br><span class="line">A,B,C,,,</span><br><span class="line">A,B</span><br></pre></td></tr></table></figure><p><code>Array</code>可以通过索引把对应的元素修改为新的值，因此，对<code>Array</code>的索引进行赋值会直接修改这个<code>Array</code>：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Array index:</span></span><br><span class="line"><span class="keyword">let</span> arr = [<span class="string">&#x27;A&#x27;</span>, <span class="string">&#x27;B&#x27;</span>, <span class="string">&#x27;C&#x27;</span>];</span><br><span class="line">arr[<span class="number">1</span>] = <span class="number">99</span>;</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(arr); <span class="comment">// arr现在变为[&#x27;A&#x27;, 99, &#x27;C&#x27;]</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(arr[<span class="number">1</span>]); <span class="comment">// 99</span></span><br></pre></td></tr></table></figure><p><em>请注意</em>，如果通过索引赋值时，索引超过了范围，同样会引起<code>Array</code>大小的变化：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 索引超出范围会导致数组大小自动调整:</span></span><br><span class="line"><span class="keyword">let</span> arr = [<span class="string">&#x27;A&#x27;</span>, <span class="string">&#x27;B&#x27;</span>, <span class="string">&#x27;C&#x27;</span>];</span><br><span class="line">arr[<span class="number">5</span>] = <span class="string">&#x27;x&#x27;</span>;</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(arr); <span class="comment">// arr变为[&#x27;A&#x27;, &#x27;B&#x27;, &#x27;C&#x27;, undefined, undefined, &#x27;x&#x27;]</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><p>运行结果：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">A,B,C,,,x</span><br></pre></td></tr></table></figure><p>大多数其他编程语言不允许直接改变数组的大小，越界访问索引会报错。然而，JavaScript的<code>Array</code>却不会有任何错误。在编写代码时，不建议直接修改<code>Array</code>的大小，访问索引时要确保索引不会越界。</p><h4 id="indexOf-1"><a href="#indexOf-1" class="headerlink" title="indexOf"></a>indexOf</h4><p>与String类似，<code>Array</code>也可以通过<code>indexOf()</code>来搜索一个指定的元素的位置：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> arr = [<span class="number">10</span>, <span class="number">20</span>, <span class="string">&#x27;30&#x27;</span>, <span class="string">&#x27;xyz&#x27;</span>];</span><br><span class="line">arr.<span class="title function_">indexOf</span>(<span class="number">10</span>); <span class="comment">// 元素10的索引为0</span></span><br><span class="line">arr.<span class="title function_">indexOf</span>(<span class="number">20</span>); <span class="comment">// 元素20的索引为1</span></span><br><span class="line">arr.<span class="title function_">indexOf</span>(<span class="number">30</span>); <span class="comment">// 元素30没有找到，返回-1</span></span><br><span class="line">arr.<span class="title function_">indexOf</span>(<span class="string">&#x27;30&#x27;</span>); <span class="comment">// 元素&#x27;30&#x27;的索引为2</span></span><br></pre></td></tr></table></figure><p>注意了，数字<code>30</code>和字符串<code>&#39;30&#39;</code>是不同的元素。</p><h4 id="slice"><a href="#slice" class="headerlink" title="slice"></a>slice</h4><p><code>slice()</code>就是对应String的<code>substring()</code>版本，它截取<code>Array</code>的部分元素，然后返回一个新的<code>Array</code>：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> arr = [<span class="string">&#x27;A&#x27;</span>, <span class="string">&#x27;B&#x27;</span>, <span class="string">&#x27;C&#x27;</span>, <span class="string">&#x27;D&#x27;</span>, <span class="string">&#x27;E&#x27;</span>, <span class="string">&#x27;F&#x27;</span>, <span class="string">&#x27;G&#x27;</span>];</span><br><span class="line">arr.<span class="title function_">slice</span>(<span class="number">0</span>, <span class="number">3</span>); <span class="comment">// 从索引0开始，到索引3结束，但不包括索引3: [&#x27;A&#x27;, &#x27;B&#x27;, &#x27;C&#x27;]</span></span><br><span class="line">arr.<span class="title function_">slice</span>(<span class="number">3</span>); <span class="comment">// 从索引3开始到结束: [&#x27;D&#x27;, &#x27;E&#x27;, &#x27;F&#x27;, &#x27;G&#x27;]</span></span><br></pre></td></tr></table></figure><p>注意到<code>slice()</code>的起止参数包括开始索引，不包括结束索引。</p><p>如果不给<code>slice()</code>传递任何参数，它就会从头到尾截取所有元素。利用这一点，我们可以很容易地复制一个<code>Array</code>：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> arr = [<span class="string">&#x27;A&#x27;</span>, <span class="string">&#x27;B&#x27;</span>, <span class="string">&#x27;C&#x27;</span>, <span class="string">&#x27;D&#x27;</span>, <span class="string">&#x27;E&#x27;</span>, <span class="string">&#x27;F&#x27;</span>, <span class="string">&#x27;G&#x27;</span>];</span><br><span class="line"><span class="keyword">let</span> aCopy = arr.<span class="title function_">slice</span>();</span><br><span class="line">aCopy; <span class="comment">// [&#x27;A&#x27;, &#x27;B&#x27;, &#x27;C&#x27;, &#x27;D&#x27;, &#x27;E&#x27;, &#x27;F&#x27;, &#x27;G&#x27;]</span></span><br><span class="line">aCopy === arr; <span class="comment">// false</span></span><br></pre></td></tr></table></figure><h4 id="push和pop"><a href="#push和pop" class="headerlink" title="push和pop"></a>push和pop</h4><p><code>push()</code>向<code>Array</code>的末尾添加若干元素，<code>pop()</code>则把<code>Array</code>的最后一个元素删除掉：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> arr = [<span class="number">1</span>, <span class="number">2</span>];</span><br><span class="line">arr.<span class="title function_">push</span>(<span class="string">&#x27;A&#x27;</span>, <span class="string">&#x27;B&#x27;</span>); <span class="comment">// 返回Array新的长度: 4</span></span><br><span class="line">arr; <span class="comment">// [1, 2, &#x27;A&#x27;, &#x27;B&#x27;]</span></span><br><span class="line">arr.<span class="title function_">pop</span>(); <span class="comment">// pop()返回&#x27;B&#x27;</span></span><br><span class="line">arr; <span class="comment">// [1, 2, &#x27;A&#x27;]</span></span><br><span class="line">arr.<span class="title function_">pop</span>(); arr.<span class="title function_">pop</span>(); arr.<span class="title function_">pop</span>(); <span class="comment">// 连续pop 3次</span></span><br><span class="line">arr; <span class="comment">// []</span></span><br><span class="line">arr.<span class="title function_">pop</span>(); <span class="comment">// 空数组继续pop不会报错，而是返回undefined</span></span><br><span class="line">arr; <span class="comment">// []</span></span><br></pre></td></tr></table></figure><h4 id="unshift和shift"><a href="#unshift和shift" class="headerlink" title="unshift和shift"></a>unshift和shift</h4><p>如果要往<code>Array</code>的头部添加若干元素，使用<code>unshift()</code>方法，<code>shift()</code>方法则把<code>Array</code>的第一个元素删掉：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> arr = [<span class="number">1</span>, <span class="number">2</span>];</span><br><span class="line">arr.<span class="title function_">unshift</span>(<span class="string">&#x27;A&#x27;</span>, <span class="string">&#x27;B&#x27;</span>); <span class="comment">// 返回Array新的长度: 4</span></span><br><span class="line">arr; <span class="comment">// [&#x27;A&#x27;, &#x27;B&#x27;, 1, 2]</span></span><br><span class="line">arr.<span class="title function_">shift</span>(); <span class="comment">// &#x27;A&#x27;</span></span><br><span class="line">arr; <span class="comment">// [&#x27;B&#x27;, 1, 2]</span></span><br><span class="line">arr.<span class="title function_">shift</span>(); arr.<span class="title function_">shift</span>(); arr.<span class="title function_">shift</span>(); <span class="comment">// 连续shift 3次</span></span><br><span class="line">arr; <span class="comment">// []</span></span><br><span class="line">arr.<span class="title function_">shift</span>(); <span class="comment">// 空数组继续shift不会报错，而是返回undefined</span></span><br><span class="line">arr; <span class="comment">// []</span></span><br></pre></td></tr></table></figure><h4 id="sort"><a href="#sort" class="headerlink" title="sort"></a>sort</h4><p><code>sort()</code>可以对当前<code>Array</code>进行排序，它会直接修改当前<code>Array</code>的元素位置，直接调用时，按照默认顺序排序：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> arr = [<span class="string">&#x27;B&#x27;</span>, <span class="string">&#x27;C&#x27;</span>, <span class="string">&#x27;A&#x27;</span>];</span><br><span class="line">arr.<span class="title function_">sort</span>();</span><br><span class="line">arr; <span class="comment">// [&#x27;A&#x27;, &#x27;B&#x27;, &#x27;C&#x27;]</span></span><br></pre></td></tr></table></figure><p>能否按照我们自己指定的顺序排序呢？完全可以，我们将在后面的函数中讲到。</p><h4 id="reverse"><a href="#reverse" class="headerlink" title="reverse"></a>reverse</h4><p><code>reverse()</code>把整个<code>Array</code>的元素给调个个，也就是反转：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> arr = [<span class="string">&#x27;one&#x27;</span>, <span class="string">&#x27;two&#x27;</span>, <span class="string">&#x27;three&#x27;</span>];</span><br><span class="line">arr.<span class="title function_">reverse</span>(); </span><br><span class="line">arr; <span class="comment">// [&#x27;three&#x27;, &#x27;two&#x27;, &#x27;one&#x27;]</span></span><br></pre></td></tr></table></figure><h4 id="splice"><a href="#splice" class="headerlink" title="splice"></a>splice</h4><p><code>splice()</code>方法是修改<code>Array</code>的“万能方法”，它可以从指定的索引开始删除若干元素，然后再从该位置添加若干元素：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> arr = [<span class="string">&#x27;Microsoft&#x27;</span>, <span class="string">&#x27;Apple&#x27;</span>, <span class="string">&#x27;Yahoo&#x27;</span>, <span class="string">&#x27;AOL&#x27;</span>, <span class="string">&#x27;Excite&#x27;</span>, <span class="string">&#x27;Oracle&#x27;</span>];</span><br><span class="line"><span class="comment">// 从索引2开始删除3个元素,然后再添加两个元素:</span></span><br><span class="line">arr.<span class="title function_">splice</span>(<span class="number">2</span>, <span class="number">3</span>, <span class="string">&#x27;Google&#x27;</span>, <span class="string">&#x27;Facebook&#x27;</span>); <span class="comment">// 返回删除的元素 [&#x27;Yahoo&#x27;, &#x27;AOL&#x27;, &#x27;Excite&#x27;]</span></span><br><span class="line">arr; <span class="comment">// [&#x27;Microsoft&#x27;, &#x27;Apple&#x27;, &#x27;Google&#x27;, &#x27;Facebook&#x27;, &#x27;Oracle&#x27;]</span></span><br><span class="line"><span class="comment">// 只删除,不添加:</span></span><br><span class="line">arr.<span class="title function_">splice</span>(<span class="number">2</span>, <span class="number">2</span>); <span class="comment">// [&#x27;Google&#x27;, &#x27;Facebook&#x27;]</span></span><br><span class="line">arr; <span class="comment">// [&#x27;Microsoft&#x27;, &#x27;Apple&#x27;, &#x27;Oracle&#x27;]</span></span><br><span class="line"><span class="comment">// 只添加,不删除:</span></span><br><span class="line">arr.<span class="title function_">splice</span>(<span class="number">2</span>, <span class="number">0</span>, <span class="string">&#x27;Google&#x27;</span>, <span class="string">&#x27;Facebook&#x27;</span>); <span class="comment">// 返回[],因为没有删除任何元素</span></span><br><span class="line">arr; <span class="comment">// [&#x27;Microsoft&#x27;, &#x27;Apple&#x27;, &#x27;Google&#x27;, &#x27;Facebook&#x27;, &#x27;Oracle&#x27;]</span></span><br></pre></td></tr></table></figure><h4 id="concat"><a href="#concat" class="headerlink" title="concat"></a>concat</h4><p><code>concat()</code>方法把当前的<code>Array</code>和另一个<code>Array</code>连接起来，并返回一个新的<code>Array</code>：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> arr = [<span class="string">&#x27;A&#x27;</span>, <span class="string">&#x27;B&#x27;</span>, <span class="string">&#x27;C&#x27;</span>];</span><br><span class="line"><span class="keyword">let</span> added = arr.<span class="title function_">concat</span>([<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>]);</span><br><span class="line">added; <span class="comment">// [&#x27;A&#x27;, &#x27;B&#x27;, &#x27;C&#x27;, 1, 2, 3]</span></span><br><span class="line">arr; <span class="comment">// [&#x27;A&#x27;, &#x27;B&#x27;, &#x27;C&#x27;]</span></span><br></pre></td></tr></table></figure><p><em>请注意</em>，<code>concat()</code>方法并没有修改当前<code>Array</code>，而是返回了一个新的<code>Array</code>。</p><p>实际上，<code>concat()</code>方法可以接收任意个元素和<code>Array</code>，并且自动把<code>Array</code>拆开，然后全部添加到新的<code>Array</code>里：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> arr = [<span class="string">&#x27;A&#x27;</span>, <span class="string">&#x27;B&#x27;</span>, <span class="string">&#x27;C&#x27;</span>];</span><br><span class="line">arr.<span class="title function_">concat</span>(<span class="number">1</span>, <span class="number">2</span>, [<span class="number">3</span>, <span class="number">4</span>]); <span class="comment">// [&#x27;A&#x27;, &#x27;B&#x27;, &#x27;C&#x27;, 1, 2, 3, 4]</span></span><br></pre></td></tr></table></figure><h4 id="join"><a href="#join" class="headerlink" title="join"></a>join</h4><p><code>join()</code>方法是一个非常实用的方法，它把当前<code>Array</code>的每个元素都用指定的字符串连接起来，然后返回连接后的字符串：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> arr = [<span class="string">&#x27;A&#x27;</span>, <span class="string">&#x27;B&#x27;</span>, <span class="string">&#x27;C&#x27;</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>];</span><br><span class="line">arr.<span class="title function_">join</span>(<span class="string">&#x27;-&#x27;</span>); <span class="comment">// &#x27;A-B-C-1-2-3&#x27;</span></span><br></pre></td></tr></table></figure><div class="note warning simple"><p><strong>join()参数需用引号包裹</strong>：<code>.join(&#39;,&#39;)</code> 或 <code>.join(&#39;，&#39;)</code></p></div><h4 id="多维数组"><a href="#多维数组" class="headerlink" title="多维数组"></a>多维数组</h4><p>如果数组的某个元素又是一个<code>Array</code>，则可以形成多维数组，例如：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> arr = [[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>], [<span class="number">400</span>, <span class="number">500</span>, <span class="number">600</span>], <span class="string">&#x27;-&#x27;</span>];</span><br></pre></td></tr></table></figure><p>上述<code>Array</code>包含3个元素，其中头两个元素本身也是<code>Array</code>。</p><h3 id="对象-1"><a href="#对象-1" class="headerlink" title="对象"></a>对象</h3><p>avaScript的对象是一种无序的集合数据类型，它由若干键值对组成。</p><p>JavaScript的对象用于描述现实世界中的某个对象。例如，为了描述“小明”这个淘气的小朋友，我们可以用若干键值对来描述他：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> xiaoming = &#123;</span><br><span class="line">    <span class="attr">name</span>: <span class="string">&#x27;小明&#x27;</span>,</span><br><span class="line">    <span class="attr">birth</span>: <span class="number">1990</span>,</span><br><span class="line">    <span class="attr">school</span>: <span class="string">&#x27;No.1 Middle School&#x27;</span>,</span><br><span class="line">    <span class="attr">height</span>: <span class="number">1.70</span>,</span><br><span class="line">    <span class="attr">weight</span>: <span class="number">65</span>,</span><br><span class="line">    <span class="attr">score</span>: <span class="literal">null</span></span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>JavaScript用一个<code>&#123;...&#125;</code>表示一个对象，键值对以<code>xxx: xxx</code>形式申明，用<code>,</code>隔开。注意，最后一个键值对不需要在末尾加<code>,</code>，如果加了，有的浏览器（如低版本的IE）将报错。</p><p>上述对象申明了一个<code>name</code>属性，值是<code>&#39;小明&#39;</code>，<code>birth</code>属性，值是<code>1990</code>，以及其他一些属性。最后，把这个对象赋值给变量<code>xiaoming</code>后，就可以通过变量<code>xiaoming</code>来获取小明的属性了：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">xiaoming.<span class="property">name</span>; <span class="comment">// &#x27;小明&#x27;</span></span><br><span class="line">xiaoming.<span class="property">birth</span>; <span class="comment">// 1990</span></span><br></pre></td></tr></table></figure><p>访问属性是通过<code>.</code>操作符完成的，但这要求属性名必须是一个有效的变量名。如果属性名包含特殊字符，就必须用<code>&#39;&#39;</code>括起来：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> xiaohong = &#123;</span><br><span class="line">    <span class="attr">name</span>: <span class="string">&#x27;小红&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;middle-school&#x27;</span>: <span class="string">&#x27;No.1 Middle School&#x27;</span></span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p><code>xiaohong</code>的属性名<code>middle-school</code>不是一个有效的变量，就需要用<code>&#39;&#39;</code>括起来。访问这个属性也无法使用<code>.</code>操作符，必须用<code>[&#39;xxx&#39;]</code>来访问：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">xiaohong[<span class="string">&#x27;middle-school&#x27;</span>]; <span class="comment">// &#x27;No.1 Middle School&#x27;</span></span><br><span class="line">xiaohong[<span class="string">&#x27;name&#x27;</span>]; <span class="comment">// &#x27;小红&#x27;</span></span><br><span class="line">xiaohong.<span class="property">name</span>; <span class="comment">// &#x27;小红&#x27;</span></span><br></pre></td></tr></table></figure><p>也可以用<code>xiaohong[&#39;name&#39;]</code>来访问<code>xiaohong</code>的<code>name</code>属性，不过<code>xiaohong.name</code>的写法更简洁。我们在编写JavaScript代码的时候，属性名尽量使用标准的变量名，这样就可以直接通过<code>object.prop</code>的形式访问一个属性了。</p><p>实际上JavaScript对象的所有属性都是字符串，不过属性对应的值可以是任意数据类型。</p><p>如果访问一个不存在的属性会返回什么呢？JavaScript规定，访问不存在的属性不报错，而是返回<code>undefined</code>：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&#x27;use strict&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> xiaoming = &#123;</span><br><span class="line">    <span class="attr">name</span>: <span class="string">&#x27;小明&#x27;</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(xiaoming.<span class="property">name</span>);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(xiaoming.<span class="property">age</span>); <span class="comment">// undefined</span></span><br></pre></td></tr></table></figure><p>由于JavaScript的对象是动态类型，你可以自由地给一个对象添加或删除属性：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> xiaoming = &#123;</span><br><span class="line">    <span class="attr">name</span>: <span class="string">&#x27;小明&#x27;</span></span><br><span class="line">&#125;;</span><br><span class="line">xiaoming.<span class="property">age</span>; <span class="comment">// undefined</span></span><br><span class="line">xiaoming.<span class="property">age</span> = <span class="number">18</span>; <span class="comment">// 新增一个age属性</span></span><br><span class="line">xiaoming.<span class="property">age</span>; <span class="comment">// 18</span></span><br><span class="line"><span class="keyword">delete</span> xiaoming.<span class="property">age</span>; <span class="comment">// 删除age属性</span></span><br><span class="line">xiaoming.<span class="property">age</span>; <span class="comment">// undefined</span></span><br><span class="line"><span class="keyword">delete</span> xiaoming[<span class="string">&#x27;name&#x27;</span>]; <span class="comment">// 删除name属性</span></span><br><span class="line">xiaoming.<span class="property">name</span>; <span class="comment">// undefined</span></span><br><span class="line"><span class="keyword">delete</span> xiaoming.<span class="property">school</span>; <span class="comment">// 删除一个不存在的school属性也不会报错</span></span><br></pre></td></tr></table></figure><p>如果我们要检测<code>xiaoming</code>是否拥有某一属性，可以用<code>in</code>操作符：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> xiaoming = &#123;</span><br><span class="line">    <span class="attr">name</span>: <span class="string">&#x27;小明&#x27;</span>,</span><br><span class="line">    <span class="attr">birth</span>: <span class="number">1990</span>,</span><br><span class="line">    <span class="attr">school</span>: <span class="string">&#x27;No.1 Middle School&#x27;</span>,</span><br><span class="line">    <span class="attr">height</span>: <span class="number">1.70</span>,</span><br><span class="line">    <span class="attr">weight</span>: <span class="number">65</span>,</span><br><span class="line">    <span class="attr">score</span>: <span class="literal">null</span></span><br><span class="line">&#125;;</span><br><span class="line"><span class="string">&#x27;name&#x27;</span> <span class="keyword">in</span> xiaoming; <span class="comment">// true</span></span><br><span class="line"><span class="string">&#x27;grade&#x27;</span> <span class="keyword">in</span> xiaoming; <span class="comment">// false</span></span><br></pre></td></tr></table></figure><p>不过要小心，如果<code>in</code>判断一个属性存在，这个属性不一定是<code>xiaoming</code>的，它可能是<code>xiaoming</code>继承得到的：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&#x27;toString&#x27;</span> <span class="keyword">in</span> xiaoming; <span class="comment">// true</span></span><br></pre></td></tr></table></figure><p>因为<code>toString</code>定义在<code>object</code>对象中，而所有对象最终都会在原型链上指向<code>object</code>，所以<code>xiaoming</code>也拥有<code>toString</code>属性。</p><p>要判断一个属性是否是<code>xiaoming</code>自身拥有的，而不是继承得到的，可以用<code>hasOwnProperty()</code>方法：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> xiaoming = &#123;</span><br><span class="line">    <span class="attr">name</span>: <span class="string">&#x27;小明&#x27;</span></span><br><span class="line">&#125;;</span><br><span class="line">xiaoming.<span class="title function_">hasOwnProperty</span>(<span class="string">&#x27;name&#x27;</span>); <span class="comment">// true</span></span><br><span class="line">xiaoming.<span class="title function_">hasOwnProperty</span>(<span class="string">&#x27;toString&#x27;</span>); <span class="comment">// false</span></span><br></pre></td></tr></table></figure><h3 id="循环"><a href="#循环" class="headerlink" title="循环"></a>循环</h3><h4 id="for-…-in"><a href="#for-…-in" class="headerlink" title="for … in"></a>for … in</h4><p><code>for</code>循环的一个变体是<code>for ... in</code>循环，它可以把一个对象的所有属性依次循环出来：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> o = &#123;</span><br><span class="line">    <span class="attr">name</span>: <span class="string">&#x27;Jack&#x27;</span>,</span><br><span class="line">    <span class="attr">age</span>: <span class="number">20</span>,</span><br><span class="line">    <span class="attr">city</span>: <span class="string">&#x27;Beijing&#x27;</span></span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">let</span> key <span class="keyword">in</span> o) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(key); <span class="comment">// &#x27;name&#x27;, &#x27;age&#x27;, &#x27;city&#x27;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>要过滤掉对象继承的属性，用<code>hasOwnProperty()</code>来实现：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> o = &#123;</span><br><span class="line">    <span class="attr">name</span>: <span class="string">&#x27;Jack&#x27;</span>,</span><br><span class="line">    <span class="attr">age</span>: <span class="number">20</span>,</span><br><span class="line">    <span class="attr">city</span>: <span class="string">&#x27;Beijing&#x27;</span></span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">let</span> key <span class="keyword">in</span> o) &#123;</span><br><span class="line">    <span class="keyword">if</span> (o.<span class="title function_">hasOwnProperty</span>(key)) &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(key); <span class="comment">// &#x27;name&#x27;, &#x27;age&#x27;, &#x27;city&#x27;</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>由于<code>Array</code>也是对象，而它的每个元素的索引被视为对象的属性，因此，<code>for ... in</code>循环可以直接循环出<code>Array</code>的索引：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> a = [<span class="string">&#x27;A&#x27;</span>, <span class="string">&#x27;B&#x27;</span>, <span class="string">&#x27;C&#x27;</span>];</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">let</span> i <span class="keyword">in</span> a) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(i); <span class="comment">// &#x27;0&#x27;, &#x27;1&#x27;, &#x27;2&#x27;</span></span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(a[i]); <span class="comment">// &#x27;A&#x27;, &#x27;B&#x27;, &#x27;C&#x27;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><em>请注意</em>，<code>for ... in</code>对<code>Array</code>的循环得到的是<code>String</code>而不是<code>Number</code>。</p><h3 id="Map和Set"><a href="#Map和Set" class="headerlink" title="Map和Set"></a>Map和Set</h3><h4 id="Map"><a href="#Map" class="headerlink" title="Map"></a>Map</h4><p><code>Map</code>是一组键值对的结构，具有极快的查找速度。</p><p>举个例子，假设要根据同学的名字查找对应的成绩，如果用<code>Array</code>实现，需要两个<code>Array</code>：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> names = [<span class="string">&#x27;Michael&#x27;</span>, <span class="string">&#x27;Bob&#x27;</span>, <span class="string">&#x27;Tracy&#x27;</span>];</span><br><span class="line"><span class="keyword">let</span> scores = [<span class="number">95</span>, <span class="number">75</span>, <span class="number">85</span>];</span><br></pre></td></tr></table></figure><p>给定一个名字，要查找对应的成绩，就先要在names中找到对应的位置，再从scores取出对应的成绩，Array越长，耗时越长。</p><p>如果用Map实现，只需要一个“名字”-“成绩”的对照表，直接根据名字查找成绩，无论这个表有多大，查找速度都不会变慢。用JavaScript写一个Map如下：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> m = <span class="keyword">new</span> <span class="title class_">Map</span>([[<span class="string">&#x27;Michael&#x27;</span>, <span class="number">95</span>], [<span class="string">&#x27;Bob&#x27;</span>, <span class="number">75</span>], [<span class="string">&#x27;Tracy&#x27;</span>, <span class="number">85</span>]]);</span><br><span class="line">m.<span class="title function_">get</span>(<span class="string">&#x27;Michael&#x27;</span>); <span class="comment">// 95</span></span><br></pre></td></tr></table></figure><p>初始化<code>Map</code>需要一个二维数组，或者直接初始化一个空<code>Map</code>。<code>Map</code>具有以下方法：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> m = <span class="keyword">new</span> <span class="title class_">Map</span>(); <span class="comment">// 空Map</span></span><br><span class="line">m.<span class="title function_">set</span>(<span class="string">&#x27;Adam&#x27;</span>, <span class="number">67</span>); <span class="comment">// 添加新的key-value</span></span><br><span class="line">m.<span class="title function_">set</span>(<span class="string">&#x27;Bob&#x27;</span>, <span class="number">59</span>);</span><br><span class="line">m.<span class="title function_">has</span>(<span class="string">&#x27;Adam&#x27;</span>); <span class="comment">// 是否存在key &#x27;Adam&#x27;: true</span></span><br><span class="line">m.<span class="title function_">get</span>(<span class="string">&#x27;Adam&#x27;</span>); <span class="comment">// 67</span></span><br><span class="line">m.<span class="title function_">delete</span>(<span class="string">&#x27;Adam&#x27;</span>); <span class="comment">// 删除key &#x27;Adam&#x27;</span></span><br><span class="line">m.<span class="title function_">get</span>(<span class="string">&#x27;Adam&#x27;</span>); <span class="comment">// undefined</span></span><br></pre></td></tr></table></figure><p>由于一个key只能对应一个value，所以，多次对一个key放入value，后面的值会把前面的值冲掉：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> m = <span class="keyword">new</span> <span class="title class_">Map</span>();</span><br><span class="line">m.<span class="title function_">set</span>(<span class="string">&#x27;Adam&#x27;</span>, <span class="number">67</span>);</span><br><span class="line">m.<span class="title function_">set</span>(<span class="string">&#x27;Adam&#x27;</span>, <span class="number">88</span>);</span><br><span class="line">m.<span class="title function_">get</span>(<span class="string">&#x27;Adam&#x27;</span>); <span class="comment">// 88</span></span><br></pre></td></tr></table></figure><h4 id="Set"><a href="#Set" class="headerlink" title="Set"></a>Set</h4><p><code>Set</code>和<code>Map</code>类似，也是一组key的集合，但不存储value。由于key不能重复，所以，在<code>Set</code>中，没有重复的key。</p><p>要创建一个<code>Set</code>，需要提供一个<code>Array</code>作为输入，或者直接创建一个空<code>Set</code>：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> s1 = <span class="keyword">new</span> <span class="title class_">Set</span>(); <span class="comment">// 空Set</span></span><br><span class="line"><span class="keyword">let</span> s2 = <span class="keyword">new</span> <span class="title class_">Set</span>([<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>]); <span class="comment">// 含1, 2, 3</span></span><br></pre></td></tr></table></figure><p>重复元素在<code>Set</code>中自动被过滤：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> s = <span class="keyword">new</span> <span class="title class_">Set</span>([<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">3</span>, <span class="string">&#x27;3&#x27;</span>]);</span><br><span class="line">s; <span class="comment">// Set &#123;1, 2, 3, &quot;3&quot;&#125;</span></span><br></pre></td></tr></table></figure><p>注意数字<code>3</code>和字符串<code>&#39;3&#39;</code>是不同的元素。</p><p>通过<code>add(key)</code>方法可以添加元素到<code>Set</code>中，可以重复添加，但不会有效果：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">s.<span class="title function_">add</span>(<span class="number">4</span>);</span><br><span class="line">s; <span class="comment">// Set &#123;1, 2, 3, 4&#125;</span></span><br><span class="line">s.<span class="title function_">add</span>(<span class="number">4</span>);</span><br><span class="line">s; <span class="comment">// 仍然是 Set &#123;1, 2, 3, 4&#125;</span></span><br></pre></td></tr></table></figure><p>通过<code>delete(key)</code>方法可以删除元素：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> s = <span class="keyword">new</span> <span class="title class_">Set</span>([<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>]);</span><br><span class="line">s; <span class="comment">// Set &#123;1, 2, 3&#125;</span></span><br><span class="line">s.<span class="title function_">delete</span>(<span class="number">3</span>);</span><br><span class="line">s; <span class="comment">// Set &#123;1, 2&#125;</span></span><br></pre></td></tr></table></figure><h3 id="iterable"><a href="#iterable" class="headerlink" title="iterable"></a>iterable</h3><p>遍历<code>Array</code>可以采用下标循环，遍历<code>Map</code>和<code>Set</code>就无法使用下标。为了统一集合类型，ES6标准引入了新的<code>iterable</code>类型，<code>Array</code>、<code>Map</code>和<code>Set</code>都属于<code>iterable</code>类型。</p><p>具有<code>iterable</code>类型的集合可以通过新的<code>for ... of</code>循环来遍历。</p><p>用<code>for ... of</code>循环遍历集合，用法如下：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> a = [<span class="string">&#x27;A&#x27;</span>, <span class="string">&#x27;B&#x27;</span>, <span class="string">&#x27;C&#x27;</span>];</span><br><span class="line"><span class="keyword">let</span> s = <span class="keyword">new</span> <span class="title class_">Set</span>([<span class="string">&#x27;A&#x27;</span>, <span class="string">&#x27;B&#x27;</span>, <span class="string">&#x27;C&#x27;</span>]);</span><br><span class="line"><span class="keyword">let</span> m = <span class="keyword">new</span> <span class="title class_">Map</span>([[<span class="number">1</span>, <span class="string">&#x27;x&#x27;</span>], [<span class="number">2</span>, <span class="string">&#x27;y&#x27;</span>], [<span class="number">3</span>, <span class="string">&#x27;z&#x27;</span>]]);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">let</span> x <span class="keyword">of</span> a) &#123; <span class="comment">// 遍历Array</span></span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(x);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">let</span> x <span class="keyword">of</span> s) &#123; <span class="comment">// 遍历Set</span></span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(x);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">let</span> x <span class="keyword">of</span> m) &#123; <span class="comment">// 遍历Map</span></span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(x[<span class="number">0</span>] + <span class="string">&#x27;=&#x27;</span> + x[<span class="number">1</span>]);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>你可能会有疑问，<code>for ... of</code>循环和<code>for ... in</code>循环有何区别？</p><p><code>for ... in</code>循环由于历史遗留问题，它遍历的实际上是对象的属性名称。一个<code>Array</code>数组实际上也是一个对象，它的每个元素的索引被视为一个属性。</p><p>当我们手动给<code>Array</code>对象添加了额外的属性后，<code>for ... in</code>循环将带来意想不到的意外效果：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> a = [<span class="string">&#x27;A&#x27;</span>, <span class="string">&#x27;B&#x27;</span>, <span class="string">&#x27;C&#x27;</span>];</span><br><span class="line">a.<span class="property">name</span> = <span class="string">&#x27;Hello&#x27;</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">let</span> x <span class="keyword">in</span> a) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(x); <span class="comment">// &#x27;0&#x27;, &#x27;1&#x27;, &#x27;2&#x27;, &#x27;name&#x27;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>for ... in</code>循环将把<code>name</code>包括在内，但<code>Array</code>的<code>length</code>属性却不包括在内。</p><p><code>for ... of</code>循环则完全修复了这些问题，它只循环集合本身的元素：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> a = [<span class="string">&#x27;A&#x27;</span>, <span class="string">&#x27;B&#x27;</span>, <span class="string">&#x27;C&#x27;</span>];</span><br><span class="line">a.<span class="property">name</span> = <span class="string">&#x27;Hello&#x27;</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">let</span> x <span class="keyword">of</span> a) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(x); <span class="comment">// &#x27;A&#x27;, &#x27;B&#x27;, &#x27;C&#x27;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>这就是为什么要引入新的<code>for ... of</code>循环。</p><p>然而，更好的方式是直接使用<code>iterable</code>内置的<code>forEach</code>方法，它接收一个函数，每次迭代就自动回调该函数。以<code>Array</code>为例：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> a = [<span class="string">&#x27;A&#x27;</span>, <span class="string">&#x27;B&#x27;</span>, <span class="string">&#x27;C&#x27;</span>];</span><br><span class="line">a.<span class="title function_">forEach</span>(<span class="keyword">function</span> (<span class="params">element, index, array</span>) &#123;</span><br><span class="line">    <span class="comment">// element: 指向当前元素的值</span></span><br><span class="line">    <span class="comment">// index: 指向当前索引</span></span><br><span class="line">    <span class="comment">// array: 指向Array对象本身</span></span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`<span class="subst">$&#123;element&#125;</span>, index = <span class="subst">$&#123;index&#125;</span>`</span>);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>运行结果：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">A, index = <span class="number">0</span></span><br><span class="line">B, index = <span class="number">1</span></span><br><span class="line">C, index = <span class="number">2</span></span><br></pre></td></tr></table></figure><p><em>注意</em>，<code>forEach()</code>方法是ES5.1标准引入的，你需要测试浏览器是否支持。</p><p><code>Set</code>与<code>Array</code>类似，但<code>Set</code>没有索引，因此回调函数的前两个参数都是元素本身：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> s = <span class="keyword">new</span> <span class="title class_">Set</span>([<span class="string">&#x27;A&#x27;</span>, <span class="string">&#x27;B&#x27;</span>, <span class="string">&#x27;C&#x27;</span>]);</span><br><span class="line">s.<span class="title function_">forEach</span>(<span class="keyword">function</span> (<span class="params">element, sameElement, set</span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(element);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p><code>Map</code>的回调函数参数依次为<code>value</code>、<code>key</code>和<code>map</code>本身：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> m = <span class="keyword">new</span> <span class="title class_">Map</span>([[<span class="number">1</span>, <span class="string">&#x27;x&#x27;</span>], [<span class="number">2</span>, <span class="string">&#x27;y&#x27;</span>], [<span class="number">3</span>, <span class="string">&#x27;z&#x27;</span>]]);</span><br><span class="line">m.<span class="title function_">forEach</span>(<span class="keyword">function</span> (<span class="params">value, key, map</span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(value);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p>如果对某些参数不感兴趣，由于JavaScript的函数调用不要求参数必须一致，因此可以忽略它们。例如，只需要获得<code>Array</code>的<code>element</code>：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> a = [<span class="string">&#x27;A&#x27;</span>, <span class="string">&#x27;B&#x27;</span>, <span class="string">&#x27;C&#x27;</span>];</span><br><span class="line">a.<span class="title function_">forEach</span>(<span class="keyword">function</span> (<span class="params">element</span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(element);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><h2 id="函数"><a href="#函数" class="headerlink" title="函数"></a>函数</h2><h3 id="函数定义和调用"><a href="#函数定义和调用" class="headerlink" title="函数定义和调用"></a>函数定义和调用</h3><h4 id="定义函数"><a href="#定义函数" class="headerlink" title="定义函数"></a>定义函数</h4><p>在JavaScript中，定义函数的方式如下：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">abs</span>(<span class="params">x</span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> (x &gt;= <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> x;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> -x;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>上述<code>abs()</code>函数的定义如下：</p><ul><li><code>function</code>指出这是一个函数定义；</li><li><code>abs</code>是函数的名称；</li><li><code>(x)</code>括号内列出函数的参数，多个参数以<code>,</code>分隔；</li><li><code>&#123; ... &#125;</code>之间的代码是函数体，可以包含若干语句，甚至可以没有任何语句。</li></ul><p>请注意，函数体内部的语句在执行时，一旦执行到<code>return</code>时，函数就执行完毕，并将结果返回。因此，函数内部通过条件判断和循环可以实现非常复杂的逻辑。</p><p>如果没有<code>return</code>语句，函数执行完毕后也会返回结果，只是结果为<code>undefined</code>。</p><p>由于JavaScript的函数也是一个对象，上述定义的<code>abs()</code>函数实际上是一个函数对象，而函数名<code>abs</code>可以视为指向该函数的变量。</p><p>因此，第二种定义函数的方式如下：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> abs = <span class="keyword">function</span> (<span class="params">x</span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> (x &gt;= <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> x;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> -x;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>在这种方式下，<code>function (x) &#123; ... &#125;</code>是一个匿名函数，它没有函数名。但是，这个匿名函数赋值给了变量<code>abs</code>，所以，通过变量<code>abs</code>就可以调用该函数。</p><p>上述两种定义<em>完全等价</em>，注意第二种方式按照完整语法需要在函数体末尾加一个<code>;</code>，表示赋值语句结束。</p><h4 id="调用函数"><a href="#调用函数" class="headerlink" title="调用函数"></a>调用函数</h4><p>调用函数时，按顺序传入参数即可：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_">abs</span>(<span class="number">10</span>); <span class="comment">// 返回10</span></span><br><span class="line"><span class="title function_">abs</span>(-<span class="number">9</span>); <span class="comment">// 返回9</span></span><br></pre></td></tr></table></figure><p>由于JavaScript允许传入任意个参数而不影响调用，因此传入的参数比定义的参数多也没有问题，虽然函数内部并不需要这些参数：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_">abs</span>(<span class="number">10</span>, <span class="string">&#x27;blablabla&#x27;</span>); <span class="comment">// 返回10</span></span><br><span class="line"><span class="title function_">abs</span>(-<span class="number">9</span>, <span class="string">&#x27;haha&#x27;</span>, <span class="string">&#x27;hehe&#x27;</span>, <span class="literal">null</span>); <span class="comment">// 返回9</span></span><br></pre></td></tr></table></figure><p>传入的参数比定义的少也没有问题：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_">abs</span>(); <span class="comment">// 返回NaN</span></span><br></pre></td></tr></table></figure><p>此时<code>abs(x)</code>函数的参数<code>x</code>将收到<code>undefined</code>，计算结果为<code>NaN</code>。</p><p>要避免收到<code>undefined</code>，可以对参数进行检查：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">abs</span>(<span class="params">x</span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">typeof</span> x !== <span class="string">&#x27;number&#x27;</span>) &#123;</span><br><span class="line">        <span class="keyword">throw</span> <span class="string">&#x27;Not a number&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (x &gt;= <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> x;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> -x;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="arguments"><a href="#arguments" class="headerlink" title="arguments"></a>arguments</h4><p>JavaScript还有一个免费赠送的关键字<code>arguments</code>，它只在函数内部起作用，并且永远指向当前函数的调用者传入的所有参数。<code>arguments</code>类似<code>Array</code>但它不是一个<code>Array</code>：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">foo</span>(<span class="params">x</span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;x = &#x27;</span> + x); <span class="comment">// 10</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">let</span> i=<span class="number">0</span>; i&lt;<span class="variable language_">arguments</span>.<span class="property">length</span>; i++) &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;arg &#x27;</span> + i + <span class="string">&#x27; = &#x27;</span> + <span class="variable language_">arguments</span>[i]); <span class="comment">// 10, 20, 30</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="title function_">foo</span>(<span class="number">10</span>, <span class="number">20</span>, <span class="number">30</span>);</span><br></pre></td></tr></table></figure><p>运行结果：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">x = <span class="number">10</span></span><br><span class="line">arg <span class="number">0</span> = <span class="number">10</span></span><br><span class="line">arg <span class="number">1</span> = <span class="number">20</span></span><br><span class="line">arg <span class="number">2</span> = <span class="number">30</span></span><br></pre></td></tr></table></figure><p>利用<code>arguments</code>，你可以获得调用者传入的所有参数。也就是说，即使函数不定义任何参数，还是可以拿到参数的值：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">abs</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="variable language_">arguments</span>.<span class="property">length</span> === <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">let</span> x = <span class="variable language_">arguments</span>[<span class="number">0</span>];</span><br><span class="line">    <span class="keyword">return</span> x &gt;= <span class="number">0</span> ? x : -x;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title function_">abs</span>(); <span class="comment">// 0</span></span><br><span class="line"><span class="title function_">abs</span>(<span class="number">10</span>); <span class="comment">// 10</span></span><br><span class="line"><span class="title function_">abs</span>(-<span class="number">9</span>); <span class="comment">// 9</span></span><br></pre></td></tr></table></figure><p>实际上<code>arguments</code>最常用于判断传入参数的个数。你可能会看到这样的写法：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// foo(a[, b], c)</span></span><br><span class="line"><span class="comment">// 接收2~3个参数，b是可选参数，如果只传2个参数，b默认为null：</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">foo</span>(<span class="params">a, b, c</span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="variable language_">arguments</span>.<span class="property">length</span> === <span class="number">2</span>) &#123;</span><br><span class="line">        <span class="comment">// 实际拿到的参数是a和b，c为undefined</span></span><br><span class="line">        c = b; <span class="comment">// 把b赋给c</span></span><br><span class="line">        b = <span class="literal">null</span>; <span class="comment">// b变为默认值</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>要把中间的参数<code>b</code>变为“可选”参数，就只能通过<code>arguments</code>判断，然后重新调整参数并赋值。</p><h4 id="rest参数"><a href="#rest参数" class="headerlink" title="rest参数"></a>rest参数</h4><p>由于JavaScript函数允许接收任意个参数，于是我们就不得不用<code>arguments</code>来获取所有参数：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">foo</span>(<span class="params">a, b</span>) &#123;</span><br><span class="line">    <span class="keyword">let</span> i, rest = [];</span><br><span class="line">    <span class="keyword">if</span> (<span class="variable language_">arguments</span>.<span class="property">length</span> &gt; <span class="number">2</span>) &#123;</span><br><span class="line">        <span class="keyword">for</span> (i = <span class="number">2</span>; i&lt;<span class="variable language_">arguments</span>.<span class="property">length</span>; i++) &#123;</span><br><span class="line">            rest.<span class="title function_">push</span>(<span class="variable language_">arguments</span>[i]);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;a = &#x27;</span> + a);</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;b = &#x27;</span> + b);</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(rest);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>为了获取除了已定义参数<code>a</code>、<code>b</code>之外的参数，我们不得不用<code>arguments</code>，并且循环要从索引<code>2</code>开始以便排除前两个参数，这种写法很别扭，只是为了获得额外的<code>rest</code>参数，有没有更好的方法？</p><p>ES6标准引入了rest参数，上面的函数可以改写为：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">foo</span>(<span class="params">a, b, ...rest</span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;a = &#x27;</span> + a);</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;b = &#x27;</span> + b);</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(rest);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title function_">foo</span>(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>);</span><br><span class="line"><span class="comment">// 结果:</span></span><br><span class="line"><span class="comment">// a = 1</span></span><br><span class="line"><span class="comment">// b = 2</span></span><br><span class="line"><span class="comment">// Array [ 3, 4, 5 ]</span></span><br><span class="line"></span><br><span class="line"><span class="title function_">foo</span>(<span class="number">1</span>);</span><br><span class="line"><span class="comment">// 结果:</span></span><br><span class="line"><span class="comment">// a = 1</span></span><br><span class="line"><span class="comment">// b = undefined</span></span><br><span class="line"><span class="comment">// Array []</span></span><br></pre></td></tr></table></figure><p><strong>rest参数只能写在最后，前面用<code>...</code>标识</strong>，从运行结果可知，传入的参数先绑定<code>a</code>、<code>b</code>，多余的参数以数组形式交给变量<code>rest</code>，所以，不再需要<code>arguments</code>我们就获取了全部参数。</p><p>如果传入的参数连正常定义的参数都没填满，也不要紧，rest参数会接收一个空数组（注意不是<code>undefined</code>）。</p><div class="note warning simple"><h4 id="小心你的return语句"><a href="#小心你的return语句" class="headerlink" title="小心你的return语句"></a>小心你的return语句</h4><p>前面我们讲到了JavaScript引擎有一个在行末自动添加分号的机制，这可能让你栽到return语句的一个大坑：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">foo</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> &#123; <span class="attr">name</span>: <span class="string">&#x27;foo&#x27;</span> &#125;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title function_">foo</span>(); <span class="comment">// &#123; name: &#x27;foo&#x27; &#125;</span></span><br></pre></td></tr></table></figure><p>如果把return语句拆成两行：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">foo</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span></span><br><span class="line">        &#123; <span class="attr">name</span>: <span class="string">&#x27;foo&#x27;</span> &#125;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title function_">foo</span>(); <span class="comment">// undefined</span></span><br></pre></td></tr></table></figure><p><em>要小心了</em>，由于JavaScript引擎在行末自动添加分号的机制，上面的代码实际上变成了：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">foo</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span>; <span class="comment">// 自动添加了分号，相当于return undefined;</span></span><br><span class="line">        &#123; <span class="attr">name</span>: <span class="string">&#x27;foo&#x27;</span> &#125;; <span class="comment">// 这行语句已经没法执行到了</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>所以正确的多行写法是：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">foo</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> &#123; <span class="comment">// 这里不会自动加分号，因为&#123;表示语句尚未结束</span></span><br><span class="line">        <span class="attr">name</span>: <span class="string">&#x27;foo&#x27;</span></span><br><span class="line">    &#125;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div><h3 id="变量作用域与解构赋值"><a href="#变量作用域与解构赋值" class="headerlink" title="变量作用域与解构赋值"></a>变量作用域与解构赋值</h3><h4 id="变量提升"><a href="#变量提升" class="headerlink" title="变量提升"></a>变量提升</h4><p>JavaScript的函数定义有个特点，它会先扫描整个函数体的语句，把所有用<code>var</code>申明的变量“提升”到函数顶部：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">foo</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">var</span> x = <span class="string">&#x27;Hello, &#x27;</span> + y;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(x);</span><br><span class="line">    <span class="keyword">var</span> y = <span class="string">&#x27;Bob&#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title function_">foo</span>();</span><br></pre></td></tr></table></figure><p>虽然是strict模式，但语句<code>var x = &#39;Hello, &#39; + y;</code>并不报错，原因是变量<code>y</code>在稍后申明了。但是<code>console.log</code>显示<code>Hello, undefined</code>，说明变量<code>y</code>的值为<code>undefined</code>。这正是因为JavaScript引擎<strong>自动提升了变量<code>y</code>的声明，但不会提升变量<code>y</code>的赋值</strong>。</p><p>对于上述<code>foo()</code>函数，JavaScript引擎看到的代码相当于：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">foo</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">var</span> y; <span class="comment">// 提升变量y的申明，此时y为undefined</span></span><br><span class="line">    <span class="keyword">var</span> x = <span class="string">&#x27;Hello, &#x27;</span> + y;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(x);</span><br><span class="line">    y = <span class="string">&#x27;Bob&#x27;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>由于JavaScript的这一怪异的“特性”，我们在函数内部定义变量时，请严格遵守“在函数内部首先申明所有变量”这一规则。最常见的做法是用一个<code>var</code>申明函数内部用到的所有变量：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">foo</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">var</span></span><br><span class="line">        x = <span class="number">1</span>, <span class="comment">// x初始化为1</span></span><br><span class="line">        y = x + <span class="number">1</span>, <span class="comment">// y初始化为2</span></span><br><span class="line">        z, i; <span class="comment">// z和i为undefined</span></span><br><span class="line">    <span class="comment">// 其他语句:</span></span><br><span class="line">    <span class="keyword">for</span> (i=<span class="number">0</span>; i&lt;<span class="number">100</span>; i++) &#123;</span><br><span class="line">        ...</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>如果不需要兼容低版本浏览器，完全可以用<code>let</code>代替<code>var</code>来申明变量。</p><h4 id="全局作用域"><a href="#全局作用域" class="headerlink" title="全局作用域"></a>全局作用域</h4><p>不在任何函数内定义的变量就具有全局作用域。实际上，JavaScript默认有一个全局对象<code>window</code>，全局作用域的变量实际上被绑定到<code>window</code>的一个属性：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> course = <span class="string">&#x27;Learn JavaScript&#x27;</span>;</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(course); <span class="comment">// &#x27;Learn JavaScript&#x27;</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="variable language_">window</span>.<span class="property">course</span>); <span class="comment">// &#x27;Learn JavaScript&#x27;</span></span><br></pre></td></tr></table></figure><p>因此，直接访问全局变量<code>course</code>和访问<code>window.course</code>是完全一样的。</p><p>你可能猜到了，由于函数定义有两种方式，以变量方式<code>var foo = function () &#123;&#125;</code>定义的函数实际上也是一个全局变量，因此，顶层函数的定义也被视为一个全局变量，并绑定到<code>window</code>对象：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">foo</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="title function_">alert</span>(<span class="string">&#x27;foo&#x27;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title function_">foo</span>(); <span class="comment">// 直接调用foo()</span></span><br><span class="line"><span class="variable language_">window</span>.<span class="title function_">foo</span>(); <span class="comment">// 通过window.foo()调用</span></span><br></pre></td></tr></table></figure><p>进一步大胆地猜测，我们每次直接调用的<code>alert()</code>函数其实也是<code>window</code>的一个变量：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">window</span>.<span class="title function_">alert</span>(<span class="string">&#x27;调用window.alert()&#x27;</span>);</span><br><span class="line"><span class="comment">// 把alert保存到另一个变量:</span></span><br><span class="line"><span class="keyword">let</span> old_alert = <span class="variable language_">window</span>.<span class="property">alert</span>;</span><br><span class="line"><span class="comment">// 给alert赋一个新函数:</span></span><br><span class="line"><span class="variable language_">window</span>.<span class="property">alert</span> = <span class="keyword">function</span> (<span class="params"></span>) &#123;&#125;</span><br><span class="line"></span><br><span class="line"><span class="title function_">alert</span>(<span class="string">&#x27;无法用alert()显示了!&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 恢复alert:</span></span><br><span class="line"><span class="variable language_">window</span>.<span class="property">alert</span> = old_alert;</span><br><span class="line"><span class="title function_">alert</span>(<span class="string">&#x27;又可以用alert()了!&#x27;</span>);</span><br></pre></td></tr></table></figure><p>这说明JavaScript实际上只有一个全局作用域。任何变量（函数也视为变量），如果没有在当前函数作用域中找到，就会继续往上查找，最后如果在全局作用域中也没有找到，则报<code>ReferenceError</code>错误。</p><h4 id="名字空间"><a href="#名字空间" class="headerlink" title="名字空间"></a>名字空间</h4><p>全局变量会绑定到<code>window</code>上，不同的JavaScript文件如果使用了相同的全局变量，或者定义了相同名字的顶层函数，都会造成命名冲突，并且很难被发现。</p><p>减少冲突的一个方法是把自己的所有变量和函数全部绑定到一个全局变量中。例如：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 唯一的全局变量MYAPP:</span></span><br><span class="line"><span class="keyword">let</span> <span class="variable constant_">MYAPP</span> = &#123;&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 其他变量:</span></span><br><span class="line"><span class="variable constant_">MYAPP</span>.<span class="property">name</span> = <span class="string">&#x27;myapp&#x27;</span>;</span><br><span class="line"><span class="variable constant_">MYAPP</span>.<span class="property">version</span> = <span class="number">1.0</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 其他函数:</span></span><br><span class="line"><span class="variable constant_">MYAPP</span>.<span class="property">foo</span> = <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;foo&#x27;</span>;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>把自己的代码全部放入唯一的名字空间<code>MYAPP</code>中，会大大减少全局变量冲突的可能。</p><p>许多著名的JavaScript库都是这么干的：jQuery，YUI，underscore等等。</p><h4 id="局部作用域"><a href="#局部作用域" class="headerlink" title="局部作用域"></a>局部作用域</h4><p>由于JavaScript的变量作用域实际上是函数内部，我们在<code>for</code>循环等语句块中是无法定义具有局部作用域的变量的：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">foo</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> i=<span class="number">0</span>; i&lt;<span class="number">100</span>; i++) &#123;</span><br><span class="line">        <span class="comment">//</span></span><br><span class="line">    &#125;</span><br><span class="line">    i += <span class="number">100</span>; <span class="comment">// 仍然可以引用变量i</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>为了解决块级作用域，ES6引入了新的关键字<code>let</code>，用<code>let</code>替代<code>var</code>可以申明一个块级作用域的变量：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">foo</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">let</span> sum = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">let</span> i=<span class="number">0</span>; i&lt;<span class="number">100</span>; i++) &#123;</span><br><span class="line">        sum += i;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// SyntaxError:</span></span><br><span class="line">    i += <span class="number">1</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><div class="note info simple"><p>i</p><p>在 JavaScript 中，<code>let</code> 和 <code>var</code> 都是用于声明变量的关键字，但它们在作用域、提升和重复声明等方面有显著区别：</p><ol><li><strong>作用域（Scope）</strong></li></ol><ul><li><p><strong><code>var</code></strong>:  </p><ul><li>只有 <strong>函数作用域</strong>（function scope）或 <strong>全局作用域</strong>（global scope）。  </li><li>在代码块（如 <code>{}</code>、<code>if</code>、<code>for</code>）中声明的变量会 <strong>泄露到外部</strong>。  <figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (<span class="literal">true</span>) &#123;</span><br><span class="line">  <span class="keyword">var</span> a = <span class="number">10</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(a); <span class="comment">// 输出 10（变量泄露到外部）</span></span><br></pre></td></tr></table></figure></li></ul></li><li><p><strong><code>let</code></strong>:  </p><ul><li>具有 <strong>块级作用域</strong>（block scope）。  </li><li>只在声明它的代码块（如 <code>{}</code>、<code>if</code>、<code>for</code>）内有效。  <figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (<span class="literal">true</span>) &#123;</span><br><span class="line">  <span class="keyword">let</span> b = <span class="number">20</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(b); <span class="comment">// 报错：b is not defined</span></span><br></pre></td></tr></table></figure></li></ul></li></ul><ol><li><strong>变量提升（Hoisting）</strong></li></ol><ul><li><p><strong><code>var</code></strong>:  </p><ul><li>变量会被提升到作用域顶部，<strong>初始值为 <code>undefined</code></strong>。  </li><li>可以在声明前访问（值为 <code>undefined</code>）。  <figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(x); <span class="comment">// 输出 undefined（不会报错）</span></span><br><span class="line"><span class="keyword">var</span> x = <span class="number">5</span>;</span><br></pre></td></tr></table></figure></li></ul></li><li><p><strong><code>let</code></strong>:  </p><ul><li>变量也会提升，但处于 <strong>“暂时性死区”（TDZ）</strong>。  </li><li>在声明前访问会抛出 <strong><code>ReferenceError</code></strong>。  <figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(y); <span class="comment">// 报错：Cannot access &#x27;y&#x27; before initialization</span></span><br><span class="line"><span class="keyword">let</span> y = <span class="number">10</span>;</span><br></pre></td></tr></table></figure></li></ul></li></ul><ol><li><strong>重复声明</strong></li></ol><ul><li><p><strong><code>var</code></strong>:  </p><ul><li>允许在 <strong>同一作用域内重复声明</strong>（覆盖之前的值）。  <figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> z = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">var</span> z = <span class="number">2</span>; <span class="comment">// 合法</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(z); <span class="comment">// 输出 2</span></span><br></pre></td></tr></table></figure></li></ul></li><li><p><strong><code>let</code></strong>:  </p><ul><li>禁止在 <strong>同一作用域内重复声明</strong>（会抛出语法错误）。  <figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> w = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">let</span> w = <span class="number">2</span>; <span class="comment">// 报错：Identifier &#x27;w&#x27; has already been declared</span></span><br></pre></td></tr></table></figure></li></ul></li></ul><ol><li><strong>全局作用域的行为</strong></li></ol><ul><li><p><strong><code>var</code></strong>:  </p><ul><li>在全局作用域声明的变量会成为 <strong><code>window</code> 对象的属性</strong>（浏览器环境）。  <figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> globalVar = <span class="string">&quot;Hi&quot;</span>;</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="variable language_">window</span>.<span class="property">globalVar</span>); <span class="comment">// 输出 &quot;Hi&quot;</span></span><br></pre></td></tr></table></figure></li></ul></li><li><p><strong><code>let</code></strong>:  </p><ul><li>在全局作用域声明的变量 <strong>不会</strong> 成为 <code>window</code> 对象的属性。  <figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> globalLet = <span class="string">&quot;Hello&quot;</span>;</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="variable language_">window</span>.<span class="property">globalLet</span>); <span class="comment">// 输出 undefined</span></span><br></pre></td></tr></table></figure></li></ul></li></ul><ol><li><strong>循环中的表现（关键区别）</strong></li></ol><ul><li><p><strong><code>var</code> 在循环中</strong>:  </p><ul><li>由于没有块级作用域，循环中的变量会 <strong>共享同一个作用域</strong>。  <figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; <span class="number">3</span>; i++) &#123;</span><br><span class="line">  <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> <span class="variable language_">console</span>.<span class="title function_">log</span>(i), <span class="number">100</span>); <span class="comment">// 输出 3, 3, 3</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ul></li><li><p><strong><code>let</code> 在循环中</strong>:  </p><ul><li>每次迭代创建一个 <strong>新的块级作用域</strong>，解决循环闭包问题。  <figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> (<span class="keyword">let</span> j = <span class="number">0</span>; j &lt; <span class="number">3</span>; j++) &#123;</span><br><span class="line">  <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> <span class="variable language_">console</span>.<span class="title function_">log</span>(j), <span class="number">100</span>); <span class="comment">// 输出 0, 1, 2</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ul></li></ul><p>总结表</p><div class="table-container"><table><thead><tr><th>特性</th><th><code>var</code></th><th><code>let</code></th></tr></thead><tbody><tr><td><strong>作用域</strong></td><td>函数作用域 / 全局作用域</td><td>块级作用域</td></tr><tr><td><strong>变量提升</strong></td><td>提升，初始值为 <code>undefined</code></td><td>提升（TDZ），访问报错</td></tr><tr><td><strong>重复声明</strong></td><td>允许</td><td>禁止（同一作用域）</td></tr><tr><td><strong>全局属性</strong></td><td>成为 <code>window</code> 的属性</td><td>不会成为 <code>window</code> 的属性</td></tr><tr><td><strong>循环中的行为</strong></td><td>共享同一变量</td><td>每次迭代创建新变量</td></tr></tbody></table></div></div><h4 id="常量"><a href="#常量" class="headerlink" title="常量"></a>常量</h4><p>由于<code>var</code>和<code>let</code>申明的是变量，如果要申明一个常量，在ES6之前是不行的，我们通常用全部大写的变量来表示“这是一个常量，不要修改它的值”：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> <span class="variable constant_">PI</span> = <span class="number">3.14</span>;</span><br></pre></td></tr></table></figure><p>ES6标准引入了新的关键字<code>const</code>来定义常量，<code>const</code>与<code>let</code>都具有块级作用域：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="variable constant_">PI</span> = <span class="number">3.14</span>;</span><br><span class="line"><span class="variable constant_">PI</span> = <span class="number">3</span>; <span class="comment">// 某些浏览器不报错，但是无效果！</span></span><br><span class="line"><span class="variable constant_">PI</span>; <span class="comment">// 3.14</span></span><br></pre></td></tr></table></figure><h4 id="解构赋值"><a href="#解构赋值" class="headerlink" title="解构赋值"></a>解构赋值</h4><p>从ES6开始，JavaScript引入了解构赋值，可以同时对一组变量进行赋值。</p><p>什么是解构赋值？我们先看看传统的做法，如何把一个数组的元素分别赋值给几个变量：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> array = [<span class="string">&#x27;hello&#x27;</span>, <span class="string">&#x27;JavaScript&#x27;</span>, <span class="string">&#x27;ES6&#x27;</span>];</span><br><span class="line"><span class="keyword">let</span> x = array[<span class="number">0</span>];</span><br><span class="line"><span class="keyword">let</span> y = array[<span class="number">1</span>];</span><br><span class="line"><span class="keyword">let</span> z = array[<span class="number">2</span>];</span><br></pre></td></tr></table></figure><p>现在，在ES6中，可以使用解构赋值，直接对多个变量同时赋值：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 如果浏览器支持解构赋值就不会报错:</span></span><br><span class="line"><span class="keyword">let</span> [x, y, z] = [<span class="string">&#x27;hello&#x27;</span>, <span class="string">&#x27;JavaScript&#x27;</span>, <span class="string">&#x27;ES6&#x27;</span>];</span><br><span class="line"></span><br><span class="line"><span class="comment">// x, y, z分别被赋值为数组对应元素:</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`x = <span class="subst">$&#123;x&#125;</span>, y = <span class="subst">$&#123;y&#125;</span>, z = <span class="subst">$&#123;z&#125;</span>`</span>);</span><br></pre></td></tr></table></figure><p>运行结果：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">x = hello, y = <span class="title class_">JavaScript</span>, z = <span class="title class_">ES6</span></span><br></pre></td></tr></table></figure><p>注意，对数组元素进行解构赋值时，多个变量要用<code>[...]</code>括起来。</p><p>如果数组本身还有嵌套，也可以通过下面的形式进行解构赋值，注意嵌套层次和位置要保持一致：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> [x, [y, z]] = [<span class="string">&#x27;hello&#x27;</span>, [<span class="string">&#x27;JavaScript&#x27;</span>, <span class="string">&#x27;ES6&#x27;</span>]];</span><br><span class="line">x; <span class="comment">// &#x27;hello&#x27;</span></span><br><span class="line">y; <span class="comment">// &#x27;JavaScript&#x27;</span></span><br><span class="line">z; <span class="comment">// &#x27;ES6&#x27;</span></span><br></pre></td></tr></table></figure><p>解构赋值还可以忽略某些元素：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> [, , z] = [<span class="string">&#x27;hello&#x27;</span>, <span class="string">&#x27;JavaScript&#x27;</span>, <span class="string">&#x27;ES6&#x27;</span>]; <span class="comment">// 忽略前两个元素，只对z赋值第三个元素</span></span><br><span class="line">z; <span class="comment">// &#x27;ES6&#x27;</span></span><br></pre></td></tr></table></figure><p>如果需要从一个对象中取出若干属性，也可以使用解构赋值，便于快速获取对象的指定属性：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> person = &#123;</span><br><span class="line">    <span class="attr">name</span>: <span class="string">&#x27;小明&#x27;</span>,</span><br><span class="line">    <span class="attr">age</span>: <span class="number">20</span>,</span><br><span class="line">    <span class="attr">gender</span>: <span class="string">&#x27;male&#x27;</span>,</span><br><span class="line">    <span class="attr">passport</span>: <span class="string">&#x27;G-12345678&#x27;</span>,</span><br><span class="line">    <span class="attr">school</span>: <span class="string">&#x27;No.4 middle school&#x27;</span></span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">let</span> &#123;name, age, passport&#125; = person;</span><br><span class="line"></span><br><span class="line"><span class="comment">// name, age, passport分别被赋值为对应属性:</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`name = <span class="subst">$&#123;name&#125;</span>, age = <span class="subst">$&#123;age&#125;</span>, passport = <span class="subst">$&#123;passport&#125;</span>`</span>);</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>运行结果：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">name = 小明, age = <span class="number">20</span>, passport = G-<span class="number">12345678</span></span><br></pre></td></tr></table></figure><p>对一个对象进行解构赋值时，同样可以直接对嵌套的对象属性进行赋值，只要保证对应的层次是一致的：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> person = &#123;</span><br><span class="line">    <span class="attr">name</span>: <span class="string">&#x27;小明&#x27;</span>,</span><br><span class="line">    <span class="attr">age</span>: <span class="number">20</span>,</span><br><span class="line">    <span class="attr">gender</span>: <span class="string">&#x27;male&#x27;</span>,</span><br><span class="line">    <span class="attr">passport</span>: <span class="string">&#x27;G-12345678&#x27;</span>,</span><br><span class="line">    <span class="attr">school</span>: <span class="string">&#x27;No.4 middle school&#x27;</span>,</span><br><span class="line">    <span class="attr">address</span>: &#123;</span><br><span class="line">        <span class="attr">city</span>: <span class="string">&#x27;Beijing&#x27;</span>,</span><br><span class="line">        <span class="attr">street</span>: <span class="string">&#x27;No.1 Road&#x27;</span>,</span><br><span class="line">        <span class="attr">zipcode</span>: <span class="string">&#x27;100001&#x27;</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">let</span> &#123;name, <span class="attr">address</span>: &#123;city, zip&#125;&#125; = person;</span><br><span class="line">name; <span class="comment">// &#x27;小明&#x27;</span></span><br><span class="line">city; <span class="comment">// &#x27;Beijing&#x27;</span></span><br><span class="line">zip; <span class="comment">// undefined, 因为属性名是zipcode而不是zip</span></span><br><span class="line"><span class="comment">// 注意: address不是变量，而是为了让city和zip获得嵌套的address对象的属性:</span></span><br><span class="line">address; <span class="comment">// Uncaught ReferenceError: address is not defined</span></span><br></pre></td></tr></table></figure><p>使用解构赋值对对象属性进行赋值时，如果对应的属性不存在，变量将被赋值为<code>undefined</code>，这和引用一个不存在的属性获得<code>undefined</code>是一致的。如果要使用的变量名和属性名不一致，可以用下面的语法获取：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> person = &#123;</span><br><span class="line">    <span class="attr">name</span>: <span class="string">&#x27;小明&#x27;</span>,</span><br><span class="line">    <span class="attr">age</span>: <span class="number">20</span>,</span><br><span class="line">    <span class="attr">gender</span>: <span class="string">&#x27;male&#x27;</span>,</span><br><span class="line">    <span class="attr">passport</span>: <span class="string">&#x27;G-12345678&#x27;</span>,</span><br><span class="line">    <span class="attr">school</span>: <span class="string">&#x27;No.4 middle school&#x27;</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 把passport属性赋值给变量id:</span></span><br><span class="line"><span class="keyword">let</span> &#123;name, <span class="attr">passport</span>:id&#125; = person;</span><br><span class="line">name; <span class="comment">// &#x27;小明&#x27;</span></span><br><span class="line">id; <span class="comment">// &#x27;G-12345678&#x27;</span></span><br><span class="line"><span class="comment">// 注意: passport不是变量，而是为了让变量id获得passport属性:</span></span><br><span class="line">passport; <span class="comment">// Uncaught ReferenceError: passport is not defined</span></span><br></pre></td></tr></table></figure><p>解构赋值还可以使用默认值，这样就避免了不存在的属性返回<code>undefined</code>的问题：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> person = &#123;</span><br><span class="line">    <span class="attr">name</span>: <span class="string">&#x27;小明&#x27;</span>,</span><br><span class="line">    <span class="attr">age</span>: <span class="number">20</span>,</span><br><span class="line">    <span class="attr">gender</span>: <span class="string">&#x27;male&#x27;</span>,</span><br><span class="line">    <span class="attr">passport</span>: <span class="string">&#x27;G-12345678&#x27;</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 如果person对象没有single属性，默认赋值为true:</span></span><br><span class="line"><span class="keyword">let</span> &#123;name, single=<span class="literal">true</span>&#125; = person;</span><br><span class="line">name; <span class="comment">// &#x27;小明&#x27;</span></span><br><span class="line">single; <span class="comment">// true</span></span><br></pre></td></tr></table></figure><p>有些时候，如果变量已经被声明了，再次赋值的时候，正确的写法也会报语法错误：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 声明变量:</span></span><br><span class="line"><span class="keyword">let</span> x, y;</span><br><span class="line"><span class="comment">// 解构赋值:</span></span><br><span class="line">&#123;x, y&#125; = &#123; <span class="attr">name</span>: <span class="string">&#x27;小明&#x27;</span>, <span class="attr">x</span>: <span class="number">100</span>, <span class="attr">y</span>: <span class="number">200</span>&#125;;</span><br><span class="line"><span class="comment">// 语法错误: Uncaught SyntaxError: Unexpected token =</span></span><br></pre></td></tr></table></figure><p>这是因为JavaScript引擎把<code>&#123;</code>开头的语句当作了块处理，于是<code>=</code>不再合法。解决方法是用小括号括起来：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">(&#123;x, y&#125; = &#123; <span class="attr">name</span>: <span class="string">&#x27;小明&#x27;</span>, <span class="attr">x</span>: <span class="number">100</span>, <span class="attr">y</span>: <span class="number">200</span>&#125;);</span><br></pre></td></tr></table></figure><p><strong>括号的作用</strong>：强制告诉引擎 <code>&#123;...&#125;</code> 是一个<strong>表达式</strong>（赋值语句的一部分），而不是代码块</p><h4 id="使用场景"><a href="#使用场景" class="headerlink" title="使用场景"></a>使用场景</h4><p>解构赋值在很多时候可以大大简化代码。例如，交换两个变量<code>x</code>和<code>y</code>的值，可以这么写，不再需要临时变量：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> x=<span class="number">1</span>, y=<span class="number">2</span>;</span><br><span class="line">[x, y] = [y, x]</span><br></pre></td></tr></table></figure><p>快速获取当前页面的域名和路径：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> &#123;<span class="attr">hostname</span>:domain, <span class="attr">pathname</span>:path&#125; = location;</span><br></pre></td></tr></table></figure><p>如果一个函数接收一个对象作为参数，那么，可以使用解构直接把对象的属性绑定到变量中。例如，下面的函数可以快速创建一个<code>Date</code>对象：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">buildDate</span>(<span class="params">&#123;year, month, day, hour=<span class="number">0</span>, minute=<span class="number">0</span>, second=<span class="number">0</span>&#125;</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Date</span>(<span class="string">`<span class="subst">$&#123;year&#125;</span>-<span class="subst">$&#123;month&#125;</span>-<span class="subst">$&#123;day&#125;</span> <span class="subst">$&#123;hour&#125;</span>:<span class="subst">$&#123;minute&#125;</span>:<span class="subst">$&#123;second&#125;</span>`</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>它的方便之处在于传入的对象只需要<code>year</code>、<code>month</code>和<code>day</code>这三个属性：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_">buildDate</span>(&#123; <span class="attr">year</span>: <span class="number">2017</span>, <span class="attr">month</span>: <span class="number">1</span>, <span class="attr">day</span>: <span class="number">1</span> &#125;);</span><br><span class="line"><span class="comment">// Sun Jan 01 2017 00:00:00 GMT+0800 (CST)</span></span><br></pre></td></tr></table></figure><p>也可以传入<code>hour</code>、<code>minute</code>和<code>second</code>属性：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_">buildDate</span>(&#123; <span class="attr">year</span>: <span class="number">2017</span>, <span class="attr">month</span>: <span class="number">1</span>, <span class="attr">day</span>: <span class="number">1</span>, <span class="attr">hour</span>: <span class="number">20</span>, <span class="attr">minute</span>: <span class="number">15</span> &#125;);</span><br><span class="line"><span class="comment">// Sun Jan 01 2017 20:15:00 GMT+0800 (CST)</span></span><br></pre></td></tr></table></figure><p>使用解构赋值可以减少代码量，但是，需要在支持ES6解构赋值特性的现代浏览器中才能正常运行。目前支持解构赋值的浏览器包括Chrome，Firefox，Edge等。</p><h3 id="方法"><a href="#方法" class="headerlink" title="方法"></a>方法</h3><p>在一个对象中绑定函数，称为这个对象的方法。</p><p>在JavaScript中，对象的定义是这样的：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> xiaoming = &#123;</span><br><span class="line">    <span class="attr">name</span>: <span class="string">&#x27;小明&#x27;</span>,</span><br><span class="line">    <span class="attr">birth</span>: <span class="number">1990</span></span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>但是，如果我们给<code>xiaoming</code>绑定一个函数，就可以做更多的事情。比如，写个<code>age()</code>方法，返回<code>xiaoming</code>的年龄：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> xiaoming = &#123;</span><br><span class="line">    <span class="attr">name</span>: <span class="string">&#x27;小明&#x27;</span>,</span><br><span class="line">    <span class="attr">birth</span>: <span class="number">1990</span>,</span><br><span class="line">    <span class="attr">age</span>: <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">        <span class="keyword">let</span> y = <span class="keyword">new</span> <span class="title class_">Date</span>().<span class="title function_">getFullYear</span>();</span><br><span class="line">        <span class="keyword">return</span> y - <span class="variable language_">this</span>.<span class="property">birth</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">xiaoming.<span class="property">age</span>; <span class="comment">// function xiaoming.age()</span></span><br><span class="line">xiaoming.<span class="title function_">age</span>(); <span class="comment">// 今年调用是25,明年调用就变成26了</span></span><br></pre></td></tr></table></figure><p>绑定到对象上的函数称为方法，和普通函数也没啥区别，但是它在内部使用了一个<code>this</code>关键字，这个东东是什么？</p><p>在一个方法内部，<code>this</code>是一个特殊变量，它始终指向当前对象，也就是<code>xiaoming</code>这个变量。所以，<code>this.birth</code>可以拿到<code>xiaoming</code>的<code>birth</code>属性。</p><p>让我们拆开写：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">getAge</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">let</span> y = <span class="keyword">new</span> <span class="title class_">Date</span>().<span class="title function_">getFullYear</span>();</span><br><span class="line">    <span class="keyword">return</span> y - <span class="variable language_">this</span>.<span class="property">birth</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> xiaoming = &#123;</span><br><span class="line">    <span class="attr">name</span>: <span class="string">&#x27;小明&#x27;</span>,</span><br><span class="line">    <span class="attr">birth</span>: <span class="number">1990</span>,</span><br><span class="line">    <span class="attr">age</span>: getAge</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">xiaoming.<span class="title function_">age</span>(); <span class="comment">// 25, 正常结果</span></span><br><span class="line"><span class="title function_">getAge</span>(); <span class="comment">// NaN</span></span><br></pre></td></tr></table></figure><p>单独调用函数<code>getAge()</code>怎么返回了<code>NaN</code>？<em>请注意</em>，我们已经进入到了JavaScript的一个大坑里。</p><p>JavaScript的函数内部如果调用了<code>this</code>，那么这个<code>this</code>到底指向谁？</p><p>答案是，视情况而定！</p><p>如果以对象的方法形式调用，比如<code>xiaoming.age()</code>，该函数的<code>this</code>指向被调用的对象，也就是<code>xiaoming</code>，这是符合我们预期的。</p><p>如果单独调用函数，比如<code>getAge()</code>，此时，该函数的<code>this</code>指向全局对象，也就是<code>window</code>。</p><p>坑爹啊！</p><p>更坑爹的是，如果这么写：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> fn = xiaoming.<span class="property">age</span>; <span class="comment">// 先拿到xiaoming的age函数</span></span><br><span class="line"><span class="title function_">fn</span>(); <span class="comment">// NaN</span></span><br></pre></td></tr></table></figure><p>也是不行的！要保证<code>this</code>指向正确，必须用<code>obj.xxx()</code>的形式调用！</p><p>由于这是一个巨大的设计错误，要想纠正可没那么简单。ECMA决定，在strict模式下让函数的<code>this</code>指向<code>undefined</code>，因此，在strict模式下，你会得到一个错误：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&#x27;use strict&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> xiaoming = &#123;</span><br><span class="line">    <span class="attr">name</span>: <span class="string">&#x27;小明&#x27;</span>,</span><br><span class="line">    <span class="attr">birth</span>: <span class="number">1990</span>,</span><br><span class="line">    <span class="attr">age</span>: <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">        <span class="keyword">let</span> y = <span class="keyword">new</span> <span class="title class_">Date</span>().<span class="title function_">getFullYear</span>();</span><br><span class="line">        <span class="keyword">return</span> y - <span class="variable language_">this</span>.<span class="property">birth</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> fn = xiaoming.<span class="property">age</span>;</span><br><span class="line"><span class="title function_">fn</span>(); <span class="comment">// Uncaught TypeError: Cannot read property &#x27;birth&#x27; of undefined</span></span><br></pre></td></tr></table></figure><p>这个决定只是让错误及时暴露出来，并没有解决<code>this</code>应该指向的正确位置。</p><p>有些时候，喜欢重构的你把方法重构了一下：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&#x27;use strict&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> xiaoming = &#123;</span><br><span class="line">    <span class="attr">name</span>: <span class="string">&#x27;小明&#x27;</span>,</span><br><span class="line">    <span class="attr">birth</span>: <span class="number">1990</span>,</span><br><span class="line">    <span class="attr">age</span>: <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">        <span class="keyword">function</span> <span class="title function_">getAgeFromBirth</span>(<span class="params"></span>) &#123;</span><br><span class="line">            <span class="keyword">let</span> y = <span class="keyword">new</span> <span class="title class_">Date</span>().<span class="title function_">getFullYear</span>();</span><br><span class="line">            <span class="keyword">return</span> y - <span class="variable language_">this</span>.<span class="property">birth</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="title function_">getAgeFromBirth</span>();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">xiaoming.<span class="title function_">age</span>(); <span class="comment">// Uncaught TypeError: Cannot read property &#x27;birth&#x27; of undefined</span></span><br></pre></td></tr></table></figure><p>结果又报错了！原因是<code>this</code>指针只在<code>age</code>方法的函数内指向<code>xiaoming</code>，在函数内部定义的函数，<code>this</code>又指向<code>undefined</code>了！（在非strict模式下，它重新指向全局对象<code>window</code>！）</p><p>修复的办法也不是没有，我们用一个<code>that</code>变量首先捕获<code>this</code>：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&#x27;use strict&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> xiaoming = &#123;</span><br><span class="line">    <span class="attr">name</span>: <span class="string">&#x27;小明&#x27;</span>,</span><br><span class="line">    <span class="attr">birth</span>: <span class="number">1990</span>,</span><br><span class="line">    <span class="attr">age</span>: <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">        <span class="keyword">let</span> that = <span class="variable language_">this</span>; <span class="comment">// 在方法内部一开始就捕获this</span></span><br><span class="line">        <span class="keyword">function</span> <span class="title function_">getAgeFromBirth</span>(<span class="params"></span>) &#123;</span><br><span class="line">            <span class="keyword">let</span> y = <span class="keyword">new</span> <span class="title class_">Date</span>().<span class="title function_">getFullYear</span>();</span><br><span class="line">            <span class="keyword">return</span> y - that.<span class="property">birth</span>; <span class="comment">// 用that而不是this</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="title function_">getAgeFromBirth</span>();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">xiaoming.<span class="title function_">age</span>(); <span class="comment">// 25</span></span><br></pre></td></tr></table></figure><p>用<code>let that = this;</code>，你就可以放心地在方法内部定义其他函数，而不是把所有语句都堆到一个方法中。</p><h4 id="apply"><a href="#apply" class="headerlink" title="apply"></a>apply</h4><p>虽然在一个独立的函数调用中，根据是否是strict模式，<code>this</code>指向<code>undefined</code>或<code>window</code>，不过，我们还是可以控制<code>this</code>的指向的！</p><p>要指定函数的<code>this</code>指向哪个对象，可以用函数本身的<code>apply</code>方法，它接收两个参数，第一个参数就是需要绑定的<code>this</code>变量，第二个参数是<code>Array</code>，表示函数本身的参数。</p><p>用<code>apply</code>修复<code>getAge()</code>调用：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">getAge</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">let</span> y = <span class="keyword">new</span> <span class="title class_">Date</span>().<span class="title function_">getFullYear</span>();</span><br><span class="line">    <span class="keyword">return</span> y - <span class="variable language_">this</span>.<span class="property">birth</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> xiaoming = &#123;</span><br><span class="line">    <span class="attr">name</span>: <span class="string">&#x27;小明&#x27;</span>,</span><br><span class="line">    <span class="attr">birth</span>: <span class="number">1990</span>,</span><br><span class="line">    <span class="attr">age</span>: getAge</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">xiaoming.<span class="title function_">age</span>(); <span class="comment">// 25</span></span><br><span class="line">getAge.<span class="title function_">apply</span>(xiaoming, []); <span class="comment">// 25, this指向xiaoming, 参数为空</span></span><br></pre></td></tr></table></figure><p>另一个与<code>apply()</code>类似的方法是<code>call()</code>，唯一区别是：</p><ul><li><code>apply()</code>把参数打包成<code>Array</code>再传入；</li><li><code>call()</code>把参数按顺序传入。</li></ul><p>比如调用<code>Math.max(3, 5, 4)</code>，分别用<code>apply()</code>和<code>call()</code>实现如下：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="title class_">Math</span>.<span class="property">max</span>.<span class="title function_">apply</span>(<span class="literal">null</span>, [<span class="number">3</span>, <span class="number">5</span>, <span class="number">4</span>]); <span class="comment">// 5</span></span><br><span class="line"><span class="title class_">Math</span>.<span class="property">max</span>.<span class="title function_">call</span>(<span class="literal">null</span>, <span class="number">3</span>, <span class="number">5</span>, <span class="number">4</span>); <span class="comment">// 5</span></span><br></pre></td></tr></table></figure><p>对普通函数调用，我们通常把<code>this</code>绑定为<code>null</code>。</p><h4 id="装饰器"><a href="#装饰器" class="headerlink" title="装饰器"></a>装饰器</h4><p>利用<code>apply()</code>，我们还可以动态改变函数的行为。</p><p>JavaScript的所有对象都是动态的，即使内置的函数，我们也可以重新指向新的函数。</p><p>现在假定我们想统计一下代码一共调用了多少次<code>parseInt()</code>，可以把所有的调用都找出来，然后手动加上<code>count += 1</code>，不过这样做太傻了。最佳方案是用我们自己的函数替换掉默认的<code>parseInt()</code>：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&#x27;use strict&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> count = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">let</span> oldParseInt = <span class="built_in">parseInt</span>; <span class="comment">// 保存原函数</span></span><br><span class="line"></span><br><span class="line"><span class="variable language_">window</span>.<span class="property">parseInt</span> = <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">    count += <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">return</span> oldParseInt.<span class="title function_">apply</span>(<span class="literal">null</span>, <span class="variable language_">arguments</span>); <span class="comment">// 调用原函数</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 测试:</span></span><br><span class="line"><span class="built_in">parseInt</span>(<span class="string">&#x27;10&#x27;</span>);</span><br><span class="line"><span class="built_in">parseInt</span>(<span class="string">&#x27;20&#x27;</span>);</span><br><span class="line"><span class="built_in">parseInt</span>(<span class="string">&#x27;30&#x27;</span>);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;count = &#x27;</span> + count); <span class="comment">// 3</span></span><br></pre></td></tr></table></figure><h3 id="高阶函数"><a href="#高阶函数" class="headerlink" title="高阶函数"></a>高阶函数</h3><h4 id="map"><a href="#map" class="headerlink" title="map"></a>map</h4><p>举例说明，比如我们有一个函数f(x)=x2，要把这个函数作用在一个数组<code>[1, 2, 3, 4, 5, 6, 7, 8, 9]</code>上，就可以用<code>map</code>实现如下：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">            f(x) = x * x</span><br><span class="line"></span><br><span class="line">                  │</span><br><span class="line">                  │</span><br><span class="line">  ┌───┬───┬───┬───┼───┬───┬───┬───┐</span><br><span class="line">  │   │   │   │   │   │   │   │   │</span><br><span class="line">  ▼   ▼   ▼   ▼   ▼   ▼   ▼   ▼   ▼</span><br><span class="line"></span><br><span class="line">[ 1   2   3   4   5   6   7   8   9 ]</span><br><span class="line"></span><br><span class="line">  │   │   │   │   │   │   │   │   │</span><br><span class="line">  │   │   │   │   │   │   │   │   │</span><br><span class="line">  ▼   ▼   ▼   ▼   ▼   ▼   ▼   ▼   ▼</span><br><span class="line"></span><br><span class="line">[ 1   4   9  16  25  36  49  64  81 ]</span><br></pre></td></tr></table></figure><p>由于<code>map()</code>方法定义在JavaScript的<code>Array</code>中，我们调用<code>Array</code>的<code>map()</code>方法，传入我们自己的函数，就得到了一个新的<code>Array</code>作为结果：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">pow</span>(<span class="params">x</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> x * x;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> arr = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">8</span>, <span class="number">9</span>];</span><br><span class="line"><span class="keyword">let</span> results = arr.<span class="title function_">map</span>(pow); <span class="comment">// [1, 4, 9, 16, 25, 36, 49, 64, 81]</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(results);</span><br></pre></td></tr></table></figure><p>注意：<code>map()</code>传入的参数是<code>pow</code>，即函数对象本身。</p><p>你可能会想，不需要<code>map()</code>，写一个循环，也可以计算出结果：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> f = <span class="keyword">function</span> (<span class="params">x</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> x * x;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> arr = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">8</span>, <span class="number">9</span>];</span><br><span class="line"><span class="keyword">let</span> result = [];</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">let</span> i=<span class="number">0</span>; i&lt;arr.<span class="property">length</span>; i++) &#123;</span><br><span class="line">    result.<span class="title function_">push</span>(<span class="title function_">f</span>(arr[i]));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>的确可以，但是，从上面的循环代码，我们无法一眼看明白“把f(x)作用在Array的每一个元素并把结果生成一个新的Array”。</p><p>所以，<code>map()</code>作为高阶函数，事实上它把运算规则抽象了，因此，我们不但可以计算简单的f(x)=x2，还可以计算任意复杂的函数，比如，把<code>Array</code>的所有数字转为字符串：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> arr = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">8</span>, <span class="number">9</span>];</span><br><span class="line">arr.<span class="title function_">map</span>(<span class="title class_">String</span>); <span class="comment">// [&#x27;1&#x27;, &#x27;2&#x27;, &#x27;3&#x27;, &#x27;4&#x27;, &#x27;5&#x27;, &#x27;6&#x27;, &#x27;7&#x27;, &#x27;8&#x27;, &#x27;9&#x27;]</span></span><br></pre></td></tr></table></figure><p>只需要一行代码。</p><h4 id="reduce"><a href="#reduce" class="headerlink" title="reduce"></a>reduce</h4><p>再看reduce的用法。Array的<code>reduce()</code>把一个函数作用在这个<code>Array</code>的<code>[x1, x2, x3...]</code>上，这个函数必须接收两个参数，<code>reduce()</code>把结果继续和序列的下一个元素做累积计算，其效果就是：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[x1, x2, x3, x4].<span class="title function_">reduce</span>(f) = <span class="title function_">f</span>(<span class="title function_">f</span>(<span class="title function_">f</span>(x1, x2), x3), x4)</span><br></pre></td></tr></table></figure><p>比方说对一个<code>Array</code>求和，就可以用<code>reduce</code>实现：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> arr = [<span class="number">1</span>, <span class="number">3</span>, <span class="number">5</span>, <span class="number">7</span>, <span class="number">9</span>];</span><br><span class="line">arr.<span class="title function_">reduce</span>(<span class="keyword">function</span> (<span class="params">x, y</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> x + y;</span><br><span class="line">&#125;); <span class="comment">// 25</span></span><br></pre></td></tr></table></figure><p>如果数组元素只有1个，那么还需要提供一个额外的初始参数以便至少凑够两：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> arr = [<span class="number">123</span>];</span><br><span class="line">arr.<span class="title function_">reduce</span>(<span class="keyword">function</span> (<span class="params">x, y</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> x + y;</span><br><span class="line">&#125;, <span class="number">0</span>); <span class="comment">// 123</span></span><br></pre></td></tr></table></figure><h4 id="filter"><a href="#filter" class="headerlink" title="filter"></a>filter</h4><p>filter也是一个常用的操作，它用于把<code>Array</code>的某些元素过滤掉，然后返回剩下的元素。</p><p>和<code>map()</code>类似，<code>Array</code>的<code>filter()</code>也接收一个函数。和<code>map()</code>不同的是，<code>filter()</code>把传入的函数依次作用于每个元素，然后根据返回值是<code>true</code>还是<code>false</code>决定保留还是丢弃该元素。</p><p>例如，在一个<code>Array</code>中，删掉偶数，只保留奇数，可以这么写：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> arr = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">9</span>, <span class="number">10</span>, <span class="number">15</span>];</span><br><span class="line"><span class="keyword">let</span> r = arr.<span class="title function_">filter</span>(<span class="keyword">function</span> (<span class="params">x</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> x % <span class="number">2</span> !== <span class="number">0</span>;</span><br><span class="line">&#125;);</span><br><span class="line">r; <span class="comment">// [1, 5, 9, 15]</span></span><br></pre></td></tr></table></figure><p>把一个<code>Array</code>中的空字符串删掉，可以这么写：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> arr = [<span class="string">&#x27;A&#x27;</span>, <span class="string">&#x27;&#x27;</span>, <span class="string">&#x27;B&#x27;</span>, <span class="literal">null</span>, <span class="literal">undefined</span>, <span class="string">&#x27;C&#x27;</span>, <span class="string">&#x27;  &#x27;</span>];</span><br><span class="line"><span class="keyword">let</span> r = arr.<span class="title function_">filter</span>(<span class="keyword">function</span> (<span class="params">s</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> s &amp;&amp; s.<span class="title function_">trim</span>(); <span class="comment">// 注意：IE9以下的版本没有trim()方法</span></span><br><span class="line">&#125;);</span><br><span class="line">r; <span class="comment">// [&#x27;A&#x27;, &#x27;B&#x27;, &#x27;C&#x27;]</span></span><br></pre></td></tr></table></figure><p>可见用<code>filter()</code>这个高阶函数，关键在于正确实现一个“筛选”函数。</p><p><strong>回调函数</strong></p><p><code>filter()</code>接收的回调函数，其实可以有多个参数。通常我们仅使用第一个参数，表示<code>Array</code>的某个元素。回调函数还可以接收另外两个参数，表示元素的位置和数组本身：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> arr = [<span class="string">&#x27;A&#x27;</span>, <span class="string">&#x27;B&#x27;</span>, <span class="string">&#x27;C&#x27;</span>];</span><br><span class="line"><span class="keyword">let</span> r = arr.<span class="title function_">filter</span>(<span class="keyword">function</span> (<span class="params">element, index, self</span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(element); <span class="comment">// 依次打印&#x27;A&#x27;, &#x27;B&#x27;, &#x27;C&#x27;</span></span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(index); <span class="comment">// 依次打印0, 1, 2</span></span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(self); <span class="comment">// self就是变量arr</span></span><br><span class="line">    <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p>利用<code>filter</code>，可以巧妙地去除<code>Array</code>的重复元素：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span></span><br><span class="line">    r,</span><br><span class="line">    arr = [<span class="string">&#x27;apple&#x27;</span>, <span class="string">&#x27;strawberry&#x27;</span>, <span class="string">&#x27;banana&#x27;</span>, <span class="string">&#x27;pear&#x27;</span>, <span class="string">&#x27;apple&#x27;</span>, <span class="string">&#x27;orange&#x27;</span>, <span class="string">&#x27;orange&#x27;</span>, <span class="string">&#x27;strawberry&#x27;</span>];</span><br><span class="line"></span><br><span class="line">r = arr.<span class="title function_">filter</span>(<span class="keyword">function</span> (<span class="params">element, index, self</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> self.<span class="title function_">indexOf</span>(element) === index;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(r);</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>运行结果：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">apple,strawberry,banana,pear,orange</span><br></pre></td></tr></table></figure><p>去除重复元素依靠的是<code>indexOf</code>总是返回第一个元素的位置，后续的重复元素位置与<code>indexOf</code>返回的位置不相等，因此被<code>filter</code>滤掉了。</p><h4 id="sort-1"><a href="#sort-1" class="headerlink" title="sort"></a>sort</h4><p>排序也是在程序中经常用到的算法。无论使用冒泡排序还是快速排序，排序的核心是比较两个元素的大小。如果是数字，我们可以直接比较，但如果是字符串或者两个对象呢？直接比较数学上的大小是没有意义的，因此，比较的过程必须通过函数抽象出来。通常规定，对于两个元素<code>x</code>和<code>y</code>，如果认为<code>x &lt; y</code>，则返回<code>-1</code>，如果认为<code>x == y</code>，则返回<code>0</code>，如果认为<code>x &gt; y</code>，则返回<code>1</code>，这样，排序算法就不用关心具体的比较过程，而是根据比较结果直接排序。</p><p>JavaScript的<code>Array</code>的<code>sort()</code>方法就是用于排序的，但是排序结果可能让你大吃一惊：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 看上去正常的结果:</span></span><br><span class="line">[<span class="string">&#x27;Google&#x27;</span>, <span class="string">&#x27;Apple&#x27;</span>, <span class="string">&#x27;Microsoft&#x27;</span>].<span class="title function_">sort</span>(); <span class="comment">// [&#x27;Apple&#x27;, &#x27;Google&#x27;, &#x27;Microsoft&#x27;];</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// apple排在了最后:</span></span><br><span class="line">[<span class="string">&#x27;Google&#x27;</span>, <span class="string">&#x27;apple&#x27;</span>, <span class="string">&#x27;Microsoft&#x27;</span>].<span class="title function_">sort</span>(); <span class="comment">// [&#x27;Google&#x27;, &#x27;Microsoft&quot;, &#x27;apple&#x27;]</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 无法理解的结果:</span></span><br><span class="line">[<span class="number">10</span>, <span class="number">20</span>, <span class="number">1</span>, <span class="number">2</span>].<span class="title function_">sort</span>(); <span class="comment">// [1, 10, 2, 20]</span></span><br></pre></td></tr></table></figure><p>第二个排序把<code>apple</code>排在了最后，是因为字符串根据ASCII码进行排序，而小写字母<code>a</code>的ASCII码在大写字母之后。</p><p>第三个排序结果是什么鬼？简单的数字排序都能错？</p><p>这是因为<code>Array</code>的<code>sort()</code>方法默认把所有元素先转换为String再排序，结果<code>&#39;10&#39;</code>排在了<code>&#39;2&#39;</code>的前面，因为字符<code>&#39;1&#39;</code>比字符<code>&#39;2&#39;</code>的ASCII码小。</p><p>如果不知道<code>sort()</code>方法的默认排序规则，直接对数字排序，绝对栽进坑里！</p><p>幸运的是，<code>sort()</code>方法也是一个高阶函数，它还可以接收一个比较函数来实现自定义的排序。</p><p>要按数字大小排序，我们可以这么写：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> arr = [<span class="number">10</span>, <span class="number">20</span>, <span class="number">1</span>, <span class="number">2</span>];</span><br><span class="line"></span><br><span class="line">arr.<span class="title function_">sort</span>(<span class="keyword">function</span> (<span class="params">x, y</span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> (x &lt; y) &#123;</span><br><span class="line">        <span class="keyword">return</span> -<span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (x &gt; y) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(arr); <span class="comment">// [1, 2, 10, 20]</span></span><br></pre></td></tr></table></figure><p>如果要倒序排序，我们可以把大的数放前面：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> arr = [<span class="number">10</span>, <span class="number">20</span>, <span class="number">1</span>, <span class="number">2</span>];</span><br><span class="line">arr.<span class="title function_">sort</span>(<span class="keyword">function</span> (<span class="params">x, y</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> y - x;</span><br><span class="line">&#125;); <span class="comment">// [20, 10, 2, 1]</span></span><br></pre></td></tr></table></figure><p>给<code>sort()</code>传入的比较函数接受<code>x</code>和<code>y</code>两个参数，如果<code>x&lt;y</code>，应返回负数，如果<code>x&gt;y</code>，应返回正数，如果<code>x=y</code>，应返回0。</p><p>默认情况下，对字符串排序，是按照ASCII的大小比较的，现在，我们提出排序应该忽略大小写，按照字母序排序。要实现这个算法，不必对现有代码大加改动，只要我们能定义出忽略大小写的比较算法就可以：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> arr = [<span class="string">&#x27;Google&#x27;</span>, <span class="string">&#x27;apple&#x27;</span>, <span class="string">&#x27;Microsoft&#x27;</span>];</span><br><span class="line">arr.<span class="title function_">sort</span>(<span class="keyword">function</span> (<span class="params">s1, s2</span>) &#123;</span><br><span class="line">    x1 = s1.<span class="title function_">toUpperCase</span>();</span><br><span class="line">    x2 = s2.<span class="title function_">toUpperCase</span>();</span><br><span class="line">    <span class="keyword">if</span> (x1 &lt; x2) &#123;</span><br><span class="line">        <span class="keyword">return</span> -<span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (x1 &gt; x2) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;); <span class="comment">// [&#x27;apple&#x27;, &#x27;Google&#x27;, &#x27;Microsoft&#x27;]</span></span><br></pre></td></tr></table></figure><p>忽略大小写来比较两个字符串，实际上就是先把字符串都变成大写（或者都变成小写），再比较。</p><p>从上述例子可以看出，高阶函数的抽象能力是非常强大的，而且，核心代码可以保持得非常简洁。</p><p>最后友情提示，<code>sort()</code>方法会直接对<code>Array</code>进行修改，它返回的结果仍是当前<code>Array</code>：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> a1 = [<span class="string">&#x27;B&#x27;</span>, <span class="string">&#x27;A&#x27;</span>, <span class="string">&#x27;C&#x27;</span>];</span><br><span class="line"><span class="keyword">let</span> a2 = a1.<span class="title function_">sort</span>();</span><br><span class="line">a1; <span class="comment">// [&#x27;A&#x27;, &#x27;B&#x27;, &#x27;C&#x27;]</span></span><br><span class="line">a2; <span class="comment">// [&#x27;A&#x27;, &#x27;B&#x27;, &#x27;C&#x27;]</span></span><br><span class="line">a1 === a2; <span class="comment">// true, a1和a2是同一对象</span></span><br></pre></td></tr></table></figure><div class="note info simple"><p>用lodash包</p></div><h4 id="其他"><a href="#其他" class="headerlink" title="其他"></a>其他</h4><h5 id="every"><a href="#every" class="headerlink" title="every"></a>every</h5><p><code>every()</code>方法可以判断数组的所有元素是否满足测试条件。</p><p>例如，给定一个包含若干字符串的数组，判断所有字符串是否满足指定的测试条件：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> arr = [<span class="string">&#x27;Apple&#x27;</span>, <span class="string">&#x27;pear&#x27;</span>, <span class="string">&#x27;orange&#x27;</span>];</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(arr.<span class="title function_">every</span>(<span class="keyword">function</span> (<span class="params">s</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> s.<span class="property">length</span> &gt; <span class="number">0</span>;</span><br><span class="line">&#125;)); <span class="comment">// true, 因为每个元素都满足s.length&gt;0</span></span><br><span class="line"></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(arr.<span class="title function_">every</span>(<span class="keyword">function</span> (<span class="params">s</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> s.<span class="title function_">toLowerCase</span>() === s;</span><br><span class="line">&#125;)); <span class="comment">// false, 因为不是每个元素都全部是小写</span></span><br></pre></td></tr></table></figure><h5 id="find"><a href="#find" class="headerlink" title="find"></a>find</h5><p><code>find()</code>方法用于查找符合条件的第一个元素，如果找到了，返回这个元素，否则，返回<code>undefined</code>：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> arr = [<span class="string">&#x27;Apple&#x27;</span>, <span class="string">&#x27;pear&#x27;</span>, <span class="string">&#x27;orange&#x27;</span>];</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(arr.<span class="title function_">find</span>(<span class="keyword">function</span> (<span class="params">s</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> s.<span class="title function_">toLowerCase</span>() === s;</span><br><span class="line">&#125;)); <span class="comment">// &#x27;pear&#x27;, 因为pear全部是小写</span></span><br><span class="line"></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(arr.<span class="title function_">find</span>(<span class="keyword">function</span> (<span class="params">s</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> s.<span class="title function_">toUpperCase</span>() === s;</span><br><span class="line">&#125;)); <span class="comment">// undefined, 因为没有全部是大写的元素</span></span><br></pre></td></tr></table></figure><h5 id="findIndex"><a href="#findIndex" class="headerlink" title="findIndex"></a>findIndex</h5><p><code>findIndex()</code>和<code>find()</code>类似，也是查找符合条件的第一个元素，不同之处在于<code>findIndex()</code>会返回这个元素的索引，如果没有找到，返回<code>-1</code>：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> arr = [<span class="string">&#x27;Apple&#x27;</span>, <span class="string">&#x27;pear&#x27;</span>, <span class="string">&#x27;orange&#x27;</span>];</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(arr.<span class="title function_">findIndex</span>(<span class="keyword">function</span> (<span class="params">s</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> s.<span class="title function_">toLowerCase</span>() === s;</span><br><span class="line">&#125;)); <span class="comment">// 1, 因为&#x27;pear&#x27;的索引是1</span></span><br><span class="line"></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(arr.<span class="title function_">findIndex</span>(<span class="keyword">function</span> (<span class="params">s</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> s.<span class="title function_">toUpperCase</span>() === s;</span><br><span class="line">&#125;)); <span class="comment">// -1</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="箭头函数"><a href="#箭头函数" class="headerlink" title="箭头函数"></a>箭头函数</h3><p>ES6标准新增了一种新的函数：箭头函数（Arrow Function）。</p><p>为什么叫箭头函数？因为它的定义用的就是一个箭头：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">x =&gt; x * x</span><br></pre></td></tr></table></figure><p>上面的箭头函数相当于：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> (<span class="params">x</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> x * x;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>头函数相当于匿名函数，并且简化了函数定义。箭头函数有两种格式，一种像上面的，只包含一个表达式，连<code>&#123; ... &#125;</code>和<code>return</code>都省略掉了。还有一种可以包含多条语句，这时候就不能省略<code>&#123; ... &#125;</code>和<code>return</code>：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">x =&gt; &#123;</span><br><span class="line">    <span class="keyword">if</span> (x &gt; <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> x * x;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> - x * x;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>如果参数不是一个，就需要用括号<code>()</code>括起来：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 两个参数:</span></span><br><span class="line">(x, y) =&gt; x * x + y * y</span><br><span class="line"></span><br><span class="line"><span class="comment">// 无参数:</span></span><br><span class="line">() =&gt; <span class="number">3.14</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 可变参数:</span></span><br><span class="line">(x, y, ...rest) =&gt; &#123;</span><br><span class="line">    <span class="keyword">let</span> i, sum = x + y;</span><br><span class="line">    <span class="keyword">for</span> (i=<span class="number">0</span>; i&lt;rest.<span class="property">length</span>; i++) &#123;</span><br><span class="line">        sum += rest[i];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> sum;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>如果要返回一个对象，就要注意，如果是单表达式，这么写的话会报错：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// SyntaxError:</span></span><br><span class="line">x =&gt; &#123; <span class="attr">foo</span>: x &#125;</span><br></pre></td></tr></table></figure><p>因为和函数体的<code>&#123; ... &#125;</code>有语法冲突，所以要改为：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ok:</span></span><br><span class="line">x =&gt; (&#123; <span class="attr">foo</span>: x &#125;)</span><br></pre></td></tr></table></figure><h4 id="this"><a href="#this" class="headerlink" title="this"></a>this</h4><p>箭头函数看上去是匿名函数的一种简写，但实际上，箭头函数和匿名函数有个明显的区别：箭头函数内部的<code>this</code>是词法作用域，由上下文确定。</p><p>回顾前面的例子，由于JavaScript函数对<code>this</code>绑定的错误处理，下面的例子无法得到预期结果：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> obj = &#123;</span><br><span class="line">    <span class="attr">birth</span>: <span class="number">1990</span>,</span><br><span class="line">    <span class="attr">getAge</span>: <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">        <span class="keyword">let</span> b = <span class="variable language_">this</span>.<span class="property">birth</span>; <span class="comment">// 1990</span></span><br><span class="line">        <span class="keyword">let</span> fn = <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Date</span>().<span class="title function_">getFullYear</span>() - <span class="variable language_">this</span>.<span class="property">birth</span>; <span class="comment">// this指向window或undefined</span></span><br><span class="line">        &#125;;</span><br><span class="line">        <span class="keyword">return</span> <span class="title function_">fn</span>();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>现在，箭头函数完全修复了<code>this</code>的指向，<code>this</code>总是指向词法作用域，也就是外层调用者<code>obj</code>：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> obj = &#123;</span><br><span class="line">    <span class="attr">birth</span>: <span class="number">1990</span>,</span><br><span class="line">    <span class="attr">getAge</span>: <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">        <span class="keyword">let</span> b = <span class="variable language_">this</span>.<span class="property">birth</span>; <span class="comment">// 1990</span></span><br><span class="line">        <span class="keyword">let</span> <span class="title function_">fn</span> = (<span class="params"></span>) =&gt; <span class="keyword">new</span> <span class="title class_">Date</span>().<span class="title function_">getFullYear</span>() - <span class="variable language_">this</span>.<span class="property">birth</span>; <span class="comment">// this指向obj对象</span></span><br><span class="line">        <span class="keyword">return</span> <span class="title function_">fn</span>();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line">obj.<span class="title function_">getAge</span>(); <span class="comment">// 25</span></span><br></pre></td></tr></table></figure><p>如果使用箭头函数，以前的那种hack写法：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> that = <span class="variable language_">this</span>;</span><br></pre></td></tr></table></figure><p>就不再需要了。</p><p>由于<code>this</code>在箭头函数中已经按照词法作用域绑定了，所以，用<code>call()</code>或者<code>apply()</code>调用箭头函数时，无法对<code>this</code>进行绑定，即传入的第一个参数被忽略：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> obj = &#123;</span><br><span class="line">    <span class="attr">birth</span>: <span class="number">1990</span>,</span><br><span class="line">    <span class="attr">getAge</span>: <span class="keyword">function</span> (<span class="params">year</span>) &#123;</span><br><span class="line">        <span class="keyword">let</span> b = <span class="variable language_">this</span>.<span class="property">birth</span>; <span class="comment">// 1990</span></span><br><span class="line">        <span class="keyword">let</span> <span class="title function_">fn</span> = (<span class="params">y</span>) =&gt; y - <span class="variable language_">this</span>.<span class="property">birth</span>; <span class="comment">// this.birth仍是1990</span></span><br><span class="line">        <span class="keyword">return</span> fn.<span class="title function_">call</span>(&#123;<span class="attr">birth</span>:<span class="number">2000</span>&#125;, year);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line">obj.<span class="title function_">getAge</span>(<span class="number">2015</span>); <span class="comment">// 25</span></span><br></pre></td></tr></table></figure><h3 id="生成器"><a href="#生成器" class="headerlink" title="生成器"></a>生成器</h3><p>生成器（generator）是ES6标准引入的新的数据类型。一个生成器看上去像一个函数，但可以返回多次。</p><p>我们先复习函数的概念。一个函数是一段完整的代码，调用一个函数就是传入参数，然后返回结果：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">foo</span>(<span class="params">x</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> x + x;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> r = <span class="title function_">foo</span>(<span class="number">1</span>); <span class="comment">// 调用foo函数</span></span><br></pre></td></tr></table></figure><p>函数在执行过程中，如果没有遇到<code>return</code>语句（函数末尾如果没有<code>return</code>，就是隐含的<code>return undefined;</code>），控制权无法交回被调用的代码。</p><p>generator跟函数很像，定义如下：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span>* <span class="title function_">foo</span>(<span class="params">x</span>) &#123;</span><br><span class="line">    <span class="keyword">yield</span> x + <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">yield</span> x + <span class="number">2</span>;</span><br><span class="line">    <span class="keyword">return</span> x + <span class="number">3</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>generator和函数不同的是，generator由<code>function*</code>定义（注意多出的<code>*</code>号），并且，除了<code>return</code>语句，还可以用<code>yield</code>返回多次。</p><p>大多数同学立刻就晕了，generator就是能够返回多次的“函数”？返回多次有啥用？</p><p>还是举个栗子吧。</p><p>我们以一个著名的斐波那契数列为例，它由<code>0</code>，<code>1</code>开头：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">0</span> <span class="number">1</span> <span class="number">1</span> <span class="number">2</span> <span class="number">3</span> <span class="number">5</span> <span class="number">8</span> <span class="number">13</span> <span class="number">21</span> <span class="number">34</span> ...</span><br></pre></td></tr></table></figure><p>要编写一个产生斐波那契数列的函数，可以这么写：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">fib</span>(<span class="params">max</span>) &#123;</span><br><span class="line">    <span class="keyword">let</span></span><br><span class="line">        t,</span><br><span class="line">        a = <span class="number">0</span>,</span><br><span class="line">        b = <span class="number">1</span>,</span><br><span class="line">        arr = [<span class="number">0</span>, <span class="number">1</span>];</span><br><span class="line">    <span class="keyword">while</span> (arr.<span class="property">length</span> &lt; max) &#123;</span><br><span class="line">        [a, b] = [b, a + b];</span><br><span class="line">        arr.<span class="title function_">push</span>(b);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> arr;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 测试:</span></span><br><span class="line"><span class="title function_">fib</span>(<span class="number">5</span>); <span class="comment">// [0, 1, 1, 2, 3]</span></span><br><span class="line"><span class="title function_">fib</span>(<span class="number">10</span>); <span class="comment">// [0, 1, 1, 2, 3, 5, 8, 13, 21, 34]</span></span><br></pre></td></tr></table></figure><p>函数只能返回一次，所以必须返回一个<code>Array</code>。但是，如果换成generator，就可以一次返回一个数，不断返回多次。用generator改写如下：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span>* <span class="title function_">fib</span>(<span class="params">max</span>) &#123;</span><br><span class="line">    <span class="keyword">let</span></span><br><span class="line">        t,</span><br><span class="line">        a = <span class="number">0</span>,</span><br><span class="line">        b = <span class="number">1</span>,</span><br><span class="line">        n = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span> (n &lt; max) &#123;</span><br><span class="line">        <span class="keyword">yield</span> a;</span><br><span class="line">        [a, b] = [b, a + b];</span><br><span class="line">        n ++;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>直接调用试试：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_">fib</span>(<span class="number">5</span>); <span class="comment">// fib &#123;[[GeneratorStatus]]: &quot;suspended&quot;, [[GeneratorReceiver]]: Window&#125;</span></span><br></pre></td></tr></table></figure><p>直接调用一个generator和调用函数不一样，<code>fib(5)</code>仅仅是创建了一个generator对象，还没有去执行它。</p><p>调用generator对象有两个方法，一是不断地调用generator对象的<code>next()</code>方法：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> f = <span class="title function_">fib</span>(<span class="number">5</span>);</span><br><span class="line">f.<span class="title function_">next</span>(); <span class="comment">// &#123;value: 0, done: false&#125;</span></span><br><span class="line">f.<span class="title function_">next</span>(); <span class="comment">// &#123;value: 1, done: false&#125;</span></span><br><span class="line">f.<span class="title function_">next</span>(); <span class="comment">// &#123;value: 1, done: false&#125;</span></span><br><span class="line">f.<span class="title function_">next</span>(); <span class="comment">// &#123;value: 2, done: false&#125;</span></span><br><span class="line">f.<span class="title function_">next</span>(); <span class="comment">// &#123;value: 3, done: false&#125;</span></span><br><span class="line">f.<span class="title function_">next</span>(); <span class="comment">// &#123;value: undefined, done: true&#125;</span></span><br></pre></td></tr></table></figure><p><code>next()</code>方法会执行generator的代码，然后，每次遇到<code>yield x;</code>就返回一个对象<code>&#123;value: x, done: true/false&#125;</code>，然后“暂停”。返回的<code>value</code>就是<code>yield</code>的返回值，<code>done</code>表示这个generator是否已经执行结束了。如果<code>done</code>为<code>true</code>，则<code>value</code>就是<code>return</code>的返回值。</p><p>当执行到<code>done</code>为<code>true</code>时，这个generator对象就已经全部执行完毕，不要再继续调用<code>next()</code>了。</p><p>第二个方法是直接用<code>for ... of</code>循环迭代generator对象，这种方式不需要我们自己判断<code>done</code>：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span>* <span class="title function_">fib</span>(<span class="params">max</span>) &#123;</span><br><span class="line">    <span class="keyword">let</span></span><br><span class="line">        a = <span class="number">0</span>,</span><br><span class="line">        b = <span class="number">1</span>,</span><br><span class="line">        n = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span> (n &lt; max) &#123;</span><br><span class="line">        <span class="keyword">yield</span> a;</span><br><span class="line">        [a, b] = [b, a + b];</span><br><span class="line">        n ++;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">let</span> x <span class="keyword">of</span> <span class="title function_">fib</span>(<span class="number">10</span>)) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(x); <span class="comment">// 依次输出0, 1, 1, 2, 3, ...</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>generator和普通函数相比，有什么用？</p><p>因为generator可以在执行过程中多次返回，所以它看上去就像一个可以记住执行状态的函数，利用这一点，写一个generator就可以实现需要用面向对象才能实现的功能。例如，用一个对象来保存状态，得这么写：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> fib = &#123;</span><br><span class="line">    <span class="attr">a</span>: <span class="number">0</span>,</span><br><span class="line">    <span class="attr">b</span>: <span class="number">1</span>,</span><br><span class="line">    <span class="attr">n</span>: <span class="number">0</span>,</span><br><span class="line">    <span class="attr">max</span>: <span class="number">5</span>,</span><br><span class="line">    <span class="attr">next</span>: <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">        <span class="keyword">let</span></span><br><span class="line">            r = <span class="variable language_">this</span>.<span class="property">a</span>,</span><br><span class="line">            t = <span class="variable language_">this</span>.<span class="property">a</span> + <span class="variable language_">this</span>.<span class="property">b</span>;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">a</span> = <span class="variable language_">this</span>.<span class="property">b</span>;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">b</span> = t;</span><br><span class="line">        <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="property">n</span> &lt; <span class="variable language_">this</span>.<span class="property">max</span>) &#123;</span><br><span class="line">            <span class="variable language_">this</span>.<span class="property">n</span> ++;</span><br><span class="line">            <span class="keyword">return</span> r;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">undefined</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>用对象的属性来保存状态，相当繁琐。</p><p>generator还有另一个巨大的好处，就是把异步回调代码变成“同步”代码。这个好处要等到后面学了AJAX以后才能体会到。</p><p>没有generator之前的黑暗时代，用AJAX时需要这么写代码：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_">ajax</span>(<span class="string">&#x27;http://url-1&#x27;</span>, data1, <span class="keyword">function</span> (<span class="params">err, result</span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> (err) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="title function_">handle</span>(err);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="title function_">ajax</span>(<span class="string">&#x27;http://url-2&#x27;</span>, data2, <span class="keyword">function</span> (<span class="params">err, result</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (err) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="title function_">handle</span>(err);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="title function_">ajax</span>(<span class="string">&#x27;http://url-3&#x27;</span>, data3, <span class="keyword">function</span> (<span class="params">err, result</span>) &#123;</span><br><span class="line">            <span class="keyword">if</span> (err) &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="title function_">handle</span>(err);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> <span class="title function_">success</span>(result);</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p>回调越多，代码越难看。</p><p>有了generator的美好时代，用AJAX时可以这么写：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">try</span> &#123;</span><br><span class="line">    r1 = <span class="keyword">yield</span> <span class="title function_">ajax</span>(<span class="string">&#x27;http://url-1&#x27;</span>, data1);</span><br><span class="line">    r2 = <span class="keyword">yield</span> <span class="title function_">ajax</span>(<span class="string">&#x27;http://url-2&#x27;</span>, data2);</span><br><span class="line">    r3 = <span class="keyword">yield</span> <span class="title function_">ajax</span>(<span class="string">&#x27;http://url-3&#x27;</span>, data3);</span><br><span class="line">    <span class="title function_">success</span>(r3);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">catch</span> (err) &#123;</span><br><span class="line">    <span class="title function_">handle</span>(err);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>看上去是同步的代码，实际执行是异步的。</p><h2 id="标准对象"><a href="#标准对象" class="headerlink" title="标准对象"></a>标准对象</h2><p>在JavaScript的世界里，一切都是对象。</p><p>但是某些对象还是和其他对象不太一样。为了区分对象的类型，我们用<code>typeof</code>操作符获取对象的类型，它总是返回一个字符串：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">typeof</span> <span class="number">123</span>; <span class="comment">// &#x27;number&#x27;</span></span><br><span class="line"><span class="keyword">typeof</span> <span class="number">123n</span>; <span class="comment">// &#x27;bigint&#x27;</span></span><br><span class="line"><span class="keyword">typeof</span> <span class="title class_">NaN</span>; <span class="comment">// &#x27;number&#x27;</span></span><br><span class="line"><span class="keyword">typeof</span> <span class="string">&#x27;str&#x27;</span>; <span class="comment">// &#x27;string&#x27;</span></span><br><span class="line"><span class="keyword">typeof</span> <span class="literal">true</span>; <span class="comment">// &#x27;boolean&#x27;</span></span><br><span class="line"><span class="keyword">typeof</span> <span class="literal">undefined</span>; <span class="comment">// &#x27;undefined&#x27;</span></span><br><span class="line"><span class="keyword">typeof</span> <span class="title class_">Math</span>.<span class="property">abs</span>; <span class="comment">// &#x27;function&#x27;</span></span><br><span class="line"><span class="keyword">typeof</span> <span class="literal">null</span>; <span class="comment">// &#x27;object&#x27;</span></span><br><span class="line"><span class="keyword">typeof</span> []; <span class="comment">// &#x27;object&#x27;</span></span><br><span class="line"><span class="keyword">typeof</span> &#123;&#125;; <span class="comment">// &#x27;object&#x27;</span></span><br></pre></td></tr></table></figure><p>可见，<code>number</code>、<code>bigint</code>、<code>string</code>、<code>boolean</code>、<code>function</code>和<code>undefined</code>有别于其他类型。特别注意<code>null</code>的类型是<code>object</code>，<code>Array</code>的类型也是<code>object</code>，如果我们用<code>typeof</code>将无法区分出<code>null</code>、<code>Array</code>和通常意义上的object——<code>&#123;&#125;</code>。</p><h3 id="包装对象"><a href="#包装对象" class="headerlink" title="包装对象"></a>包装对象</h3><p>除了这些类型外，JavaScript还提供了包装对象，熟悉Java的小伙伴肯定很清楚<code>int</code>和<code>Integer</code>这种暧昧关系。</p><p><code>number</code>、<code>boolean</code>和<code>string</code>都有包装对象。没错，在JavaScript中，字符串也区分<code>string</code>类型和它的包装类型。包装对象用<code>new</code>创建：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> n = <span class="keyword">new</span> <span class="title class_">Number</span>(<span class="number">123</span>); <span class="comment">// 123,生成了新的包装类型</span></span><br><span class="line"><span class="keyword">let</span> b = <span class="keyword">new</span> <span class="title class_">Boolean</span>(<span class="literal">true</span>); <span class="comment">// true,生成了新的包装类型</span></span><br><span class="line"><span class="keyword">let</span> s = <span class="keyword">new</span> <span class="title class_">String</span>(<span class="string">&#x27;str&#x27;</span>); <span class="comment">// &#x27;str&#x27;,生成了新的包装类型</span></span><br></pre></td></tr></table></figure><p>虽然包装对象看上去和原来的值一模一样，显示出来也是一模一样，但他们的类型已经变为<code>object</code>了！所以，包装对象和原始值用<code>===</code>比较会返回<code>false</code>：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">typeof</span> <span class="keyword">new</span> <span class="title class_">Number</span>(<span class="number">123</span>); <span class="comment">// &#x27;object&#x27;</span></span><br><span class="line"><span class="keyword">new</span> <span class="title class_">Number</span>(<span class="number">123</span>) === <span class="number">123</span>; <span class="comment">// false</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">typeof</span> <span class="keyword">new</span> <span class="title class_">Boolean</span>(<span class="literal">true</span>); <span class="comment">// &#x27;object&#x27;</span></span><br><span class="line"><span class="keyword">new</span> <span class="title class_">Boolean</span>(<span class="literal">true</span>) === <span class="literal">true</span>; <span class="comment">// false</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">typeof</span> <span class="keyword">new</span> <span class="title class_">String</span>(<span class="string">&#x27;str&#x27;</span>); <span class="comment">// &#x27;object&#x27;</span></span><br><span class="line"><span class="keyword">new</span> <span class="title class_">String</span>(<span class="string">&#x27;str&#x27;</span>) === <span class="string">&#x27;str&#x27;</span>; <span class="comment">// false</span></span><br></pre></td></tr></table></figure><p>所以<em>闲的蛋疼也不要使用包装对象</em>！尤其是针对<code>string</code>类型！！！</p><p>如果我们在使用<code>Number</code>、<code>Boolean</code>和<code>String</code>时，没有写<code>new</code>会发生什么情况？</p><p>此时，<code>Number()</code>、<code>Boolean</code>和<code>String()</code>被当做普通函数，把任何类型的数据转换为<code>number</code>、<code>boolean</code>和<code>string</code>类型（注意不是其包装类型）：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> n = <span class="title class_">Number</span>(<span class="string">&#x27;123&#x27;</span>); <span class="comment">// 123，相当于parseInt()或parseFloat()</span></span><br><span class="line"><span class="keyword">typeof</span> n; <span class="comment">// &#x27;number&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> b = <span class="title class_">Boolean</span>(<span class="string">&#x27;true&#x27;</span>); <span class="comment">// true</span></span><br><span class="line"><span class="keyword">typeof</span> b; <span class="comment">// &#x27;boolean&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> b2 = <span class="title class_">Boolean</span>(<span class="string">&#x27;false&#x27;</span>); <span class="comment">// true! &#x27;false&#x27;字符串转换结果为true！因为它是非空字符串！</span></span><br><span class="line"><span class="keyword">let</span> b3 = <span class="title class_">Boolean</span>(<span class="string">&#x27;&#x27;</span>); <span class="comment">// false</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> s = <span class="title class_">String</span>(<span class="number">123.45</span>); <span class="comment">// &#x27;123.45&#x27;</span></span><br><span class="line"><span class="keyword">typeof</span> s; <span class="comment">// &#x27;string&#x27;</span></span><br></pre></td></tr></table></figure><p>是不是感觉头大了？这就是JavaScript特有的催眠魅力！</p><p>总结一下，有这么几条规则需要遵守：</p><ul><li>不要使用<code>new Number()</code>、<code>new Boolean()</code>、<code>new String()</code>创建包装对象；</li><li>用<code>parseInt()</code>或<code>parseFloat()</code>来转换任意类型到<code>number</code>；</li><li>用<code>String()</code>来转换任意类型到<code>string</code>，或者直接调用某个对象的<code>toString()</code>方法；</li><li>通常不必把任意类型转换为<code>boolean</code>再判断，因为可以直接写<code>if (myVar) &#123;...&#125;</code>；</li><li><code>typeof</code>操作符可以判断出<code>number</code>、<code>boolean</code>、<code>string</code>、<code>function</code>和<code>undefined</code>；</li><li>判断<code>Array</code>要使用<code>Array.isArray(arr)</code>；</li><li>判断<code>null</code>请使用<code>myVar === null</code>；</li><li>判断某个全局变量是否存在用<code>typeof window.myVar === &#39;undefined&#39;</code>；</li><li>函数内部判断某个变量是否存在用<code>typeof myVar === &#39;undefined&#39;</code>。</li></ul><p>最后有细心的同学指出，任何对象都有<code>toString()</code>方法吗？<code>null</code>和<code>undefined</code>就没有！确实如此，这两个特殊值要除外，虽然<code>null</code>还伪装成了<code>object</code>类型。</p><p>更细心的同学指出，<code>number</code>对象调用<code>toString()</code>报SyntaxError：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">123.</span><span class="title function_">toString</span>(); <span class="comment">// SyntaxError</span></span><br></pre></td></tr></table></figure><p>遇到这种情况，要特殊处理一下：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">123.</span>.<span class="title function_">toString</span>(); <span class="comment">// &#x27;123&#x27;, 注意是两个点！</span></span><br><span class="line">(<span class="number">123</span>).<span class="title function_">toString</span>(); <span class="comment">// &#x27;123&#x27;</span></span><br></pre></td></tr></table></figure><h3 id="Data"><a href="#Data" class="headerlink" title="Data"></a>Data</h3><p>在JavaScript中，<code>Date</code>对象用来表示日期和时间。</p><p>要获取系统当前时间，用：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> now = <span class="keyword">new</span> <span class="title class_">Date</span>();</span><br><span class="line">now; <span class="comment">// Wed Jun 24 2015 19:49:22 GMT+0800 (CST)</span></span><br><span class="line">now.<span class="title function_">getFullYear</span>(); <span class="comment">// 2015, 年份</span></span><br><span class="line">now.<span class="title function_">getMonth</span>(); <span class="comment">// 5, 月份，注意月份范围是0~11，5表示六月</span></span><br><span class="line">now.<span class="title function_">getDate</span>(); <span class="comment">// 24, 表示24号</span></span><br><span class="line">now.<span class="title function_">getDay</span>(); <span class="comment">// 3, 表示星期三</span></span><br><span class="line">now.<span class="title function_">getHours</span>(); <span class="comment">// 19, 24小时制</span></span><br><span class="line">now.<span class="title function_">getMinutes</span>(); <span class="comment">// 49, 分钟</span></span><br><span class="line">now.<span class="title function_">getSeconds</span>(); <span class="comment">// 22, 秒</span></span><br><span class="line">now.<span class="title function_">getMilliseconds</span>(); <span class="comment">// 875, 毫秒数</span></span><br><span class="line">now.<span class="title function_">getTime</span>(); <span class="comment">// 1435146562875, 以number形式表示的时间戳</span></span><br></pre></td></tr></table></figure><p>注意，当前时间是浏览器从本机操作系统获取的时间，所以不一定准确，因为用户可以把当前时间设定为任何值。</p><p>如果要创建一个指定日期和时间的<code>Date</code>对象，可以用：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> d = <span class="keyword">new</span> <span class="title class_">Date</span>(<span class="number">2015</span>, <span class="number">5</span>, <span class="number">19</span>, <span class="number">20</span>, <span class="number">15</span>, <span class="number">30</span>, <span class="number">123</span>);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(d); <span class="comment">// Fri Jun 19 2015 20:15:30 GMT+0800 (CST)</span></span><br></pre></td></tr></table></figure><div class="note warning simple"><p>JavaScript的Date对象月份值从0开始，牢记0=1月，1=2月，2=3月，……，11=12月。</p></div><p>第二种创建一个指定日期和时间的方法是解析一个符合<a href="https://www.w3.org/TR/NOTE-datetime">ISO 8601</a>格式的字符串：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> d = <span class="title class_">Date</span>.<span class="title function_">parse</span>(<span class="string">&#x27;2015-06-24T19:49:22.875+08:00&#x27;</span>);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(d); <span class="comment">// 1435146562875</span></span><br></pre></td></tr></table></figure><p>但它返回的不是<code>Date</code>对象，而是一个时间戳。不过有时间戳就可以很容易地把它转换为一个<code>Date</code>：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> d = <span class="keyword">new</span> <span class="title class_">Date</span>(<span class="number">1435146562875</span>);</span><br><span class="line">d; <span class="comment">// Wed Jun 24 2015 19:49:22 GMT+0800 (CST)</span></span><br><span class="line">d.<span class="title function_">getMonth</span>(); <span class="comment">// 5</span></span><br></pre></td></tr></table></figure><div class="note warning simple"><p>使用Date.parse()时传入的字符串使用实际月份01~12，转换为Date对象后getMonth()获取的月份值为0~11。</p></div><h4 id="时区"><a href="#时区" class="headerlink" title="时区"></a>时区</h4><p><code>Date</code>对象表示的时间总是按浏览器所在时区显示的，不过我们既可以显示本地时间，也可以显示调整后的UTC时间：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> d = <span class="keyword">new</span> <span class="title class_">Date</span>(<span class="number">1435146562875</span>);</span><br><span class="line">d.<span class="title function_">toLocaleString</span>(); <span class="comment">// &#x27;2015/6/24 下午7:49:22&#x27;，本地时间（北京时区+8:00），显示的字符串与操作系统设定的格式有关</span></span><br><span class="line">d.<span class="title function_">toUTCString</span>(); <span class="comment">// &#x27;Wed, 24 Jun 2015 11:49:22 GMT&#x27;，UTC时间，与本地时间相差8小时</span></span><br></pre></td></tr></table></figure><p>那么在JavaScript中如何进行时区转换呢？实际上，只要我们传递的是一个<code>number</code>类型的时间戳，我们就不用关心时区转换。任何浏览器都可以把一个时间戳正确转换为本地时间。</p><p>时间戳是个什么东西？时间戳是一个自增的整数，它表示从1970年1月1日零时整的GMT时区开始的那一刻，到现在的毫秒数。假设浏览器所在电脑的时间是准确的，那么世界上无论哪个时区的电脑，它们此刻产生的时间戳数字都是一样的，所以，时间戳可以精确地表示一个时刻，并且与时区无关。</p><p>所以，我们只需要传递时间戳，或者把时间戳从数据库里读出来，再让JavaScript自动转换为当地时间就可以了。</p><p>要获取当前时间戳，可以用：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 方法1:</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title class_">Date</span>.<span class="title function_">now</span>());</span><br><span class="line"></span><br><span class="line"><span class="comment">// 方法2:</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="keyword">new</span> <span class="title class_">Date</span>().<span class="title function_">getTime</span>());</span><br></pre></td></tr></table></figure><h3 id="JSON"><a href="#JSON" class="headerlink" title="JSON"></a>JSON</h3><p>在JSON中，一共就这么几种数据类型：</p><ul><li>number：和JavaScript的<code>number</code>完全一致；</li><li>boolean：就是JavaScript的<code>true</code>或<code>false</code>；</li><li>string：就是JavaScript的<code>string</code>；</li><li>null：就是JavaScript的<code>null</code>；</li><li>array：就是JavaScript的<code>Array</code>表示方式——<code>[]</code>；</li><li>object：就是JavaScript的<code>&#123; ... &#125;</code>表示方式。</li></ul><p>以及上面的任意组合。</p><p>并且，JSON还定死了字符集必须是UTF-8，表示多语言就没有问题了。为了统一解析，JSON的字符串规定必须用双引号<code>&quot;&quot;</code>，Object的键也必须用双引号<code>&quot;&quot;</code>。</p><p>把任何JavaScript对象变成JSON，就是把这个对象<strong>序列化</strong>成一个JSON格式的字符串，这样才能够通过网络传递给其他计算机。</p><p>如果我们收到一个JSON格式的字符串，只需要把它<strong>反序列化</strong>成一个JavaScript对象，就可以在JavaScript中直接使用这个对象了。</p><h4 id="序列化"><a href="#序列化" class="headerlink" title="序列化"></a>序列化</h4><p>让我们先把小明这个对象序列化成JSON格式的字符串：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> xiaoming = &#123;</span><br><span class="line">    <span class="attr">name</span>: <span class="string">&#x27;小明&#x27;</span>,</span><br><span class="line">    <span class="attr">age</span>: <span class="number">14</span>,</span><br><span class="line">    <span class="attr">gender</span>: <span class="literal">true</span>,</span><br><span class="line">    <span class="attr">height</span>: <span class="number">1.65</span>,</span><br><span class="line">    <span class="attr">grade</span>: <span class="literal">null</span>,</span><br><span class="line">    <span class="string">&#x27;middle-school&#x27;</span>: <span class="string">&#x27;\&quot;W3C\&quot; Middle School&#x27;</span>,</span><br><span class="line">    <span class="attr">skills</span>: [<span class="string">&#x27;JavaScript&#x27;</span>, <span class="string">&#x27;Java&#x27;</span>, <span class="string">&#x27;Python&#x27;</span>, <span class="string">&#x27;Lisp&#x27;</span>]</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> s = <span class="title class_">JSON</span>.<span class="title function_">stringify</span>(xiaoming);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(s);</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>要输出得好看一些，可以加上参数，按缩进输出：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="title class_">JSON</span>.<span class="title function_">stringify</span>(xiaoming, <span class="literal">null</span>, <span class="string">&#x27;  &#x27;</span>);</span><br></pre></td></tr></table></figure><p>结果：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="string">&quot;name&quot;</span>: <span class="string">&quot;小明&quot;</span>,</span><br><span class="line">  <span class="string">&quot;age&quot;</span>: <span class="number">14</span>,</span><br><span class="line">  <span class="string">&quot;gender&quot;</span>: <span class="literal">true</span>,</span><br><span class="line">  <span class="string">&quot;height&quot;</span>: <span class="number">1.65</span>,</span><br><span class="line">  <span class="string">&quot;grade&quot;</span>: <span class="literal">null</span>,</span><br><span class="line">  <span class="string">&quot;middle-school&quot;</span>: <span class="string">&quot;\&quot;W3C\&quot; Middle School&quot;</span>,</span><br><span class="line">  <span class="string">&quot;skills&quot;</span>: [</span><br><span class="line">    <span class="string">&quot;JavaScript&quot;</span>,</span><br><span class="line">    <span class="string">&quot;Java&quot;</span>,</span><br><span class="line">    <span class="string">&quot;Python&quot;</span>,</span><br><span class="line">    <span class="string">&quot;Lisp&quot;</span></span><br><span class="line">  ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>第二个参数用于控制如何筛选对象的键值，如果我们只想输出指定的属性，可以传入<code>Array</code>：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="title class_">JSON</span>.<span class="title function_">stringify</span>(xiaoming, [<span class="string">&#x27;name&#x27;</span>, <span class="string">&#x27;skills&#x27;</span>], <span class="string">&#x27;  &#x27;</span>);</span><br></pre></td></tr></table></figure><p>结果：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="string">&quot;name&quot;</span>: <span class="string">&quot;小明&quot;</span>,</span><br><span class="line">  <span class="string">&quot;skills&quot;</span>: [</span><br><span class="line">    <span class="string">&quot;JavaScript&quot;</span>,</span><br><span class="line">    <span class="string">&quot;Java&quot;</span>,</span><br><span class="line">    <span class="string">&quot;Python&quot;</span>,</span><br><span class="line">    <span class="string">&quot;Lisp&quot;</span></span><br><span class="line">  ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>还可以传入一个函数，这样对象的每个键值对都会被函数先处理：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">convert</span>(<span class="params">key, value</span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">typeof</span> value === <span class="string">&#x27;string&#x27;</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> value.<span class="title function_">toUpperCase</span>();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> value;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title class_">JSON</span>.<span class="title function_">stringify</span>(xiaoming, convert, <span class="string">&#x27;  &#x27;</span>);</span><br></pre></td></tr></table></figure><p>上面的代码把所有属性值都变成大写：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="string">&quot;name&quot;</span>: <span class="string">&quot;小明&quot;</span>,</span><br><span class="line">  <span class="string">&quot;age&quot;</span>: <span class="number">14</span>,</span><br><span class="line">  <span class="string">&quot;gender&quot;</span>: <span class="literal">true</span>,</span><br><span class="line">  <span class="string">&quot;height&quot;</span>: <span class="number">1.65</span>,</span><br><span class="line">  <span class="string">&quot;grade&quot;</span>: <span class="literal">null</span>,</span><br><span class="line">  <span class="string">&quot;middle-school&quot;</span>: <span class="string">&quot;\&quot;W3C\&quot; MIDDLE SCHOOL&quot;</span>,</span><br><span class="line">  <span class="string">&quot;skills&quot;</span>: [</span><br><span class="line">    <span class="string">&quot;JAVASCRIPT&quot;</span>,</span><br><span class="line">    <span class="string">&quot;JAVA&quot;</span>,</span><br><span class="line">    <span class="string">&quot;PYTHON&quot;</span>,</span><br><span class="line">    <span class="string">&quot;LISP&quot;</span></span><br><span class="line">  ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>如果我们还想要精确控制如何序列化小明，可以给<code>xiaoming</code>定义一个<code>toJSON()</code>的方法，直接返回JSON应该序列化的数据：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> xiaoming = &#123;</span><br><span class="line">    <span class="attr">name</span>: <span class="string">&#x27;小明&#x27;</span>,</span><br><span class="line">    <span class="attr">age</span>: <span class="number">14</span>,</span><br><span class="line">    <span class="attr">gender</span>: <span class="literal">true</span>,</span><br><span class="line">    <span class="attr">height</span>: <span class="number">1.65</span>,</span><br><span class="line">    <span class="attr">grade</span>: <span class="literal">null</span>,</span><br><span class="line">    <span class="string">&#x27;middle-school&#x27;</span>: <span class="string">&#x27;\&quot;W3C\&quot; Middle School&#x27;</span>,</span><br><span class="line">    <span class="attr">skills</span>: [<span class="string">&#x27;JavaScript&#x27;</span>, <span class="string">&#x27;Java&#x27;</span>, <span class="string">&#x27;Python&#x27;</span>, <span class="string">&#x27;Lisp&#x27;</span>],</span><br><span class="line">    <span class="attr">toJSON</span>: <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> &#123; <span class="comment">// 只输出name和age，并且改变了key：</span></span><br><span class="line">            <span class="string">&#x27;Name&#x27;</span>: <span class="variable language_">this</span>.<span class="property">name</span>,</span><br><span class="line">            <span class="string">&#x27;Age&#x27;</span>: <span class="variable language_">this</span>.<span class="property">age</span></span><br><span class="line">        &#125;;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="title class_">JSON</span>.<span class="title function_">stringify</span>(xiaoming); <span class="comment">// &#x27;&#123;&quot;Name&quot;:&quot;小明&quot;,&quot;Age&quot;:14&#125;&#x27;</span></span><br></pre></td></tr></table></figure><h4 id="反序列化"><a href="#反序列化" class="headerlink" title="反序列化"></a>反序列化</h4><p>拿到一个JSON格式的字符串，我们直接用<code>JSON.parse()</code>把它变成一个JavaScript对象：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="title class_">JSON</span>.<span class="title function_">parse</span>(<span class="string">&#x27;[1,2,3,true]&#x27;</span>); <span class="comment">// [1, 2, 3, true]</span></span><br><span class="line"><span class="title class_">JSON</span>.<span class="title function_">parse</span>(<span class="string">&#x27;&#123;&quot;name&quot;:&quot;小明&quot;,&quot;age&quot;:14&#125;&#x27;</span>); <span class="comment">// Object &#123;name: &#x27;小明&#x27;, age: 14&#125;</span></span><br><span class="line"><span class="title class_">JSON</span>.<span class="title function_">parse</span>(<span class="string">&#x27;true&#x27;</span>); <span class="comment">// true</span></span><br><span class="line"><span class="title class_">JSON</span>.<span class="title function_">parse</span>(<span class="string">&#x27;123.45&#x27;</span>); <span class="comment">// 123.45</span></span><br></pre></td></tr></table></figure><p><code>JSON.parse()</code>还可以接收一个函数，用来转换解析出的属性：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> obj = <span class="title class_">JSON</span>.<span class="title function_">parse</span>(<span class="string">&#x27;&#123;&quot;name&quot;:&quot;小明&quot;,&quot;age&quot;:14&#125;&#x27;</span>, <span class="keyword">function</span> (<span class="params">key, value</span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> (key === <span class="string">&#x27;name&#x27;</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> value + <span class="string">&#x27;同学&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> value;</span><br><span class="line">&#125;);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title class_">JSON</span>.<span class="title function_">stringify</span>(obj)); <span class="comment">// &#123;name: &#x27;小明同学&#x27;, age: 14&#125;</span></span><br></pre></td></tr></table></figure><h2 id="面向对象编程"><a href="#面向对象编程" class="headerlink" title="面向对象编程"></a>面向对象编程</h2><p>JavaScript的所有数据都可以看成对象，那是不是我们已经在使用面向对象编程了呢？</p><p>当然不是。如果我们只使用<code>Number</code>、<code>Array</code>、<code>string</code>以及基本的<code>&#123;...&#125;</code>定义的对象，还无法发挥出面向对象编程的威力。</p><p>JavaScript的面向对象编程和大多数其他语言如Java、C#的面向对象编程都不太一样。如果你熟悉Java或C#，很好，你一定明白面向对象的两个基本概念：</p><ol><li>类：类是对象的类型模板，例如，定义<code>Student</code>类来表示学生，类本身是一种类型，<code>Student</code>表示学生类型，但不表示任何具体的某个学生；</li><li>实例：实例是根据类创建的对象，例如，根据<code>Student</code>类可以创建出<code>xiaoming</code>、<code>xiaohong</code>、<code>xiaojun</code>等多个实例，每个实例表示一个具体的学生，他们全都属于<code>Student</code>类型。</li></ol><p>所以，类和实例是大多数面向对象编程语言的基本概念。</p><p>不过，在JavaScript中，这个概念需要改一改。JavaScript不区分类和实例的概念，而是通过原型（prototype）来实现面向对象编程。</p><p>原型是指当我们想要创建<code>xiaoming</code>这个具体的学生时，我们并没有一个<code>Student</code>类型可用。那怎么办？恰好有这么一个现成的对象：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> robot = &#123;</span><br><span class="line">    <span class="attr">name</span>: <span class="string">&#x27;Robot&#x27;</span>,</span><br><span class="line">    <span class="attr">height</span>: <span class="number">1.6</span>,</span><br><span class="line">    <span class="attr">run</span>: <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="variable language_">this</span>.<span class="property">name</span> + <span class="string">&#x27; is running...&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>我们看这个<code>robot</code>对象有名字，有身高，还会跑，有点像小明，干脆就根据它来“创建”小明得了！</p><p>于是我们把它改名为<code>Student</code>，然后创建出<code>xiaoming</code>：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> <span class="title class_">Student</span> = &#123;</span><br><span class="line">    <span class="attr">name</span>: <span class="string">&#x27;Robot&#x27;</span>,</span><br><span class="line">    <span class="attr">height</span>: <span class="number">1.2</span>,</span><br><span class="line">    <span class="attr">run</span>: <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="variable language_">this</span>.<span class="property">name</span> + <span class="string">&#x27; is running...&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> xiaoming = &#123;</span><br><span class="line">    <span class="attr">name</span>: <span class="string">&#x27;小明&#x27;</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">xiaoming.<span class="property">__proto__</span> = <span class="title class_">Student</span>;</span><br></pre></td></tr></table></figure><p>注意最后一行代码把<code>xiaoming</code>的原型指向了对象<code>Student</code>，看上去<code>xiaoming</code>仿佛是从<code>Student</code>继承下来的：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">xiaoming.<span class="property">name</span>; <span class="comment">// &#x27;小明&#x27;</span></span><br><span class="line">xiaoming.<span class="title function_">run</span>(); <span class="comment">// 小明 is running...</span></span><br></pre></td></tr></table></figure><p><code>xiaoming</code>有自己的<code>name</code>属性，但并没有定义<code>run()</code>方法。不过，由于小明是从<code>Student</code>继承而来，只要<code>Student</code>有<code>run()</code>方法，<code>xiaoming</code>也可以调用：</p><p><img src="https://liaoxuefeng.com/books/javascript/oop/proto.jpg" alt="xiaoming-prototype"></p><p>JavaScript的原型链和Java的Class区别就在，它没有“Class”的概念，所有对象都是实例，所谓继承关系不过是把一个对象的原型指向另一个对象而已。</p><p>如果你把<code>xiaoming</code>的原型指向其他对象：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> <span class="title class_">Bird</span> = &#123;</span><br><span class="line">    <span class="attr">fly</span>: <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="variable language_">this</span>.<span class="property">name</span> + <span class="string">&#x27; is flying...&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">xiaoming.<span class="property">__proto__</span> = <span class="title class_">Bird</span>;</span><br></pre></td></tr></table></figure><p>现在<code>xiaoming</code>已经无法<code>run()</code>了，他已经变成了一只鸟：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">xiaoming.<span class="title function_">fly</span>(); <span class="comment">// 小明 is flying...</span></span><br></pre></td></tr></table></figure><p>在JavaScrip代码运行时期，你可以把<code>xiaoming</code>从<code>Student</code>变成<code>Bird</code>，或者变成任何对象。</p><p><em>请注意</em>，上述代码仅用于演示目的。在编写JavaScript代码时，不要直接用<code>obj.__proto__</code>去改变一个对象的原型，并且，低版本的IE也无法使用<code>__proto__</code>。<code>Object.create()</code>方法可以传入一个原型对象，并创建一个基于该原型的新对象，但是新对象什么属性都没有，因此，我们可以编写一个函数来创建<code>xiaoming</code>：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 原型对象:</span></span><br><span class="line"><span class="keyword">let</span> <span class="title class_">Student</span> = &#123;</span><br><span class="line">    <span class="attr">name</span>: <span class="string">&#x27;Robot&#x27;</span>,</span><br><span class="line">    <span class="attr">height</span>: <span class="number">1.2</span>,</span><br><span class="line">    <span class="attr">run</span>: <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="variable language_">this</span>.<span class="property">name</span> + <span class="string">&#x27; is running...&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">createStudent</span>(<span class="params">name</span>) &#123;</span><br><span class="line">    <span class="comment">// 基于Student原型创建一个新对象:</span></span><br><span class="line">    <span class="keyword">let</span> s = <span class="title class_">Object</span>.<span class="title function_">create</span>(<span class="title class_">Student</span>);</span><br><span class="line">    <span class="comment">// 初始化新对象:</span></span><br><span class="line">    s.<span class="property">name</span> = name;</span><br><span class="line">    <span class="keyword">return</span> s;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> xiaoming = <span class="title function_">createStudent</span>(<span class="string">&#x27;小明&#x27;</span>);</span><br><span class="line">xiaoming.<span class="title function_">run</span>(); <span class="comment">// 小明 is running...</span></span><br><span class="line">xiaoming.<span class="property">__proto__</span> === <span class="title class_">Student</span>; <span class="comment">// true</span></span><br></pre></td></tr></table></figure><h3 id="创建对象"><a href="#创建对象" class="headerlink" title="创建对象"></a>创建对象</h3><p>JavaScript对每个创建的对象都会设置一个原型，指向它的原型对象。</p><p>当我们用<code>obj.xxx</code>访问一个对象的属性时，JavaScript引擎先在当前对象上查找该属性，如果没有找到，就到其原型对象上找，如果还没有找到，就一直上溯到<code>Object.prototype</code>对象，最后，如果还没有找到，就只能返回<code>undefined</code>。</p><p>例如，创建一个<code>Array</code>对象：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> arr = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>];</span><br></pre></td></tr></table></figure><p>其原型链是：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">       null</span><br><span class="line">         ▲</span><br><span class="line">         │</span><br><span class="line">┌─────────────────┐</span><br><span class="line">│Object.prototype │</span><br><span class="line">└─────────────────┘</span><br><span class="line">         ▲</span><br><span class="line">         │</span><br><span class="line">┌─────────────────┐</span><br><span class="line">│ Array.prototype │</span><br><span class="line">└─────────────────┘</span><br><span class="line">         ▲</span><br><span class="line">         │</span><br><span class="line">┌─────────────────┐</span><br><span class="line">│       arr       │</span><br><span class="line">└─────────────────┘</span><br></pre></td></tr></table></figure><p><code>Array.prototype</code>定义了<code>indexOf()</code>、<code>shift()</code>等方法，因此你可以在所有的<code>Array</code>对象上直接调用这些方法。</p><p>当我们创建一个函数时：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">foo</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>函数也是一个对象，它的原型链是：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">        null</span><br><span class="line">          ▲</span><br><span class="line">          │</span><br><span class="line">┌───────────────────┐</span><br><span class="line">│ Object.prototype  │</span><br><span class="line">└───────────────────┘</span><br><span class="line">          ▲</span><br><span class="line">          │</span><br><span class="line">┌───────────────────┐</span><br><span class="line">│Function.prototype │</span><br><span class="line">└───────────────────┘</span><br><span class="line">          ▲</span><br><span class="line">          │</span><br><span class="line">┌───────────────────┐</span><br><span class="line">│        foo        │</span><br><span class="line">└───────────────────┘</span><br></pre></td></tr></table></figure><p>由于<code>Function.prototype</code>定义了<code>apply()</code>等方法，因此，所有函数都可以调用<code>apply()</code>方法。</p><p>很容易想到，如果原型链很长，那么访问一个对象的属性就会因为花更多的时间查找而变得更慢，因此要注意不要把原型链搞得太长。</p><h4 id="构造函数"><a href="#构造函数" class="headerlink" title="构造函数"></a>构造函数</h4><p>除了直接用<code>&#123; ... &#125;</code>创建一个对象外，JavaScript还可以用一种构造函数的方法来创建对象。它的用法是，先定义一个构造函数：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">Student</span>(<span class="params">name</span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">name</span> = name;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">hello</span> = <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">        <span class="title function_">alert</span>(<span class="string">&#x27;Hello, &#x27;</span> + <span class="variable language_">this</span>.<span class="property">name</span> + <span class="string">&#x27;!&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>你会问，咦，这不是一个普通函数吗？</p><p>这确实是一个普通函数，但是在JavaScript中，可以用关键字<code>new</code>来调用这个函数，并返回一个对象：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> xiaoming = <span class="keyword">new</span> <span class="title class_">Student</span>(<span class="string">&#x27;小明&#x27;</span>);</span><br><span class="line">xiaoming.<span class="property">name</span>; <span class="comment">// &#x27;小明&#x27;</span></span><br><span class="line">xiaoming.<span class="title function_">hello</span>(); <span class="comment">// Hello, 小明!</span></span><br></pre></td></tr></table></figure><p><em>注意</em>，如果不写<code>new</code>，这就是一个普通函数，它返回<code>undefined</code>。但是，如果写了<code>new</code>，它就变成了一个构造函数，它绑定的<code>this</code>指向新创建的对象，并默认返回<code>this</code>，也就是说，不需要在最后写<code>return this;</code>。</p><p>新创建的<code>xiaoming</code>的原型链是：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">       null</span><br><span class="line">         ▲</span><br><span class="line">         │</span><br><span class="line">┌─────────────────┐</span><br><span class="line">│Object.prototype │</span><br><span class="line">└─────────────────┘</span><br><span class="line">         ▲</span><br><span class="line">         │</span><br><span class="line">┌─────────────────┐</span><br><span class="line">│Student.prototype│</span><br><span class="line">└─────────────────┘</span><br><span class="line">         ▲</span><br><span class="line">         │</span><br><span class="line">┌─────────────────┐</span><br><span class="line">│    xiaoming     │</span><br><span class="line">└─────────────────┘</span><br></pre></td></tr></table></figure><p>也就是说，<code>xiaoming</code>的原型指向函数<code>Student</code>的原型。如果你又创建了<code>xiaohong</code>、<code>xiaojun</code>，那么这些对象的原型与<code>xiaoming</code>是一样的：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">              null</span><br><span class="line">                ▲</span><br><span class="line">                │</span><br><span class="line">       ┌─────────────────┐</span><br><span class="line">       │Object.prototype │</span><br><span class="line">       └─────────────────┘</span><br><span class="line">                ▲</span><br><span class="line">                │</span><br><span class="line">       ┌─────────────────┐</span><br><span class="line">       │Student.prototype│</span><br><span class="line">       └─────────────────┘</span><br><span class="line">         ▲      ▲      ▲</span><br><span class="line">         │      │      │</span><br><span class="line">┌─────────┐┌─────────┐┌─────────┐</span><br><span class="line">│xiaoming ││xiaohong ││ xiaojun │</span><br><span class="line">└─────────┘└─────────┘└─────────┘</span><br></pre></td></tr></table></figure><p>用<code>new Student()</code>创建的对象还从原型上获得了一个<code>constructor</code>属性，它指向函数<code>Student</code>本身：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">xiaoming.<span class="property">constructor</span> === <span class="title class_">Student</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">constructor</span>; <span class="comment">// true</span></span><br><span class="line"><span class="title class_">Student</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">constructor</span> === <span class="title class_">Student</span>; <span class="comment">// true</span></span><br><span class="line"></span><br><span class="line"><span class="title class_">Object</span>.<span class="title function_">getPrototypeOf</span>(xiaoming) === <span class="title class_">Student</span>.<span class="property"><span class="keyword">prototype</span></span>; <span class="comment">// true</span></span><br><span class="line"></span><br><span class="line">xiaoming <span class="keyword">instanceof</span> <span class="title class_">Student</span>; <span class="comment">// true</span></span><br></pre></td></tr></table></figure><p>看晕了吧？用一张图来表示这些乱七八糟的关系就是：</p><p><img src="https://liaoxuefeng.com/books/javascript/oop/create-object/prototypes.jpg" alt="prototypes"></p><p>红色箭头是原型链。注意，<code>Student.prototype</code>指向的对象就是<code>xiaoming</code>、<code>xiaohong</code>的原型对象，这个原型对象自己还有个属性<code>constructor</code>，指向<code>Student</code>函数本身。</p><p>另外，函数<code>Student</code>恰好有个属性<code>prototype</code>指向<code>xiaoming</code>、<code>xiaohong</code>的原型对象，但是<code>xiaoming</code>、<code>xiaohong</code>这些对象可没有<code>prototype</code>这个属性，不过可以用<code>__proto__</code>这个非标准用法来查看。</p><p>现在我们就认为<code>xiaoming</code>、<code>xiaohong</code>这些对象“继承”自<code>Student</code>。</p><p>不过还有一个小问题，注意观察：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">xiaoming.<span class="property">name</span>; <span class="comment">// &#x27;小明&#x27;</span></span><br><span class="line">xiaohong.<span class="property">name</span>; <span class="comment">// &#x27;小红&#x27;</span></span><br><span class="line">xiaoming.<span class="property">hello</span>; <span class="comment">// function: Student.hello()</span></span><br><span class="line">xiaohong.<span class="property">hello</span>; <span class="comment">// function: Student.hello()</span></span><br><span class="line">xiaoming.<span class="property">hello</span> === xiaohong.<span class="property">hello</span>; <span class="comment">// false</span></span><br></pre></td></tr></table></figure><p><code>xiaoming</code>和<code>xiaohong</code>各自的<code>name</code>不同，这是对的，否则我们无法区分谁是谁了。</p><p><code>xiaoming</code>和<code>xiaohong</code>各自的<code>hello</code>是一个函数，但它们是两个不同的函数，虽然函数名称和代码都是相同的！</p><p>如果我们通过<code>new Student()</code>创建了很多对象，这些对象的<code>hello</code>函数实际上只需要共享同一个函数就可以了，这样可以节省很多内存。</p><p>要让创建的对象共享一个<code>hello</code>函数，根据对象的属性查找原则，我们只要把<code>hello</code>函数移动到<code>xiaoming</code>、<code>xiaohong</code>这些对象共同的原型上就可以了，也就是<code>Student.prototype</code>：</p><p><img src="https://liaoxuefeng.com/books/javascript/oop/create-object/proto-share.jpg" alt="protos2"></p><p>修改代码如下：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">Student</span>(<span class="params">name</span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">name</span> = name;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title class_">Student</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">hello</span> = <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">    <span class="title function_">alert</span>(<span class="string">&#x27;Hello, &#x27;</span> + <span class="variable language_">this</span>.<span class="property">name</span> + <span class="string">&#x27;!&#x27;</span>);</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>用<code>new</code>创建基于原型的JavaScript的对象就是这么简单！</p><h4 id="忘记写new怎么办"><a href="#忘记写new怎么办" class="headerlink" title="忘记写new怎么办"></a>忘记写new怎么办</h4><p>如果一个函数被定义为用于创建对象的构造函数，但是调用时忘记了写<code>new</code>怎么办？</p><p>在strict模式下，<code>this.name = name</code>将报错，因为<code>this</code>绑定为<code>undefined</code>，在非strict模式下，<code>this.name = name</code>不报错，因为<code>this</code>绑定为<code>window</code>，于是无意间创建了全局变量<code>name</code>，并且返回<code>undefined</code>，这个结果更糟糕。</p><p>所以，调用构造函数千万不要忘记写<code>new</code>。为了区分普通函数和构造函数，按照约定，构造函数首字母应当大写，而普通函数首字母应当小写，这样，一些语法检查工具如<a href="https://www.jslint.com/">jslint</a>将可以帮你检测到漏写的<code>new</code>。</p><p>最后，我们还可以编写一个<code>createStudent()</code>函数，在内部封装所有的<code>new</code>操作。一个常用的编程模式像这样：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">Student</span>(<span class="params">props</span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">name</span> = props.<span class="property">name</span> || <span class="string">&#x27;匿名&#x27;</span>; <span class="comment">// 默认值为&#x27;匿名&#x27;</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">grade</span> = props.<span class="property">grade</span> || <span class="number">1</span>; <span class="comment">// 默认值为1</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title class_">Student</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">hello</span> = <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">    <span class="title function_">alert</span>(<span class="string">&#x27;Hello, &#x27;</span> + <span class="variable language_">this</span>.<span class="property">name</span> + <span class="string">&#x27;!&#x27;</span>);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">createStudent</span>(<span class="params">props</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Student</span>(props || &#123;&#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>这个<code>createStudent()</code>函数有几个巨大的优点：一是不需要<code>new</code>来调用，二是参数非常灵活，可以不传，也可以这么传：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> xiaoming = <span class="title function_">createStudent</span>(&#123;</span><br><span class="line">    <span class="attr">name</span>: <span class="string">&#x27;小明&#x27;</span></span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">xiaoming.<span class="property">grade</span>; <span class="comment">// 1</span></span><br></pre></td></tr></table></figure><p>如果创建的对象有很多属性，我们只需要传递需要的某些属性，剩下的属性可以用默认值。由于参数是一个Object，我们无需记忆参数的顺序。如果恰好从<code>JSON</code>拿到了一个对象，就可以直接创建出<code>xiaoming</code>。</p><h3 id="原型继承"><a href="#原型继承" class="headerlink" title="原型继承"></a>原型继承</h3><p>什么玩意不学</p><h3 id="Class继承"><a href="#Class继承" class="headerlink" title="Class继承"></a>Class继承</h3><p>我们先回顾用函数实现<code>Student</code>的方法：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">Student</span>(<span class="params">name</span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">name</span> = name;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title class_">Student</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">hello</span> = <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">    <span class="title function_">alert</span>(<span class="string">&#x27;Hello, &#x27;</span> + <span class="variable language_">this</span>.<span class="property">name</span> + <span class="string">&#x27;!&#x27;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>如果用新的<code>class</code>关键字来编写<code>Student</code>，可以这样写：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Student</span> &#123;</span><br><span class="line">    <span class="title function_">constructor</span>(<span class="params">name</span>) &#123;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">name</span> = name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="title function_">hello</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="title function_">alert</span>(<span class="string">&#x27;Hello, &#x27;</span> + <span class="variable language_">this</span>.<span class="property">name</span> + <span class="string">&#x27;!&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>比较一下就可以发现，<code>class</code>的定义包含了构造函数<code>constructor</code>和定义在原型对象上的函数<code>hello()</code>（注意没有<code>function</code>关键字），这样就避免了<code>Student.prototype.hello = function () &#123;...&#125;</code>这样分散的代码。</p><p>最后，创建一个<code>Student</code>对象代码和前面章节完全一样：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> xiaoming = <span class="keyword">new</span> <span class="title class_">Student</span>(<span class="string">&#x27;小明&#x27;</span>);</span><br><span class="line">xiaoming.<span class="title function_">hello</span>();</span><br></pre></td></tr></table></figure><p>用<code>class</code>定义对象的另一个巨大的好处是继承更方便了。想一想我们从<code>Student</code>派生一个<code>PrimaryStudent</code>需要编写的代码量。现在，原型继承的中间对象，原型对象的构造函数等等都不需要考虑了，直接通过<code>extends</code>来实现：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">PrimaryStudent</span> <span class="keyword">extends</span> <span class="title class_ inherited__">Student</span> &#123;</span><br><span class="line">    <span class="title function_">constructor</span>(<span class="params">name, grade</span>) &#123;</span><br><span class="line">        <span class="variable language_">super</span>(name); <span class="comment">// 记得用super调用父类的构造方法!</span></span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">grade</span> = grade;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="title function_">myGrade</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="title function_">alert</span>(<span class="string">&#x27;I am at grade &#x27;</span> + <span class="variable language_">this</span>.<span class="property">grade</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>注意<code>PrimaryStudent</code>的定义也是class关键字实现的，而<code>extends</code>则表示原型链对象来自<code>Student</code>。子类的构造函数可能会与父类不太相同，例如，<code>PrimaryStudent</code>需要<code>name</code>和<code>grade</code>两个参数，并且需要通过<code>super(name)</code>来调用父类的构造函数，否则父类的<code>name</code>属性无法正常初始化。</p><p><code>PrimaryStudent</code>已经自动获得了父类<code>Student</code>的<code>hello</code>方法，我们又在子类中定义了新的<code>myGrade</code>方法。</p><p>ES6引入的<code>class</code>和原有的JavaScript原型继承有什么区别呢？实际上它们没有任何区别，<code>class</code>的作用就是让JavaScript引擎去实现原来需要我们自己编写的原型链代码。简而言之，用<code>class</code>的好处就是极大地简化了原型链代码。</p><h2 id="浏览器"><a href="#浏览器" class="headerlink" title="浏览器"></a>浏览器</h2><h3 id="浏览器对象"><a href="#浏览器对象" class="headerlink" title="浏览器对象"></a>浏览器对象</h3><h4 id="window"><a href="#window" class="headerlink" title="window"></a>window</h4><p><code>window</code>对象不但充当全局作用域，而且表示浏览器窗口。</p><p><code>window</code>对象有<code>innerWidth</code>和<code>innerHeight</code>属性，可以获取浏览器窗口的内部宽度和高度。内部宽高是指除去菜单栏、工具栏、边框等占位元素后，用于显示网页的净宽高。</p><p>兼容性：IE&lt;=8不支持。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 可以调整浏览器窗口大小试试:</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;window inner size: &#x27;</span> + <span class="variable language_">window</span>.<span class="property">innerWidth</span> + <span class="string">&#x27; x &#x27;</span> + <span class="variable language_">window</span>.<span class="property">innerHeight</span>);</span><br></pre></td></tr></table></figure><p>对应的，还有一个<code>outerWidth</code>和<code>outerHeight</code>属性，可以获取浏览器窗口的整个宽高。</p><h4 id="navigator"><a href="#navigator" class="headerlink" title="navigator"></a>navigator</h4><p><code>navigator</code>对象表示浏览器的信息，最常用的属性包括：</p><ul><li>navigator.appName：浏览器名称；</li><li>navigator.appVersion：浏览器版本；</li><li>navigator.language：浏览器设置的语言；</li><li>navigator.platform：操作系统类型；</li><li>navigator.userAgent：浏览器设定的<code>User-Agent</code>字符串。</li></ul><h4 id="screen"><a href="#screen" class="headerlink" title="screen"></a>screen</h4><p><code>screen</code>对象表示屏幕的信息，常用的属性有：</p><ul><li>screen.width：屏幕宽度，以像素为单位；</li><li>screen.height：屏幕高度，以像素为单位；</li><li>screen.colorDepth：返回颜色位数，如8、16、24。</li></ul><h4 id="location"><a href="#location" class="headerlink" title="location"></a>location</h4><p><code>location</code>对象表示当前页面的URL信息。例如，一个完整的URL：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://www.example.com:8080/path/index.html?a=1&amp;b=2#TOP</span><br></pre></td></tr></table></figure><p>可以用<code>location.href</code>获取。要获得URL各个部分的值，可以这么写：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">location.<span class="property">protocol</span>; <span class="comment">// &#x27;http&#x27;</span></span><br><span class="line">location.<span class="property">host</span>; <span class="comment">// &#x27;www.example.com&#x27;</span></span><br><span class="line">location.<span class="property">port</span>; <span class="comment">// &#x27;8080&#x27;</span></span><br><span class="line">location.<span class="property">pathname</span>; <span class="comment">// &#x27;/path/index.html&#x27;</span></span><br><span class="line">location.<span class="property">search</span>; <span class="comment">// &#x27;?a=1&amp;b=2&#x27;</span></span><br><span class="line">location.<span class="property">hash</span>; <span class="comment">// &#x27;TOP&#x27;</span></span><br></pre></td></tr></table></figure><p>要加载一个新页面，可以调用<code>location.assign()</code>。如果要重新加载当前页面，调用<code>location.reload()</code>方法非常方便。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (<span class="title function_">confirm</span>(<span class="string">&#x27;重新加载当前页&#x27;</span> + location.<span class="property">href</span> + <span class="string">&#x27;?&#x27;</span>)) &#123;</span><br><span class="line">    location.<span class="title function_">reload</span>();</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    location.<span class="title function_">assign</span>(<span class="string">&#x27;/&#x27;</span>); <span class="comment">// 设置一个新的URL地址</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="document"><a href="#document" class="headerlink" title="document"></a>document</h4><p><code>document</code>对象表示当前页面。由于HTML在浏览器中以DOM形式表示为树形结构，<code>document</code>对象就是整个DOM树的根节点。</p><p><code>document</code>的<code>title</code>属性是从HTML文档中的<code>&lt;title&gt;xxx&lt;/title&gt;</code>读取的，但是可以动态改变：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">document</span>.<span class="property">title</span> = <span class="string">&#x27;努力学习JavaScript!&#x27;</span>;</span><br></pre></td></tr></table></figure><p>要查找DOM树的某个节点，需要从<code>document</code>对象开始查找。最常用的查找是根据ID和Tag Name。</p><p>我们先准备HTML数据：</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dl</span> <span class="attr">id</span>=<span class="string">&quot;drink-menu&quot;</span> <span class="attr">style</span>=<span class="string">&quot;border:solid 1px #ccc;padding:6px;&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dt</span>&gt;</span>摩卡<span class="tag">&lt;/<span class="name">dt</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dd</span>&gt;</span>热摩卡咖啡<span class="tag">&lt;/<span class="name">dd</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dt</span>&gt;</span>酸奶<span class="tag">&lt;/<span class="name">dt</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dd</span>&gt;</span>北京老酸奶<span class="tag">&lt;/<span class="name">dd</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dt</span>&gt;</span>果汁<span class="tag">&lt;/<span class="name">dt</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dd</span>&gt;</span>鲜榨苹果汁<span class="tag">&lt;/<span class="name">dd</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dl</span>&gt;</span></span><br></pre></td></tr></table></figure><ul><li><p>摩卡</p><p>热摩卡咖啡</p></li><li><p>酸奶</p><p>北京老酸奶</p></li><li><p>果汁</p><p>鲜榨苹果汁</p></li></ul><p>用<code>document</code>对象提供的<code>getElementById()</code>和<code>getElementsByTagName()</code>可以按ID获得一个DOM节点和按Tag名称获得一组DOM节点：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> menu = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;drink-menu&#x27;</span>);</span><br><span class="line"><span class="keyword">let</span> drinks = <span class="variable language_">document</span>.<span class="title function_">getElementsByTagName</span>(<span class="string">&#x27;dt&#x27;</span>);</span><br><span class="line"><span class="keyword">let</span> s = <span class="string">&#x27;提供的饮料有:&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">let</span> i=<span class="number">0</span>; i&lt;drinks.<span class="property">length</span>; i++) &#123;</span><br><span class="line">    s = s + drinks[i].<span class="property">innerHTML</span> + <span class="string">&#x27;,&#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(s);</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>运行结果：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">提供的饮料有:摩卡,酸奶,果汁,</span><br></pre></td></tr></table></figure><p><code>document</code>对象还有一个<code>cookie</code>属性，可以获取当前页面的Cookie。</p><p>Cookie是由服务器发送的key-value标示符。因为HTTP协议是无状态的，但是服务器要区分到底是哪个用户发过来的请求，就可以用Cookie来区分。当一个用户成功登录后，服务器发送一个Cookie给浏览器，例如<code>user=ABC123XYZ(加密的字符串)...</code>，此后，浏览器访问该网站时，会在请求头附上这个Cookie，服务器根据Cookie即可区分出用户。</p><p>Cookie还可以存储网站的一些设置，例如，页面显示的语言等等。</p><p>JavaScript可以通过<code>document.cookie</code>读取到当前页面的Cookie：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">document</span>.<span class="property">cookie</span>; <span class="comment">// &#x27;v=123; remember=true; prefer=zh&#x27;</span></span><br></pre></td></tr></table></figure><p>由于JavaScript能读取到页面的Cookie，而用户的登录信息通常也存在Cookie中，这就造成了巨大的安全隐患，这是因为在HTML页面中引入第三方的JavaScript代码是允许的：</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 当前页面在wwwexample.com --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;http://www.foo.com/jquery.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">    ...</span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><p>如果引入的第三方的JavaScript中存在恶意代码，则<code>www.foo.com</code>网站将直接获取到<code>www.example.com</code>网站的用户登录信息。</p><p>为了解决这个问题，服务器在设置Cookie时可以使用<code>httpOnly</code>，设定了<code>httpOnly</code>的Cookie将不能被JavaScript读取。这个行为由浏览器实现，主流浏览器均支持<code>httpOnly</code>选项，IE从IE6 SP1开始支持。</p><p>为了确保安全，服务器端在设置Cookie时，应该始终坚持使用<code>httpOnly</code>。</p><h4 id="history"><a href="#history" class="headerlink" title="history"></a>history</h4><p><code>history</code>对象保存了浏览器的历史记录，JavaScript可以调用<code>history</code>对象的<code>back()</code>或<code>forward ()</code>，相当于用户点击了浏览器的“后退”或“前进”按钮。</p><p>这个对象属于历史遗留对象，对于现代Web页面来说，由于大量使用AJAX和页面交互，简单粗暴地调用<code>history.back()</code>可能会让用户感到非常愤怒。</p><p>新手开始设计Web页面时喜欢在登录页登录成功时调用<code>history.back()</code>，试图回到登录前的页面。这是一种错误的方法。</p><p>对使用AJAX动态加载的页面，如果希望页面更新时同时更新<code>history</code>对象，应当使用<code>history.pushState()</code>方法：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// when AJAX is done:</span></span><br><span class="line"><span class="keyword">let</span> state = <span class="string">&#x27;any-data&#x27;</span>;</span><br><span class="line"><span class="keyword">let</span> newUrl = <span class="string">&#x27;/ajax.html#signin&#x27;</span>;</span><br><span class="line">history.<span class="title function_">pushState</span>(state, <span class="string">&#x27;&#x27;</span>, newUrl);</span><br></pre></td></tr></table></figure><p>当用户点击“后退”时，浏览器并不会刷新页面，而是触发<code>popstate</code>事件，可由JavaScript捕获并更新相应的部分页面内容。</p><h3 id="操作DOM"><a href="#操作DOM" class="headerlink" title="操作DOM"></a>操作DOM</h3><p>由于HTML文档被浏览器解析后就是一棵DOM树，要改变HTML的结构，就需要通过JavaScript来操作DOM。</p><p>始终记住DOM是一个树形结构。操作一个DOM节点实际上就是这么几个操作：</p><ul><li>更新：更新该DOM节点的内容，相当于更新了该DOM节点表示的HTML的内容；</li><li>遍历：遍历该DOM节点下的子节点，以便进行进一步操作；</li><li>添加：在该DOM节点下新增一个子节点，相当于动态增加了一个HTML节点；</li><li>删除：将该节点从HTML中删除，相当于删掉了该DOM节点的内容以及它包含的所有子节点。</li></ul><p>在操作一个DOM节点前，我们需要通过各种方式先拿到这个DOM节点。最常用的方法是<code>document.getElementById()</code>和<code>document.getElementsByTagName()</code>，以及CSS选择器<code>document.getElementsByClassName()</code>。</p><p>由于ID在HTML文档中是唯一的，所以<code>document.getElementById()</code>可以直接定位唯一的一个DOM节点。<code>document.getElementsByTagName()</code>和<code>document.getElementsByClassName()</code>总是返回一组DOM节点。要精确地选择DOM，可以先定位父节点，再从父节点开始选择，以缩小范围。</p><p>例如：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 返回ID为&#x27;test&#x27;的节点：</span></span><br><span class="line"><span class="keyword">let</span> test = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;test&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 先定位ID为&#x27;test-table&#x27;的节点，再返回其内部所有tr节点：</span></span><br><span class="line"><span class="keyword">let</span> trs = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;test-table&#x27;</span>).<span class="title function_">getElementsByTagName</span>(<span class="string">&#x27;tr&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 先定位ID为&#x27;test-div&#x27;的节点，再返回其内部所有class包含red的节点：</span></span><br><span class="line"><span class="keyword">let</span> reds = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;test-div&#x27;</span>).<span class="title function_">getElementsByClassName</span>(<span class="string">&#x27;red&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 获取节点test下的所有直属子节点:</span></span><br><span class="line"><span class="keyword">let</span> cs = test.<span class="property">children</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 获取节点test下第一个、最后一个子节点：</span></span><br><span class="line"><span class="keyword">let</span> first = test.<span class="property">firstElementChild</span>;</span><br><span class="line"><span class="keyword">let</span> last = test.<span class="property">lastElementChild</span>;</span><br></pre></td></tr></table></figure><p>第二种方法是使用<code>querySelector()</code>和<code>querySelectorAll()</code>，需要了解selector语法，然后使用条件来获取节点，更加方便：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 通过querySelector获取ID为q1的节点：</span></span><br><span class="line"><span class="keyword">let</span> q1 = <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;#q1&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 通过querySelectorAll获取q1节点内的符合条件的所有节点：</span></span><br><span class="line"><span class="keyword">let</span> ps = q1.<span class="title function_">querySelectorAll</span>(<span class="string">&#x27;div.highlighted &gt; p&#x27;</span>);</span><br></pre></td></tr></table></figure><p>注意：低版本的IE&lt;8不支持<code>querySelector</code>和<code>querySelectorAll</code>。IE8仅有限支持。</p><p>严格地讲，我们这里的DOM节点是指<code>Element</code>，但是DOM节点实际上是<code>Node</code>，在HTML中，<code>Node</code>包括<code>Element</code>、<code>Comment</code>、<code>CDATA_SECTION</code>等很多种，以及根节点<code>Document</code>类型，但是，绝大多数时候我们只关心<code>Element</code>，也就是实际控制页面结构的<code>Node</code>，其他类型的<code>Node</code>忽略即可。根节点<code>Document</code>已经自动绑定为全局变量<code>document</code>。</p><h4 id="selector"><a href="#selector" class="headerlink" title="selector"></a>selector</h4><p>JavaScript中有多种selector语法，主要用于选择和操作DOM元素。以下是常用的selector语法：</p><ol><li><h5 id="基本选择器方法"><a href="#基本选择器方法" class="headerlink" title="基本选择器方法"></a>基本选择器方法</h5></li></ol><p><strong>querySelector()</strong></p><p>选择匹配的第一个元素：<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 选择第一个class为&quot;example&quot;的元素</span></span><br><span class="line"><span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;.example&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 选择id为&quot;myId&quot;的元素</span></span><br><span class="line"><span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;#myId&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 选择第一个p标签</span></span><br><span class="line"><span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;p&#x27;</span>)</span><br></pre></td></tr></table></figure></p><p><strong>querySelectorAll()</strong></p><p>选择所有匹配的元素，返回NodeList：<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 选择所有class为&quot;example&quot;的元素</span></span><br><span class="line"><span class="variable language_">document</span>.<span class="title function_">querySelectorAll</span>(<span class="string">&#x27;.example&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 选择所有p标签</span></span><br><span class="line"><span class="variable language_">document</span>.<span class="title function_">querySelectorAll</span>(<span class="string">&#x27;p&#x27;</span>)</span><br></pre></td></tr></table></figure></p><ol><li><h5 id="CSS选择器语法"><a href="#CSS选择器语法" class="headerlink" title="CSS选择器语法"></a>CSS选择器语法</h5></li></ol><p><strong>基本选择器</strong></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 标签选择器</span></span><br><span class="line"><span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;div&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 类选择器</span></span><br><span class="line"><span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;.className&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// ID选择器</span></span><br><span class="line"><span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;#idName&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 属性选择器</span></span><br><span class="line"><span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;[data-id=&quot;123&quot;]&#x27;</span>)</span><br><span class="line"><span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;input[type=&quot;text&quot;]&#x27;</span>)</span><br></pre></td></tr></table></figure><p><strong>组合选择器</strong></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 后代选择器</span></span><br><span class="line"><span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;div p&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 子选择器</span></span><br><span class="line"><span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;div &gt; p&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 相邻兄弟选择器</span></span><br><span class="line"><span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;h1 + p&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 通用兄弟选择器</span></span><br><span class="line"><span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;h1 ~ p&#x27;</span>)</span><br></pre></td></tr></table></figure><details class="folding-tag" green><summary> 解释 </summary>              <div class='content'>              <ol><li><strong>后代选择器 (div p)</strong></li></ol><ul><li><p><strong>代码</strong>: document.querySelector(‘div p’)</p></li><li><p><strong>含义</strong>: 选择所有作为 div 元素后代的 p 元素。</p></li><li><p><strong>解释</strong>: 这个选择器会选中 div 元素内部的所有 p 元素，无论这些 p 是 div 的直接子元素还是嵌套在更深层次的子元素中。换句话说，只要 p 在 div 内部，它就会被选中。</p></li><li><p>示例</p><p>:</p><p>html</p><p>CollapseWrap</p><p>Copy</p><ul><li>document.querySelector(‘div p’) 会返回第一个匹配的 <p> 元素（例如上面的第一个 <p>）。</li></ul></li></ul><hr><ol><li><strong>子选择器 (div &gt; p)</strong></li></ol><ul><li><p><strong>代码</strong>: document.querySelector(‘div &gt; p’)</p></li><li><p><strong>含义</strong>: 选择所有作为 div 元素直接子元素的 p 元素。</p></li><li><p><strong>解释</strong>: 这个选择器只会选中 div 的直接子元素中的 p，不会选择嵌套在更深层次的 p 元素。也就是说，只有当 p 是 div 的第一级子元素时才会被选中。</p></li><li><p>示例</p><p>:</p><p>html</p><p>CollapseWrap</p><p>Copy</p><ul><li>document.querySelector(‘div &gt; p’) 会返回第一个直接在 div 下的 <p> 元素（例如上面的第一个 <p>）。</li></ul></li></ul><hr><ol><li><strong>相邻兄弟选择器 (h1 + p)</strong></li></ol><ul><li><p><strong>代码</strong>: document.querySelector(‘h1 + p’)</p></li><li><p><strong>含义</strong>: 选择紧跟在 h1 元素后面的第一个 p 元素。</p></li><li><p><strong>解释</strong>: 这个选择器会选中与 h1 元素在同一层级且紧随其后的第一个 p 元素。如果 h1 后面没有 p，或者中间隔着其他元素，则不会选中任何元素。</p></li><li><p>示例</p><p>:</p><p>html</p><p>CollapseWrap</p><p>Copy</p><p><code>&lt;h1&gt;标题&lt;/h1&gt; &lt;p&gt;这个 p 会被选择&lt;/p&gt; &lt;p&gt;这个 p 不会被选择&lt;/p&gt;</code></p><ul><li>document.querySelector(‘h1 + p’) 会返回紧跟在 <h1> 后面的第一个 <p> 元素（例如上面的第一个 <p>）。</li></ul></li></ul><hr><ol><li><strong>通用兄弟选择器 (h1 ~ p)</strong></li></ol><ul><li><p><strong>代码</strong>: document.querySelector(‘h1 ~ p’)</p></li><li><p><strong>含义</strong>: 选择所有在 h1 元素后面的 p 元素。</p></li><li><p><strong>解释</strong>: 这个选择器会选中与 h1 元素在同一层级且位于 h1 之后的所有 p 元素，不要求它们必须紧邻。只要 p 在 h1 后面且在同一层级，它就会被选中。</p></li><li><p>示例</p><p>:</p><p>html</p><p>CollapseWrap</p><p>Copy</p><p><code>&lt;h1&gt;标题&lt;/h1&gt; &lt;div&gt;其他元素&lt;/div&gt; &lt;p&gt;这个 p 会被选择&lt;/p&gt; &lt;p&gt;这个 p 也会被选择&lt;/p&gt;</code></p><ul><li>document.querySelector(‘h1 ~ p’) 会返回第一个在 <h1> 后面的 <p> 元素（例如上面的第一个 <p>）。</li></ul></li></ul>              </div>            </details><p><strong>伪类选择器</strong></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 第一个子元素</span></span><br><span class="line"><span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;li:first-child&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 最后一个子元素</span></span><br><span class="line"><span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;li:last-child&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 第n个子元素</span></span><br><span class="line"><span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;li:nth-child(2)&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// hover状态（通常用于CSS，在JS中较少用）</span></span><br><span class="line"><span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;button:hover&#x27;</span>)</span><br></pre></td></tr></table></figure><ol><li><h5 id="传统选择器方法"><a href="#传统选择器方法" class="headerlink" title="传统选择器方法"></a>传统选择器方法</h5></li></ol><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 通过ID选择</span></span><br><span class="line"><span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;myId&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 通过类名选择</span></span><br><span class="line"><span class="variable language_">document</span>.<span class="title function_">getElementsByClassName</span>(<span class="string">&#x27;className&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 通过标签名选择</span></span><br><span class="line"><span class="variable language_">document</span>.<span class="title function_">getElementsByTagName</span>(<span class="string">&#x27;div&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 通过name属性选择</span></span><br><span class="line"><span class="variable language_">document</span>.<span class="title function_">getElementsByName</span>(<span class="string">&#x27;inputName&#x27;</span>)</span><br></pre></td></tr></table></figure><ol><li><h5 id="高级选择器示例"><a href="#高级选择器示例" class="headerlink" title="高级选择器示例"></a>高级选择器示例</h5></li></ol><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 复合选择器</span></span><br><span class="line"><span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;div.container #header&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 多个类</span></span><br><span class="line"><span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;.class1.class2&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 属性包含特定值</span></span><br><span class="line"><span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;[class*=&quot;btn&quot;]&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 属性以特定值开头</span></span><br><span class="line"><span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;[id^=&quot;menu&quot;]&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 属性以特定值结尾</span></span><br><span class="line"><span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;[class$=&quot;active&quot;]&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 选择多个选择器（用逗号分隔）</span></span><br><span class="line"><span class="variable language_">document</span>.<span class="title function_">querySelectorAll</span>(<span class="string">&#x27;h1, h2, h3&#x27;</span>)</span><br></pre></td></tr></table></figure><ol><li><h5 id="实用技巧"><a href="#实用技巧" class="headerlink" title="实用技巧"></a>实用技巧</h5></li></ol><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 选择没有特定类的元素</span></span><br><span class="line"><span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;div:not(.excluded)&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 选择空元素</span></span><br><span class="line"><span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;p:empty&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 选择包含特定文本的元素（需要遍历）</span></span><br><span class="line">[...<span class="variable language_">document</span>.<span class="title function_">querySelectorAll</span>(<span class="string">&#x27;p&#x27;</span>)].<span class="title function_">find</span>(<span class="function"><span class="params">p</span> =&gt;</span> p.<span class="property">textContent</span>.<span class="title function_">includes</span>(<span class="string">&#x27;搜索文本&#x27;</span>))</span><br></pre></td></tr></table></figure><h4 id="更新DOM"><a href="#更新DOM" class="headerlink" title="更新DOM"></a>更新DOM</h4><p>拿到一个DOM节点后，我们可以对它进行更新。</p><p>可以直接修改节点的文本，方法有两种：</p><p>一种是修改<code>innerHTML</code>属性，这个方式非常强大，不但可以修改一个DOM节点的文本内容，还可以直接通过HTML片段修改DOM节点内部的子树：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 获取&lt;p id=&quot;p-id&quot;&gt;...&lt;/p&gt;</span></span><br><span class="line"><span class="keyword">let</span> p = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;p-id&#x27;</span>);</span><br><span class="line"><span class="comment">// 设置文本为abc:</span></span><br><span class="line">p.<span class="property">innerHTML</span> = <span class="string">&#x27;ABC&#x27;</span>; <span class="comment">// &lt;p id=&quot;p-id&quot;&gt;ABC&lt;/p&gt;</span></span><br><span class="line"><span class="comment">// 设置HTML:</span></span><br><span class="line">p.<span class="property">innerHTML</span> = <span class="string">&#x27;ABC &lt;span style=&quot;color:red&quot;&gt;RED&lt;/span&gt; XYZ&#x27;</span>;</span><br><span class="line"><span class="comment">// &lt;p&gt;...&lt;/p&gt;的内部结构已修改</span></span><br></pre></td></tr></table></figure><p>用<code>innerHTML</code>时要注意，是否需要写入HTML。如果写入的字符串是通过网络拿到的，要注意对字符编码来避免XSS攻击。</p><p>第二种是修改<code>innerText</code>或<code>textContent</code>属性，这样可以自动对字符串进行HTML编码，保证无法设置任何HTML标签：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 获取&lt;p id=&quot;p-id&quot;&gt;...&lt;/p&gt;</span></span><br><span class="line"><span class="keyword">let</span> p = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;p-id&#x27;</span>);</span><br><span class="line"><span class="comment">// 设置文本:</span></span><br><span class="line">p.<span class="property">innerText</span> = <span class="string">&#x27;&lt;script&gt;alert(&quot;Hi&quot;)&lt;/script&gt;&#x27;</span>;</span><br><span class="line"><span class="comment">// HTML被自动编码，无法设置一个&lt;script&gt;节点:</span></span><br><span class="line"><span class="comment">// &lt;p id=&quot;p-id&quot;&gt;&amp;lt;script&amp;gt;alert(&quot;Hi&quot;)&amp;lt;/script&amp;gt;&lt;/p&gt;</span></span><br></pre></td></tr></table></figure><p>两者的区别在于读取属性时，<code>innerText</code>不返回隐藏元素的文本，而<code>textContent</code>返回所有文本。另外注意IE&lt;9不支持<code>textContent</code>。</p><p>修改CSS也是经常需要的操作。DOM节点的<code>style</code>属性对应所有的CSS，可以直接获取或设置。因为CSS允许<code>font-size</code>这样的名称，但它并非JavaScript有效的属性名，所以需要在JavaScript中改写为驼峰式命名<code>fontSize</code>：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 获取&lt;p id=&quot;p-id&quot;&gt;...&lt;/p&gt;</span></span><br><span class="line"><span class="keyword">let</span> p = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;p-id&#x27;</span>);</span><br><span class="line"><span class="comment">// 设置CSS:</span></span><br><span class="line">p.<span class="property">style</span>.<span class="property">color</span> = <span class="string">&#x27;#ff0000&#x27;</span>;</span><br><span class="line">p.<span class="property">style</span>.<span class="property">fontSize</span> = <span class="string">&#x27;20px&#x27;</span>;</span><br><span class="line">p.<span class="property">style</span>.<span class="property">paddingTop</span> = <span class="string">&#x27;2em&#x27;</span>;</span><br></pre></td></tr></table></figure><h4 id="插入DOM"><a href="#插入DOM" class="headerlink" title="插入DOM"></a>插入DOM</h4><p>当我们获得了某个DOM节点，想在这个DOM节点内插入新的DOM，应该如何做？</p><p>如果这个DOM节点是空的，例如，<code>&lt;div&gt;&lt;/div&gt;</code>，那么，直接使用<code>innerHTML = &#39;&lt;span&gt;child&lt;/span&gt;&#39;</code>就可以修改DOM节点的内容，相当于“插入”了新的DOM节点。</p><p>如果这个DOM节点不是空的，那就不能这么做，因为<code>innerHTML</code>会直接替换掉原来的所有子节点。</p><p>有两个办法可以插入新的节点。一个是使用<code>appendChild</code>，把一个子节点添加到父节点的最后一个子节点。例如：</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- HTML结构 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span> <span class="attr">id</span>=<span class="string">&quot;js&quot;</span>&gt;</span>JavaScript<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;list&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span> <span class="attr">id</span>=<span class="string">&quot;java&quot;</span>&gt;</span>Java<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span> <span class="attr">id</span>=<span class="string">&quot;python&quot;</span>&gt;</span>Python<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span> <span class="attr">id</span>=<span class="string">&quot;scheme&quot;</span>&gt;</span>Scheme<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure><p>把<code>&lt;p id=&quot;js&quot;&gt;JavaScript&lt;/p&gt;</code>添加到<code>&lt;div id=&quot;list&quot;&gt;</code>的最后一项：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span></span><br><span class="line">    js = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;js&#x27;</span>),</span><br><span class="line">    list = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;list&#x27;</span>);</span><br><span class="line">list.<span class="title function_">appendChild</span>(js);</span><br></pre></td></tr></table></figure><p>现在，HTML结构变成了这样：</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- HTML结构 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;list&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span> <span class="attr">id</span>=<span class="string">&quot;java&quot;</span>&gt;</span>Java<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span> <span class="attr">id</span>=<span class="string">&quot;python&quot;</span>&gt;</span>Python<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span> <span class="attr">id</span>=<span class="string">&quot;scheme&quot;</span>&gt;</span>Scheme<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span> <span class="attr">id</span>=<span class="string">&quot;js&quot;</span>&gt;</span>JavaScript<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure><p>因为我们插入的<code>js</code>节点已经存在于当前的文档树，因此这个节点首先会从原先的位置删除，再插入到新的位置。</p><p>更多的时候我们会从零创建一个新的节点，然后插入到指定位置：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span></span><br><span class="line">    list = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;list&#x27;</span>),</span><br><span class="line">    haskell = <span class="variable language_">document</span>.<span class="title function_">createElement</span>(<span class="string">&#x27;p&#x27;</span>);</span><br><span class="line">haskell.<span class="property">id</span> = <span class="string">&#x27;haskell&#x27;</span>;</span><br><span class="line">haskell.<span class="property">innerText</span> = <span class="string">&#x27;Haskell&#x27;</span>;</span><br><span class="line">list.<span class="title function_">appendChild</span>(haskell);</span><br></pre></td></tr></table></figure><p>这样我们就动态添加了一个新的节点：</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- HTML结构 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;list&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span> <span class="attr">id</span>=<span class="string">&quot;java&quot;</span>&gt;</span>Java<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span> <span class="attr">id</span>=<span class="string">&quot;python&quot;</span>&gt;</span>Python<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span> <span class="attr">id</span>=<span class="string">&quot;scheme&quot;</span>&gt;</span>Scheme<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span> <span class="attr">id</span>=<span class="string">&quot;haskell&quot;</span>&gt;</span>Haskell<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure><p>动态创建一个节点然后添加到DOM树中，可以实现很多功能。举个例子，下面的代码动态创建了一个<code>&lt;style&gt;</code>节点，然后把它添加到<code>&lt;head&gt;</code>节点的末尾，这样就动态地给文档添加了新的CSS定义：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> d = <span class="variable language_">document</span>.<span class="title function_">createElement</span>(<span class="string">&#x27;style&#x27;</span>);</span><br><span class="line">d.<span class="title function_">setAttribute</span>(<span class="string">&#x27;type&#x27;</span>, <span class="string">&#x27;text/css&#x27;</span>);</span><br><span class="line">d.<span class="property">innerHTML</span> = <span class="string">&#x27;p &#123; color: red &#125;&#x27;</span>;</span><br><span class="line"><span class="variable language_">document</span>.<span class="title function_">getElementsByTagName</span>(<span class="string">&#x27;head&#x27;</span>)[<span class="number">0</span>].<span class="title function_">appendChild</span>(d);</span><br></pre></td></tr></table></figure><p>可以在Chrome的控制台执行上述代码，观察页面样式的变化。</p><h5 id="insertBefore"><a href="#insertBefore" class="headerlink" title="insertBefore"></a>insertBefore</h5><p>如果我们要把子节点插入到指定的位置怎么办？可以使用<code>parentElement.insertBefore(newElement, referenceElement);</code>，子节点会插入到<code>referenceElement</code>之前。</p><p>还是以上面的HTML为例，假定我们要把<code>Haskell</code>插入到<code>Python</code>之前：</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- HTML结构 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;list&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span> <span class="attr">id</span>=<span class="string">&quot;java&quot;</span>&gt;</span>Java<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span> <span class="attr">id</span>=<span class="string">&quot;python&quot;</span>&gt;</span>Python<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span> <span class="attr">id</span>=<span class="string">&quot;scheme&quot;</span>&gt;</span>Scheme<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure><p>可以这么写：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span></span><br><span class="line">    list = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;list&#x27;</span>),</span><br><span class="line">    ref = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;python&#x27;</span>),</span><br><span class="line">    haskell = <span class="variable language_">document</span>.<span class="title function_">createElement</span>(<span class="string">&#x27;p&#x27;</span>);</span><br><span class="line">haskell.<span class="property">id</span> = <span class="string">&#x27;haskell&#x27;</span>;</span><br><span class="line">haskell.<span class="property">innerText</span> = <span class="string">&#x27;Haskell&#x27;</span>;</span><br><span class="line">list.<span class="title function_">insertBefore</span>(haskell, ref);</span><br></pre></td></tr></table></figure><p>新的HTML结构如下：</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- HTML结构 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;list&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span> <span class="attr">id</span>=<span class="string">&quot;java&quot;</span>&gt;</span>Java<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span> <span class="attr">id</span>=<span class="string">&quot;haskell&quot;</span>&gt;</span>Haskell<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span> <span class="attr">id</span>=<span class="string">&quot;python&quot;</span>&gt;</span>Python<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span> <span class="attr">id</span>=<span class="string">&quot;scheme&quot;</span>&gt;</span>Scheme<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure><p>可见，使用<code>insertBefore</code>重点是要拿到一个“参考子节点”的引用。很多时候，需要循环一个父节点的所有子节点，可以通过迭代<code>children</code>属性实现：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span></span><br><span class="line">    i, c,</span><br><span class="line">    list = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;list&#x27;</span>);</span><br><span class="line"><span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; list.<span class="property">children</span>.<span class="property">length</span>; i++) &#123;</span><br><span class="line">    c = list.<span class="property">children</span>[i]; <span class="comment">// 拿到第i个子节点</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="删除DOM"><a href="#删除DOM" class="headerlink" title="删除DOM"></a>删除DOM</h4><p>删除一个DOM节点就比插入要容易得多。</p><p>要删除一个节点，首先要获得该节点本身以及它的父节点，然后，调用父节点的<code>removeChild</code>把自己删掉：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 拿到待删除节点:</span></span><br><span class="line"><span class="keyword">let</span> self = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;to-be-removed&#x27;</span>);</span><br><span class="line"><span class="comment">// 拿到父节点:</span></span><br><span class="line"><span class="keyword">let</span> parent = self.<span class="property">parentElement</span>;</span><br><span class="line"><span class="comment">// 删除:</span></span><br><span class="line"><span class="keyword">let</span> removed = parent.<span class="title function_">removeChild</span>(self);</span><br><span class="line">removed === self; <span class="comment">// true</span></span><br></pre></td></tr></table></figure><p>注意到删除后的节点虽然不在文档树中了，但其实它还在内存中，可以随时再次被添加到别的位置。</p><p>当你遍历一个父节点的子节点并进行删除操作时，要注意，<code>children</code>属性是一个只读属性，并且它在子节点变化时会实时更新。</p><p>例如，对于如下HTML结构：</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;parent&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span>&gt;</span>First<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span>&gt;</span>Second<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure><p>当我们用如下代码删除子节点时：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> parent = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;parent&#x27;</span>);</span><br><span class="line">parent.<span class="title function_">removeChild</span>(parent.<span class="property">children</span>[<span class="number">0</span>]);</span><br><span class="line">parent.<span class="title function_">removeChild</span>(parent.<span class="property">children</span>[<span class="number">1</span>]); <span class="comment">// &lt;-- 浏览器报错</span></span><br></pre></td></tr></table></figure><p>浏览器报错：<code>parent.children[1]</code>不是一个有效的节点。原因就在于，当<code>&lt;p&gt;First&lt;/p&gt;</code>节点被删除后，<code>parent.children</code>的节点数量已经从2变为了1，索引<code>[1]</code>已经不存在了。</p><p>因此，删除多个节点时，要注意<code>children</code>属性时刻都在变化。</p>]]></content>
    
    
    <summary type="html">js学习</summary>
    
    
    
    <category term="编程基础" scheme="https://stack2005.github.io/categories/%E7%BC%96%E7%A8%8B%E5%9F%BA%E7%A1%80/"/>
    
    
    <category term="js" scheme="https://stack2005.github.io/tags/js/"/>
    
    <category term="前端" scheme="https://stack2005.github.io/tags/%E5%89%8D%E7%AB%AF/"/>
    
  </entry>
  
  <entry>
    <title>pyautogui学习</title>
    <link href="https://stack2005.github.io/posts/bdb53df8.html"/>
    <id>https://stack2005.github.io/posts/bdb53df8.html</id>
    <published>2025-07-07T16:00:00.000Z</published>
    <updated>2025-07-07T16:00:00.000Z</updated>
    
    <content type="html"><![CDATA[<h2 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip3 install pyautogui</span><br></pre></td></tr></table></figure><h2 id="基础知识"><a href="#基础知识" class="headerlink" title="基础知识"></a>基础知识</h2><p>屏幕上的位置由X和Y笛卡尔坐标表示。X坐标从左侧的0开始，向右增加。与数学不同，Y坐标从顶部的0开始，向下增加。左上角的像素位于坐标(0, 0)。如果您的屏幕分辨率为 1920 x 1080，则右下角的像素将为(1919, 1079)，因为坐标从0开始，而不是1。坐标系如下所示。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">0,0       X increases --&gt;</span><br><span class="line">+---------------------------+</span><br><span class="line">|                           | Y increases</span><br><span class="line">|                           |     |</span><br><span class="line">|   1920 x 1080 screen      |     |</span><br><span class="line">|                           |     V</span><br><span class="line">|                           |</span><br><span class="line">|                           |</span><br><span class="line">+---------------------------+ 1919, 1079</span><br></pre></td></tr></table></figure><h2 id="一般函数与故障保险"><a href="#一般函数与故障保险" class="headerlink" title="一般函数与故障保险"></a>一般函数与故障保险</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pyautogui</span><br><span class="line"> </span><br><span class="line">pyautogui.PAUSE = <span class="number">1</span> <span class="comment"># 调用在执行动作后暂停的秒数，只能在执行一些pyautogui动作后才能使用，建议用time.sleep</span></span><br><span class="line">pyautogui.FAILSAFE = <span class="literal">True</span> <span class="comment"># 启用自动防故障功能，左上角的坐标为（0，0），将鼠标移到屏幕的左上角，来抛出failSafeException异常</span></span><br><span class="line"> </span><br><span class="line"><span class="comment"># 判断(x,y)是否在屏幕上</span></span><br><span class="line">x, y = <span class="number">122</span>, <span class="number">244</span></span><br><span class="line">pyautogui.onScreen(x, y) <span class="comment"># 结果为true</span></span><br><span class="line"> </span><br><span class="line">width, height = pyautogui.size() <span class="comment"># 屏幕的宽度和高度</span></span><br><span class="line"><span class="built_in">print</span>(width, height)</span><br></pre></td></tr></table></figure><h2 id="鼠标操作"><a href="#鼠标操作" class="headerlink" title="鼠标操作"></a>鼠标操作</h2><h3 id="鼠标移动"><a href="#鼠标移动" class="headerlink" title="鼠标移动"></a>鼠标移动</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 用num_seconds(秒)将鼠标移动到(x,y)位置</span></span><br><span class="line">x = <span class="number">200</span></span><br><span class="line">y = <span class="number">100</span></span><br><span class="line">num_seconds = <span class="number">1</span></span><br><span class="line">pyautogui.moveTo(x, y, duration=num_seconds)  </span><br><span class="line"></span><br><span class="line"><span class="comment"># 用num_seconds(秒)将鼠标从当前位置向右移动xOffset，向下移动yOffset</span></span><br><span class="line"><span class="comment"># 如果duration为0或未指定，则立即移动。</span></span><br><span class="line">xOffset = <span class="number">30</span></span><br><span class="line">yOffset = -<span class="number">50</span></span><br><span class="line">num_seconds = <span class="number">0.5</span></span><br><span class="line">pyautogui.moveRel(xOffset, yOffset, duration=num_seconds) </span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="鼠标拖动"><a href="#鼠标拖动" class="headerlink" title="鼠标拖动"></a>鼠标拖动</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 用num_seconds(秒)将鼠标推动到(x,y)位置</span></span><br><span class="line"><span class="comment"># 鼠标拖动是指按下鼠标左键移动鼠标。</span></span><br><span class="line">x = <span class="number">200</span></span><br><span class="line">y = <span class="number">100</span></span><br><span class="line">num_seconds= <span class="number">1</span></span><br><span class="line">pyautogui.dragTo(x, y, duration=num_seconds)  </span><br><span class="line"></span><br><span class="line"><span class="comment"># 用num_seconds(秒)将鼠标从当前位置向右拖动xOffset，向下推动yOffset</span></span><br><span class="line">xOffset = <span class="number">30</span></span><br><span class="line">yOffset = -<span class="number">50</span></span><br><span class="line">num_seconds = <span class="number">0.5</span></span><br><span class="line">pyautogui.dragRel(xOffset, yOffset, duration=num_seconds) </span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="鼠标单击"><a href="#鼠标单击" class="headerlink" title="鼠标单击"></a>鼠标单击</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 将鼠标移动到(moveToX,moveToY)位置，点击鼠标num_of_clicks次，每次点击间隔secs_between_clicks秒</span></span><br><span class="line"><span class="comment"># button表示单击方式，&#x27;left&#x27;左键单击，&#x27;middle&#x27;中键单击，&#x27;right&#x27;右键单击</span></span><br><span class="line">moveToX = <span class="number">500</span></span><br><span class="line">moveToY = <span class="number">600</span></span><br><span class="line">num_of_clicks = <span class="number">1</span></span><br><span class="line">secs_between_clicks = <span class="number">1</span></span><br><span class="line">pyautogui.click(x=moveToX, y=moveToY, clicks=num_of_clicks, interval=secs_between_clicks, button=<span class="string">&#x27;left&#x27;</span>)</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>所有的鼠标点击都可以用click()完成，但也存在一些函数是为了方便阅读，如下所示。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">moveToX = <span class="number">10</span></span><br><span class="line">moveToY = <span class="number">20</span></span><br><span class="line"><span class="comment"># 右键单击</span></span><br><span class="line">pyautogui.rightClick(x=moveToX + <span class="number">50</span>, y=moveToY)</span><br><span class="line"><span class="comment"># 中键单击</span></span><br><span class="line">pyautogui.middleClick(x=moveToX + <span class="number">50</span>, y=moveToY)</span><br><span class="line"><span class="comment"># 左键双击</span></span><br><span class="line">pyautogui.doubleClick(x=moveToX + <span class="number">50</span>, y=moveToY)</span><br><span class="line"><span class="comment"># 左键三击</span></span><br><span class="line">pyautogui.tripleClick(x=moveToX + <span class="number">50</span>, y=moveToY)</span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="鼠标滚动"><a href="#鼠标滚动" class="headerlink" title="鼠标滚动"></a>鼠标滚动</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">moveToX = <span class="number">100</span></span><br><span class="line">moveToY = <span class="number">200</span></span><br><span class="line"><span class="comment"># 鼠标在当前位置向下滑动100格</span></span><br><span class="line"><span class="comment"># pyautogui.scroll(clicks=-100)</span></span><br><span class="line"><span class="comment"># 鼠标移动到(moveToX,moveToY)位置，然后向上滚动150格</span></span><br><span class="line">pyautogui.scroll(clicks=<span class="number">150</span>, x=moveToX, y=moveToY)</span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="鼠标按下"><a href="#鼠标按下" class="headerlink" title="鼠标按下"></a>鼠标按下</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 鼠标移动到(moveToX,moveToY)位置，鼠标左键按下</span></span><br><span class="line">pyautogui.mouseDown(x=moveToX, y=moveToY, button=<span class="string">&#x27;left&#x27;</span>)</span><br><span class="line"><span class="comment"># 鼠标移动到(moveToX,moveToY)位置，鼠标右键松开（按下右键的情况下）</span></span><br><span class="line">pyautogui.mouseUp(x=moveToX, y=moveToY, button=<span class="string">&#x27;right&#x27;</span>)</span><br><span class="line"><span class="comment"># 鼠标在当前位置，按下中键</span></span><br><span class="line">pyautogui.mouseDown(button=<span class="string">&#x27;middle&#x27;</span>)</span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="缓动-渐变（Tween-Easing）函数"><a href="#缓动-渐变（Tween-Easing）函数" class="headerlink" title="缓动/渐变（Tween / Easing）函数"></a>缓动/渐变（Tween / Easing）函数</h3><p>缓动/渐变函数的作用是让光标的移动更炫。如果你不需要用到的话，你可以忽略这些。PyAutoGUI有30种缓动/渐变函数，可以通过以下函数查看</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">print</span>(pyautogui.ease*?)</span><br></pre></td></tr></table></figure><p>常用缓动/渐变函数使用示例如下：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">moveToX = <span class="number">100</span></span><br><span class="line">moveToY = <span class="number">100</span></span><br><span class="line"><span class="comment"># #开始慢，结束快</span></span><br><span class="line">pyautogui.moveTo(moveToX + <span class="number">5</span> , moveToY+ <span class="number">45</span>, <span class="number">2</span>, pyautogui.easeInQuad)  </span><br><span class="line"><span class="comment"># 开始快，结束慢   </span></span><br><span class="line">pyautogui.moveTo(moveToX + <span class="number">15</span>, moveToY+ <span class="number">35</span>, <span class="number">2</span>, pyautogui.easeOutQuad) </span><br><span class="line"><span class="comment"># 快速开始和结束，中间缓慢</span></span><br><span class="line">pyautogui.moveTo(moveToX + <span class="number">25</span>, moveToY+ <span class="number">25</span>, <span class="number">2</span>, pyautogui.easeInOutQuad)  </span><br><span class="line"><span class="comment"># 最后反弹</span></span><br><span class="line">pyautogui.moveTo(moveToX + <span class="number">35</span>, moveToY+ <span class="number">15</span>, <span class="number">2</span>, pyautogui.easeInBounce)  </span><br><span class="line"><span class="comment"># 反复横跳</span></span><br><span class="line">pyautogui.moveTo(moveToX + <span class="number">45</span>, moveToY+ <span class="number">5</span>, <span class="number">2</span>, pyautogui.easeInElastic) </span><br></pre></td></tr></table></figure><h2 id="键盘函数"><a href="#键盘函数" class="headerlink" title="键盘函数"></a>键盘函数</h2><h3 id="文字输入"><a href="#文字输入" class="headerlink" title="文字输入"></a>文字输入</h3><p>键盘控制文字输入的主要函数就是typewrite()/write()。这个函数可以实现字符输入，可以用interval参数设置两次输入间时间间隔。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 在当前位置输入文字text，每个字符输入间隔secs_between_keys秒</span></span><br><span class="line"><span class="comment"># \n表示换行</span></span><br><span class="line">text = <span class="string">&#x27;Hello world!\n&#x27;</span></span><br><span class="line">secs_between_keys = <span class="number">0.1</span></span><br><span class="line">pyautogui.typewrite(message=text, interval=secs_between_keys)  </span><br><span class="line"><span class="comment"># 在当前位置按下键盘各种键</span></span><br><span class="line">pyautogui.typewrite([<span class="string">&#x27;\t&#x27;</span>, <span class="string">&#x27;a&#x27;</span>, <span class="string">&#x27;b&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;left&#x27;</span>, <span class="string">&#x27;backspace&#x27;</span>, <span class="string">&#x27;enter&#x27;</span>, <span class="string">&#x27;f1&#x27;</span>,<span class="string">&#x27;\n&#x27;</span>], interval=secs_between_keys)</span><br><span class="line"><span class="comment"># 查看所有支持按键</span></span><br><span class="line"><span class="built_in">print</span>(pyautogui.KEYBOARD_KEYS)</span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="快捷键"><a href="#快捷键" class="headerlink" title="快捷键"></a>快捷键</h3><p>通过keyDown/keyUp按下或者松开键盘，通过hotkey执行快捷键操作。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ctrl+c 复制文字</span></span><br><span class="line">pyautogui.hotkey(<span class="string">&#x27;ctrl&#x27;</span>, <span class="string">&#x27;c&#x27;</span>)  </span><br><span class="line"><span class="comment"># ctrl+v 粘贴文字</span></span><br><span class="line">pyautogui.hotkey(<span class="string">&#x27;ctrl&#x27;</span>, <span class="string">&#x27;v&#x27;</span>) </span><br><span class="line"></span><br><span class="line"><span class="comment"># 按下ctrl键</span></span><br><span class="line">pyautogui.keyDown(<span class="string">&#x27;ctrl&#x27;</span>)</span><br><span class="line"><span class="comment"># 按下v键，相当文字粘贴</span></span><br><span class="line">pyautogui.keyDown(<span class="string">&#x27;v&#x27;</span>)</span><br><span class="line"><span class="comment"># 松开ctrl键盘</span></span><br><span class="line">pyautogui.keyUp(<span class="string">&#x27;ctrl&#x27;</span>)</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>当然可以使用press()函数设置按下某个键再释放某个键，如下所示。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#  按下shift键</span></span><br><span class="line">pyautogui.keyDown(<span class="string">&#x27;shift&#x27;</span>)</span><br><span class="line">pyautogui.press(<span class="string">&#x27;left&#x27;</span>)</span><br><span class="line">pyautogui.press(<span class="string">&#x27;left&#x27;</span>)</span><br><span class="line">pyautogui.press(<span class="string">&#x27;left&#x27;</span>)</span><br><span class="line"><span class="comment">#  松开shift键</span></span><br><span class="line">pyautogui.keyUp(<span class="string">&#x27;shift&#x27;</span>)</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>同时也可以和typewrite()函数一样，用数组把一组键传入press()，或者设置press按压次数。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 按下三个left键</span></span><br><span class="line">pyautogui.press([<span class="string">&#x27;left&#x27;</span>, <span class="string">&#x27;left&#x27;</span>, <span class="string">&#x27;left&#x27;</span>])</span><br><span class="line"><span class="comment"># 按left键五次</span></span><br><span class="line">pyautogui.press(<span class="string">&#x27;left&#x27;</span>, presses=<span class="number">5</span>)</span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="hold-上下文管理器"><a href="#hold-上下文管理器" class="headerlink" title="hold()上下文管理器"></a>hold()上下文管理器</h3><p>hold()函数可以用作上下文管理器，并从pyautogui.KEYBOARD_KEYS传递一个字符串，并且该键将在上下文块的持续时间内保持。示例如下：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 按住shift</span></span><br><span class="line"><span class="keyword">with</span> pyautogui.hold(<span class="string">&#x27;shift&#x27;</span>):</span><br><span class="line">    <span class="comment"># 连续按left,然后松开shift</span></span><br><span class="line">    pyautogui.press([<span class="string">&#x27;left&#x27;</span>, <span class="string">&#x27;left&#x27;</span>, <span class="string">&#x27;left&#x27;</span>])</span><br><span class="line"></span><br><span class="line"><span class="comment"># 上面代码功能和下面代码实现功能相同</span></span><br><span class="line"><span class="comment"># 按下shift键</span></span><br><span class="line">pyautogui.keyDown(<span class="string">&#x27;shift&#x27;</span>)</span><br><span class="line">pyautogui.press(<span class="string">&#x27;left&#x27;</span>)</span><br><span class="line">pyautogui.press(<span class="string">&#x27;left&#x27;</span>)</span><br><span class="line">pyautogui.press(<span class="string">&#x27;left&#x27;</span>)</span><br><span class="line"><span class="comment"># 松开shift键</span></span><br><span class="line">pyautogui.keyUp(<span class="string">&#x27;shift&#x27;</span>)</span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="常用按键"><a href="#常用按键" class="headerlink" title="常用按键"></a>常用按键</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 所有按键的字符串标识如下</span></span><br><span class="line"><span class="built_in">print</span>(pyautogui.KEYBOARD_KEYS)</span><br><span class="line"><span class="comment"># 输出:</span></span><br><span class="line">[</span><br><span class="line"><span class="string">&#x27;\t&#x27;</span>, <span class="string">&#x27;\n&#x27;</span>, <span class="string">&#x27;\r&#x27;</span>, <span class="string">&#x27; &#x27;</span>, <span class="string">&#x27;!&#x27;</span>, <span class="string">&#x27;&quot;&#x27;</span>, <span class="string">&#x27;#&#x27;</span>, <span class="string">&#x27;$&#x27;</span>, <span class="string">&#x27;%&#x27;</span>, <span class="string">&#x27;&amp;&#x27;</span>, <span class="string">&quot;&#x27;&quot;</span>, <span class="string">&#x27;(&#x27;</span>, <span class="string">&#x27;)&#x27;</span>, <span class="string">&#x27;*&#x27;</span>, <span class="string">&#x27;+&#x27;</span>, <span class="string">&#x27;,&#x27;</span>, <span class="string">&#x27;-&#x27;</span>, <span class="string">&#x27;.&#x27;</span>, <span class="string">&#x27;/&#x27;</span>, <span class="string">&#x27;0&#x27;</span>, <span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;2&#x27;</span>, <span class="string">&#x27;3&#x27;</span>, <span class="string">&#x27;4&#x27;</span>, <span class="string">&#x27;5&#x27;</span>, <span class="string">&#x27;6&#x27;</span>, <span class="string">&#x27;7&#x27;</span>, <span class="string">&#x27;8&#x27;</span>, <span class="string">&#x27;9&#x27;</span>, <span class="string">&#x27;:&#x27;</span>, <span class="string">&#x27;;&#x27;</span>, <span class="string">&#x27;&lt;&#x27;</span>, <span class="string">&#x27;=&#x27;</span>, <span class="string">&#x27;&gt;&#x27;</span>, <span class="string">&#x27;?&#x27;</span>, <span class="string">&#x27;@&#x27;</span>, <span class="string">&#x27;[&#x27;</span>, <span class="string">&#x27;\\&#x27;</span>, <span class="string">&#x27;]&#x27;</span>, <span class="string">&#x27;^&#x27;</span>, <span class="string">&#x27;_&#x27;</span>, <span class="string">&#x27;`&#x27;</span>, <span class="string">&#x27;a&#x27;</span>, <span class="string">&#x27;b&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;d&#x27;</span>, <span class="string">&#x27;e&#x27;</span>, <span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;g&#x27;</span>, <span class="string">&#x27;h&#x27;</span>, <span class="string">&#x27;i&#x27;</span>, <span class="string">&#x27;j&#x27;</span>, <span class="string">&#x27;k&#x27;</span>, <span class="string">&#x27;l&#x27;</span>, <span class="string">&#x27;m&#x27;</span>, </span><br><span class="line"><span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;o&#x27;</span>, <span class="string">&#x27;p&#x27;</span>, <span class="string">&#x27;q&#x27;</span>, <span class="string">&#x27;r&#x27;</span>, <span class="string">&#x27;s&#x27;</span>, <span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;v&#x27;</span>, <span class="string">&#x27;w&#x27;</span>, <span class="string">&#x27;x&#x27;</span>, <span class="string">&#x27;y&#x27;</span>, <span class="string">&#x27;z&#x27;</span>, <span class="string">&#x27;&#123;&#x27;</span>, <span class="string">&#x27;|&#x27;</span>, <span class="string">&#x27;&#125;&#x27;</span>, <span class="string">&#x27;~&#x27;</span>, <span class="string">&#x27;accept&#x27;</span>, <span class="string">&#x27;add&#x27;</span>, <span class="string">&#x27;alt&#x27;</span>, <span class="string">&#x27;altleft&#x27;</span>, <span class="string">&#x27;altright&#x27;</span>, <span class="string">&#x27;apps&#x27;</span>, </span><br><span class="line"><span class="string">&#x27;backspace&#x27;</span>, <span class="string">&#x27;browserback&#x27;</span>, <span class="string">&#x27;browserfavorites&#x27;</span>, <span class="string">&#x27;browserforward&#x27;</span>, <span class="string">&#x27;browserhome&#x27;</span>, <span class="string">&#x27;browserrefresh&#x27;</span>, <span class="string">&#x27;browsersearch&#x27;</span>, <span class="string">&#x27;browserstop&#x27;</span>, <span class="string">&#x27;capslock&#x27;</span>, <span class="string">&#x27;clear&#x27;</span>, <span class="string">&#x27;convert&#x27;</span>, <span class="string">&#x27;ctrl&#x27;</span>, <span class="string">&#x27;ctrlleft&#x27;</span>, <span class="string">&#x27;ctrlright&#x27;</span>, <span class="string">&#x27;decimal&#x27;</span>, <span class="string">&#x27;del&#x27;</span>, <span class="string">&#x27;delete&#x27;</span>, <span class="string">&#x27;divide&#x27;</span>, <span class="string">&#x27;down&#x27;</span>, <span class="string">&#x27;end&#x27;</span>, <span class="string">&#x27;enter&#x27;</span>, <span class="string">&#x27;esc&#x27;</span>, <span class="string">&#x27;escape&#x27;</span>, <span class="string">&#x27;execute&#x27;</span>, <span class="string">&#x27;f1&#x27;</span>, <span class="string">&#x27;f10&#x27;</span>, <span class="string">&#x27;f11&#x27;</span>, <span class="string">&#x27;f12&#x27;</span>, <span class="string">&#x27;f13&#x27;</span>, <span class="string">&#x27;f14&#x27;</span>, <span class="string">&#x27;f15&#x27;</span>, <span class="string">&#x27;f16&#x27;</span>, <span class="string">&#x27;f17&#x27;</span>, <span class="string">&#x27;f18&#x27;</span>, <span class="string">&#x27;f19&#x27;</span>, <span class="string">&#x27;f2&#x27;</span>, <span class="string">&#x27;f20&#x27;</span>, <span class="string">&#x27;f21&#x27;</span>, <span class="string">&#x27;f22&#x27;</span>, <span class="string">&#x27;f23&#x27;</span>, <span class="string">&#x27;f24&#x27;</span>, <span class="string">&#x27;f3&#x27;</span>, <span class="string">&#x27;f4&#x27;</span>, <span class="string">&#x27;f5&#x27;</span>, <span class="string">&#x27;f6&#x27;</span>, <span class="string">&#x27;f7&#x27;</span>, <span class="string">&#x27;f8&#x27;</span>, <span class="string">&#x27;f9&#x27;</span>, <span class="string">&#x27;final&#x27;</span>, <span class="string">&#x27;fn&#x27;</span>, <span class="string">&#x27;hanguel&#x27;</span>, <span class="string">&#x27;hangul&#x27;</span>, <span class="string">&#x27;hanja&#x27;</span>, <span class="string">&#x27;help&#x27;</span>, <span class="string">&#x27;home&#x27;</span>, <span class="string">&#x27;insert&#x27;</span>, <span class="string">&#x27;junja&#x27;</span>, <span class="string">&#x27;kana&#x27;</span>, <span class="string">&#x27;kanji&#x27;</span>, <span class="string">&#x27;launchapp1&#x27;</span>, <span class="string">&#x27;launchapp2&#x27;</span>, <span class="string">&#x27;launchmail&#x27;</span>, <span class="string">&#x27;launchmediaselect&#x27;</span>, <span class="string">&#x27;left&#x27;</span>, <span class="string">&#x27;modechange&#x27;</span>, <span class="string">&#x27;multiply&#x27;</span>, <span class="string">&#x27;nexttrack&#x27;</span>, <span class="string">&#x27;nonconvert&#x27;</span>, <span class="string">&#x27;num0&#x27;</span>, <span class="string">&#x27;num1&#x27;</span>, <span class="string">&#x27;num2&#x27;</span>, <span class="string">&#x27;num3&#x27;</span>, <span class="string">&#x27;num4&#x27;</span>, <span class="string">&#x27;num5&#x27;</span>, <span class="string">&#x27;num6&#x27;</span>, <span class="string">&#x27;num7&#x27;</span>, <span class="string">&#x27;num8&#x27;</span>, <span class="string">&#x27;num9&#x27;</span>, <span class="string">&#x27;numlock&#x27;</span>, <span class="string">&#x27;pagedown&#x27;</span>, <span class="string">&#x27;pageup&#x27;</span>, <span class="string">&#x27;pause&#x27;</span>, <span class="string">&#x27;pgdn&#x27;</span>, <span class="string">&#x27;pgup&#x27;</span>, <span class="string">&#x27;playpause&#x27;</span>, <span class="string">&#x27;prevtrack&#x27;</span>, <span class="string">&#x27;print&#x27;</span>, <span class="string">&#x27;printscreen&#x27;</span>, <span class="string">&#x27;prntscrn&#x27;</span>, <span class="string">&#x27;prtsc&#x27;</span>, <span class="string">&#x27;prtscr&#x27;</span>, <span class="string">&#x27;return&#x27;</span>, <span class="string">&#x27;right&#x27;</span>, <span class="string">&#x27;scrolllock&#x27;</span>, <span class="string">&#x27;select&#x27;</span>, <span class="string">&#x27;separator&#x27;</span>, <span class="string">&#x27;shift&#x27;</span>, <span class="string">&#x27;shiftleft&#x27;</span>, <span class="string">&#x27;shiftright&#x27;</span>, <span class="string">&#x27;sleep&#x27;</span>, <span class="string">&#x27;space&#x27;</span>, <span class="string">&#x27;stop&#x27;</span>, <span class="string">&#x27;subtract&#x27;</span>, <span class="string">&#x27;tab&#x27;</span>, <span class="string">&#x27;up&#x27;</span>, <span class="string">&#x27;volumedown&#x27;</span>, <span class="string">&#x27;volumemute&#x27;</span>, <span class="string">&#x27;volumeup&#x27;</span>, <span class="string">&#x27;win&#x27;</span>, <span class="string">&#x27;winleft&#x27;</span>, <span class="string">&#x27;winright&#x27;</span>, <span class="string">&#x27;yen&#x27;</span>, <span class="string">&#x27;command&#x27;</span>, <span class="string">&#x27;option&#x27;</span>, <span class="string">&#x27;optionleft&#x27;</span>, <span class="string">&#x27;optionright&#x27;</span></span><br><span class="line">]</span><br><span class="line">+ <span class="string">&#x27;Add&#x27;</span> - 加号键（<span class="string">&quot;+&quot;</span>）通常用于添加或增加操作。</span><br><span class="line">+ <span class="string">&#x27;Alt&#x27;</span> - 通常与键盘上的 <span class="string">&quot;Alt&quot;</span> 键相对应，它是一种常用的快捷键，可以用于访问特殊功能或菜单。</span><br><span class="line">+ <span class="string">&#x27;Altleft&#x27;</span> - 这个单词通常与键盘上的 <span class="string">&quot;Alt&quot;</span> 键左边的部分相对应，也是用于访问特殊功能或菜单。</span><br><span class="line">+ <span class="string">&#x27;Altright&#x27;</span> - 这个单词通常与键盘上的 <span class="string">&quot;Alt&quot;</span> 键右边的部分相对应，也是用于访问特殊功能或菜单。</span><br><span class="line">+ <span class="string">&#x27;Apps&#x27;</span> - 右键菜单</span><br><span class="line">+ <span class="string">&#x27;Backspace&#x27;</span> - 这个单词通常与键盘上的 <span class="string">&quot;Backspace&quot;</span> 键相对应，用于删除前一个字符或命令。</span><br><span class="line">+ <span class="string">&#x27;Browserback&#x27;</span> - 这个单词通常与浏览器相关的快捷键相对应，用于返回浏览器的上一个页面。</span><br><span class="line">+ <span class="string">&#x27;Browserfavorites&#x27;</span> - 这个单词通常与浏览器相关的快捷键相对应，用于访问浏览器的收藏夹。</span><br><span class="line">+ <span class="string">&#x27;Browserforward&#x27;</span> - 这个单词通常与浏览器相关的快捷键相对应，用于前进到浏览器的一个页面。</span><br><span class="line">+ <span class="string">&#x27;Browserhome&#x27;</span> - 这个单词通常与浏览器相关的快捷键相对应，用于导航到浏览器的首页。</span><br><span class="line">+ <span class="string">&#x27;Browserrefresh&#x27;</span> - 这个单词通常与浏览器相关的快捷键相对应，用于刷新当前页面。</span><br><span class="line">+ <span class="string">&#x27;Browsersearch&#x27;</span> - 这个单词通常与浏览器相关的快捷键相对应，用于在浏览器中执行搜索操作。</span><br><span class="line">+ <span class="string">&#x27;Browserstop&#x27;</span> - 这个单词通常与浏览器相关的快捷键相对应，用于停止加载当前页面。</span><br><span class="line">+ <span class="string">&#x27;Capslock&#x27;</span> - 这个单词通常与键盘上的 <span class="string">&quot;Capslock&quot;</span> 键相对应，用于锁定或解锁大写字母输入。</span><br><span class="line">+ <span class="string">&#x27;Ctrl&#x27;</span> - 这个单词通常与键盘上的 <span class="string">&quot;Ctrl&quot;</span> 键相对应，用于执行各种控制命令或组合键操作。</span><br><span class="line">+ <span class="string">&#x27;Ctrlleft&#x27;</span> - 这个单词通常与键盘上的 <span class="string">&quot;Ctrl&quot;</span> 键左边的部分相对应，也是用于执行各种控制命令或组合键操作。</span><br><span class="line">+ <span class="string">&#x27;Ctrlright&#x27;</span> - 这个单词通常与键盘上的 <span class="string">&quot;Ctrl&quot;</span> 键右边的部分相对应，也是用于执行各种控制命令或组合键操作。</span><br><span class="line">+ <span class="string">&#x27;Decimal&#x27;</span> - 这个单词通常与键盘上的 <span class="string">&quot;Decimal&quot;</span> 或 <span class="string">&quot;.&quot;</span> 键相对应，用于输入小数点或十进制数字。</span><br><span class="line">+ <span class="string">&#x27;fn&#x27;</span> - <span class="string">&quot;fn&quot;</span> 是一个特殊的键盘功能键，通常在笔记本电脑和一些特定的键盘布局中找到。它用于配合其他按键使用，以实现一些特定的功能，如调节亮度、音量等。</span><br><span class="line">+ <span class="string">&#x27;home&#x27;</span> - <span class="string">&quot;home&quot;</span> 对应的按键是键盘上的 <span class="string">&quot;Home&quot;</span> 键，通常用于快速导航到页面的顶部或文本的开头。</span><br><span class="line">+ <span class="string">&#x27;insert&#x27;</span> - <span class="string">&quot;insert&quot;</span> 对应的按键是键盘上的 <span class="string">&quot;Insert&quot;</span> 键，用于插入文本或数据。</span><br><span class="line">+ <span class="string">&#x27;left&#x27;</span>, <span class="string">&#x27;right&#x27;</span>, <span class="string">&#x27;up&#x27;</span>, <span class="string">&#x27;down&#x27;</span> - 这些方向键对应的按键分别是 <span class="string">&quot;Left Arrow&quot;</span>、<span class="string">&quot;Right Arrow&quot;</span>、<span class="string">&quot;Up Arrow&quot;</span> 和 <span class="string">&quot;Down Arrow&quot;</span>。它们通常用于控制光标的位置。</span><br><span class="line">+ <span class="string">&#x27;num0&#x27;</span> 到 <span class="string">&#x27;num9&#x27;</span> - 这些数字键对应的按键是从 <span class="string">&quot;0&quot;</span> 到 <span class="string">&quot;9&quot;</span>。它们用于输入数字和进行数学运算。</span><br><span class="line">+ <span class="string">&#x27;numlock&#x27;</span>, <span class="string">&#x27;scrolllock&#x27;</span>, <span class="string">&#x27;select&#x27;</span>, <span class="string">&#x27;separator&#x27;</span>, <span class="string">&#x27;tab&#x27;</span> - 这些都是特殊的锁定键或其他功能键，通常用于控制光标移动、滚动页面、选择文本等操作。</span><br><span class="line">+ <span class="string">&#x27;space&#x27;</span>, <span class="string">&#x27;return&#x27;</span> - <span class="string">&quot;Space&quot;</span> 键对应的按键是空格键，用于在文本中插入空格。<span class="string">&quot;Return&quot;</span> 键对应的按键是回车键，用于换行或确认输入。</span><br><span class="line">+ <span class="string">&#x27;win&#x27;</span>, <span class="string">&#x27;winleft&#x27;</span>, <span class="string">&#x27;winright&#x27;</span> - 这些是特定的功能键，通常用于操作系统中的窗口控制和菜单操作。<span class="string">&quot;Win&quot;</span> 键对应的按键通常是 Windows 徽标键（通常是带有 Windows 标志的按键）。<span class="string">&quot;Winleft&quot;</span> 和 <span class="string">&quot;Winright&quot;</span> 是左右 Windows 功能键的称呼，但它们并不对应键盘上的标准按键</span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="消息框函数"><a href="#消息框函数" class="headerlink" title="消息框函数"></a>消息框函数</h2><p>如果你需要暂停程序直到用户点击确定，或者想向用户显示一些信息，可以使用消息框函数。这里消息框函数的使用方式和javascript一样</p><h3 id="可以设置一个button"><a href="#可以设置一个button" class="headerlink" title="可以设置一个button"></a>可以设置一个button</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#消息框</span></span><br><span class="line"><span class="comment">#title:标题</span></span><br><span class="line"><span class="comment">#text:文本</span></span><br><span class="line"><span class="comment"># button:按钮，默认是OK</span></span><br><span class="line"><span class="comment">#返回值：默认是OK</span></span><br><span class="line">arr1 = pg.alert(title=<span class="string">&#x27;Hello, World!&#x27;</span>,text=<span class="string">&#x27;没钱只能当牛马&#x27;</span>,button=<span class="string">&#x27;ok&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(arr1)</span><br></pre></td></tr></table></figure><h3 id="可以设置多个button"><a href="#可以设置多个button" class="headerlink" title="可以设置多个button"></a>可以设置多个button</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#可以设置多个button</span></span><br><span class="line"><span class="comment">#返回值：返回用户点击的按钮</span></span><br><span class="line">arr2 = pg.confirm(title=<span class="string">&#x27;Hello, World!&#x27;</span>,text=<span class="string">&#x27;没钱只能当牛马&#x27;</span>,buttons=[<span class="string">&#x27;ok&#x27;</span>,<span class="string">&#x27;cancel&#x27;</span>])</span><br><span class="line"><span class="built_in">print</span>(arr2)</span><br></pre></td></tr></table></figure><h3 id="自带文本输入框的消息框"><a href="#自带文本输入框的消息框" class="headerlink" title="自带文本输入框的消息框"></a>自带文本输入框的消息框</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#自带文本输入框的消息框</span></span><br><span class="line"><span class="comment">#返回值：返回用户输入的内容</span></span><br><span class="line"><span class="comment">#文本输入框没字返回：None</span></span><br><span class="line">arr3=pg.prompt(title=<span class="string">&#x27;Hello, World!&#x27;</span>,text=<span class="string">&#x27;没钱只能当牛马&#x27;</span>,default=<span class="string">&#x27;请您输入：&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;您输入的内容是：&quot;</span>+arr3)</span><br></pre></td></tr></table></figure><h3 id="自带密码的文本输入框的消息框"><a href="#自带密码的文本输入框的消息框" class="headerlink" title="自带密码的文本输入框的消息框"></a>自带密码的文本输入框的消息框</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#自带密码的文本输入框的消息框</span></span><br><span class="line"><span class="comment">#返回值：返回用户输入的密码</span></span><br><span class="line"><span class="comment">#密码没字返回：None</span></span><br><span class="line">arr4=pg.password(title=<span class="string">&#x27;Hello, World!&#x27;</span>,text=<span class="string">&#x27;没钱只能当牛马&#x27;</span>,default=<span class="string">&#x27;请您输入：&#x27;</span>,mask=<span class="string">&#x27;*&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;您输入的密码是：&quot;</span>+arr4)</span><br></pre></td></tr></table></figure><h2 id="图像操作"><a href="#图像操作" class="headerlink" title="图像操作"></a>图像操作</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pyautogui</span><br><span class="line"> </span><br><span class="line">pyautogui.screenshot(<span class="string">r&#x27;C:\Users\ZDH\Desktop\PY\my_screenshot.png&#x27;</span>) <span class="comment"># 截全屏并设置保存图片的位置和名称</span></span><br><span class="line">im = pyautogui.screenshot(<span class="string">r&#x27;C:\Users\ZDH\Desktop\PY\my_screenshot.png&#x27;</span>) <span class="comment"># 截全屏并设置保存图片的位置和名称</span></span><br><span class="line"><span class="built_in">print</span>(im) <span class="comment"># 打印图片的属性</span></span><br><span class="line"> </span><br><span class="line"><span class="comment"># 不截全屏，截取区域图片。截取区域region参数为：左上角XY坐标值、宽度和高度</span></span><br><span class="line">pyautogui.screenshot(<span class="string">r&#x27;C:\Users\ZDH\Desktop\PY\region_screenshot.png&#x27;</span>, region=(<span class="number">0</span>, <span class="number">0</span>, <span class="number">300</span>, <span class="number">400</span>))</span><br><span class="line"> </span><br><span class="line">pix = pyautogui.screenshot().getpixel((<span class="number">220</span>, <span class="number">200</span>)) <span class="comment"># 获取坐标(220,200)所在屏幕点的RGB颜色</span></span><br><span class="line">positionStr = <span class="string">&#x27; RGB:(&#x27;</span> + <span class="built_in">str</span>(pix[<span class="number">0</span>]).rjust(<span class="number">3</span>) + <span class="string">&#x27;,&#x27;</span> + <span class="built_in">str</span>(pix[<span class="number">1</span>]).rjust(<span class="number">3</span>) + <span class="string">&#x27;,&#x27;</span> + <span class="built_in">str</span>(pix[<span class="number">2</span>]).rjust(<span class="number">3</span>) + <span class="string">&#x27;)&#x27;</span></span><br><span class="line"><span class="built_in">print</span>(positionStr) <span class="comment"># 打印结果为RGB:( 60, 63, 65)</span></span><br><span class="line">pix = pyautogui.pixel(<span class="number">220</span>, <span class="number">200</span>) <span class="comment"># 获取坐标(220,200)所在屏幕点的RGB颜色与上面三行代码作用一样</span></span><br><span class="line">positionStr = <span class="string">&#x27; RGB:(&#x27;</span> + <span class="built_in">str</span>(pix[<span class="number">0</span>]).rjust(<span class="number">3</span>) + <span class="string">&#x27;,&#x27;</span> + <span class="built_in">str</span>(pix[<span class="number">1</span>]).rjust(<span class="number">3</span>) + <span class="string">&#x27;,&#x27;</span> + <span class="built_in">str</span>(pix[<span class="number">2</span>]).rjust(<span class="number">3</span>) + <span class="string">&#x27;)&#x27;</span></span><br><span class="line"><span class="built_in">print</span>(positionStr) <span class="comment"># 打印结果为RGB:( 60, 63, 65)</span></span><br><span class="line"> </span><br><span class="line"><span class="comment"># 如果你只是要检验一下指定位置的像素值，可以用pixelMatchesColor(x,y,RGB)函数，把X、Y和RGB元组值穿入即可</span></span><br><span class="line"><span class="comment"># 如果所在屏幕中(x,y)点的实际RGB三色与函数中的RGB一样就会返回True，否则返回False</span></span><br><span class="line"><span class="comment"># tolerance参数可以指定红、绿、蓝3种颜色误差范围</span></span><br><span class="line">pyautogui.pixelMatchesColor(<span class="number">100</span>, <span class="number">200</span>, (<span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>))</span><br><span class="line">pyautogui.pixelMatchesColor(<span class="number">100</span>, <span class="number">200</span>, (<span class="number">255</span>, <span class="number">255</span>, <span class="number">245</span>), tolerance=<span class="number">10</span>)</span><br><span class="line"> </span><br><span class="line"><span class="comment"># 获得文件图片在现在的屏幕上面的坐标，返回的是一个元组(top, left, width, height)</span></span><br><span class="line"><span class="comment"># 如果截图没找到，pyautogui.locateOnScreen()函数返回None</span></span><br><span class="line">a = pyautogui.locateOnScreen(<span class="string">r&#x27;C:\Users\ZDH\Desktop\PY\region_screenshot.png&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(a) <span class="comment"># 打印结果为Box(left=0, top=0, width=300, height=400)</span></span><br><span class="line">x, y = pyautogui.center(a) <span class="comment"># 获得文件图片在现在的屏幕上面的中心坐标</span></span><br><span class="line"><span class="built_in">print</span>(x, y) <span class="comment"># 打印结果为150 200</span></span><br><span class="line">x, y = pyautogui.locateCenterOnScreen(<span class="string">r&#x27;C:\Users\ZDH\Desktop\PY\region_screenshot.png&#x27;</span>) <span class="comment"># 这步与上面的四行代码作用一样</span></span><br><span class="line"><span class="built_in">print</span>(x, y) <span class="comment"># 打印结果为150 200</span></span><br><span class="line"> </span><br><span class="line"><span class="comment"># 匹配屏幕所有与目标图片的对象，可以用for循环和list()输出</span></span><br><span class="line">pyautogui.locateAllOnScreen(<span class="string">r&#x27;C:\Users\ZDH\Desktop\PY\region_screenshot.png&#x27;</span>)</span><br><span class="line"><span class="keyword">for</span> pos <span class="keyword">in</span> pyautogui.locateAllOnScreen(<span class="string">r&#x27;C:\Users\ZDH\Desktop\PY\region_screenshot.png&#x27;</span>):</span><br><span class="line">  <span class="built_in">print</span>(pos)</span><br><span class="line"><span class="comment"># 打印结果为Box(left=0, top=0, width=300, height=400)</span></span><br><span class="line">a = <span class="built_in">list</span>(pyautogui.locateAllOnScreen(<span class="string">r&#x27;C:\Users\ZDH\Desktop\PY\region_screenshot.png&#x27;</span>))</span><br><span class="line"><span class="built_in">print</span>(a) <span class="comment"># 打印结果为[Box(left=0, top=0, width=300, height=400)]</span></span><br></pre></td></tr></table></figure><h2 id="官方教程"><a href="#官方教程" class="headerlink" title="官方教程"></a>官方教程</h2><div calss='anzhiyu-tag-link'><a class="tag-Link" target="_blank" href="https://pyautogui.readthedocs.io/en/latest/quickstart.html">    <div class="tag-link-tips">引用站外地址</div>    <div class="tag-link-bottom">        <div class="tag-link-left" style="background-image: url(https://bu.dusays.com/2025/03/03/67c59b2d8ca62.png);"></div>        <div class="tag-link-right">            <div class="tag-link-title">官方教程</div>            <div class="tag-link-sitename">PyAutoGui</div>        </div>        <i class="fa-solid fa-angle-right"></i>    </div>    </a></div>]]></content>
    
    
    <summary type="html">学习pyautogui</summary>
    
    
    
    <category term="编程基础" scheme="https://stack2005.github.io/categories/%E7%BC%96%E7%A8%8B%E5%9F%BA%E7%A1%80/"/>
    
    
    <category term="python" scheme="https://stack2005.github.io/tags/python/"/>
    
  </entry>
  
  <entry>
    <title>pygame学习</title>
    <link href="https://stack2005.github.io/posts/5c903a76.html"/>
    <id>https://stack2005.github.io/posts/5c903a76.html</id>
    <published>2025-04-17T16:00:00.000Z</published>
    <updated>2025-04-17T16:00:00.000Z</updated>
    
    <content type="html"><![CDATA[<h2 id="pygame-安装"><a href="#pygame-安装" class="headerlink" title="pygame 安装"></a>pygame 安装</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip install pygame</span><br></pre></td></tr></table></figure><h2 id="第一个pygame"><a href="#第一个pygame" class="headerlink" title="第一个pygame"></a>第一个pygame</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#导入所需的模块</span></span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="keyword">import</span> pygame</span><br><span class="line"></span><br><span class="line"><span class="comment"># 使用pygame之前必须初始化</span></span><br><span class="line">pygame.init()</span><br><span class="line"></span><br><span class="line"><span class="comment"># 设置主屏窗口</span></span><br><span class="line">screen = pygame.display.set_mode((<span class="number">400</span>,<span class="number">400</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment"># 设置窗口的标题，即游戏名称</span></span><br><span class="line">pygame.display.set_caption(<span class="string">&#x27;hello world&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 引入字体类型</span></span><br><span class="line">f = pygame.font.Font(<span class="string">&#x27;C:/Windows/Fonts/simhei.ttf&#x27;</span>,<span class="number">50</span>)</span><br><span class="line"><span class="comment"># 生成文本信息，第一个参数文本内容；第二个参数，字体是否平滑；</span></span><br><span class="line"><span class="comment"># 第三个参数，RGB模式的字体颜色；第四个参数，RGB模式字体背景颜色；</span></span><br><span class="line">text = f.render(<span class="string">&quot;老公是1我是0&quot;</span>,<span class="literal">True</span>,(<span class="number">255</span>,<span class="number">0</span>,<span class="number">0</span>),(<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>))</span><br><span class="line"><span class="comment">#获得显示对象的rect区域坐标</span></span><br><span class="line">textRect =text.get_rect()</span><br><span class="line"><span class="comment"># 设置显示对象居中</span></span><br><span class="line">textRect.center = (<span class="number">200</span>,<span class="number">200</span>)</span><br><span class="line"><span class="comment"># 将准备好的文本信息，绘制到主屏幕 Screen 上。</span></span><br><span class="line">screen.blit(text,textRect)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 固定代码段，实现点击&quot;X&quot;号退出界面的功能，几乎所有的pygame都会使用该段代码</span></span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    <span class="comment"># 循环获取事件，监听事件状态</span></span><br><span class="line">    <span class="keyword">for</span> event <span class="keyword">in</span> pygame.event.get():</span><br><span class="line">        <span class="comment"># 判断用户是否点了&quot;X&quot;关闭按钮,并执行if代码段</span></span><br><span class="line">        <span class="keyword">if</span> event.<span class="built_in">type</span> == pygame.QUIT:</span><br><span class="line">            <span class="comment">#卸载所有模块</span></span><br><span class="line">            pygame.quit()</span><br><span class="line">            <span class="comment">#终止程序，确保退出程序</span></span><br><span class="line">            sys.exit()</span><br><span class="line">    pygame.display.flip() <span class="comment">#更新屏幕内容</span></span><br></pre></td></tr></table></figure><h3 id="初始化程序"><a href="#初始化程序" class="headerlink" title="初始化程序"></a>初始化程序</h3><p>在使用 Pygame 编写程序前，要做的第一个步骤是“初始化程序”，代码如下所示：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pygame.init()</span><br></pre></td></tr></table></figure><p>这是整个程序中的第一句代码，它的作用是自动检测 Pygame 软件包是否正常可用，并检查电脑的硬件调用接口、基础功能是否存在问题，比如音频、光驱、声卡驱动等设备。同时，它会完成 Pygame 中所有模块的初始化操作，比如 display（显示模块）、font（字体模块）、mixer（声音控制模块）、cursors（光标控制模块）等。</p><h3 id="创建Surface对象"><a href="#创建Surface对象" class="headerlink" title="创建Surface对象"></a>创建Surface对象</h3><p>想要掌握 Pygame 的编程逻辑，首先就要理解 surface 对象的概念，它是 Pygame 中最重要的组成部分。</p><p>Surface 翻译为表面、表层、外观，在 Pygame 中，您可以把 surface 对象理解成一张“白纸”，通过这张纸可以做许多的事情，比如在纸上添加文字、填充颜色、添加图片以及绘制任意形状的图形等。既然是“纸”就有规格尺寸，Pygame 允许您创建任意大小的纸。</p><p>那么我们应该如何创建 Surface 对象呢？Pygame 提供了多种创建 Surface 对象的方法，这里先介绍以下几种方法。</p><p>上述示例，使用如下方式创建了一个 surface 对象：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#也叫screen对象，本质上是一个Surface，大小400*400</span></span><br><span class="line">screen = pygame.display.set_mode((<span class="number">400</span>,<span class="number">400</span>))</span><br></pre></td></tr></table></figure><p>screen 的本质上就是一个 Surface 对象，它是游戏的主窗口，也就是整个游戏中尺寸最大的“纸”，任何其他的 Surface 对象都需要附着在这张最大的“纸”上，比如创建一个包含文本的 Surface 对象，通过以下方法将它绘制在主屏幕上：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#创建一个包含文字的Surface对象</span></span><br><span class="line">text = f.render(<span class="string">&quot;老公是1我是0&quot;</span>,<span class="literal">True</span>,(<span class="number">255</span>,<span class="number">0</span>,<span class="number">0</span>),(<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>))</span><br><span class="line"><span class="comment">#通过blit方法将其绘制在主屏幕上，这里的textRect表示位置坐标</span></span><br><span class="line">screen.blit(text,textRect)</span><br></pre></td></tr></table></figure><p>如果想创建一个包含图像的 surface 对象可以使用如下方法：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">surface_image =pygame.image.load(<span class="string">&quot;图片路径&quot;</span>) </span><br></pre></td></tr></table></figure><h3 id="事件监听"><a href="#事件监听" class="headerlink" title="事件监听"></a>事件监听</h3><p>游戏，在我们日常生活中经常接触到，无论是手游、还是电脑端游戏，已经成了信息社会中，不可或缺的一部分。</p><p>游戏大致来讲是由动画和人机交互的体验两部分构成，其中动画则是由一系列连续静止的图片，经过一定频率的刷新构成的，这个频率被称为 FPS，如果频率值越大则画面越流畅；如果频率值越小则画面会出现卡顿的感，在游戏过程中一般人能接受的最低 FPS 约为 30Hz，如果想要画面流畅则 FPS 要大于 60 Hz。</p><p>动画保证了玩家的视觉体验，而人机交互则是操作上的体验。通过移动和点击鼠标、按下键盘上的技能键，或是滑动手机屏幕等操作来实现人机交互，这些与游戏程序交互的操作被称为事件（Event）。</p><p>Pygame 作为一个游戏开发库，同样具有设置和监听事件的功能。它提供了一个 enevt 事件模块，这个模块中包含了所有常用到游戏事件。下面是退出游戏的代码示例（其他事件类型，后续会做介绍）：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 循环获取事件，监听事件状态，使用get()获取事件</span></span><br><span class="line"><span class="keyword">for</span> event <span class="keyword">in</span> pygame.event.get():</span><br><span class="line">    <span class="comment"># 判断事件类型，用户是否点了&quot;X&quot;关闭按钮</span></span><br><span class="line">    <span class="comment"># pygame.QUIT 指点击右上角窗口的&quot;X&quot;号</span></span><br><span class="line">    <span class="keyword">if</span> event.<span class="built_in">type</span> == pygame.QUIT:</span><br><span class="line">        <span class="comment">#点击后，卸载所有pygame模块</span></span><br><span class="line">        pygame.quit()</span><br></pre></td></tr></table></figure><h3 id="游戏循环"><a href="#游戏循环" class="headerlink" title="游戏循环"></a>游戏循环</h3><p>当打我们游戏时可能会触发游戏中的各种事件，比如鼠标事件、键盘按键事件、摄像拍照事件等等，因此游戏程序需要一直循环监听玩家的操作，只有当用户点击了游戏“关闭”按钮时，监听才会结束。如果想要达到“循环监听”目的，此时就需要设置一个游戏循环（Game Loop）也称为游戏的主循环，这样才能保证人机交互的体验感。代码示例如下：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#游戏主循环(游戏循环)</span></span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    <span class="comment"># 循环获取事件，监听事件</span></span><br><span class="line">    <span class="keyword">for</span> event <span class="keyword">in</span> pygame.event.get():</span><br><span class="line">        <span class="comment"># 判断用户是否点了关闭按钮</span></span><br><span class="line">        <span class="keyword">if</span> event.<span class="built_in">type</span> == pygame.QUIT:</span><br><span class="line">            <span class="comment"># 当用户关闭游戏窗口时执行以下操作</span></span><br><span class="line">            <span class="comment"># 这里必须调用quit()方法，退出游戏</span></span><br><span class="line">            pygame.quit()</span><br><span class="line">            <span class="comment">#终止系统</span></span><br><span class="line">            sys.exit()</span><br><span class="line">    <span class="comment">#更新并绘制屏幕内容</span></span><br><span class="line">    pygame.display.flip() </span><br></pre></td></tr></table></figure><p>游戏主循环是每个 Pygame 游戏程序中必不可少的一部分，它主要承担着以下三个重要任务：</p><ul><li>处理游戏事件</li><li>更新游戏状态</li><li>把更新后的游戏状态绘制到屏幕上</li></ul><p><img src="https://c.biancheng.net/uploads/allimg/211109/105U22616-1.gif" alt="pygame程序"></p><p>游戏画面和游戏操作状态会因为动画效果和玩家的操作而改变，因此需要以循环的方式实时地更新主屏幕（screen）的显示内容。把下列代码放入游戏主循环中即可实现实时更新和绘制屏幕内容，如下所示：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#刷新界面显示</span></span><br><span class="line">pygame.display.flip() </span><br></pre></td></tr></table></figure><p>除了上述方法外，Pygame 还提供了另一个方法。如下所示：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pygame.display.update() </span><br></pre></td></tr></table></figure><p>这两个方法的主要区别是：<strong>后者可以根据选定的区域来更新部分内容，而前者则是更新整个待显示的内容。</strong>如果后者没有提供区域位置参数时，其作用和 display.flip() 相同。</p><h2 id="Display显示模块"><a href="#Display显示模块" class="headerlink" title="Display显示模块"></a>Display显示模块</h2><p>Pygame 使用<code>pygame.display</code>显示模块中的方法创建游戏的主窗口：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pygame.display.set_mode(size, flags, depth, display, vsync)</span><br></pre></td></tr></table></figure><p>上述函数有两个参数常用参数：</p><ul><li>size：元组参数，用来设置主窗口的大小</li><li>flags：功能标志位，表示创建的主窗口样式，比如创建全屏窗口、无边框窗口等，flags 参数值见下表。</li></ul><div class="table-container"><table><thead><tr><th>标志位</th><th>功能</th></tr></thead><tbody><tr><td>pygame.FULLSCREEN</td><td>创建一个全屏窗口。</td></tr><tr><td>pygame.HWSURFACE</td><td>创建一个硬件加速窗口，必须和 FULLSCREEN 同时使用。</td></tr><tr><td>pygame.OPENGL</td><td>创建一个 OPENGL 渲染窗口。</td></tr><tr><td>pygame.RESIZABLE</td><td>创建一个可以改变大小的窗口。</td></tr><tr><td>pygame.DOUBLEBUF</td><td>创建一个双缓冲区窗口，建议在 HWSURFACE 或者 OPENGL 时使用。</td></tr><tr><td>pygame.NOFRAME</td><td>创建一个没有边框的窗口。</td></tr><tr><td>pygame.SCALED</td><td>分辨率取决于桌面尺寸和图形比例</td></tr><tr><td>pygame.SHOWN</td><td>窗口以可见模式打开（默认）</td></tr><tr><td>pygame.HIDDEN</td><td>窗口是以隐藏模式打开的</td></tr></tbody></table></div><p>如果vsync参数设置为1，有可能得到一个垂直同步的显示，但不保证能得到一个。该请求只对设置了 pygame.OPENGL 或 pygame.SCALED 标志的 set_mode() 的调用完全有效。</p><p>显示指数0意味着使用默认显示。深度参数将默认为系统的最佳和最快的颜色深度。对于给定的宽度和高度，Pygame 将从 list_modes() 中选择最佳模式。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="built_in">print</span> (pygame.display.list_modes())</span><br><span class="line">[(<span class="number">1366</span>, <span class="number">768</span>), (<span class="number">1360</span>, <span class="number">768</span>), (<span class="number">1280</span>, <span class="number">768</span>), (<span class="number">1280</span>, <span class="number">720</span>), (<span class="number">1024</span>, <span class="number">768</span>), (<span class="number">800</span>, <span class="number">600</span>), (<span class="number">640</span>, <span class="number">480</span>)]</span><br></pre></td></tr></table></figure><p><strong>pygame.display.mode_ok(</strong> )</p><p>这个函数为一个显示模式挑选最佳颜色深度。它用于确定请求的显示模式是否可用。如果不能设置显示模式，它将返回0。否则，它将返回一个最符合所要求的显示模式的像素深度。</p><p><strong>pygame.display.update(</strong> )</p><p>这个函数将更新整个显示屏的内容。</p><table>    <tbody>        <tr>            <th>                方法名称</th>            <th>                说明</th>        </tr>        <tr>            <td>                pygame.display.get_surface()</td>            <td>                获取当前显示的 Surface 对象。</td>        </tr>        <tr>            <td>                pygame.display.flip()</td>            <td>                更新整个待显示的 Surface 对象到屏幕上。</td>        </tr>        <tr>            <td>                pygame.display.update()</td>            <td>                更新部分软件界面显示。</td>        </tr>        <tr>            <td>                pygame.display.Info()</td>            <td>                产生一个 VideoInfo 对象，包含了显示界面的相关信息。</td>        </tr>        <tr>            <td>                pygame.display.set_icon()</td>            <td>                设置左上角的游戏图标，图标尺寸大小为 32*32。</td>        </tr>        <tr>            <td>                pygame.display.iconify()</td>            <td>                将显示的主窗口即 Surface 对象最小化，或者隐藏。</td>        </tr>        <tr>            <td>                pygame.display.get_active()</td>            <td>                当前显示界面显示在屏幕上时返回 True，如果窗口被隐藏和最小化则返回 False。</td>        </tr>        <tr>            <td>                pygame.display.set_caption()</td>            <td>                设置窗口标题</td>        </tr>    </tbody></table><p>当运行程序后会在电脑桌面上出现一个游戏的主窗口，这个主窗口的本质是一个 surface 对象，把理解为画布、画板、白纸在合适不过了，它相当于一个载体，用于承载一切游戏所用到的元素。假如需要将一段文本方放置到主窗口中，那么需要先创建一个包含文本的 surface 对象，之后再将它附加到主窗口上。简单的理解，就是将一张图 A 粘贴到另一张图 B 上。</p><p>主窗口（screen）相当于游戏程序中尺寸最大的 Surface 对象，在这个最大的“画布”中，我们还可以添加其他“小”的 Surface 对象，这些对象以矩形的形式存在于主窗口中，它们共同组成了一个游戏程序。通过下列方法可以将一个 Surface 对象粘贴至主窗口上：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">scrren.blit(source, dest, area=<span class="literal">None</span>, special_flags = <span class="number">0</span>)</span><br></pre></td></tr></table></figure><div class="note info simple"><ul><li>source：表示要粘贴的 Surface 对象。</li><li>dest：主窗口中的一个标识的坐标位置，可以接受一个 (x,y) 元组，或者 (x,y,width,height) 元组，也可以是一个 Rect 对象；</li><li>area：接受一个 Rect 对象，默认为 None，如果提供该参数则相当于抠图操作，即在屏幕的指定区域显示想要的内容；</li><li>special_flags：可选参数，它是 Pygame.1.8 版本新增的功能，用于指定对应位置颜色的混合方式，参数值有 BLEND_RGBA_ADD、BLEND_SUB 等。如果不提供该参数的情况下，默认使用 source 的颜色覆盖 screen 的颜色。</li></ul></div><h2 id="Pygame-Surface创建图像"><a href="#Pygame-Surface创建图像" class="headerlink" title="Pygame Surface创建图像"></a>Pygame Surface创建图像</h2><p>Pygame 针对文本、图像、颜色提供了不同模块来生成它们各自的 Surface 对象。Surface 模块是Pygame 中专门用来新建图像的，通过该模块可以创建一个 Surface 对象，语法格式如下：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Surface=pygame.Surface(size=(width,height),flags,depth)</span><br></pre></td></tr></table></figure><p>参数函数如下：</p><ul><li>size：表示 Surface 对象的矩形区域大小；</li><li>flags：功能标志位，有两个可选参数值 HWSURFACE 和 SPCALPHA，前者代表将创建的 Surface 对象存放于显存中，后者表示让图像的每一个像素都包含一个 alpha 通道</li><li>depth：指定像素的颜色深度，默认为自适应模式，由 Pygame 自动调节。</li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="keyword">import</span> pygame</span><br><span class="line"><span class="comment">#使用pygame之前必须初始化</span></span><br><span class="line">pygame.init()</span><br><span class="line"><span class="comment">#设置主屏窗口 ；设置全屏格式：flags=pygame.FULLSCREEN</span></span><br><span class="line">screen = pygame.display.set_mode((<span class="number">400</span>,<span class="number">400</span>))</span><br><span class="line"><span class="comment">#设置窗口标题</span></span><br><span class="line">pygame.display.set_caption(<span class="string">&#x27;bingbing&#x27;</span>)</span><br><span class="line">screen.fill(<span class="string">&#x27;white&#x27;</span>)</span><br><span class="line"><span class="comment">#创建一个 50*50 的图像,并优化显示</span></span><br><span class="line">face = pygame.Surface((<span class="number">50</span>,<span class="number">50</span>),flags=pygame.HWSURFACE)</span><br><span class="line"><span class="comment">#填充颜色</span></span><br><span class="line">face.fill(color=<span class="string">&#x27;pink&#x27;</span>)</span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    <span class="comment"># 循环获取事件，监听事件</span></span><br><span class="line">    <span class="keyword">for</span> event <span class="keyword">in</span> pygame.event.get():</span><br><span class="line">        <span class="comment"># 判断用户是否点了关闭按钮</span></span><br><span class="line">        <span class="keyword">if</span> event.<span class="built_in">type</span> == pygame.QUIT:</span><br><span class="line">            <span class="comment">#卸载所有模块</span></span><br><span class="line">            pygame.quit()</span><br><span class="line">            <span class="comment">#终止程序</span></span><br><span class="line">            sys.exit()</span><br><span class="line">    <span class="comment"># 将绘制的图像添加到主屏幕上，(100,100)是位置坐标，显示屏的左上角为坐标系的(0,0)原点</span></span><br><span class="line">    screen.blit(face, (<span class="number">100</span>, <span class="number">100</span>))</span><br><span class="line">    pygame.display.flip() <span class="comment">#更新屏幕内容</span></span><br></pre></td></tr></table></figure><p>从上述运行结果可以看出，通过 Surface 模块，我们成功的在主屏幕上绘制一个 50 * 50 的矩形区域。注意，如果不设置尺寸，Surface 默认创建一个和主游戏屏幕同样大小的区域。</p><table>    <tbody>        <tr>            <th>                方法</th>            <th>                说明</th>        </tr>        <tr>            <td>                pygame.Surface.blit()&nbsp;</td>            <td>                将一个图像（Surface 对象）绘制到另一个图像上</td>        </tr>        <tr>            <td>                pygame.Surface.convert()&nbsp;</td>            <td>                修改图像（Surface 对象）的像素格式</td>        </tr>        <tr>            <td>                pygame.Surface.fill()&nbsp;&nbsp;</td>            <td>                使用纯色填充 Surface 对象</td>        </tr>        <tr>            <td>                pygame.Surface.scroll()&nbsp;</td>            <td>                复制并移动 Surface 对象</td>        </tr>        <tr>            <td>                pygame.Surface.set_alpha()&nbsp;</td>            <td>                设置整个图像的透明度</td>        </tr>        <tr>            <td>                pygame.Surface.get_at()&nbsp;</td>            <td>                获取一个像素的颜色值</td>        </tr>        <tr>            <td>                pygame.Surface.set_at()&nbsp;</td>            <td>                设置一个像素的颜色值</td>        </tr>        <tr>            <td>                pygame.Surface.get_palette()</td>            <td>                获取 Surface 对象 8 位索引的调色板</td>        </tr>        <tr>            <td>                pygame.Surface.map_rgb()&nbsp;&nbsp;</td>            <td>                将一个 RGBA 颜色转换为映射的颜色值</td>        </tr>        <tr>            <td>                pygame.Surface.set_clip()&nbsp;</td>            <td>                设置该 Surface 对象的当前剪切区域</td>        </tr>        <tr>            <td>                pygame.Surface.subsurface()&nbsp;&nbsp;</td>            <td>                根据父对象创建一个新的子 Surface 对象</td>        </tr>        <tr>            <td>                pygame.Surface.get_offset()</td>            <td>                获取子 Surface 对象在父对象中的偏移位置</td>        </tr>        <tr>            <td>                pygame.Surface.get_size()</td>            <td>                获取 Surface 对象的尺寸</td>        </tr>    </tbody></table><p>除了使用 Surface 模块新建图像外，我们还可以使用另外一种方法从外部加载图像，如下所示：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pygame.image.load(&quot;图片路径&quot;).convert()  </span><br></pre></td></tr></table></figure><p>上述方法将被加载的图像作为 Surface 对象来使用，因此它可以调用上述表格中所有方法。注意，此处之所以使用 convert(）来转换被加载图片的像素格式，是为了提升 Pygame 对图片的处理速度，该操作能够保证图像的像素格式与图片的显示格式是相同的。</p><p><strong>通过 image.load() 方法可以加载游戏的背景图，或者游戏中使用的其他元素，比如的人物、道具等等。</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pygame</span><br><span class="line"><span class="comment">#引入pygame中所有常量，比如 QUIT</span></span><br><span class="line"><span class="keyword">from</span> pygame.<span class="built_in">locals</span> <span class="keyword">import</span> *</span><br><span class="line">pygame.init()</span><br><span class="line">screen = pygame.display.set_mode((<span class="number">500</span>,<span class="number">250</span>))</span><br><span class="line">pygame.display.set_caption(<span class="string">&#x27;bingbing&#x27;</span>)</span><br><span class="line"><span class="comment">#加载一张图片</span></span><br><span class="line">image_surface = pygame.image.load(<span class="string">&quot;C:/Users/Administrator/Desktop/c-net.png&quot;</span>).convert()</span><br><span class="line"><span class="comment"># rect(left,top,width,height)指定图片上某个区域</span></span><br><span class="line"><span class="comment"># special_flags功能标志位,指定颜色混合模式，默认为 0 表示用纯色填充</span></span><br><span class="line">image_surface.fill((<span class="number">0</span>,<span class="number">0</span>,<span class="number">255</span>),rect=(<span class="number">100</span>,<span class="number">100</span>,<span class="number">100</span>,<span class="number">50</span>),special_flags=<span class="number">0</span>)</span><br><span class="line"><span class="comment"># 200,100 表示图像在水平、垂直方向上的偏移量，以左上角为坐标原点</span></span><br><span class="line">image_surface.scroll(<span class="number">100</span>,<span class="number">50</span>)</span><br><span class="line"><span class="comment"># 无限循环，让窗口停留</span></span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    <span class="keyword">for</span> event <span class="keyword">in</span> pygame.event.get():</span><br><span class="line">        <span class="keyword">if</span> event.<span class="built_in">type</span> == QUIT:</span><br><span class="line">            exit()</span><br><span class="line">    <span class="comment"># 将图像放置在主屏幕上</span></span><br><span class="line">    screen.blit(image_surface,(<span class="number">0</span>,<span class="number">0</span>))</span><br><span class="line">    pygame.display.update()</span><br></pre></td></tr></table></figure><h2 id="Pygame-Transform图像变形"><a href="#Pygame-Transform图像变形" class="headerlink" title="Pygame Transform图像变形"></a>Pygame Transform图像变形</h2><p>pygame.transform 模块允许您对加载、创建后的图像进行一系列操作，比如调整图像大小、旋转图片等操作，常用方法如下所示：</p><table>    <tbody>        <tr>            <th>                方法</th>            <th>                说明</th>        </tr>        <tr>            <td>                pygame.transform.scale()</td>            <td>                将图片缩放至指定的大小，并返回一个新的 Surface 对象。</td>        </tr>        <tr>            <td>                pygame.transform.rotate()</td>            <td>                将图片旋转至指定的角度。</td>        </tr>        <tr>            <td>                pygame.transform.rotozoom()</td>            <td>                以角度旋转图像，同时将图像缩小或放大至指定的倍数。</td>        </tr>    </tbody></table><p>示例：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pygame</span><br><span class="line"><span class="comment">#引入pygame中所有常量，比如 QUIT</span></span><br><span class="line"><span class="keyword">from</span> pygame.<span class="built_in">locals</span> <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">pygame.init()</span><br><span class="line">screen = pygame.display.set_mode((<span class="number">500</span>,<span class="number">250</span>))</span><br><span class="line">pygame.display.set_caption(<span class="string">&#x27;bingbing&#x27;</span>)</span><br><span class="line"><span class="comment">#加载一张图片（455*191)</span></span><br><span class="line">image_surface = pygame.image.load(<span class="string">&quot;C:/Users/Administrator/Desktop/c-net.png&quot;</span>).convert()</span><br><span class="line">image_new = pygame.transform.scale(image_surface,(<span class="number">300</span>,<span class="number">300</span>))</span><br><span class="line"><span class="comment"># 查看新生成的图片的对象类型</span></span><br><span class="line"><span class="comment">#print(type(image_new))</span></span><br><span class="line"><span class="comment"># 对新生成的图像进行旋转至45度</span></span><br><span class="line">image_1 =pygame.transform.rotate(image_new,<span class="number">45</span>)</span><br><span class="line"><span class="comment"># 使用rotozoom() 旋转 0 度，将图像缩小0.5倍</span></span><br><span class="line">image_2 = pygame.transform.rotozoom(image_1,<span class="number">0</span>,<span class="number">0.5</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    <span class="keyword">for</span> event <span class="keyword">in</span> pygame.event.get():</span><br><span class="line">        <span class="keyword">if</span> event.<span class="built_in">type</span> == QUIT:</span><br><span class="line">            exit()</span><br><span class="line">    <span class="comment"># 将最后生成的image_2添加到显示屏幕上</span></span><br><span class="line">    screen.blit(image_2,(<span class="number">0</span>,<span class="number">0</span>))</span><br><span class="line">    pygame.display.update()</span><br></pre></td></tr></table></figure><h2 id="Pygame-Time时间控制详解"><a href="#Pygame-Time时间控制详解" class="headerlink" title="Pygame Time时间控制详解"></a>Pygame Time时间控制详解</h2><p>pygame.time 时间控制模块，是 Pygame 中使用频率较高的模块，其主要功能是管理时间和游戏帧数率（即 FPS）。</p><p>时间在游戏开发中承担着非常重要的作用，比如释放某个技能所消耗的时间，或者播放动画、声音的持续时间，这些都需要时间来管理。time 模块另外一个重要作用是控制游戏帧数率（即 FPS），它是评价游戏画面是否流畅的关键指标。在一般情况下，计算机的 FPS 都能达到 60帧/s 的速度，这足够我们使用，如果当帧数小于 30 的时候，游戏画面就会变得卡顿。</p><h4 id="1-游戏暂停"><a href="#1-游戏暂停" class="headerlink" title="1) 游戏暂停"></a>1) 游戏暂停</h4><p>Pygame.time 模块提供了以下常用方法，如下表所示：</p><table>    <tbody>        <tr>            <th>                方法</th>            <th>                说明</th>        </tr>        <tr>            <td>                pygame.time.get_ticks()&nbsp;</td>            <td>                以毫秒为单位获取时间</td>        </tr>        <tr>            <td>                pygame.time.wait()</td>            <td>                使程序暂停一段时间</td>        </tr>        <tr>            <td>                pygame.time.set_timer()</td>            <td>                创建一个定时器，即每隔一段时间，去执行一些动作</td>        </tr>        <tr>            <td>                pygame.time.Clock()</td>            <td>                创建一个时钟对象来帮我们确定游戏要以多大的帧数运行</td>        </tr>    </tbody></table><h4 id="2-设置游戏FPS"><a href="#2-设置游戏FPS" class="headerlink" title="2) 设置游戏FPS"></a>2) 设置游戏FPS</h4><p>若想设置游戏的帧数率（FPS）可以通过 Clock() 方法来实现，该对象提供了以下常用方法：</p><table>    <tbody>        <tr>            <th>                方法</th>            <th>                说明</th>        </tr>        <tr>            <td>                pygame.time.Clock.tick()</td>            <td>                更新clock对象</td>        </tr>        <tr>            <td>                pygame.time.Clock.get_time()</td>            <td>                获取上一个tick中的时间</td>        </tr>        <tr>            <td>                pygame.time.Clock.get_fps()</td>            <td>                计算clock对象的帧率</td>        </tr>    </tbody></table><p>示例：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pygame</span><br><span class="line"></span><br><span class="line">pygame.init()</span><br><span class="line">screen = pygame.display.set_mode((<span class="number">500</span>,<span class="number">300</span>))</span><br><span class="line">pygame.display.set_caption(<span class="string">&#x27;bingbing&#x27;</span>)</span><br><span class="line"><span class="comment"># 获取以毫秒为单位的时间</span></span><br><span class="line">t = pygame.time.get_ticks() <span class="comment">#该时间指的从pygame初始化后开始计算，到调用该函数为止</span></span><br><span class="line">t1 =pygame.time.delay(<span class="number">3000</span>) <span class="comment">#暂停游戏3000毫秒</span></span><br><span class="line"><span class="built_in">print</span>(t1)</span><br><span class="line"><span class="comment">#暂停t1时间后，加载图片</span></span><br><span class="line">image_surface = pygame.image.load(<span class="string">&quot;C:/Users/Administrator/Desktop/c-net.png&quot;</span>)</span><br><span class="line"><span class="comment">#创建时钟对象（控制游戏的FPS）</span></span><br><span class="line">clock = pygame.time.Clock()</span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line"></span><br><span class="line">    <span class="comment">#通过时钟对象，指定循环频率，每秒循环60次</span></span><br><span class="line">    clock.tick(<span class="number">60</span>)</span><br><span class="line">    <span class="keyword">for</span> event <span class="keyword">in</span> pygame.event.get():</span><br><span class="line">        <span class="keyword">if</span> event.<span class="built_in">type</span> == pygame.QUIT:</span><br><span class="line">            exit()</span><br><span class="line">    screen.blit(image_surface,(<span class="number">0</span>,<span class="number">0</span>))</span><br><span class="line">    pygame.display.update()</span><br></pre></td></tr></table></figure><h2 id="Pygame-Rect区域位置"><a href="#Pygame-Rect区域位置" class="headerlink" title="Pygame Rect区域位置"></a>Pygame Rect区域位置</h2><p>Rect（rectangle）指的是矩形，或者长方形，在 Pygame 中我们使用 Rect() 方法来创建一个指定位置，大小的矩形区域。函数的语法格式如下：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rect =pygame.Rect(left,top,width,height) </span><br></pre></td></tr></table></figure><p>Rect 表示的区域必须位于一个 Surface 对象之上，比如游戏的主窗口（screen）。</p><p><img src="https://c.biancheng.net/uploads/allimg/211109/1111164644-0.gif" alt="pygame Rect区域"></p><div class="note info simple"><p>注意：在 Pygame 中以游戏主窗口的左上角为坐标原点。</p></div><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pygame</span><br><span class="line">pygame.init()</span><br><span class="line">screen = pygame.display.set_mode((<span class="number">500</span>,<span class="number">300</span>))</span><br><span class="line">pygame.display.set_caption(<span class="string">&#x27;bingbing&#x27;</span>)</span><br><span class="line">image_surface = pygame.image.load(<span class="string">&quot;C:/Users/Administrator/Desktop/c-net.png&quot;</span>)</span><br><span class="line">rect1 = pygame.Rect(<span class="number">50</span>,<span class="number">50</span>,<span class="number">100</span>,<span class="number">100</span>)</span><br><span class="line"><span class="comment"># 在原图的基础上创建一个新的子图（surface对象）</span></span><br><span class="line">image_child= image_surface.subsurface(rect1)</span><br><span class="line">rect2 = image_child.get_rect()</span><br><span class="line"><span class="comment">#输出的矩形大小为 100*100</span></span><br><span class="line"><span class="built_in">print</span>(rect2)</span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    <span class="keyword">for</span> event <span class="keyword">in</span> pygame.event.get():</span><br><span class="line">        <span class="keyword">if</span> event.<span class="built_in">type</span> == pygame.QUIT:</span><br><span class="line">            exit()</span><br><span class="line">    <span class="comment">#在屏幕上显示子图的区域</span></span><br><span class="line">    screen.blit(image_child,rect1)</span><br><span class="line">    pygame.display.update()</span><br></pre></td></tr></table></figure><p>我们在图片上截取了一个和 rect1 同样大小的矩形区域（100*100）</p><p>Rect提供了其他方法：</p><table>    <tbody>        <tr>            <th>                方法</th>            <th>                说明</th>        </tr>        <tr>            <td>                pygame.Rect.copy()</td>            <td>                复制矩形</td>        </tr>        <tr>            <td>                pygame.Rect.move()</td>            <td>                移动矩形区域，接受一个列表参数</td>        </tr>        <tr>            <td>                pygame.Rect.move_ip()</td>            <td>                移动矩形（无返回）</td>        </tr>        <tr>            <td>                pygame.Rect.inflate()</td>            <td>                增大或缩小矩形大小</td>        </tr>        <tr>            <td>                pygame.Rect.clamp()</td>            <td>                将矩形移到另一个矩形内</td>        </tr>        <tr>            <td>                pygame.Rect.union()</td>            <td>                返回一个两个矩形合并后的矩形。</td>        </tr>        <tr>            <td>                pygame.Rect.fit()</td>            <td>                按纵横比调整矩形的大小或移动矩形。</td>        </tr>        <tr>            <td>                pygame.Rect.contains()</td>            <td>                测试一个矩形是否在另一个矩形内</td>        </tr>        <tr>            <td>                pygame.Rect.collidepoint()&nbsp;</td>            <td>                测试点是否在矩形内</td>        </tr>        <tr>            <td>                pygame.Rect.colliderect()</td>            <td>                测试两个矩形是否重叠</td>        </tr>    </tbody></table><div class="note info simple"><p>同时 Rect 对象也提供了一些关于矩形大小的常用的属性，如下所示：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">x,y  <span class="comment">#表示矩形距离 x、y 轴的距离</span></span><br><span class="line">top, left, bottom, right <span class="comment">#在坐标系内描述矩形的大小</span></span><br><span class="line">topleft, bottomleft, topright, bottomright <span class="comment">#返回一个描述矩形大小的元组</span></span><br><span class="line">midtop, midleft, midbottom, midright <span class="comment">#返回一个描述矩形大小的元组</span></span><br><span class="line">center, centerx, centery <span class="comment">#(centerx，centery)表示矩形中央坐标(x,y)的值</span></span><br><span class="line">size, width, height</span><br><span class="line">w,h  <span class="comment">#用于描述矩形的width、height</span></span><br></pre></td></tr></table></figure><p>简单示例：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span>  pygame</span><br><span class="line"><span class="comment"># 对应left/top/width/height</span></span><br><span class="line">rect1 = pygame.Rect(<span class="number">0</span>,<span class="number">0</span>,<span class="number">100</span>,<span class="number">100</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;x的值是&#123;&#125;；y的值是&#123;&#125;&#x27;</span>.<span class="built_in">format</span>(rect1.x,rect1.y))</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;bottom的值是&#123;&#125;；right的值是&#123;&#125;&#x27;</span>.<span class="built_in">format</span>(rect1.bottom,rect1.right))</span><br><span class="line"><span class="comment"># 设置居中的距离</span></span><br><span class="line"><span class="built_in">print</span>(rect1.center,rect1.centerx,rect1.centery)</span><br><span class="line"><span class="comment"># 返回值为 (centerx,top)</span></span><br><span class="line"><span class="built_in">print</span>(rect1.midtop)</span><br><span class="line"><span class="comment"># 返回值为 (right,centery)的元组</span></span><br><span class="line"><span class="built_in">print</span>(rect1.midright)</span><br><span class="line"><span class="comment"># 返回值为（left,bottom）</span></span><br><span class="line"><span class="built_in">print</span>(rect1.bottomleft)</span><br><span class="line"><span class="comment"># 返回矩形区域大小，元组格式</span></span><br><span class="line"><span class="built_in">print</span>(rect1.size)</span><br></pre></td></tr></table></figure><p>输出结果如下：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">x的值是<span class="number">0</span>；y的值是<span class="number">0</span></span><br><span class="line">bottom的值是<span class="number">100</span>；right的值是<span class="number">100</span></span><br><span class="line"><span class="comment">#中心</span></span><br><span class="line">(<span class="number">50</span>, <span class="number">50</span>) <span class="number">50</span> <span class="number">50</span></span><br><span class="line">(<span class="number">50</span>, <span class="number">0</span>)</span><br><span class="line"><span class="comment">#midright</span></span><br><span class="line">(<span class="number">100</span>, <span class="number">50</span>)</span><br><span class="line"><span class="comment">#bottomleft</span></span><br><span class="line">(<span class="number">0</span>, <span class="number">100</span>)</span><br><span class="line"><span class="comment">#size</span></span><br><span class="line">(<span class="number">100</span>, <span class="number">100</span>)</span><br></pre></td></tr></table></figure></div><p>我们还可以通过属性对来设置，或者者更改矩形区域的大小，如下所示：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rect1.left = 30 rect1.center = (70,70)</span><br></pre></td></tr></table></figure><p>除了通过 Rect 对象来构造一个矩形区域之外，我们还可以使用<code>rect</code>属性来构建一个矩形区域。在 Pygame 中有许多函数都提供了<code>rect</code>属性，比如有下列函数：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">surface.fill((0,0,255),rect=(100,100,100,50))</span><br></pre></td></tr></table></figure><p>上述代码会在 surface 对象的区域内选定一个 rect 区域，并将该区域填充为蓝色（RGB(0,0,255)）。</p><h2 id="Pygame-Event"><a href="#Pygame-Event" class="headerlink" title="Pygame Event"></a>Pygame Event</h2><p>事件（Event）是 Pygame 的重要模块之一，它是构建整个游戏程序的核心，比如鼠标点击、键盘敲击、游戏窗口移动、调整窗口大小、触发特定的情节、退出游戏等等，这些都可以看做是“事件”</p><h3 id="事件类型"><a href="#事件类型" class="headerlink" title="事件类型"></a>事件类型</h3><p>Pygame 定义了一个专门用来处理事件的结构，即事件队列，该结构遵循遵循队列“先到先处理”的基本原则，通过事件队列，我们可以有序的、逐一的处理用户的操作（触发事件）。下述表格列出了 Pygame 中常用的游戏事件：</p><table>    <tbody>        <tr>            <th>                事件类型</th>            <th>                描述</th>            <th>                成员属性</th>        </tr>        <tr>            <td>                QUIT</td>            <td>                用户按下窗口的关闭按钮</td>            <td>                none</td>        </tr>        <tr>            <td>                ATIVEEVENT</td>            <td>                Pygame被激活或者隐藏</td>            <td>                gain,state</td>        </tr>        <tr>            <td>                KEYDOWN</td>            <td>                键盘按下</td>            <td>                unicode、key、mod</td>        </tr>        <tr>            <td>                KEYUP</td>            <td>                键盘放开</td>            <td>                key、mod</td>        </tr>        <tr>            <td>                MOUSEMOTION</td>            <td>                鼠标移动&nbsp;&nbsp;</td>            <td>                pos, rel, buttons</td>        </tr>        <tr>            <td>                MOUSEBUTTONDOWN</td>            <td>                鼠标按下&nbsp;</td>            <td>                pos, button</td>        </tr>        <tr>            <td>                MOUSEBUTTONUP</td>            <td>                鼠标放开&nbsp;</td>            <td>                pos, button</td>        </tr>        <tr>            <td>                JOYAXISMOTION</td>            <td>                游戏手柄(Joystick or pad) 移动&nbsp;</td>            <td>                joy, axis, value</td>        </tr>        <tr>            <td>                JOYBALLMOTION&nbsp;</td>            <td>                游戏球(Joy ball) 移动&nbsp;&nbsp;</td>            <td>                joy, axis, value</td>        </tr>        <tr>            <td>                JOYHATMOTION</td>            <td>                游戏手柄(Joystick) 移动&nbsp; &nbsp;&nbsp;</td>            <td>                joy, axis, value</td>        </tr>        <tr>            <td>                JOYBUTTONDOWN</td>            <td>                游戏手柄按下</td>            <td>                joy, button</td>        </tr>        <tr>            <td>                JOYBUTTONUP</td>            <td>                游戏手柄放开&nbsp; &nbsp;&nbsp;</td>            <td>                joy, button</td>        </tr>        <tr>            <td>                VIDEORESIZE</td>            <td>                Pygame窗口缩放&nbsp;&nbsp;</td>            <td>                size, w, h</td>        </tr>        <tr>            <td>                VIDEOEXPOSE</td>            <td>                Pygame窗口部分公开(expose)&nbsp;</td>            <td>                none</td>        </tr>        <tr>            <td>                USEREVENT</td>            <td>                <span style="color: rgb(79, 79, 79); font-family: -apple-system, &quot;SF UI Text&quot;, Arial, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif, SimHei, SimSun; background-color: rgb(247, 247, 247);">触发一个用户事件&nbsp;&nbsp;</span></td>            <td>                事件代码</td>        </tr>    </tbody></table><h3 id="事件处理方法"><a href="#事件处理方法" class="headerlink" title="事件处理方法"></a>事件处理方法</h3><p>Pygame.event 模块提供了处理事件队列的常用方法，如下表所示：</p><table>    <tbody>        <tr>            <th>                方法</th>            <th>                说明</th>        </tr>        <tr>            <td>                pygame.event.get()</td>            <td>                从事件队列中获取一个事件，并从队列中删除该事件</td>        </tr>        <tr>            <td>                pygame.event.wait()&nbsp;</td>            <td>                阻塞直至事件发生才会继续执行，若没有事件发生将一直处于阻塞状态</td>        </tr>        <tr>            <td>                pygame.event.set_blocked()&nbsp;</td>            <td>                控制哪些事件禁止进入队列，如果参数值为None，则表示禁止所有事件进入</td>        </tr>        <tr>            <td>                pygame.event.set_allowed()&nbsp;&nbsp;</td>            <td>                控制哪些事件允许进入队列</td>        </tr>        <tr>            <td>                pygame.event.pump()&nbsp;</td>            <td>                调用该方法后，Pygame 会自动处理事件队列</td>        </tr>        <tr>            <td>                pygame.event.poll()&nbsp;</td>            <td>                会根据实际情形返回一个真实的事件，或者一个None</td>        </tr>        <tr>            <td>                pygame.event.peek()&nbsp;&nbsp;</td>            <td>                检测某类型事件是否在队列中</td>        </tr>        <tr>            <td>                pygame.event.clear()</td>            <td>                从队列中清除所有的事件</td>        </tr>        <tr>            <td>                pygame.event.get_blocked()&nbsp;</td>            <td>                检测某一类型的事件是否被禁止进入队列</td>        </tr>        <tr>            <td>                pygame.event.post()&nbsp;&nbsp;</td>            <td>                放置一个新的事件到队列中</td>        </tr>        <tr>            <td>                pygame.event.Event()&nbsp;&nbsp;</td>            <td>                创建一个用户自定义的新事件</td>        </tr>    </tbody></table><p>当我们使用 Pygame 处理事件时，逻辑一般都是相似的。首先是判断事件的类型，然后根据不同的事件操作，执行不同的游戏操作。因此这种情况非常适合使用 if … else 语句。如下所示：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line"></span><br><span class="line">    <span class="comment">#等待事件发生</span></span><br><span class="line">    event = pygame.event.wait()</span><br><span class="line">    <span class="keyword">if</span> event.<span class="built_in">type</span> == pygame.QUIT:</span><br><span class="line">        exit()</span><br><span class="line">    <span class="keyword">if</span> event.<span class="built_in">type</span> == pygame.MOUSEBUTTONDOWN:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;鼠标按下&#x27;</span>,event.pos)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> event.<span class="built_in">type</span> == pygame.MOUSEBUTTONUP:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;鼠标弹起&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> event.<span class="built_in">type</span> == pygame.MOUSEMOTION:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;鼠标移动&#x27;</span>)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># 键盘事件</span></span><br><span class="line">    <span class="keyword">if</span> event.<span class="built_in">type</span> ==pygame.KEYDOWN:</span><br><span class="line">        <span class="comment"># 打印按键的英文字符</span></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;键盘按下&#x27;</span>,<span class="built_in">chr</span>(event.key))</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> event.<span class="built_in">type</span> == pygame.KEYUP:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;键盘弹起&#x27;</span>)</span><br><span class="line">    ....</span><br></pre></td></tr></table></figure><h3 id="处理键盘事件"><a href="#处理键盘事件" class="headerlink" title="处理键盘事件"></a>处理键盘事件</h3><p>键盘事件会涉及到大量的按键操作，比如游戏中的上下左右，或者人物的前进、后退等操作，这些都需要键盘来配合实现。</p><p>键盘事件提供了一个 key 属性，通过该属性可以获取键盘的按键。Pygame 将键盘上的字母键、数字键、组合键等按键以常量的方式进行了定义，下表列出了部分常用按键的常量：</p><table>    <tbody>        <tr>            <th>                常量名</th>            <th>                描述</th>        </tr>        <tr>            <td>                K_BACKSPACE</td>            <td>                退格键（Backspace）</td>        </tr>        <tr>            <td>                K_TAB</td>            <td>                制表键（Tab）</td>        </tr>        <tr>            <td>                K_CLEAR</td>            <td>                清除键（Clear）</td>        </tr>        <tr>            <td>                K_RETURN</td>            <td>                回车键（Enter）</td>        </tr>        <tr>            <td>                K_PAUSE</td>            <td>                暂停键（Pause）</td>        </tr>        <tr>            <td>                K_ESCAPE</td>            <td>                退出键（Escape）</td>        </tr>        <tr>            <td>                K_SPACE</td>            <td>                空格键（Space）</td>        </tr>        <tr>            <td>                K_0...K_9</td>            <td>                0...9</td>        </tr>        <tr>            <td>                K_a...Kz</td>            <td>                a...z</td>        </tr>        <tr>            <td>                K_DELETE</td>            <td>                删除键（delete）</td>        </tr>        <tr>            <td>                K_KP0...K_KP9</td>            <td>                0（小键盘）...9（小键盘）</td>        </tr>        <tr>            <td>                K_F1...K_F15</td>            <td>                F1...F15</td>        </tr>        <tr>            <td>                K_UP</td>            <td>                向上箭头（up arrow）</td>        </tr>        <tr>            <td>                K_DOWN</td>            <td>                向下箭头（down arrow）</td>        </tr>        <tr>            <td>                K_RIGHT</td>            <td>                向右箭头（right arrow）</td>        </tr>        <tr>            <td>                K_LEFT</td>            <td>                向左箭头（left arrow）</td>        </tr>        <tr>            <td>                KMOD_ALT</td>            <td>                同时按下Alt键</td>        </tr>    </tbody></table><blockquote><p>想要了解更多按键常量可参考官方文档，这里有您想要的更多知识 ———&gt; <a href="https://www.pygame.org/docs/ref/key.html">点击前往</a>。</p></blockquote><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pygame</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"></span><br><span class="line"><span class="comment"># 初始化pygame</span></span><br><span class="line">pygame.init()</span><br><span class="line"><span class="comment"># 定义变量</span></span><br><span class="line">size = width, height = <span class="number">600</span>, <span class="number">400</span></span><br><span class="line">bg = (<span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 加载logo图</span></span><br><span class="line">img = pygame.image.load(<span class="string">&quot;C:/Users/Administrator/Desktop/logo.jpg&quot;</span>)</span><br><span class="line"><span class="comment"># 获取图像的位置</span></span><br><span class="line">position = img.get_rect()</span><br><span class="line"><span class="comment"># 创建一个主窗口</span></span><br><span class="line">screen = pygame.display.set_mode(size)</span><br><span class="line"><span class="comment"># 标题</span></span><br><span class="line">pygame.display.set_caption(<span class="string">&quot;bation&quot;</span>)</span><br><span class="line"><span class="comment"># 创建游戏主循环</span></span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    <span class="comment"># 设置初始值</span></span><br><span class="line">    site = [<span class="number">0</span>, <span class="number">0</span>]</span><br><span class="line">    <span class="keyword">for</span> event <span class="keyword">in</span> pygame.event.get():</span><br><span class="line">        <span class="keyword">if</span> event.<span class="built_in">type</span> == pygame.QUIT:</span><br><span class="line">            sys.exit()</span><br><span class="line">        <span class="comment"># 图像移动 KEYDOWN 键盘按下事件</span></span><br><span class="line">        <span class="comment"># 通过 key 属性对应按键</span></span><br><span class="line">        <span class="keyword">if</span> event.<span class="built_in">type</span> == pygame.KEYDOWN:</span><br><span class="line">            <span class="keyword">if</span> event.key == pygame.K_UP:</span><br><span class="line">                site[<span class="number">1</span>] -= <span class="number">8</span></span><br><span class="line">            <span class="keyword">if</span> event.key == pygame.K_DOWN:</span><br><span class="line">                site[<span class="number">1</span>] += <span class="number">8</span></span><br><span class="line">            <span class="keyword">if</span> event.key == pygame.K_LEFT:</span><br><span class="line">                site[<span class="number">0</span>] -= <span class="number">8</span></span><br><span class="line">            <span class="keyword">if</span> event.key == pygame.K_RIGHT:</span><br><span class="line">                site[<span class="number">0</span>] += <span class="number">8</span></span><br><span class="line">    <span class="comment"># 移动图像</span></span><br><span class="line">    position = position.move(site)</span><br><span class="line">    <span class="comment"># 填充背景</span></span><br><span class="line">    screen.fill(bg)</span><br><span class="line">    <span class="comment"># 放置图片</span></span><br><span class="line">    screen.blit(img, position)</span><br><span class="line">    <span class="comment"># 更新显示界面</span></span><br><span class="line">    pygame.display.flip()</span><br></pre></td></tr></table></figure><p>鼠标是计算机最重要外接设备之一，同时它也是游戏玩家必不可少的工具之一。</p><p>Pygame 提供了三个鼠标事件，分别是鼠标移动（MOUSEMOTION）、鼠标按下（MOUSEBUTTONDOWN）、鼠标释放（MOUSEBUTTONUP），不同事件类型对应着不同的成员属性。如下所示：</p><div class="note info simple"><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">pygame.event.MOUSEMOTION鼠标移动事件</span><br><span class="line"></span><br><span class="line">    event.pos 相对于窗口左上角，鼠标的当前坐标值(x,y)</span><br><span class="line">    event.rel 鼠标相对运动距离(X,Y)，相对于上次事件</span><br><span class="line">    event.buttons 鼠标按钮初始状态(0,0,0)，分别对应(左键,滑轮,右键)，移动过程中点击那个键，相应位置变会为1</span><br><span class="line"></span><br><span class="line">pygame.event.MOUSEBUTTONUP鼠标键释放事件</span><br><span class="line"></span><br><span class="line">    event.pos 相对于窗口左上角，鼠标的当前坐标值(x,y)</span><br><span class="line">    event.button 鼠标释放键编号（整数）左键为1，按下滚动轮2、右键为3</span><br><span class="line"></span><br><span class="line">pygame.event.MOUSEBUTTONDOWN 鼠标键按下事件</span><br><span class="line"></span><br><span class="line">    event.pos 相对于窗口左上角，鼠标的当前坐标值(x,y)</span><br><span class="line">    event.button 鼠标按下键编号（整数），左键为1，按下滚动轮2、右键为3，向前滚动滑轮4、向后滚动滑轮5</span><br></pre></td></tr></table></figure></div><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pygame</span><br><span class="line"><span class="keyword">from</span> random <span class="keyword">import</span> randint</span><br><span class="line"></span><br><span class="line"><span class="comment"># 初始化程序</span></span><br><span class="line">pygame.init()</span><br><span class="line">screen = pygame.display.set_mode((<span class="number">450</span>,<span class="number">400</span>))</span><br><span class="line">pygame.display.set_caption(<span class="string">&quot;c语言中文网&quot;</span>)</span><br><span class="line"><span class="comment"># 更新显示</span></span><br><span class="line">pygame.display.flip()</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    <span class="comment">#等待事件发生</span></span><br><span class="line">    event = pygame.event.wait()</span><br><span class="line">    <span class="keyword">if</span> event.<span class="built_in">type</span> == pygame.QUIT:</span><br><span class="line">        exit(<span class="string">&quot;成功退出&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> event.<span class="built_in">type</span> == pygame.MOUSEBUTTONDOWN:</span><br><span class="line">        <span class="comment"># pos 获取鼠标当前位置</span></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;鼠标按下&#x27;</span>,event.pos)</span><br><span class="line">        mx,my = event.pos</span><br><span class="line">        <span class="comment"># 调用 pygame.draw 模块画圆</span></span><br><span class="line">        pygame.draw.circle(screen,(<span class="number">255</span>,<span class="number">255</span>,<span class="number">0</span>),(mx,my),<span class="number">50</span>)</span><br><span class="line">        <span class="comment"># 处理完，更新显示</span></span><br><span class="line">        pygame.display.update()</span><br><span class="line">    <span class="keyword">if</span> event.<span class="built_in">type</span> == pygame.MOUSEBUTTONUP:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;鼠标弹起&#x27;</span>)</span><br><span class="line">        <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> event.<span class="built_in">type</span> == pygame.MOUSEMOTION:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;鼠标移动&#x27;</span>)</span><br><span class="line">        mx, my = event.pos</span><br><span class="line">        <span class="comment"># 随机生成 RGB 颜色值</span></span><br><span class="line">        r = randint(<span class="number">0</span>,<span class="number">255</span>)</span><br><span class="line">        g = randint(<span class="number">0</span>,<span class="number">255</span>)</span><br><span class="line">        b = randint(<span class="number">0</span>,<span class="number">255</span>)</span><br><span class="line">        pygame.draw.circle(screen, (r,g,b,),(mx, my), <span class="number">50</span>)</span><br><span class="line">        <span class="comment"># 处理完，更新显示</span></span><br><span class="line">        pygame.display.update()</span><br></pre></td></tr></table></figure><h2 id="Pygame-Draw"><a href="#Pygame-Draw" class="headerlink" title="Pygame Draw"></a>Pygame Draw</h2><p>Pygame 中提供了一个<code>draw</code>模块用来绘制一些简单的图形状，比如矩形、多边形、圆形、直线、弧线等。</p><p><code>pygame.draw</code>模块的常用方法如下表所示：</p><table>    <tbody>        <tr>            <th>                方法</th>            <th>                说明</th>        </tr>        <tr>            <td>                pygame.draw.rect()&nbsp;</td>            <td>                绘制矩形</td>        </tr>        <tr>            <td>                pygame.draw.polygon()&nbsp;</td>            <td>                绘制多边形</td>        </tr>        <tr>            <td>                pygame.draw.circle()&nbsp;</td>            <td>                根据圆心和半径绘制圆形</td>        </tr>        <tr>            <td>                pygame.draw.ellipse()&nbsp;</td>            <td>                绘制一个椭圆形</td>        </tr>        <tr>            <td>                pygame.draw.arc()&nbsp;</td>            <td>                绘制弧线（挥着椭圆的一部分）</td>        </tr>        <tr>            <td>                pygame.draw.line()&nbsp;</td>            <td>                绘制线段（直线）</td>        </tr>        <tr>            <td>                pygame.draw.lines()&nbsp;</td>            <td>                绘制多条连续的线段</td>        </tr>        <tr>            <td>                pygame.draw.aaline()&nbsp;</td>            <td>                绘制一条平滑的线段（抗锯齿）</td>        </tr>        <tr>            <td>                pygame.draw.aalines()&nbsp;</td>            <td>                绘制多条连续的线段</td>        </tr>    </tbody></table><p>表格中的函数使用方法大同小异，它们都可以在 Surface 对象上绘制一些简单的形状，返回值是一个 Rect 对象，表示实际绘制图形的矩形区域。上述绘图函数都提供了一个 color 参数，我们可以通过以下三种方式来传递 color 参数值：</p><ul><li>使用 pygame.color 对象</li><li>RGB 三元组</li><li>RGBA 四元组</li></ul><h4 id="1-绘制矩形"><a href="#1-绘制矩形" class="headerlink" title="1) 绘制矩形"></a>1) 绘制矩形</h4><p>绘制矩形的语法格式如下：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pygame.draw.rect(surface, color, rect, width)</span><br></pre></td></tr></table></figure><p>参数说明如下：</p><ul><li>surface：指主游戏窗口，无特殊情况，一般都会绘制在主屏幕上；</li><li>color：该参数用于该图形着色；</li><li>rect：绘制图形的位置和尺寸大小；</li><li>width：可选参数，指定边框的宽度，默认为 0，表示填充该矩形区域。</li></ul><p>注意，当 width &gt; 0 时，表示线框的宽度；而 width &lt; 0 时，此时不会绘制任何图形。</p><h4 id="2-绘制多边形"><a href="#2-绘制多边形" class="headerlink" title="2) 绘制多边形"></a>2) 绘制多边形</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pygame.draw.polygon(surface, color, points, width)</span><br></pre></td></tr></table></figure><p>其中 points 一个列表参数，它表示组成多边形顶点的 3 或者多个 (x,y) 坐标，通过元组或者列表来表示这些多边形顶点。其余参数与上述函数相同。</p><h4 id="3-绘制圆形"><a href="#3-绘制圆形" class="headerlink" title="3) 绘制圆形"></a>3) 绘制圆形</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pygame.circle(surface, color, pos, radius, width=0)</span><br></pre></td></tr></table></figure><p>上述参数的含义如下：</p><ul><li>pos：该参数用来指定的圆心位置；</li><li>radius：用来指定圆的半径；</li></ul><h4 id="4-绘制椭圆形"><a href="#4-绘制椭圆形" class="headerlink" title="4) 绘制椭圆形"></a>4) 绘制椭圆形</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pygame.draw.ellipse(surface, color, Rect, width=0)</span><br></pre></td></tr></table></figure><p>绘制椭圆形的过程，其实就是在矩形区域内部（Rect）绘制一个内接椭圆形，其余参数与上述参数意思相同。</p><h4 id="5-绘制圆弧曲线"><a href="#5-绘制圆弧曲线" class="headerlink" title="5) 绘制圆弧曲线"></a>5) 绘制圆弧曲线</h4><p>当需要绘制圆弧的曲线时，使用以下函数，语法格式如下：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pygame.draw.arc(Surface, color, Rect, start_angle, stop_angle, width=1)</span><br></pre></td></tr></table></figure><p>与 ellipse 函数相比，该函数多了两个参数：</p><ul><li>start_angle是该段圆弧的起始角度；</li><li>stop_angle是终止角度；</li></ul><p>这两个都是用弧度制来表示的，而原点就是矩形 Rect 的中心位置。</p><h4 id="6-绘制直线"><a href="#6-绘制直线" class="headerlink" title="6) 绘制直线"></a>6) 绘制直线</h4><p>Draw 模块提供了两类绘制直线的方法，即是否消除直线的锯齿，并且根据实际情况，我们还可以选择绘制一条或者多条直线。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pygame.draw.line(surface, color, start_pos, end_pos, width=1)</span><br></pre></td></tr></table></figure><p>参数说明：</p><ul><li>start_pos 和 end_pos 表示线段的起始位置，此处使用 [x,y] 来表示起始位置；</li><li>width =1 表示直线的宽度，默认为 1。</li></ul><p>如果是绘制一条消除锯齿的平滑线，此时则使用 blend = 1 参数，如下所示：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pygame.aaline(surface, color, startpos, endpos, blend=1) </span><br></pre></td></tr></table></figure><p>blend 参数表示通过绘制混合背景的阴影来实现抗锯齿功能。</p><h4 id="7-绘制多条直接"><a href="#7-绘制多条直接" class="headerlink" title="7) 绘制多条直接"></a>7) 绘制多条直接</h4><p>当需要绘制多条直线的时候，我们可以使用以下方法：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pygame.lines(surface, color, closed, pointlist, width=1)</span><br></pre></td></tr></table></figure><p>其中 pointlist 与 closed 含义如下：</p><ul><li>pointlist：参数值为列表，包含了一些列点坐标的列表</li><li>closed：布尔值参数，如果设置为 True，表示直线的第一个端点和直线的最后一个端点要首尾相连；</li></ul><p>如果绘制抗锯齿直线，使用以下方法：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pygame.draw.aalines(surface, color, closed, pointlist, blend=1)</span><br></pre></td></tr></table></figure><p>除了指定了 blend = 1 之外，其余参数含义与上述函数相同。</p><h4 id="例子"><a href="#例子" class="headerlink" title="例子"></a>例子</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pygame</span><br><span class="line"><span class="keyword">from</span> math <span class="keyword">import</span> pi</span><br><span class="line"></span><br><span class="line"><span class="comment">#初始化</span></span><br><span class="line">pygame.init()</span><br><span class="line"><span class="comment"># 设置主屏幕大小</span></span><br><span class="line">size = (<span class="number">500</span>, <span class="number">450</span>)</span><br><span class="line">screen = pygame.display.set_mode(size)</span><br><span class="line"><span class="comment">#设置标题</span></span><br><span class="line">pygame.display.set_caption(<span class="string">&quot;C语言中文网&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 设置一个控制主循环的变量</span></span><br><span class="line">done = <span class="literal">False</span></span><br><span class="line"><span class="comment">#创建时钟对象</span></span><br><span class="line">clock = pygame.time.Clock()</span><br><span class="line"><span class="keyword">while</span> <span class="keyword">not</span> done:</span><br><span class="line">    <span class="comment"># 设置游戏的fps</span></span><br><span class="line">    clock.tick(<span class="number">10</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> event <span class="keyword">in</span> pygame.event.get():</span><br><span class="line">        <span class="keyword">if</span> event.<span class="built_in">type</span> == pygame.QUIT:</span><br><span class="line">            done = <span class="literal">True</span>  <span class="comment"># 若检测到关闭窗口，则将done置为True</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># 绘制一条宽度为 3 的红色对角线</span></span><br><span class="line">    pygame.draw.line(screen, (<span class="number">0</span>, <span class="number">255</span>, <span class="number">0</span>), [<span class="number">0</span>, <span class="number">0</span>], (<span class="number">500</span>, <span class="number">450</span>), <span class="number">3</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 绘制多条蓝色的直线（连续直线，非抗锯齿），False 表示首尾不相连</span></span><br><span class="line">    pygame.draw.lines(screen, (<span class="number">0</span>, <span class="number">0</span>, <span class="number">255</span>), <span class="literal">False</span>, [[<span class="number">0</span>, <span class="number">80</span>], [<span class="number">50</span>, <span class="number">90</span>], [<span class="number">200</span>, <span class="number">80</span>], [<span class="number">220</span>, <span class="number">30</span>]], <span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 绘制一个灰色的矩形区域，以灰色填充区域</span></span><br><span class="line">    pygame.draw.rect(screen, (<span class="number">155</span>, <span class="number">155</span>, <span class="number">155</span>), (<span class="number">75</span>, <span class="number">10</span>, <span class="number">50</span>, <span class="number">20</span>), <span class="number">0</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 绘制一个线框宽度为2的矩形区域</span></span><br><span class="line">    pygame.draw.rect(screen, (<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>), [<span class="number">150</span>, <span class="number">10</span>, <span class="number">50</span>, <span class="number">20</span>],<span class="number">2</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 绘制一个椭圆形,其线宽为2</span></span><br><span class="line">    pygame.draw.ellipse(screen, (<span class="number">255</span>, <span class="number">0</span>, <span class="number">0</span>), (<span class="number">225</span>, <span class="number">10</span>, <span class="number">50</span>, <span class="number">20</span>), <span class="number">2</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 绘制一个实心的红色椭圆形</span></span><br><span class="line">    pygame.draw.ellipse(screen, (<span class="number">255</span>, <span class="number">0</span>, <span class="number">0</span>), (<span class="number">300</span>, <span class="number">10</span>, <span class="number">50</span>, <span class="number">20</span>))</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 绘制一个绿色边框(宽度为2)三角形</span></span><br><span class="line">    pygame.draw.polygon(screen, (<span class="number">100</span>, <span class="number">200</span>, <span class="number">45</span>), [[<span class="number">100</span>, <span class="number">100</span>], [<span class="number">0</span>, <span class="number">200</span>], [<span class="number">200</span>, <span class="number">200</span>]], <span class="number">2</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 绘制一个蓝色实心的圆形，其中[60,250]表示圆心的位置，40为半径，width默认为0</span></span><br><span class="line">    pygame.draw.circle(screen, (<span class="number">0</span>, <span class="number">0</span>, <span class="number">255</span>), [<span class="number">60</span>, <span class="number">250</span>], <span class="number">40</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 绘制一个圆弧,其中0表示弧线的开始位置，pi/2表示弧线的结束位置，2表示线宽</span></span><br><span class="line">    pygame.draw.arc(screen, (<span class="number">255</span>, <span class="number">10</span>, <span class="number">0</span>), (<span class="number">210</span>, <span class="number">75</span>, <span class="number">150</span>, <span class="number">125</span>), <span class="number">0</span>, pi / <span class="number">2</span>, <span class="number">2</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 刷新显示屏幕</span></span><br><span class="line">    pygame.display.flip()</span><br><span class="line"></span><br><span class="line"><span class="comment"># 点击关闭，退出pygame程序</span></span><br><span class="line">pygame.quit()</span><br></pre></td></tr></table></figure><h2 id="Pygame精灵和碰撞检测"><a href="#Pygame精灵和碰撞检测" class="headerlink" title="Pygame精灵和碰撞检测"></a>Pygame精灵和碰撞检测</h2><p>精灵（英文译为 Sprite），其实在一个游戏程序中，精灵本质指的是一张张小尺寸的图片，比如游戏中的各种道具、人物、场景装饰等，它们都可以看做成一张张小的“精灵”图。除此之外，人物的移动也可以看做是一系列小精灵图构成的序列（按帧组成的序列），如下图所示：</p><p><img src="https://c.biancheng.net/uploads/allimg/211109/1121064645-0.gif" alt="pygame精灵图"></p><p>如果将逐帧分解后的动作，按照一定的频率播放，那么就形成了动画精灵，您将会看到雄鹰展翅高飞、人在策马奔腾、运动员奋力跳远。</p><p>精灵有个特点就是允许精灵之间进行交互，也称之为碰撞，而碰撞检测，指的就是检测两个精灵之间是否发生了碰撞。比如在贪吃蛇游戏中蛇的头部是否与食物发生了碰撞，或者飞机大战游戏中子弹是否击中了外星人等等。当检测到碰撞发生后，接下来会触发某些事件，比如子弹击中外星人，外星人就会消失，玩家的得分也会随之增加，并且在游戏屏幕上又会出现一个外星人。</p><p>Pygame 专门提供了一个处理精灵的模块，也就是 sprite（pygame.sprite）模块。通常情况下，我们使用该模块的基类 Sprite 来创建一个子类，从而达到处理精灵的目的，该子类提供了操作精灵的常用属性和方法，如下所示：</p><table>    <tbody>        <tr>            <th>                属性&amp;方法</th>            <th>                说明</th>        </tr>        <tr>            <td>                self.image</td>            <td>                加载要显示的精灵图片，控制图片大小和填充色</td>        </tr>        <tr>            <td>                self.rect</td>            <td>                精灵图片显示在哪个位置</td>        </tr>        <tr>            <td>                Sprite.update()</td>            <td>                刷新精灵图，使其相应效果生效</td>        </tr>        <tr>            <td>                Sprite.add()</td>            <td>                添加精灵图到精灵组中（groups）</td>        </tr>        <tr>            <td>                Sprite.remove()</td>            <td>                从精灵组中删除选中的精灵图</td>        </tr>        <tr>            <td>                Sprite.kill()</td>            <td>                删除精灵组中全部的精灵</td>        </tr>        <tr>            <td>                Sprite.alive()</td>            <td>                判断某个精灵是否属于精灵组</td>        </tr>    </tbody></table><p>注意，当游戏中有大量的精灵时，操作它们将变得复杂，此时通过构建精灵容器（group 类）也就是精灵组来统一管理这些精灵。构建方法如下：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"># 创建精灵组group = pygame.sprite.Group()# 向组内添加一个精灵group.add(sprite_one)</span><br></pre></td></tr></table></figure><p>于此同时<code>pygame.sprite</code>模块也提供了多种检测精灵是否碰撞的方法，如下所示：</p><table>    <tbody>        <tr>            <th>                方法</th>            <th>                说明</th>        </tr>        <tr>            <td>                pygame.sprite.collide_rect()&nbsp;</td>            <td>                两个精灵之间的矩形检测，即矩形区域是否有交汇，返回一个布尔值。</td>        </tr>        <tr>            <td>                pygame.sprite.collide_circle()</td>            <td>                两个精灵之间的圆形检测，即圆形区域是否有交汇，返回一个布尔值。</td>        </tr>        <tr>            <td>                pygame.sprite.collide_mask()&nbsp;</td>            <td>                两个精灵之间的像素蒙版检测，更为精准的一种检测方式。</td>        </tr>        <tr>            <td>                pygame.sprite.spritecollide()&nbsp;</td>            <td>                精灵和精灵组之间的矩形碰撞检测，一个组内的所有精灵会逐一地对另外一个单个精灵进行碰撞检测，返回值是一个列表，包含了发生碰撞的所有精灵。</td>        </tr>        <tr>            <td>                pygame.sprite.spritecollideany()</td>            <td>                精灵和精灵组之间的矩形碰撞检测，上述函数的变体，当发生碰撞时，返回组内的一个精灵，无碰撞发生时，返回 None。</td>        </tr>        <tr>            <td>                pygame.sprite.groupcollide()</td>            <td>                检测在两个组之间发生碰撞的所有精灵，它返回值是一个字典，将第一组中发生碰撞的精灵作为键，第二个组中发生碰撞的精灵作为值。</td>        </tr>    </tbody></table>]]></content>
    
    
    <summary type="html">学习pygame</summary>
    
    
    
    <category term="编程基础" scheme="https://stack2005.github.io/categories/%E7%BC%96%E7%A8%8B%E5%9F%BA%E7%A1%80/"/>
    
    
    <category term="python" scheme="https://stack2005.github.io/tags/python/"/>
    
  </entry>
  
  <entry>
    <title>MAkefile简单学习</title>
    <link href="https://stack2005.github.io/posts/f7c1b6ea.html"/>
    <id>https://stack2005.github.io/posts/f7c1b6ea.html</id>
    <published>2025-04-14T16:00:00.000Z</published>
    <updated>2025-04-14T16:00:00.000Z</updated>
    
    <content type="html"><![CDATA[<h2 id="基础"><a href="#基础" class="headerlink" title="基础"></a>基础</h2><p>在Linux环境下，当我们输入<code>make</code>命令时，它就在当前目录查找一个名为<code>Makefile</code>的文件，然后，根据这个文件定义的规则，自动化地执行任意命令，包括编译命令。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">┌─────┐ ┌─────┐ ┌─────┐</span><br><span class="line">│a.txt│ │b.txt│ │c.txt│</span><br><span class="line">└─────┘ └─────┘ └─────┘</span><br><span class="line">   │       │       │</span><br><span class="line">   └───┬───┘       │</span><br><span class="line">       │           │</span><br><span class="line">       ▼           │</span><br><span class="line">    ┌─────┐        │</span><br><span class="line">    │m.txt│        │</span><br><span class="line">    └─────┘        │</span><br><span class="line">       │           │</span><br><span class="line">       └─────┬─────┘</span><br><span class="line">             │</span><br><span class="line">             ▼</span><br><span class="line">          ┌─────┐</span><br><span class="line">          │x.txt│</span><br><span class="line">          └─────┘</span><br></pre></td></tr></table></figure><h3 id="规则"><a href="#规则" class="headerlink" title="规则"></a>规则</h3><p><code>Makefile</code>由若干条规则（Rule）构成，每一条规则指出一个目标文件（Target），若干依赖文件（prerequisites），以及生成目标文件的命令。</p><figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="section">目标: 依赖项</span></span><br><span class="line">    [Tab]命令</span><br></pre></td></tr></table></figure><p>针对上面的例子：</p><figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 目标文件: 依赖文件1 依赖文件2</span></span><br><span class="line"><span class="section">m.txt: a.txt b.txt</span></span><br><span class="line">cat a.txt b.txt &gt; m.txt</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>一条规则的格式为<code>目标文件: 依赖文件1 依赖文件2 ...</code>，紧接着，以Tab开头的是命令，用来生成目标文件。上述规则使用<code>cat</code>命令合并了<code>a.txt</code>与<code>b.txt</code>，并写入到<code>m.txt</code>。用什么方式生成目标文件<code>make</code>并不关心，因为命令完全是我们自己写的，可以是编译命令，也可以是<code>cp</code>、<code>mv</code>等任何命令。</p><p>以<code>#</code>开头的是注释，会被<code>make</code>命令忽略。</p><div class="note danger simple"><p>注意：Makefile的规则中，命令必须以Tab开头，不能是空格。</p></div><div class="note info simple"><ul><li><strong>目标</strong>：要生成的文件（如 <code>main.o</code>）或操作名（如 <code>clean</code>）。</li><li><strong>依赖项</strong>：生成目标所需的文件或目标。</li><li><strong>命令</strong>：生成目标的具体命令（必须以 <code>Tab</code> 开头）。</li></ul></div><p>越是接近目标文件的命令，就越是要写在前面。因为程序是按照<strong>递归</strong>的方式进行依赖文件查找的，看到第一行有一个没见过的依赖文件，就往下一行进行查找，以此类推。</p><p>把默认执行的规则放第一条，其他规则的顺序是无关紧要的，因为<code>make</code>执行时自动判断依赖。</p><p>此外，<code>make</code>会打印出执行的每一条命令，便于我们观察执行顺序以便调试。</p><p>如果我们再次运行<code>make</code>，输出如下：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ make</span><br><span class="line">make: `x.txt<span class="string">&#x27; is up to date.</span></span><br></pre></td></tr></table></figure><p><code>make</code>检测到<code>x.txt</code>已经是最新版本，无需再次执行，因为<code>x.txt</code>的创建时间晚于它依赖的<code>m.txt</code>和<code>c.txt</code>的最后修改时间。</p><p><strong>make使用文件的创建和修改时间来判断是否应该更新一个目标文件。</strong></p><p>修改<code>c.txt</code>后，运行<code>make</code>，会触发<code>x.txt</code>的更新：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ make</span><br><span class="line"><span class="built_in">cat</span> m.txt c.txt &gt; x.txt</span><br></pre></td></tr></table></figure><p>但并不会触发<code>m.txt</code>的更新，原因是<code>m.txt</code>的依赖<code>a.txt</code>与<code>b.txt</code>并未更新，所以，<code>make</code>只会根据<code>Makefile</code>去执行那些必要的规则，并不会把所有规则都无脑执行一遍。</p><p>在编译大型程序时，全量编译往往需要几十分钟甚至几个小时。全量编译完成后，如果仅修改了几个文件，再全部重新编译完全没有必要，用<code>Makefile</code>实现增量编译就十分节省时间。</p><h3 id="伪目标"><a href="#伪目标" class="headerlink" title="伪目标"></a>伪目标</h3><p>因为<code>m.txt</code>与<code>x.txt</code>都是自动生成的文件，所以，可以安全地删除。</p><p>删除时，我们也不希望手动删除，而是编写一个<code>clean</code>规则来删除它们：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">clean:</span><br><span class="line"><span class="built_in">rm</span> -f m.txt</span><br><span class="line"><span class="built_in">rm</span> -f x.txt</span><br></pre></td></tr></table></figure><p><code>clean</code>规则与我们前面编写的规则有所不同，它没有依赖文件，因此，要执行<code>clean</code>，必须用命令<code>make clean</code>：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$ make clean</span><br><span class="line"><span class="built_in">rm</span> -f m.txt</span><br><span class="line"><span class="built_in">rm</span> -f x.txt</span><br></pre></td></tr></table></figure><p>然而，在执行<code>clean</code>时，我们并没有创建一个名为<code>clean</code>的文件，所以，因为目标文件<code>clean</code>不存在，每次运行<code>make clean</code>，都会执行这个规则的命令。</p><p>如果我们手动创建一个<code>clean</code>的文件，这个<code>clean</code>规则就不会执行了！</p><p>如果我们希望<code>make</code>把<code>clean</code>不要视为文件，可以添加一个标识：</p><figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta"><span class="keyword">.PHONY</span>: clean</span></span><br><span class="line"><span class="section">clean:</span></span><br><span class="line">rm -f m.txt</span><br><span class="line">rm -f x.txt</span><br></pre></td></tr></table></figure><p>此时，<code>clean</code>就不被视为一个文件，而是伪目标（Phony Target）。</p><p>大型项目通常会提供<code>clean</code>、<code>install</code>这些约定俗成的伪目标名称，方便用户快速执行特定任务。</p><p>一般来说，并不需要用<code>.PHONY</code>标识<code>clean</code>等约定俗成的伪目标名称，除非有人故意搞破坏，手动创建名字叫<code>clean</code>的文件。</p><h3 id="控制打印"><a href="#控制打印" class="headerlink" title="控制打印"></a>控制打印</h3><p>默认情况下，<code>make</code>会打印出它执行的每一条命令。如果我们不想打印某一条命令，可以在命令前加上<code>@</code>，表示不打印命令（但是仍然会执行）：</p><figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="section">no_output:</span></span><br><span class="line">@echo &#x27;not display&#x27;</span><br><span class="line">echo &#x27;will display&#x27;</span><br></pre></td></tr></table></figure><p>执行结果如下：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">$ make no_output</span><br><span class="line">not display</span><br><span class="line"><span class="built_in">echo</span> <span class="string">&#x27;will display&#x27;</span></span><br><span class="line">will display</span><br></pre></td></tr></table></figure><p>注意命令<code>echo &#39;not display&#39;</code>本身没有打印，但命令仍然会执行，并且执行的结果仍然正常打印。</p><h3 id="控制错误"><a href="#控制错误" class="headerlink" title="控制错误"></a>控制错误</h3><p><code>make</code>在执行命令时，会检查每一条命令的返回值，如果返回错误（非0值），就会中断执行。</p><p>例如，不使用<code>-f</code>删除一个不存在的文件会报错：</p><figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="section">has_error:</span></span><br><span class="line">rm zzz.txt</span><br><span class="line">echo &#x27;ok&#x27;</span><br></pre></td></tr></table></figure><p>执行上述目标，输出如下：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">$ make has_error</span><br><span class="line"><span class="built_in">rm</span> zzz.txt</span><br><span class="line"><span class="built_in">rm</span>: zzz.txt: No such file or directory</span><br><span class="line">make: *** [has_error] Error 1</span><br></pre></td></tr></table></figure><p>由于命令<code>rm zzz.txt</code>报错，导致后面的命令<code>echo &#39;ok&#39;</code>并不会执行，<code>make</code>打印出错误，然后退出。</p><p>有些时候，我们想忽略错误，继续执行后续命令，可以在需要忽略错误的命令前加上<code>-</code>：</p><figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="section">ignore_error:</span></span><br><span class="line">-rm zzz.txt</span><br><span class="line">echo &#x27;ok&#x27;</span><br></pre></td></tr></table></figure><p>执行上述目标，输出如下：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">$ make ignore_error</span><br><span class="line"><span class="built_in">rm</span> zzz.txt</span><br><span class="line"><span class="built_in">rm</span>: zzz.txt: No such file or directory</span><br><span class="line">make: [ignore_error] Error 1 (ignored)</span><br><span class="line"><span class="built_in">echo</span> <span class="string">&#x27;ok&#x27;</span></span><br><span class="line">ok</span><br></pre></td></tr></table></figure><p><code>make</code>检测到<code>rm zzz.txt</code>报错，并打印错误，但显示<code>(ignored)</code>，然后继续执行后续命令。</p><p>对于执行可能出错，但不影响逻辑的命令，可以用<code>-</code>忽略。</p><h3 id="自动变量和模式规则"><a href="#自动变量和模式规则" class="headerlink" title="自动变量和模式规则"></a>自动变量和模式规则</h3><p>假设项目有 <code>main.c</code> 和 <code>utils.c</code>，生成可执行文件 <code>app</code>：</p><figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">CC = gcc</span><br><span class="line">CFLAGS = -Wall -O2</span><br><span class="line">TARGET = app</span><br><span class="line">OBJS = main.o utils.o</span><br><span class="line"></span><br><span class="line"><span class="variable">$(TARGET)</span>: <span class="variable">$(OBJS)</span></span><br><span class="line">    <span class="variable">$(CC)</span> <span class="variable">$(CFLAGS)</span> -o <span class="variable">$@</span> <span class="variable">$^</span></span><br><span class="line"></span><br><span class="line"><span class="section">%.o: %.c</span></span><br><span class="line">    <span class="variable">$(CC)</span> <span class="variable">$(CFLAGS)</span> -c <span class="variable">$&lt;</span> -o <span class="variable">$@</span></span><br><span class="line"></span><br><span class="line"><span class="meta"><span class="keyword">.PHONY</span>: clean</span></span><br><span class="line"><span class="section">clean:</span></span><br><span class="line">    rm -f <span class="variable">$(OBJS)</span> <span class="variable">$(TARGET)</span></span><br></pre></td></tr></table></figure><ul><li><strong>变量</strong>：<code>CC</code>（编译器）、<code>CFLAGS</code>（编译选项）、<code>TARGET</code>（目标文件）、<code>OBJS</code>（中间文件）。</li><li><strong>自动变量</strong>：<ul><li><code>$@</code>：当前目标名（如 <code>app</code>）。</li><li><code>$^</code>：所有依赖项（如 <code>main.o utils.o</code>）。</li><li><code>$&lt;</code>：第一个依赖项（如 <code>main.c</code>）。</li></ul></li><li><strong>模式规则</strong>：<code>%.o: %.c</code> 表示所有 <code>.o</code> 文件由同名 <code>.c</code> 文件编译。</li><li><strong>伪目标</strong>：<code>.PHONY</code> 声明非文件目标（如 <code>clean</code>）。</li></ul><h3 id="处理头文件依赖"><a href="#处理头文件依赖" class="headerlink" title="处理头文件依赖"></a><strong>处理头文件依赖</strong></h3><p>若 <code>.c</code> 文件依赖头文件（如 <code>utils.h</code>），需显式声明：</p><figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="section">main.o: main.c utils.h</span></span><br><span class="line"><span class="section">utils.o: utils.c utils.h</span></span><br></pre></td></tr></table></figure><p>或使用自动生成依赖：</p><figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">DEPENDS = $(OBJS:.o=.d)</span><br><span class="line"></span><br><span class="line"><span class="section">%.d: %.c</span></span><br><span class="line">    <span class="variable">$(CC)</span> -MM <span class="variable">$&lt;</span> &gt; <span class="variable">$@</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">-include</span> <span class="variable">$(DEPENDS)</span></span><br></pre></td></tr></table></figure><ul><li><code>-MM</code> 选项生成依赖关系到 <code>.d</code> 文件。</li><li><code>-include</code> 将依赖文件包含到 Makefile 中。</li></ul><h2 id="编译C程序"><a href="#编译C程序" class="headerlink" title="编译C程序"></a>编译C程序</h2><p>C程序的编译通常分两步：</p><ol><li>将每个<code>.c</code>文件编译为<code>.o</code>文件；</li><li>将所有<code>.o</code>文件链接为最终的可执行文件。</li></ol><p>我们假设如下的一个C项目，包含<code>hello.c</code>、<code>hello.h</code>和<code>main.c</code>。</p><p><code>hello.c</code>内容如下：</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">hello</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;hello, world!\n&quot;</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>hello.h</code>内容如下：</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> <span class="title function_">hello</span><span class="params">()</span>;</span><br></pre></td></tr></table></figure><p><code>main.c</code>内容如下：</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;hello.h&quot;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;start...\n&quot;</span>);</span><br><span class="line">    hello();</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;exit.\n&quot;</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>注意到<code>main.c</code>引用了头文件<code>hello.h</code>。我们很容易梳理出需要生成的文件，逻辑如下：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">┌───────┐ ┌───────┐ ┌───────┐</span><br><span class="line">│hello.c│ │main.c │ │hello.h│</span><br><span class="line">└───────┘ └───────┘ └───────┘</span><br><span class="line">    │         │         │</span><br><span class="line">    │         └────┬────┘</span><br><span class="line">    │              │</span><br><span class="line">    ▼              ▼</span><br><span class="line">┌───────┐      ┌───────┐</span><br><span class="line">│hello.o│      │main.o │</span><br><span class="line">└───────┘      └───────┘</span><br><span class="line">    │              │</span><br><span class="line">    └───────┬──────┘</span><br><span class="line">            │</span><br><span class="line">            ▼</span><br><span class="line">       ┌─────────┐</span><br><span class="line">       │world.out│</span><br><span class="line">       └─────────┘</span><br></pre></td></tr></table></figure><p>假定最终生成的可执行文件是<code>world.out</code>，中间步骤还需要生成<code>hello.o</code>和<code>main.o</code>两个文件。根据上述依赖关系，我们可以很容易地写出<code>Makefile</code>如下：</p><figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 生成可执行文件:</span></span><br><span class="line"><span class="section">world.out: hello.o main.o</span></span><br><span class="line">cc -o world.out hello.o main.o</span><br><span class="line"></span><br><span class="line"><span class="comment"># 编译 hello.c:</span></span><br><span class="line"><span class="section">hello.o: hello.c</span></span><br><span class="line">cc -c hello.c</span><br><span class="line"></span><br><span class="line"><span class="comment"># 编译 main.c:</span></span><br><span class="line"><span class="section">main.o: main.c hello.h</span></span><br><span class="line">cc -c main.c</span><br><span class="line"></span><br><span class="line"><span class="section">clean:</span></span><br><span class="line">rm -f *.o world.out</span><br></pre></td></tr></table></figure><p>执行<code>make</code>，输出如下：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">$ make</span><br><span class="line">cc -c hello.c</span><br><span class="line">cc -c main.c</span><br><span class="line">cc -o world.out hello.o main.o</span><br></pre></td></tr></table></figure><h2 id="例子"><a href="#例子" class="headerlink" title="例子"></a>例子</h2><figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 定义变量</span></span><br><span class="line">head = pctl.h</span><br><span class="line">srcs = pctl.c</span><br><span class="line">objs = pctl.o</span><br><span class="line">opts = -g -c</span><br><span class="line"></span><br><span class="line"><span class="comment"># 默认目标</span></span><br><span class="line"><span class="section">all: pctl</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 生成可执行文件 pctl</span></span><br><span class="line"><span class="section">pctl: <span class="variable">$(objs)</span></span></span><br><span class="line">gcc <span class="variable">$(objs)</span> -o pctl</span><br><span class="line"></span><br><span class="line"><span class="comment"># 生成目标文件 pctl.o（需依赖 pctl.c 和 pctl.h）</span></span><br><span class="line"><span class="section">pctl.o: <span class="variable">$(srcs)</span> <span class="variable">$(head)</span></span></span><br><span class="line">gcc <span class="variable">$(opts)</span> <span class="variable">$(srcs)</span> -o <span class="variable">$@</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 清理生成的文件</span></span><br><span class="line"><span class="section">clean:</span></span><br><span class="line">rm -f pctl *.o</span><br><span class="line"></span><br><span class="line"><span class="comment"># 声明伪目标（避免与同名文件冲突）</span></span><br><span class="line"><span class="meta"><span class="keyword">.PHONY</span>: all clean</span></span><br></pre></td></tr></table></figure>]]></content>
    
    
    <summary type="html">make简单使用，非深度学习</summary>
    
    
    
    <category term="编程基础" scheme="https://stack2005.github.io/categories/%E7%BC%96%E7%A8%8B%E5%9F%BA%E7%A1%80/"/>
    
    
    <category term="Make" scheme="https://stack2005.github.io/tags/Make/"/>
    
  </entry>
  
  <entry>
    <title>虚言本为护心栽，怎奈真情难自埋：从友夕线看范乃秋晴如何把握人物和剧情</title>
    <link href="https://stack2005.github.io/posts/d561c4d0.html"/>
    <id>https://stack2005.github.io/posts/d561c4d0.html</id>
    <published>2025-04-09T16:00:00.000Z</published>
    <updated>2025-04-09T16:00:00.000Z</updated>
    
    <content type="html"><![CDATA[<p>​    《喜欢我的话就要说出来！》是<code>chuable</code>会社于2015年发售的一款恋爱adv。笔者一直以来都很喜欢这个会社的风格，但是没想到这部作品仍能给我惊喜。</p><p>​    这次其实是笔者第二次接触范乃秋晴，他并非多么惊世骇俗的写手，也充满着不少的小瑕疵。但其高质量的互动和日常，有时充满创意的点子，和对氛围的极致塑造深深折服了笔者。</p><p>​    我们不去分析充满诡叙和伏笔的千穗线，也不去分析互相搀扶共同追逐梦想的te铃歌线，还有萝莉秋野花线）<del>把天然大小姐写成绿色食品宣传大使的彩雨线</del>，而是单独拎出友希线去看一看范乃秋晴是如何把握人物和剧情的完成度的。</p><p><img src="https://bu.dusays.com/2025/04/10/67f7cf43d7061.png" alt="image-20250410220134065"></p><p>​    其实友希这个人物是大有问题的，青梅竹马+小恶魔+黄段子小能手，问题就出现在黄段子上。半句不离欧金金，不分场合，拿各种黄段子欺负草系男主，这是典型的人设用力过猛的表现。甚至在本作最拿得出手的苹果树下告白场景，女主仍不忘玩黄段子。范乃秋晴本来就喜欢写黄段子，笔者怀疑这就是范乃秋晴的分身（bushi</p><p><img src="https://bu.dusays.com/2025/04/10/67f7d2b98ecb2.png" alt="07ea1bb67632a514ee9694043463fbeb"></p><p>​    秋晴反过来利用这点，在恋之樱的作用下攻略友希的回收场景中，女主因为太过在意男主面前不能说黄段子而导致气氛尴尬。当然是因为女主以前几乎每句话都带黄段子，所以当不说黄段子时，真的就无话可说了）于是就有了男主帮助女主复检黄段子的场景：<br><img src="https://bu.dusays.com/2025/04/10/67f7d52d91181.png" alt="07b8db1822cbd5c9653dfb07577b1deb"></p><p>​    这么一看友希的人设虽然用力过猛，但却不单薄，她活泼可爱，有点小恶魔属性，但却极度害怕寂寞；她喜欢黄段子，但那只是因为想要跟上小时候男主的话题；她看似大大咧咧，但是是全员中情感最细腻的那个。她也会为家人的事情烦恼，对爷爷固执的厌烦和其养育的感谢，对父母的渴望于是构成本线的最大要点。</p><p>​    其实笔者一开始也以为这么甜的人设和关系，这条线也就是发发糖的附赠线而已。然不知又悄然踩进了范乃秋晴给玩家设下的陷阱之中。共通线的事件中，店长对友希特殊的态度，爷爷和店长的认识，以及店铺的生意突然火爆，都是为这条线埋下的伏笔。所以当剧情高潮揭露店长是女主的父亲，他其实并没有死的时候，意外但却合理。</p><p>​    整条线的核心冲突是爷爷对店长的态度，母亲的死亡，店长的愧疚以及男主对整件事是否告白。女主的迷茫似乎成为了剧情高潮的催化剂，她不知道如何对待爷爷，她想见父母，厌烦爷爷对待父亲和餐饮业的态度，但又对爷爷的养育充满感恩。<img src="https://bu.dusays.com/2025/04/10/67f7da605a572.png" alt="09ca1a4e62912ed7be11c34fcd1d9825"></p><p>店长的迷茫是开幕式的舞台，随着亲生关系这块帘布的慢慢拉开，他不知道如何对待女儿，他想要永远看着女儿，想要永远坚守他和妻子充满回忆的咖啡馆，但却时常因为愧疚感而感到害怕和退缩。</p><p>爷爷的迷茫是灯光下的黑暗，灯光旋转之时，观众却永远不会注意到这个丧失女儿的固执老人的迷茫。他后悔反对女儿的婚事，但又不想认为这一切都是自己的错，他恨那个带着他女儿私奔的男人，但却给了店长一丝守护咖啡馆的希望。他喜爱友希，用固执的方法去守护她，但却不经意间伤害到了她。</p><p><strong>三人的迷茫，汇成了一点；善良的谎言，贯穿了一线。</strong>人与人复杂的关系，恰好是谎言的结，解不开，也剪不断。但QP并不理解人类为什么要这么复杂的说谎，我想这也是范乃秋晴想要表达出来的：</p><blockquote><p>QP: そもそも何だって彼らは，あんなに嘘をつくんだろうね<br>颯太: 妖精には分からないかもしれないけど、相手のためを思ってつく嘘だってあるんだよ<br>QP: ふぅん。彼らは嘘をついて幸せになったんだね<br>颯太: …………いや……<br>QP : おや？違うのかい？それなら、どうして嘘をつきつづけるんだい？</p></blockquote><p>随之而来的是男主的迷茫，是否继承店长的店铺，是否坚持自己的梦想，是否对友希坦白。我很高兴范乃秋晴所描绘的男主不会一直迷茫，他拥有自己的想法，尽管他仍会对是否介入他人家事感到犹豫，对是否自己坚守店铺而摇摆。</p><blockquote><p>……だめだ。<br>やっぱり、だめだ。このまま見過ごしていいわけがない。<br>俺が初めて働いた、楽しかったこの場所が――<br>世話になったマスターと奥さんが　必死に守ろうとしてきたこの店が――<br>そして――<br>友希があんなに欲しがっていた　思い出が――<br>今にも消えようとしているのに、黙って見てることなんか　できるわけがない。</p></blockquote><p>这里的情绪调动和男主的表现很难不让笔者对范乃秋晴对场景的把控给予高评价。笔者对友希所表达的主题，感同身受。我们总以为血脉相连的亲人就该心有灵犀，但正是因为太过亲密，反而滋生出无数善意的谎言。既怕利刃般的真相割伤对方，又怕沉默的裂痕暗自生长，于是用一层层借口将自己裹成茧。可这世间哪有什么”尽在不言中”？人与人之间本就没有不言自明的默契，那些欲言又止的瞬间，恰是误会的温床。<strong>或许我们需要的，不过是一张方桌、两盏清茶，让真心话有机会在热气中慢慢舒展，直到所有伪装都化作窗台上轻盈的水雾。</strong></p><p><img src="https://bu.dusays.com/2025/04/10/67f7e467c9ef9.png" alt="37efe50fe570113a2eff7fc624a34919"></p>]]></content>
    
    
    <summary type="html">从友夕线看范乃秋晴如何把握人物和剧情</summary>
    
    
    
    <category term="游戏" scheme="https://stack2005.github.io/categories/%E6%B8%B8%E6%88%8F/"/>
    
    
    <category term="杂谈" scheme="https://stack2005.github.io/tags/%E6%9D%82%E8%B0%88/"/>
    
  </entry>
  
  <entry>
    <title>SQL中的1=0</title>
    <link href="https://stack2005.github.io/posts/d267c650.html"/>
    <id>https://stack2005.github.io/posts/d267c650.html</id>
    <published>2025-04-02T16:00:00.000Z</published>
    <updated>2025-04-02T16:00:00.000Z</updated>
    
    <content type="html"><![CDATA[<h2 id="1-Introduction"><a href="#1-Introduction" class="headerlink" title="1.Introduction"></a>1.Introduction</h2><p>In SQL, the <a href="https://www.baeldung.com/sql/having-vs-where#where-clause">WHERE</a> clause is commonly used to filter rows based on a specified condition. The condition <em>WHERE 1=0</em> may initially seem unusual, <span class='p red'>as *1=0* is always false</span> However, this seemingly nonsensical query condition has several practical applications.</p><p>In this tutorial, we’ll explore its practical applications and how it can be useful in real-world scenarios.</p><h2 id="2-Metadata-Fetching-and-Validation"><a href="#2-Metadata-Fetching-and-Validation" class="headerlink" title="2. Metadata Fetching and Validation"></a>2. Metadata Fetching and Validation</h2><p><strong>We can use the <code>WHERE 1=0</code> condition in queries to retrieve a table’s column names without fetching any data</strong>. This approach is similar to using the <a href="https://www.baeldung.com/sql/find-table-column-names#3-using-the-describe-statement">DESC</a> and <a href="https://www.baeldung.com/sql/find-column-data-type#1-the-show-columns-directive">SHOW</a> statements or other schema inspection commands but has the advantage of being universally applicable across different databases. Some <a href="https://www.baeldung.com/cs/object-relational-mapping">ORMs</a> also use this technique to fetch the schema of a table:</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> </span><br><span class="line"><span class="keyword">FROM</span> Student</span><br><span class="line"><span class="keyword">WHERE</span> <span class="number">1</span> <span class="operator">=</span> <span class="number">0</span>;</span><br></pre></td></tr></table></figure><p>Additionally, we can use this condition to validate if a specific column exists in a table:</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> name </span><br><span class="line"><span class="keyword">FROM</span> Student </span><br><span class="line"><span class="keyword">WHERE</span> <span class="number">1</span><span class="operator">=</span><span class="number">0</span></span><br></pre></td></tr></table></figure><p>If the column name doesn’t exist, the query will fail, making it a quick and effective way to validate column existence. However, unlike commands like SHOW and DESC, which provide additional information about the table’s structure, this approach only checks for the presence of the column without revealing other details.</p><h2 id="3-Preventing-Accidental-Data-Modification-in-Queries"><a href="#3-Preventing-Accidental-Data-Modification-in-Queries" class="headerlink" title="3. Preventing Accidental Data Modification in Queries"></a>3. Preventing Accidental Data Modification in Queries</h2><p>Another useful application of the <em>WHERE 1=0</em> condition is to prevent accidental data modification, especially when working with potentially destructive queries like DELETE. <strong>By adding *WHERE 1=0* to a DELETE statement while saving or testing it, we ensure that the query doesn’t accidentally remove any data</strong>. This approach allows us to safely test or save the query without the risk of unwanted changes:</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">DELETE</span> </span><br><span class="line"><span class="keyword">FROM</span> Student</span><br><span class="line"><span class="keyword">WHERE</span> id <span class="operator">&gt;</span> <span class="number">100</span> <span class="keyword">AND</span> <span class="number">1</span> <span class="operator">=</span> <span class="number">0</span>;</span><br></pre></td></tr></table></figure><p>When executing the query in real scenarios, the <em>1=0</em> condition can be explicitly removed before running the query.</p><h2 id="4-Creating-an-Empty-Table-With-the-Same-Structure"><a href="#4-Creating-an-Empty-Table-With-the-Same-Structure" class="headerlink" title="4. Creating an Empty Table With the Same Structure"></a>4. Creating an Empty Table With the Same Structure</h2><p><strong>We can use the *WHERE 1=0* condition in a query to create a new table with the same structure as an existing table</strong>:</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">INTO</span> StudentTemp </span><br><span class="line"><span class="keyword">FROM</span> Student </span><br><span class="line"><span class="keyword">WHERE</span> <span class="number">1</span><span class="operator">=</span><span class="number">0</span>;</span><br></pre></td></tr></table></figure><p>The above query works in PostgreSQL and SQL Server. But in MySQL, we need to use the query as:</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE TABLE</span> StudentTemp <span class="keyword">AS</span> </span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> </span><br><span class="line"><span class="keyword">FROM</span> Student </span><br><span class="line"><span class="keyword">WHERE</span> <span class="number">1</span><span class="operator">=</span><span class="number">0</span>;</span><br></pre></td></tr></table></figure><p>This creates a new table, <em>StudentTemp</em>, with the same structure as <em>Student</em>, but without any data. This approach is useful when setting up temporary tables or preparing a structure for batch inserts. However, <strong>it’s important to note that only the table structure is copied to the new table; <a href="https://www.baeldung.com/sql/constraints">constraints</a>, triggers, and other properties are not applied</strong>.</p><div class="note warning simple"><p>只有表结构会复制，其他如约束、触发器和其他属性均不会触发</p></div><h2 id="5-Dynamic-Query-Building"><a href="#5-Dynamic-Query-Building" class="headerlink" title="5. Dynamic Query Building"></a>5. Dynamic Query Building</h2><p><strong>The <code>WHERE 1=0</code> condition can be a placeholder in dynamic SQL queries, especially when adding optional filters</strong>. It ensures the query remains syntactically correct before any conditions are appended, preventing logical errors:</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> Student </span><br><span class="line"><span class="keyword">WHERE</span> <span class="number">1</span> <span class="operator">=</span> <span class="number">0</span> </span><br><span class="line"><span class="comment">-- Dynamic conditions</span></span><br><span class="line"><span class="keyword">OR</span> GPA <span class="operator">&lt;</span> <span class="number">2</span> </span><br><span class="line"><span class="keyword">OR</span> GPA <span class="keyword">IS</span> <span class="keyword">NULL</span>;</span><br></pre></td></tr></table></figure><p>Additionally, it helps avoid returning all rows when no filters are applied. Without this placeholder, the query could mistakenly fetch all records if no additional conditions are added, which is undesirable in production environments.</p><h2 id="6-Trigger-Execution"><a href="#6-Trigger-Execution" class="headerlink" title="6. Trigger Execution"></a>6. Trigger Execution</h2><p><strong>We can use <code>WHERE 1=0</code>in triggers, particularly BEFORE INSERT/UPDATE/DELETE triggers, to execute specific logic even when no actual data changes occur</strong>.</p><p>For instance, let’s consider a trigger that updates statistics whenever a <em>Student</em> record is deleted. <strong>We can use a DELETE query with *WHERE 1=0* to force the trigger’s execution without actually deleting any records.</strong> This ensures that the trigger executes while the <em>Student</em> table remains unchanged. This approach is particularly useful during the testing phase or when recalculating trigger-based logic without modifying real data.</p>]]></content>
    
    
    <summary type="html">1=0的妙用</summary>
    
    
    
    <category term="SQL" scheme="https://stack2005.github.io/categories/SQL/"/>
    
    
    <category term="SQL" scheme="https://stack2005.github.io/tags/SQL/"/>
    
  </entry>
  
  <entry>
    <title>抛弃DockerDesktop，拥抱原生Docker</title>
    <link href="https://stack2005.github.io/posts/e51df790.html"/>
    <id>https://stack2005.github.io/posts/e51df790.html</id>
    <published>2025-03-17T16:00:00.000Z</published>
    <updated>2025-03-17T16:00:00.000Z</updated>
    
    <content type="html"><![CDATA[<p>尽管Docker Desktop在Windows上的安装和使用非常方便，但它仍然存在一些局限性和不完善的地方。例如，一些功能在Docker Desktop上可能无法完全发挥作用，或者仍处于试验阶段，这可能会影响到使用体验。</p><h3 id="从deb包安装Docker"><a href="#从deb包安装Docker" class="headerlink" title="从deb包安装Docker"></a>从deb包安装Docker</h3><p>首先访问：<a href="https://download.docker.com/linux/ubuntu/dists/?_gl=1dzadrf_gcl_auMjAzNjIxNjkxMy4xNzE3OTE2MTA5_gaNjQ5MjUwNDYyLjE3MTc5MTYxMDk._ga_XJWPQMJYHQ*MTcxODI3NzgwNi43LjEuMTcxODI3ODUyNC41My4wLjA.">https://download.docker.com/linux/ubuntu/dists/?_gl=1dzadrf_gcl_auMjAzNjIxNjkxMy4xNzE3OTE2MTA5_gaNjQ5MjUwNDYyLjE3MTc5MTYxMDk._ga_XJWPQMJYHQ*MTcxODI3NzgwNi43LjEuMTcxO</a></p><p>这个页面列举的是各个Ubuntu发行版本的版本代号，</p><p>每个 Ubuntu 版本都有一个代号，通常由一个形容词和一个动物名称组成，并按字母顺序排列。例如：</p><ul><li>Ubuntu 18.04: Bionic Beaver</li><li>Ubuntu 20.04: Focal Fossa</li><li>Ubuntu 22.04: Jammy Jellyfish</li><li>Ubuntu 22.10: Kinetic Kudu</li></ul><p>这里，我想为 Ubuntu 22.04 下载 Docker 文件，因此选择 jammy/ 目录，来到了第2个页面：</p><p><img src="https://bu.dusays.com/2025/03/19/67da3c1e8caa7.png" alt="img"></p><p>这些是 Docker 提供的不同版本或发布渠道：</p><ul><li><p><strong>stable/</strong>: 这是 Docker 的稳定版本，推荐大多数用户使用。稳定版本经过了广泛的测试，可靠性高，并提供了长期支持。如果你正在生产环境中使用 Docker 或者不需要最新的功能，选择稳定版本是最佳选择。</p></li><li><p><strong>test/</strong>: 这是 Docker 的测试版本，包含了新的功能和改进，但可能不如稳定版本可靠。如果你想尝试最新的功能并且可以容忍可能出现的问题，你可以选择测试版本。测试版本通常会在几周或几个月后成为新的稳定版本。</p></li><li><p><strong>nightly/</strong>: 这是 Docker 的每夜构建版本，包含了最新的代码更改。每夜版本是自动构建的，没有经过广泛测试，因此可能不稳定。除非你是开发人员或者想测试最新的代码，否则不建议使用每夜版本。</p></li><li><p><strong>pool/</strong>: 这不是一个特定的 Docker 版本，而是一个包含所有 Docker deb 包的目录。你通常不需要直接使用这个目录。</p></li></ul><p>InRelease, Release, 和 Release.gpg: 这些是用于验证软件包完整性和真实性的文件，不代表特定的 Docker 版本。</p><p>现在我们使用deb包进行安装，因此访问<code>pool/</code>目录，选择<code>stable</code>稳定版，根据你的系统 CPU 架构选择相应的目录。</p><div class="note info simple"><p>你可以使用以下命令来检查你的系统架构：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">dpkg --print-architecture</span><br></pre></td></tr></table></figure></div><p>需要注意下载版本的匹配，否则安装时可能会出错。这里我选择的是当前较新的一套版本：</p><details class="folding-tag" cyan open><summary> 查看配套版本 </summary>              <div class='content'>              <ul><li><p>containerd.io_1.6.33-1_amd64.deb</p></li><li><p>docker-ce-cli_26.1.4-1ubuntu.22.04jammy_amd64.deb</p></li><li><p>docker-ce_26.1.4-1ubuntu.22.04jammy_amd64.deb</p></li><li><p>docker-buildx-plugin_0.14.1-1ubuntu.22.04jammy_amd64.deb</p></li><li><p>docker-compose-plugin_2.27.1-1ubuntu.22.04jammy_amd64.deb</p></li><li><p>docker-ce-rootless-extras_26.1.4-1ubuntu.22.04jammy_amd64.deb</p></li></ul>              </div>            </details><h3 id="WSL容器访问Windows位置以安装deb"><a href="#WSL容器访问Windows位置以安装deb" class="headerlink" title="WSL容器访问Windows位置以安装deb"></a>WSL容器访问Windows位置以安装deb</h3><p>在WSL2中，Microsoft引入了一个非常方便的功能，允许在WSL容器中直接访问Windows文件系统。这意味着你可以在WSL的Linux环境中，使用熟悉的Linux命令和工具来操作Windows上的文件和目录。</p><p>当你启动一个WSL发行版时，它会自动将Windows文件系统中的某些位置挂载到WSL的文件系统中。默认情况下，会发生以下挂载：</p><ul><li>C:盘会被挂载到<code>/mnt/c</code></li><li>D:盘会被挂载到<code>/mnt/d</code></li></ul><p>其他盘符也以此类推，如E:盘会被挂载到<code>/mnt/e</code>等。</p><p>例如，如果你在Windows的D:\Downloads目录中有一些文件，你可以在WSL中通过/mnt/d/Downloads路径来访问它们。</p><p>这个功能非常强大，它允许你在WSL中无缝地使用Windows文件系统，而不需要复制文件或在两个系统之间切换。你可以在WSL中使用ls，cd，cp，mv等命令来浏览和操作这些文件。</p><p>需要注意的是，虽然你可以在WSL中访问整个Windows文件系统，但反过来并不成立。从Windows中，你只能访问WSL的Linux文件系统的一部分，默认位置是：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">\\wsl$\&lt;DistroName&gt;\home\&lt;UserName&gt;</span><br></pre></td></tr></table></figure><p>在linux命令行输入：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cd /mnt/d/Downloads</span><br></pre></td></tr></table></figure><p>然后，使用<code>dpkg</code>命令来安装这些<strong>deb</strong>包。注意要按照一定的顺序，因为有些包有依赖关系：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">sudo dpkg -i containerd.io_1.6.33-1_amd64.deb</span><br><span class="line">sudo dpkg -i docker-ce-cli_26.1.4-1~ubuntu.22.04~jammy_amd64.deb</span><br><span class="line">sudo dpkg -i docker-ce_26.1.4-1~ubuntu.22.04~jammy_amd64.deb</span><br><span class="line">sudo dpkg -i docker-buildx-plugin_0.14.1-1~ubuntu.22.04~jammy_amd64.deb</span><br><span class="line">sudo dpkg -i docker-compose-plugin_2.27.1-1~ubuntu.22.04~jammy_amd64.deb</span><br><span class="line">sudo dpkg -i docker-ce-rootless-extras_26.1.4-1~ubuntu.22.04~jammy_amd64.deb</span><br></pre></td></tr></table></figure><p>安装完成后，<strong>Docker</strong>就已经安装到你的<strong>WSL</strong>系统中了。</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">启动Docker</span></span><br><span class="line">sudo service docker start</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">重启</span></span><br><span class="line">sudo service docker restart</span><br></pre></td></tr></table></figure><h3 id="配置Docker代理"><a href="#配置Docker代理" class="headerlink" title="配置Docker代理"></a>配置Docker代理</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">创建Docker配置文件（如果不存在）</span></span><br><span class="line">sudo mkdir -p /etc/systemd/system/docker.service.d</span><br><span class="line">sudo touch /etc/systemd/system/docker.service.d/http-proxy.conf</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">添加代理设置</span></span><br><span class="line">sudo vim /etc/systemd/system/docker.service.d/http-proxy.conf</span><br></pre></td></tr></table></figure><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[Service]</span><br><span class="line">Environment=&quot;HTTP_PROXY=http://服务端主机IP:VPN服务端口号&quot;</span><br><span class="line">Environment=&quot;HTTPS_PROXY=http://服务端主机IP:VPN服务端口号&quot;</span><br><span class="line">Environment=&quot;NO_PROXY=localhost,127.0.0.1&quot;</span><br></pre></td></tr></table></figure><p><code>NO_PROXY</code>环境变量指定了不应该通过代理访问的主机或域名，通常包括本地主机和回环地址。</p><h3 id="宿主机的网络互通"><a href="#宿主机的网络互通" class="headerlink" title="宿主机的网络互通"></a>宿主机的网络互通</h3><p>在<code>C:\Users\Administrator</code>下的<code>.wslconfig</code>修改：</p><figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="section">[wsl2]</span></span><br><span class="line"><span class="attr">memory</span>=<span class="number">4</span>GB                        <span class="comment"># 分配给 WSL 2 的内存大小</span></span><br><span class="line"><span class="attr">processors</span>=<span class="number">2</span>                      <span class="comment"># 分配给 WSL 2 的 CPU 核心数</span></span><br><span class="line"> </span><br><span class="line"><span class="section">[experimental]</span></span><br><span class="line"><span class="attr">autoMemoryReclaim</span>=gradual         <span class="comment"># 开启自动回收内存，可在 gradual, dropcache, disabled 之间选择</span></span><br><span class="line"><span class="attr">networkingMode</span>=mirrored           <span class="comment"># 开启镜像网络</span></span><br><span class="line"><span class="attr">dnsTunneling</span>=<span class="literal">true</span>                 <span class="comment"># 开启 DNS Tunneling</span></span><br><span class="line"><span class="attr">firewall</span>=<span class="literal">true</span>                     <span class="comment"># 开启 Windows 防火墙</span></span><br><span class="line"><span class="attr">autoProxy</span>=<span class="literal">true</span>                    <span class="comment"># 开启自动同步代理</span></span><br><span class="line"><span class="attr">sparseVhd</span>=<span class="literal">true</span>                    <span class="comment"># 开启自动释放 WSL2 虚拟硬盘空间</span></span><br></pre></td></tr></table></figure>]]></content>
    
    
    <summary type="html">在WSL2中玩转Docker之Docker Engine 部署与WSL入门</summary>
    
    
    
    <category term="编程基础" scheme="https://stack2005.github.io/categories/%E7%BC%96%E7%A8%8B%E5%9F%BA%E7%A1%80/"/>
    
    
    <category term="Docker" scheme="https://stack2005.github.io/tags/Docker/"/>
    
  </entry>
  
  <entry>
    <title>算法学习</title>
    <link href="https://stack2005.github.io/posts/2633a26.html"/>
    <id>https://stack2005.github.io/posts/2633a26.html</id>
    <published>2025-03-15T16:00:00.000Z</published>
    <updated>2025-03-15T16:00:00.000Z</updated>
    
    <content type="html"><![CDATA[<h2 id="位运算"><a href="#位运算" class="headerlink" title="位运算"></a>位运算</h2><h3 id="基础知识"><a href="#基础知识" class="headerlink" title="基础知识"></a>基础知识</h3><h4 id="概览"><a href="#概览" class="headerlink" title="概览"></a>概览</h4><div class="table-container"><table><thead><tr><th>符号</th><th>描述</th><th>运算规则</th></tr></thead><tbody><tr><td>&amp;</td><td>与</td><td>两个位都为1时，结果才为1</td></tr><tr><td>\</td><td></td><td>或</td><td>两个位都为0时，结果才为0</td></tr><tr><td>^</td><td>异或</td><td>两个位相同为0，相异为1</td></tr><tr><td>~</td><td>取反</td><td>0变1，1变0</td></tr><tr><td>&lt;&lt;</td><td>左移</td><td>各二进位全部左移若干位，高位丢弃，低位补0</td></tr><tr><td>&gt;&gt;</td><td>右移</td><td>各二进位全部右移若干位，对无符号数，高位补0，有符号数，各编译器处理方法不一样，有的补符号位（算术右移），有的补0（逻辑右移）</td></tr></tbody></table></div><h4 id="复合赋值运算符"><a href="#复合赋值运算符" class="headerlink" title="复合赋值运算符"></a>复合赋值运算符</h4><p>位运算符与赋值运算符结合，组成新的复合赋值运算符，它们是：</p><ul><li><code>&amp;=</code>例：<code>a &amp;= b</code> 相当于 <code>a = a &amp; b</code></li><li><code>|=</code>例：<code>a |= b</code> 相当于 <code>a = a | b</code></li><li><code>&gt;&gt;=</code>例：<code>a &gt;&gt;= b</code> 相当于 <code>a = a &gt;&gt; b</code></li><li><code>&lt;&lt;=</code>例：<code>a &lt;&lt;= b</code> 相当于 <code>a = a &lt;&lt; b</code></li><li><code>^=</code>例：<code>a ^= b</code> 相当于 <code>a = a ^ b</code></li></ul><h4 id="常用位操作小技巧"><a href="#常用位操作小技巧" class="headerlink" title="常用位操作小技巧"></a>常用位操作小技巧</h4><ol><li><strong>清零</strong>：如果想将一个单元清零，只要与一个各位都为零的数值<strong>相与</strong>，结果为零。</li><li><strong>取一个数的指定位</strong>：例如，取数 <code>X = 1010 1110</code> 的低4位，只需另找一个数 <code>Y = 0000 1111</code>，然后 <code>X &amp; Y = 0000 1110</code> 即可得到 <code>X</code> 的指定位。</li><li><strong>判断奇偶</strong>：通过判断最未位是0还是1来决定奇偶，可以用 <code>if ((a &amp; 1) == 0)</code> 代替 <code>if (a % 2 == 0)</code> 来判断 <code>a</code> 是否为偶数。</li><li><strong>设置某些位为1</strong>：例如，将数 <code>X = 1010 1110</code> 的低4位设置为1，只需另找一个数 <code>Y = 0000 1111</code>，然后 <code>X | Y = 1010 1111</code> 即可得到。</li><li><strong>翻转指定位</strong>：例如，将数 <code>X = 1010 1110</code> 的低4位翻转，只需另找一个数 <code>Y = 0000 1111</code>，然后 <code>X ^ Y = 1010 0001</code> 即可得到。</li><li><strong>与0相异或值不变</strong>：例如 <code>1010 1110 ^ 0000 0000 = 1010 1110</code></li><li><strong>交换两个数</strong>：</li></ol><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">Swap</span><span class="params">(<span class="type">int</span> &amp;a, <span class="type">int</span> &amp;b)</span> </span>&#123;</span><br><span class="line"><span class="keyword">if</span> (a != b) &#123;</span><br><span class="line">    a ^= b;</span><br><span class="line">    b ^= a;</span><br><span class="line">    a ^= b;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><div class="note info simple"><p><code>a=a^b</code></p><p><code>b=b^(a^b)</code>  =&gt;  <code>b=(b^b)^a</code>  =&gt; <code>b=0^a=a</code> 达到了把a赋给b的效果</p><p>由于前面二步可知a=(a^b)，b=a，第三步<code>a=a^b</code> =&gt; <code>a=(a^b)^a=b</code></p></div><ol><li><strong>使一个数的最低位为零</strong>：例如，使 <code>a</code> 的最低位为0，可以表示为：<code>a &amp; ~1</code>。<code>~1</code> 的值为 <code>1111 1111 1111 1110</code>，再按”与”运算，最低位一定为0。</li></ol><h3 id="相关题目"><a href="#相关题目" class="headerlink" title="相关题目"></a>相关题目</h3><h4 id="颠倒二进制位"><a href="#颠倒二进制位" class="headerlink" title="颠倒二进制位"></a>颠倒二进制位</h4><p><img src="https://bu.dusays.com/2025/03/16/67d68a700a4da.png" alt="image-20250316162304509"></p><h5 id="思路一：逐位替换"><a href="#思路一：逐位替换" class="headerlink" title="思路一：逐位替换"></a>思路一：逐位替换</h5><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="type">uint32_t</span> <span class="title">reverseBits</span><span class="params">(<span class="type">uint32_t</span> n)</span> </span>&#123;</span><br><span class="line">        <span class="type">uint32_t</span> res = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">32</span>; ++i) &#123;</span><br><span class="line">            res = (res &lt;&lt; <span class="number">1</span>) | (n &amp; <span class="number">1</span>);</span><br><span class="line">            n &gt;&gt;= <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> res;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><div class="note info simple"><p><strong>左移操作 (res &lt;&lt; 1):</strong> 这个操作将res的二进制表示向左移动一位（在右边添0）。左移一位的效果相当于将res乘以2。在这个上下文中，它为下一步的或操作（|）腾出了一个位置（最低位）。</p><p><strong>与操作 (n &amp; 1):</strong> 这个操作将n的二进制表示与1进行按位与操作。由于1的二进制表示只在最低位为1，其他位为0，这个操作的结果就是n的最低位。这样可以提取出n的当前最低位的值（0或1）。</p><p><strong>或操作 (|):</strong> 这个操作将左移后的res与n的最低位进行按位或操作。由于左移操作已经为新的位腾出了空间，这一步实际上是将n的最低位添加到res的最低位。这样，n的原始最低位就成为了res的当前最高位。</p></div><h5 id="思路二：分治"><a href="#思路二：分治" class="headerlink" title="思路二：分治"></a>思路二：分治</h5><p>先来看一个前缀知识： <strong>高低位交换</strong></p><p>给出一个16位的无符号整数。称这个二进制数的前8位为“高位”，后8位为“低位”。现在写一程序将它的高低位交换。例如，数34520用二进制表示为：</p><p>   <code>10000110 11011000</code></p><p>将它的高低位进行交换，我们得到了一个新的二进制数：</p><p>  <code>11011000 10000110</code></p><p>它即是十进制的55430。</p><p>这个问题用位操作解决起来非常方便，设x=34520=10000110 11011000(二进制) 由于x为无符号数，右移时会执行逻辑右移即高位补0，因此x右移8位将得到<code>0000000010000110</code>。而x左移8位将得到<code>11011000 00000000</code>。可以发现只要将<code>x&gt;&gt;8</code>与<code>x&lt;&lt;8</code>这两个数相或就可以得到<code>11011000 10000110</code>。用代码实现非常简洁：</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">a = (a &gt;&gt; <span class="number">8</span>) | (a &lt;&lt; <span class="number">8</span>);  </span><br></pre></td></tr></table></figure><p><strong>思路：</strong></p><p>若要翻转一个二进制串，可以将其均分成左右两部分，对每部分递归执行翻转操作，然后将左半部分拼在右半部分的后面，即完成了翻转。</p><p>由于左右两部分的计算方式是相似的，利用位掩码和位移运算，我们可以自底向上地完成这一分治流程。</p><p><img src="https://assets.leetcode-cn.com/solution-static/190/190_fig1.png" alt="fig1"></p><p>对于递归的最底层，我们需要交换所有奇偶位：</p><p>取出所有奇数位和偶数位；<br>将奇数位移到偶数位上，偶数位移到奇数位上。<br>类似地，对于倒数第二层，每两位分一组，按组号取出所有奇数组和偶数组，然后将奇数组移到偶数组上，偶数组移到奇数组上。以此类推。</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    <span class="type">const</span> <span class="type">uint32_t</span> M1 = <span class="number">0x55555555</span>; <span class="comment">// 01010101010101010101010101010101</span></span><br><span class="line">    <span class="type">const</span> <span class="type">uint32_t</span> M2 = <span class="number">0x33333333</span>; <span class="comment">// 00110011001100110011001100110011</span></span><br><span class="line">    <span class="type">const</span> <span class="type">uint32_t</span> M4 = <span class="number">0x0f0f0f0f</span>; <span class="comment">// 00001111000011110000111100001111</span></span><br><span class="line">    <span class="type">const</span> <span class="type">uint32_t</span> M8 = <span class="number">0x00ff00ff</span>; <span class="comment">// 00000000111111110000000011111111</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="type">uint32_t</span> <span class="title">reverseBits</span><span class="params">(<span class="type">uint32_t</span> n)</span> </span>&#123;</span><br><span class="line">        n = n &gt;&gt; <span class="number">1</span> &amp; M1 | (n &amp; M1) &lt;&lt; <span class="number">1</span>;</span><br><span class="line">        n = n &gt;&gt; <span class="number">2</span> &amp; M2 | (n &amp; M2) &lt;&lt; <span class="number">2</span>;</span><br><span class="line">        n = n &gt;&gt; <span class="number">4</span> &amp; M4 | (n &amp; M4) &lt;&lt; <span class="number">4</span>;</span><br><span class="line">        n = n &gt;&gt; <span class="number">8</span> &amp; M8 | (n &amp; M8) &lt;&lt; <span class="number">8</span>;</span><br><span class="line">        <span class="keyword">return</span> n &gt;&gt; <span class="number">16</span> | n &lt;&lt; <span class="number">16</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="分治"><a href="#分治" class="headerlink" title="分治"></a>分治</h2><h3 id="相关题目-1"><a href="#相关题目-1" class="headerlink" title="相关题目"></a>相关题目</h3><h4 id="最长的美好子字符串"><a href="#最长的美好子字符串" class="headerlink" title="最长的美好子字符串"></a>最长的美好子字符串</h4><p><img src="https://bu.dusays.com/2025/03/16/67d6a7487d677.png" alt="image-20250316182616253"></p><p>题目要求找到最长的美好子字符串，如果字符串本身即合法的美好字符串，此时最长的完美字符串即为字符串本身。由于字符串中含有部分字符 ch 只出现大写或者小写形式，如果字符串包含这些字符 ch 时，可以判定该字符串肯定不为完美字符串。一个字符串为美好字符串的必要条件是不包含这些非法字符。因此我们可以利用分治的思想，将字符串从这些非法的字符处切分成若干段，则满足要求的最长子串一定出现在某个被切分的段内，而不能跨越一个或多个段。</p><p>递归时，maxPos 用来记录最长完美字符串的起始索引，maxLen 用来记录最长完美字符串的长度。</p><p>每次检查区间 [start,end] 中的子字符串是否为完美字符串，如果当前的字符串为合法的完美字符串，则将当前区间的字符串的长度与 maxLen 进行比较和替换；否则我们依次对当前字符串进行切分，然后递归检测切分后的字符串。</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function">string <span class="title">longestNiceSubstring</span><span class="params">(string s)</span> </span>&#123;</span><br><span class="line">        <span class="type">int</span> maxPos = <span class="number">0</span>, maxlen = <span class="number">0</span>;</span><br><span class="line">        <span class="built_in">findLongestSubstring</span>(s,<span class="number">0</span>,s.<span class="built_in">size</span>()<span class="number">-1</span>,maxPos, maxlen);</span><br><span class="line">        <span class="keyword">return</span> s.<span class="built_in">substr</span>(maxPos, maxlen);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">findLongestSubstring</span><span class="params">(string s, <span class="type">int</span> start, <span class="type">int</span> end,<span class="type">int</span> &amp; maxPos, <span class="type">int</span> &amp; maxlen)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(start &gt;= end) <span class="keyword">return</span>;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//判断是否为完美字符串</span></span><br><span class="line">        <span class="type">int</span> lower = <span class="number">0</span>, upper = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> i = start; i &lt;= end; i++) &#123;</span><br><span class="line">            <span class="keyword">if</span>(<span class="built_in">islower</span>(s[i])) &#123;</span><br><span class="line">                lower |= <span class="number">1</span> &lt;&lt; (s[i] - <span class="string">&#x27;a&#x27;</span>);</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                upper |= <span class="number">1</span> &lt;&lt; (s[i] - <span class="string">&#x27;A&#x27;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"><span class="comment">//递归结束条件二：是完美字符串</span></span><br><span class="line">        <span class="keyword">if</span>(lower == upper) &#123;</span><br><span class="line">            <span class="keyword">if</span>(end - start + <span class="number">1</span> &gt; maxlen) &#123; <span class="comment">//更新</span></span><br><span class="line">                maxPos = start;</span><br><span class="line">                maxlen = end - start + <span class="number">1</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="type">int</span> vaild = lower &amp; upper; <span class="comment">//新的掩码，来表示哪些字母已经出现过大写和小写</span></span><br><span class="line">        <span class="type">int</span> pos = start;</span><br><span class="line">        <span class="comment">//从pos遍历，分割子字符串，问题不重复</span></span><br><span class="line">        <span class="keyword">while</span>(pos &lt;= end) &#123;</span><br><span class="line">            start = pos; <span class="comment">// 更新start</span></span><br><span class="line">            <span class="keyword">while</span> (pos &lt;= end &amp;&amp; vaild &amp; (<span class="number">1</span> &lt;&lt; (<span class="built_in">tolower</span>(s[pos]) - <span class="string">&#x27;a&#x27;</span>))) &#123; <span class="comment">// 判断pos所指向字母是否完美</span></span><br><span class="line">                ++pos;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="built_in">findLongestSubstring</span>(s, start, pos<span class="number">-1</span>, maxPos, maxlen); <span class="comment">//递归处理子字符串</span></span><br><span class="line">            ++pos;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><div class="note info simple"><ul><li><p>题目关于美好字符串的定义为: 字符串中的每个字母的大写和小写形式同时出现在该字符串中。检测时，由于英文字母 ‘a’−‘z’ 最多只有 26 个, 因此可以利用二进制位来进行标记，lower 标记字符中出现过小写英文字母，upper 标记字符中出现过大写英文字母。如果满足 lower=upper ，我们则认为字符串中所有的字符都满足大小写形式同时出现，则认定该字符串为美好字符串。</p></li><li><p>题目要求如果有多个答案，返回在字符串中最早出现的那个。此时，只需要首先检测从以字符串索引 0 为起始的子字符串。</p></li></ul></div>]]></content>
    
    
    <summary type="html">算法基础知识及相关题目</summary>
    
    
    
    <category term="算法" scheme="https://stack2005.github.io/categories/%E7%AE%97%E6%B3%95/"/>
    
    
    <category term="算法" scheme="https://stack2005.github.io/tags/%E7%AE%97%E6%B3%95/"/>
    
  </entry>
  
  <entry>
    <title>Docker学习（六）：🚚发布和部署</title>
    <link href="https://stack2005.github.io/posts/ca312837.html"/>
    <id>https://stack2005.github.io/posts/ca312837.html</id>
    <published>2025-03-13T16:00:00.000Z</published>
    <updated>2025-03-13T16:00:00.000Z</updated>
    
    <content type="html"><![CDATA[<h2 id="镜像仓库介绍"><a href="#镜像仓库介绍" class="headerlink" title="镜像仓库介绍"></a>镜像仓库介绍</h2><p>镜像仓库用来存储我们 build 出来的“安装包”，Docker 官方提供了一个 <a href="https://hub.docker.com/">镜像库</a>，里面包含了大量镜像，基本各种软件所需依赖都有，要什么直接上去搜索。</p><p>我们也可以把自己 build 出来的镜像上传到 docker 提供的镜像库中，方便传播。<br>当然你也可以搭建自己的私有镜像库，或者使用国内各种大厂提供的镜像托管服务，例如：阿里云、腾讯云</p><h2 id="上传镜像"><a href="#上传镜像" class="headerlink" title="上传镜像"></a>上传镜像</h2><ul><li>在dockerHub创建镜像仓库</li><li><p>命令行登录账号：<br><code>docker login -u username</code></p></li><li><p>新建一个tag，名字必须跟你注册账号一样<br><code>docker tag test:v1 username/test:v1</code></p></li></ul><p>使用<code>test:v1</code>这个镜像创建了<code>username/test:v1</code>这个tag</p><p>然后可以在镜像中发现<code>username/test:v1</code>的镜像</p><ul><li><p>推上去<br><code>docker push username/test:v1</code></p></li><li><p>部署试下<br><code>docker run -dp 8080:8080 username/test:v1</code></p></li></ul><p><strong>docker-compose 中也可以直接用这个镜像了</strong></p><figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">version: <span class="string">&quot;3.7&quot;</span></span><br><span class="line"></span><br><span class="line">services:</span><br><span class="line">  app:</span><br><span class="line"><span class="comment">#    build: ./</span></span><br><span class="line">    image: helloguguji/test:v1</span><br><span class="line">    ports:</span><br><span class="line">      - <span class="number">80</span>:<span class="number">8080</span></span><br><span class="line">    volumes:</span><br><span class="line">      - ./:/app</span><br><span class="line">    environment:</span><br><span class="line">      - TZ=Asia/Shanghai</span><br><span class="line">  redis:</span><br><span class="line">    image: redis:<span class="number">5.0</span>.<span class="number">13</span></span><br><span class="line">    volumes:</span><br><span class="line">      - redis:/data</span><br><span class="line">    environment:</span><br><span class="line">      - TZ=Asia/Shanghai</span><br><span class="line"></span><br><span class="line">volumes:</span><br><span class="line">  redis:</span><br><span class="line"></span><br></pre></td></tr></table></figure>]]></content>
    
    
    <summary type="html">发布和部署</summary>
    
    
    
    <category term="编程基础" scheme="https://stack2005.github.io/categories/%E7%BC%96%E7%A8%8B%E5%9F%BA%E7%A1%80/"/>
    
    
    <category term="Docker" scheme="https://stack2005.github.io/tags/Docker/"/>
    
  </entry>
  
  <entry>
    <title>Docker学习（五）：多容器通信及Docker-Compose</title>
    <link href="https://stack2005.github.io/posts/78db723e.html"/>
    <id>https://stack2005.github.io/posts/78db723e.html</id>
    <published>2025-03-05T16:00:00.000Z</published>
    <updated>2025-03-06T16:00:00.000Z</updated>
    
    <content type="html"><![CDATA[<h2 id="Docker-Network"><a href="#Docker-Network" class="headerlink" title="Docker Network"></a>Docker Network</h2><p>项目往往都不是独立运行的，需要数据库、缓存这些东西配合运作。想要多容器之间互通，则需要创建<code>Docker Network</code>。</p><p>同样先给出官方文档：</p><div calss='anzhiyu-tag-link'><a class="tag-Link" target="_blank" href="https://docs.docker.com/engine/reference/commandline/network/">    <div class="tag-link-tips">引用站外地址</div>    <div class="tag-link-bottom">        <div class="tag-link-left" style="background-image: url(https://bu.dusays.com/2025/03/03/67c59b2d8ca62.png);"></div>        <div class="tag-link-right">            <div class="tag-link-title">Docker Network</div>            <div class="tag-link-sitename">Docker</div>        </div>        <i class="fa-solid fa-angle-right"></i>    </div>    </a></div><h3 id="演示"><a href="#演示" class="headerlink" title="演示"></a>演示</h3><p><strong>创建一个名为<code>test-net</code>的网络：</strong></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker network create test-net</span><br></pre></td></tr></table></figure><p><strong>运行 Redis 在 <code>test-net</code> 网络中，网络别名<code>redis</code></strong></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker run -d --name redis --network test-net --network-alias redis redis:latest</span><br></pre></td></tr></table></figure><p><strong>修改代码中访问<code>redis</code>的地址为网络别名</strong></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> redis = <span class="built_in">require</span>(<span class="string">&#x27;redis&#x27;</span>);</span><br><span class="line"><span class="keyword">let</span> rds = redis.<span class="title function_">createClient</span>(&#123;<span class="attr">url</span>: <span class="string">&quot;redis://redis:6379&quot;</span>&#125;); </span><br><span class="line">rds.<span class="title function_">on</span>(<span class="string">&#x27;connect&#x27;</span>, <span class="function">()=&gt;</span> <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;redis connect ok&#x27;</span>))</span><br><span class="line">rds.<span class="title function_">connect</span>();</span><br></pre></td></tr></table></figure><p>第二行中的url的第二个<code>redis</code>是刚起的网络别名，<code>6379</code>是默认 Redis 端口</p><p><strong>运行 Web 项目，使用同个网络</strong></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker run -p 8080:8080 --name test -v /d/Backup/Documents/GitHub/test-docker:/app --network test-net -d test:v1</span><br></pre></td></tr></table></figure><p><img src="https://bu.dusays.com/2025/03/10/67cedbd3ccca0.png" alt="image-20250310203208573"></p><p><strong>查看数据</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://localhost:8080/redis</span><br></pre></td></tr></table></figure><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">router.<span class="title function_">all</span>(<span class="string">&#x27;/redis&#x27;</span>, <span class="keyword">async</span> ctx =&gt;&#123;</span><br><span class="line"><span class="keyword">let</span> count = <span class="keyword">await</span> rds.<span class="title function_">incr</span>(<span class="string">&quot;count&quot;</span>)</span><br><span class="line">logger.<span class="title function_">info</span>(<span class="string">`on test redis page, count <span class="subst">$&#123;count&#125;</span>`</span>)</span><br><span class="line">ctx.<span class="property">body</span> = <span class="string">`on test redis page, 44 count <span class="subst">$&#123;count&#125;</span> `</span></span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p>这里写了一个没刷新一下页面，自增count这个元素</p><p><img src="https://bu.dusays.com/2025/03/10/67cedc920586e.png" alt="image-20250310203526087"></p><p>打开redis容器的Open in external terminal(或者打开exec界面)，输入<code>redis-cli</code></p><p>输入<code>get count</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">redis-cli</span></span><br><span class="line">127.0.0.1:6379&gt; get count</span><br><span class="line">&quot;7&quot;</span><br></pre></td></tr></table></figure><h2 id="Docker-Compose"><a href="#Docker-Compose" class="headerlink" title="Docker-Compose"></a>Docker-Compose</h2><p>如果项目依赖更多的第三方软件，我们需要管理的容器就更加多，每个都要单独配置运行，指定网络。<br>这时候，我们使用 docker-compose 把项目的多个服务集合到一起，一键运行。</p><div class="note info flat"><ul><li>如果你是安装的桌面版 Docker，不需要额外安装，已经包含了。</li><li>如果是没图形界面的服务器版 Docker，你需要单独安装 安装文档</li></ul><p>运行<code>docker-compose</code>检查是否安装成功</p></div><span class='p red'>要把项目依赖的多个服务集合到一起，我们需要编写一个`docker-compose.yml`文件，描述依赖哪些服务</span><p>参考文档：<a href="https://docs.docker.com/compose/">https://docs.docker.com/compose/</a></p><figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">version: <span class="string">&quot;3.7&quot;</span> <span class="comment"># 指定了 Docker Compose 文件的版本号</span></span><br><span class="line"></span><br><span class="line">services:   <span class="comment"># 要指定的服务</span></span><br><span class="line">  app:          <span class="comment">#服务一：本地的项目</span></span><br><span class="line">    build: ./    <span class="comment">#从当前目录build</span></span><br><span class="line">    ports:       <span class="comment">#暴露端口</span></span><br><span class="line">      - <span class="number">80</span>:<span class="number">8080</span></span><br><span class="line">    volumes:     <span class="comment">#挂载</span></span><br><span class="line">      - ./:/app</span><br><span class="line">    environment:    <span class="comment">#设置环境变量</span></span><br><span class="line">      - TZ=Asia/Shanghai</span><br><span class="line">  redis:         <span class="comment">#服务二：redis</span></span><br><span class="line">    image: redis:<span class="number">5.0</span>.<span class="number">13</span>    <span class="comment">#指定镜像</span></span><br><span class="line">    volumes: </span><br><span class="line">      - redis:/data</span><br><span class="line">    environment:</span><br><span class="line">      - TZ=Asia/Shanghai</span><br><span class="line"></span><br><span class="line">volumes:      </span><br><span class="line">  redis:</span><br></pre></td></tr></table></figure><div class="tabs"><div class="nav-tabs"><button type="button" class="tab active">详细解释</button><button type="button" class="tab">总结</button></div><div class="tab-contents"><div class="tab-item-content active"><details class="folding-tag" green><summary> 详细解释 </summary>              <div class='content'>              <h4 id="1-version-“3-7”"><a href="#1-version-“3-7”" class="headerlink" title="1. version: “3.7”"></a>1. version: “3.7”</h4><ul><li><strong>含义</strong>：这一行指定了 Docker Compose 文件的版本号，这里是 “3.7”。</li><li><strong>作用</strong>：Docker Compose 的不同版本支持不同的语法和功能。使用 “3.7” 确保文件遵循 3.7 版本的规则，并与兼容的 Docker 引擎一起工作。</li></ul><h4 id="2-services"><a href="#2-services" class="headerlink" title="2. services:"></a>2. services:</h4><ul><li><strong>含义</strong>：services 是 Docker Compose 文件的核心部分，用于定义应用程序中的各个服务（每个服务通常对应一个容器）。</li><li><strong>作用</strong>：在这个文件中，定义了两个服务：<code>app</code> 和 <code>redis</code>，分别代表一个自定义应用和一个 Redis 实例。</li></ul><h5 id="a-app-（自定义应用服务）"><a href="#a-app-（自定义应用服务）" class="headerlink" title="a. app:（自定义应用服务）"></a>a. app:（自定义应用服务）</h5><ul><li><code>build: ./</code><ul><li><strong>含义</strong>：指定构建 Docker 镜像的上下文路径，这里是当前目录（<code>./</code>）。</li><li><strong>作用</strong>：Docker Compose 会读取当前目录下的 <code>Dockerfile</code>，根据它构建一个镜像，并用该镜像启动 app 服务容器。</li></ul></li><li><code>ports: - 80:8080</code><ul><li><strong>含义</strong>：将主机的 80 端口映射到容器的 8080 端口，格式为 主机端口:容器端口。</li><li><strong>作用</strong>：允许外部通过主机的 80 端口访问容器内运行在 8080 端口的应用（例如一个 Web 服务）。</li></ul></li><li><code>volumes: - ./:/app</code><ul><li><strong>含义</strong>：将主机的当前目录（<code>./</code>）挂载到容器的 <code>/app</code> 目录。</li><li><strong>作用</strong>：实现主机和容器之间的文件同步，适合开发环境，便于实时更新代码。</li></ul></li><li><code>environment: - TZ=Asia/Shanghai</code><ul><li><strong>含义</strong>：设置容器的环境变量 <code>TZ</code>（时区）为 <code>Asia/Shanghai</code>。</li><li><strong>作用</strong>：确保容器内的应用使用上海时区，避免时间显示错误。</li></ul></li></ul><h5 id="b-redis-（Redis-服务）"><a href="#b-redis-（Redis-服务）" class="headerlink" title="b. redis:（Redis 服务）"></a>b. redis:（Redis 服务）</h5><ul><li><code>image: redis:5.0.13</code><ul><li><strong>含义</strong>：指定使用 Docker Hub 上的官方 Redis 镜像，版本为 5.0.13。</li><li><strong>作用</strong>：Docker Compose 会直接拉取这个镜像并启动 Redis 容器，无需额外的构建过程。</li></ul></li><li><code>volumes: - redis:/data</code><ul><li><strong>含义</strong>：将名为 <code>redis</code> 的卷挂载到容器的 <code>/data</code> 目录。</li><li><strong>作用</strong>：Redis 默认将数据存储在 /data 目录，通过卷挂载可以持久化数据，即使容器重启，数据也不会丢失。</li></ul></li><li><code>environment: - TZ=Asia/Shanghai</code><ul><li><strong>含义</strong>：设置 Redis 容器的时区为 <code>Asia/Shanghai</code>。</li><li><strong>作用</strong>：与 app 服务保持一致，确保时间记录统一。</li></ul></li></ul><h4 id="3-volumes"><a href="#3-volumes" class="headerlink" title="3. volumes:"></a>3. volumes:</h4><ul><li><strong>含义</strong>：定义了 Docker Compose 管理的命名卷。</li><li><strong>作用</strong>：这里定义了一个名为 <code>redis</code> 的卷，供 redis 服务使用，用于持久化存储 Redis 的数据。</li></ul>              </div>            </details></div><div class="tab-item-content"><details class="folding-tag" blue><summary> 总结 </summary>              <div class='content'>              <p>Docker Compose 文件（通常命名为 docker-compose.yml）是用于定义和管理多容器 Docker 应用的配置文件。以下是编写它的基本结构和应该包含的内容：</p><h4 id="基本结构"><a href="#基本结构" class="headerlink" title="基本结构"></a>基本结构</h4><figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">version: <span class="string">&quot;x.x&quot;</span>  <span class="comment"># 指定 Compose 文件版本</span></span><br><span class="line"></span><br><span class="line">services:       <span class="comment"># 定义所有服务</span></span><br><span class="line">  service1:     <span class="comment"># 服务名称</span></span><br><span class="line">    <span class="comment"># 服务配置</span></span><br><span class="line">  service2:</span><br><span class="line">    <span class="comment"># 服务配置</span></span><br><span class="line"></span><br><span class="line">volumes:        <span class="comment"># 定义卷（可选）</span></span><br><span class="line">  volume1:</span><br><span class="line"></span><br><span class="line">networks:       <span class="comment"># 定义网络（可选）</span></span><br><span class="line">  network1:</span><br></pre></td></tr></table></figure><h4 id="应该包含的内容"><a href="#应该包含的内容" class="headerlink" title="应该包含的内容"></a>应该包含的内容</h4><ol><li><p>version</p><ul><li><strong>作用</strong>：指定 Docker Compose 文件的版本号，例如 “3.7”。</li><li><strong>注意</strong>：选择与你的 Docker 引擎版本兼容的版本，不同版本支持的功能不同。</li></ul></li><li><p>services</p><ul><li><p><strong>作用</strong>：定义应用中的各个服务，每个服务对应一个容器。</p></li><li><p>常用配置项</p><p>：</p><ul><li><strong>image</strong>：指定预构建的镜像（如 redis:5.0.13）。</li><li><strong>build</strong>：指定构建镜像的路径（如 ./），需要搭配 Dockerfile。</li><li><strong>ports</strong>：映射端口（如 80:8080），连接主机和容器。</li><li><strong>volumes</strong>：挂载主机目录或卷（如 ./:/app 或 redis:/data），用于文件共享或数据持久化。</li><li><strong>environment</strong>：设置环境变量（如 TZ=Asia/Shanghai），配置服务运行环境。</li><li><strong>depends_on</strong>（可选）：指定服务依赖关系，控制启动顺序。</li><li><strong>networks</strong>（可选）：指定服务连接的网络。</li></ul></li></ul></li><li><p>volumes</p><p>（可选）</p><ul><li><strong>作用</strong>：定义命名卷（如 redis:），用于持久化数据或在容器间共享数据。</li><li><strong>类型</strong>：可以是命名卷（显式定义）或匿名卷（自动生成）。</li></ul></li><li><p>networks</p><p>（可选）</p><ul><li><strong>作用</strong>：定义自定义网络，控制服务之间的通信。</li><li><strong>配置</strong>：可以指定网络驱动（如 bridge）、子网等。</li></ul></li></ol><h4 id="编写建议"><a href="#编写建议" class="headerlink" title="编写建议"></a>编写建议</h4><ul><li><strong>版本选择</strong>：根据你的 Docker 版本选择合适的 Compose 版本（如 “3.7”）。</li><li><strong>服务命名</strong>：使用简洁、有意义的名字，避免与关键字冲突。</li><li><strong>镜像或构建</strong>：需要自定义容器时用 build，否则用 image。</li><li><strong>端口管理</strong>：只映射必要的端口，避免冲突。</li><li><strong>卷使用</strong>：为需要持久化的服务配置卷（如数据库）。</li><li><strong>环境变量</strong>：通过 environment 配置灵活参数，避免硬编码。</li><li><strong>依赖关系</strong>：使用 depends_on 确保服务按顺序启动，但注意它不保证服务完全就绪。</li></ul>              </div>            </details></div></div><div class="tab-to-top"><button type="button" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div><p>在<code>docker-compose.yml</code> 文件所在目录，执行：<code>docker-compose up</code>就可以跑起来了。<br>命令参考：<a href="https://docs.docker.com/compose/reference/up/">https://docs.docker.com/compose/reference/up/</a></p><p><img src="https://bu.dusays.com/2025/03/10/67cee628309b1.png" alt="image-20250310211617063"></p><p><img src="https://bu.dusays.com/2025/03/10/67cee6573a05c.png" alt="image-20250310211707166"></p><p>在后台运行只需要加一个 -d 参数<code>docker-compose up -d</code></p><h3 id="其他命令"><a href="#其他命令" class="headerlink" title="其他命令"></a>其他命令</h3><p>查看运行状态：<code>docker-compose ps</code><br>停止运行：<code>docker-compose stop</code><br>重启：<code>docker-compose restart</code><br>重启单个服务：<code>docker-compose restart service-name</code><br>进入容器命令行：<code>docker-compose exec service-name sh</code><br>查看容器运行log：<code>docker-compose logs [service-name]</code></p>]]></content>
    
    
    <summary type="html">目录挂载和数据卷挂载</summary>
    
    
    
    <category term="编程基础" scheme="https://stack2005.github.io/categories/%E7%BC%96%E7%A8%8B%E5%9F%BA%E7%A1%80/"/>
    
    
    <category term="Docker" scheme="https://stack2005.github.io/tags/Docker/"/>
    
  </entry>
  
  <entry>
    <title>Docker学习（四）：目录挂载和数据卷挂载</title>
    <link href="https://stack2005.github.io/posts/770c643.html"/>
    <id>https://stack2005.github.io/posts/770c643.html</id>
    <published>2025-03-05T16:00:00.000Z</published>
    <updated>2025-03-13T16:00:00.000Z</updated>
    
    <content type="html"><![CDATA[<h2 id="绑定可选项"><a href="#绑定可选项" class="headerlink" title="绑定可选项"></a>绑定可选项</h2><p>官方给出了四种方式：</p><blockquote><p>Docker supports the following types of storage mounts for storing data outside of the writable layer of the container:</p><ul><li><a href="https://docs.docker.com/engine/storage/#volume-mounts">Volume mounts</a></li><li><a href="https://docs.docker.com/engine/storage/#bind-mounts">Bind mounts</a></li><li><a href="https://docs.docker.com/engine/storage/#tmpfs-mounts">tmpfs mounts</a></li><li><a href="https://docs.docker.com/engine/storage/#named-pipes">Named pipes</a></li></ul><p>No matter which type of mount you choose to use, the data looks the same from within the container. It is exposed as either a directory or an individual file in the container’s filesystem.</p></blockquote><p>个人一般只会用到Volume mounts（数据卷挂载）和Bind mounts（目录挂载）</p><p><img src="https://bu.dusays.com/2025/03/07/67ca763fa00c6.png" alt=""></p><h2 id="Volume-mounts"><a href="#Volume-mounts" class="headerlink" title="Volume mounts"></a>Volume mounts</h2><p>先看看官方给出的定义：</p><blockquote><p>Volumes are persistent storage mechanisms managed by the Docker daemon. They retain data even after the containers using them are removed. Volume data is stored on the filesystem on the host, but in order to interact with the data in the volume, you must mount the volume to a container. Directly accessing or interacting with the volume data is unsupported, undefined behavior, and may result in the volume or its data breaking in unexpected ways.</p><p>Volumes are ideal for performance-critical data processing and long-term storage needs. Since the storage location is managed on the daemon host, volumes provide the same raw file performance as accessing the host filesystem directly.</p></blockquote><p>Docker的数据卷是可供一个/多个容器使用的<strong>特殊目录</strong>，其作用和特性如下所示：</p><ul><li>（1）可以在容器之间共享和重用；</li><li>（2）可以被修改，且立即生效；</li><li>（3）对其进行更新，并不影响镜像；</li><li>（4）默认情况下，即使容器被删除了，它也会一直存在</li></ul><div class="note info simple"><p><code>volume</code> 由容器创建和管理，创建在宿主机，所以删除容器不会丢失，官方推荐，更高效，Linux 文件系统，适合存储数据库数据，持久化数据。可挂到多个容器上</p></div><div class="note warning simple"><ul><li>如果需要从主机访问文件，<code>volume</code>不是一个好的选择，因为volume完全由 Docker 管理。如果需要从容器和主机访问文件或目录,使用<code>bind-mounts</code>.</li><li>如果你的容器生成非持久状态数据，请考虑使用 <code>tmpfs mount</code>以避免将数据永久存储在任何地方，并通过避免写入容器的可写层来提高容器的性能。</li></ul></div><h3 id="Syntax"><a href="#Syntax" class="headerlink" title="Syntax"></a>Syntax</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">docker run --mount <span class="built_in">type</span>=volume,src=&lt;volume-name&gt;,dst=&lt;mount-path&gt;</span><br><span class="line">docker run --volume &lt;volume-name&gt;:&lt;mount-path&gt;</span><br></pre></td></tr></table></figure><p>一般情况下， <code>--mount</code>是首选。主要区别在于<code>--mount</code> 标志更加明确，并支持所有可用选项。</p><p><strong>Create a volume:</strong></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker volume create my-vol</span><br></pre></td></tr></table></figure><p><strong>List volumes:</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">docker volume <span class="built_in">ls</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">local</span>               my-vol</span><br></pre></td></tr></table></figure><p><strong>Inspect a volume:</strong> </p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">docker volume inspect my-vol</span><br><span class="line">[</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="string">&quot;Driver&quot;</span>: <span class="string">&quot;local&quot;</span>,</span><br><span class="line">        <span class="string">&quot;Labels&quot;</span>: &#123;&#125;,</span><br><span class="line">        <span class="string">&quot;Mountpoint&quot;</span>: <span class="string">&quot;/var/lib/docker/volumes/my-vol/_data&quot;</span>,</span><br><span class="line">        <span class="string">&quot;Name&quot;</span>: <span class="string">&quot;my-vol&quot;</span>,</span><br><span class="line">        <span class="string">&quot;Options&quot;</span>: &#123;&#125;,</span><br><span class="line">        <span class="string">&quot;Scope&quot;</span>: <span class="string">&quot;local&quot;</span></span><br><span class="line">    &#125;</span><br><span class="line">]</span><br></pre></td></tr></table></figure><p><strong>Remove a volume:</strong> </p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker volume <span class="built_in">rm</span> my-vol</span><br></pre></td></tr></table></figure><p><strong>Start a container with a volume</strong></p><p>如果你启动一个容器，但其中的卷尚不存在，Docker 会为你创建该卷。</p><div class="tabs"><div class="nav-tabs"><button type="button" class="tab active">--mount</button><button type="button" class="tab">-v</button></div><div class="tab-contents"><div class="tab-item-content active"><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">docker run -d \</span><br><span class="line">  --name devtest \</span><br><span class="line">  --mount <span class="built_in">source</span>=myvol2,target=/app \</span><br><span class="line">  nginx:latest</span><br></pre></td></tr></table></figure></div><div class="tab-item-content"><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">docker run -d \</span><br><span class="line">  --name devtest \</span><br><span class="line">  -v myvol2:/app \</span><br><span class="line">  nginx:latest</span><br></pre></td></tr></table></figure></div></div><div class="tab-to-top"><button type="button" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div><p>使用<code>docker inspect devtest</code>验证 Docker 是否创建了卷并正确挂载。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&quot;Mounts&quot;</span>: [</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="string">&quot;Type&quot;</span>: <span class="string">&quot;volume&quot;</span>,</span><br><span class="line">        <span class="string">&quot;Name&quot;</span>: <span class="string">&quot;myvol2&quot;</span>,</span><br><span class="line">        <span class="string">&quot;Source&quot;</span>: <span class="string">&quot;/var/lib/docker/volumes/myvol2/_data&quot;</span>,</span><br><span class="line">        <span class="string">&quot;Destination&quot;</span>: <span class="string">&quot;/app&quot;</span>,</span><br><span class="line">        <span class="string">&quot;Driver&quot;</span>: <span class="string">&quot;local&quot;</span>,</span><br><span class="line">        <span class="string">&quot;Mode&quot;</span>: <span class="string">&quot;&quot;</span>,</span><br><span class="line">        <span class="string">&quot;RW&quot;</span>: <span class="literal">true</span>, </span><br><span class="line">        <span class="string">&quot;Propagation&quot;</span>: <span class="string">&quot;&quot;</span></span><br><span class="line">    &#125;</span><br><span class="line">],</span><br></pre></td></tr></table></figure><p>其他更复杂用法，请查询<a href="https://docs.docker.com/engine/storage/volumes/#a-volumes-lifecycle">官方文档</a></p><h3 id="备份和恢复"><a href="#备份和恢复" class="headerlink" title="备份和恢复"></a>备份和恢复</h3><h4 id="备份和导入-Volume-的流程"><a href="#备份和导入-Volume-的流程" class="headerlink" title="备份和导入 Volume 的流程"></a>备份和导入 Volume 的流程</h4><p>备份：</p><ul><li>运行一个 ubuntu 的容器，挂载需要备份的 volume 到容器，并且挂载宿主机目录到容器里的备份目录。</li><li>运行 tar 命令把数据压缩为一个文件</li><li>把备份文件复制到需要导入的机器</li></ul><p>导入：</p><ul><li>运行 ubuntu 容器，挂载容器的 volume，并且挂载宿主机备份文件所在目录到容器里</li><li>运行 tar 命令解压备份文件到指定目录</li></ul><h4 id="备份-MongoDB-数据演示"><a href="#备份-MongoDB-数据演示" class="headerlink" title="备份 MongoDB 数据演示"></a>备份 MongoDB 数据演示</h4><ul><li>运行一个 mongodb，创建一个名叫<code>mongo-data</code>的 volume 指向容器的 /data 目录<br><code>docker run -p 27018:27017 --name mongo -v mongo-data:/data -d mongo:4.4</code></li><li>运行一个 Ubuntu 的容器，挂载<code>mongo</code>容器的所有 volume，映射宿主机的 backup 目录到容器里面的 /backup 目录，然后运行 tar 命令把数据压缩打包<br><code>docker run --rm --volumes-from mongo -v d:/backup:/backup ubuntu tar cvf /backup/backup.tar /data/</code></li></ul><p>最后你就可以拿着这个 backup.tar 文件去其他地方导入了。</p><h4 id="恢复-Volume-数据演示"><a href="#恢复-Volume-数据演示" class="headerlink" title="恢复 Volume 数据演示"></a>恢复 Volume 数据演示</h4><ul><li>运行一个 ubuntu 容器，挂载 mongo 容器的所有 volumes，然后读取 /backup 目录中的备份文件，解压到 /data/ 目录<br><code>docker run --rm --volumes-from mongo -v d:/backup:/backup ubuntu bash -c &quot;cd /data/ &amp;&amp; tar xvf /backup/backup.tar --strip 1&quot;</code></li></ul><div class="note danger simple"><ul><li><p>注意，<code>volumes-from</code> 指定的是容器名字</p></li><li><p><code>strip 1</code> 表示解压时去掉前面1层目录，因为压缩时包含了绝对路径</p></li></ul></div><h2 id="Bind-mounts"><a href="#Bind-mounts" class="headerlink" title="Bind mounts"></a>Bind mounts</h2><p>同样先看一下官方定义：</p><blockquote><p>Bind mounts create a direct link between a host system path and a container, allowing access to files or directories stored anywhere on the host. Since they aren’t isolated by Docker, both non-Docker processes on the host and container processes can modify the mounted files simultaneously.</p><p>Use bind mounts when you need to be able to access files from both the container and the host.</p></blockquote><p>目录挂载适用于：</p><ul><li>在 Docker 主机和容器上的开发环境之间共享源代码或构建工件。</li><li>在容器中创建或生成文件并将文件保存到主机的文件系统中时。</li><li>将配置文件从主机共享到容器。</li></ul><div class="note warning simple"><p>如果将挂载文件或目录绑定到容器中存在文件或目录的目录中，则挂载会遮盖预先存在的文件。而且绑定挂载依赖于主机文件系统是否具有可用的特定目录结构。也就是说，适用于主机目录有源代码的情况。</p></div><h3 id="Syntax-1"><a href="#Syntax-1" class="headerlink" title="Syntax"></a>Syntax</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">docker run --mount <span class="built_in">type</span>=<span class="built_in">bind</span>,src=&lt;host-path&gt;,dst=&lt;container-path&gt;</span><br><span class="line">docker run --volume &lt;host-path&gt;:&lt;container-path&gt;</span><br></pre></td></tr></table></figure><div class="note warning simple"><p>对于<code>-v</code>,</p><p><code>bind mount</code> 方式用<strong>绝对路径</strong> <code>-v D:/code:/app</code><br><code>volume</code> 方式，只需要一个<strong>名字</strong> <code>-v db-data:/app</code></p></div><div class="note warning simple"><p>Windows下目录为反斜杠<code>\</code>,为了与 Docker 基于 Unix 的内部结构保持一致，最好使用正斜杠 <code>/</code>,路径风格应使用 <strong>POSIX 风格</strong>。</p><p>例如，你的主机目录为<code>D:\Backup\Documents\GitHub\test-docker</code>,应该在参数填<code>/d/Backup/Documents/GitHub/test-docker</code></p></div><div class="note danger simple"><p>对于Windows系统，需要docker dsktop 开放File sharing，<span class="hide-inline"><button type="button" class="hide-button" style="">查看设置方法</button><span class="hide-content">到setting-&gt;general 去掉勾选 use the wsl2base engine选项</span>&lt;/span&gt;</p></div><p>如果使用<code>--volume</code>绑定挂载 Docker 主机上尚不存在的文件或目录，Docker 会自动在主机上为您创建目录。</p><p>如果主机上不存在指定的挂载路径， <code>--mount</code>不会自动创建目录。相反，它会产生一个错误：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">docker run --mount <span class="built_in">type</span>=<span class="built_in">bind</span>,src=/dev/noexist,dst=/mnt/foo alpine</span><br><span class="line">docker: Error response from daemon: invalid mount config <span class="keyword">for</span> <span class="built_in">type</span> <span class="string">&quot;bind&quot;</span>: <span class="built_in">bind</span> <span class="built_in">source</span> path does not exist: /dev/noexist.</span><br></pre></td></tr></table></figure>]]></content>
    
    
    <summary type="html">目录挂载和数据卷挂载</summary>
    
    
    
    <category term="编程基础" scheme="https://stack2005.github.io/categories/%E7%BC%96%E7%A8%8B%E5%9F%BA%E7%A1%80/"/>
    
    
    <category term="Docker" scheme="https://stack2005.github.io/tags/Docker/"/>
    
  </entry>
  
  <entry>
    <title>软件设计哲学：三个理念</title>
    <link href="https://stack2005.github.io/posts/f248899a.html"/>
    <id>https://stack2005.github.io/posts/f248899a.html</id>
    <published>2025-03-05T16:00:00.000Z</published>
    <updated>2025-03-05T16:00:00.000Z</updated>
    
    <content type="html"><![CDATA[<p>The book named <em>“A Philosophy of Software Design” by John Ousterhout</em>  is pretty packed with insights.</p><h2 id="Idea-1-Zero-tolerance-towards-complexity"><a href="#Idea-1-Zero-tolerance-towards-complexity" class="headerlink" title="Idea 1: Zero-tolerance towards complexity"></a>Idea 1: Zero-tolerance towards complexity</h2><blockquote><p>On the second chapter of the book, the author describes what is complexity and what are its symptoms:</p><ul><li><strong>Change amplification</strong>: a simple change requires changes in many different places.</li><li><strong>Cognitive load</strong>: the developer needs to learn a lot to complete a task.</li><li><strong>Unknown unknowns</strong>: it is not obvious which pieces of code need to change to complete a task.</li></ul><p>The author argues that complexity is not caused by a single error, it accumulates. Sometimes we convince ourselves that a bit of complexity here won’t matter much, but if everyone on the project adopts this mindset, the project will become complex rapidly.</p><p>“In order to slow the growth of complexity, you must adopt a zero-tolerance philosophy”.</p></blockquote><div class="note info simple"><p>复杂性的三个症状：</p><ul><li>一个简单的变化需要改动不同的地方</li><li>开发人员需要学习很多东西才能完成这个程序</li><li>不清楚要改哪些代码才能完成任务</li></ul></div><h3 id="Example"><a href="#Example" class="headerlink" title="Example"></a>Example</h3><blockquote><p>Imagine a simple order processing system where you calculate shipping costs, and apply discounts. However, this system is poorly designed with duplicated logic across multiple services, leading to change amplification. Let’s say both the <code>CheckoutService</code> and the <code>ShippingService</code> use the same logic to calculate discounts, but it’s implemented separately in both places.</p><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">CheckoutService</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="built_in">decimal</span> <span class="title">CalculateTotal</span>(<span class="params">Order order</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">decimal</span> total = order.Items.Sum(item =&gt; item.Price);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// Apply discount logic</span></span><br><span class="line">        <span class="keyword">if</span> (order.CouponCode == <span class="string">&quot;SUMMER2024&quot;</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            total -= <span class="number">10</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> total;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">ShippingService</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="built_in">decimal</span> <span class="title">CalculateShipping</span>(<span class="params">Order order</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">decimal</span> shippingCost = order.ShippingAddress.Country == <span class="string">&quot;US&quot;</span> ? <span class="number">5</span> : <span class="number">15</span>;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// Apply discount logic (duplicated)</span></span><br><span class="line">        <span class="keyword">if</span> (order.CouponCode == <span class="string">&quot;SUMMER2024&quot;</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            shippingCost -= <span class="number">10</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> shippingCost;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure></blockquote><h3 id="Why-is-it-bad"><a href="#Why-is-it-bad" class="headerlink" title="Why is it bad?"></a>Why is it bad?</h3><blockquote><ul><li><strong>Change Amplification</strong>: If you want to modify how discounts are applied (e.g., introduce a new discount or change the criteria), you have to modify both <code>CheckoutService</code> and <code>ShippingService</code>.</li><li><strong>Cognitive Load</strong>: Developers must remember to update every part of the system that touches discounts. Forgetting to update one part (e.g., missing it in <code>ShippingService</code>) will lead to inconsistent behavior.</li><li><strong>Unknown Unknowns</strong>: If a new developer is tasked with updating the discount logic, they may not know that the same discount logic exists in multiple places. They might update one but miss the other, causing a bug in shipping cost calculations.</li></ul></blockquote><h3 id="How-to-improve-it"><a href="#How-to-improve-it" class="headerlink" title="How to improve it?"></a>How to improve it?</h3><blockquote><p>We can refactor the system to eliminate duplicated logic by encapsulating the discount logic in its own class. This way, if the discount logic changes, you only need to modify one place, reducing overall complexity.</p><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">DiscountService</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="built_in">decimal</span> <span class="title">ApplyDiscount</span>(<span class="params">Order order, <span class="built_in">decimal</span> total</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (order.CouponCode == <span class="string">&quot;SUMMER2024&quot;</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">return</span> total - <span class="number">10</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> total;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">CheckoutService</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">readonly</span> DiscountService _discountService;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">CheckoutService</span>(<span class="params">DiscountService discountService</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        _discountService = discountService;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="built_in">decimal</span> <span class="title">CalculateTotal</span>(<span class="params">Order order</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">decimal</span> total = order.Items.Sum(item =&gt; item.Price);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// Apply discount through centralized service</span></span><br><span class="line">        total = _discountService.ApplyDiscount(order, total);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> total;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">ShippingService</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">readonly</span> DiscountService _discountService;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">ShippingService</span>(<span class="params">DiscountService discountService</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        _discountService = discountService;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="built_in">decimal</span> <span class="title">CalculateShipping</span>(<span class="params">Order order</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">decimal</span> shippingCost = order.ShippingAddress.Country == <span class="string">&quot;US&quot;</span> ? <span class="number">5</span> : <span class="number">15</span>;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// Apply discount through centralized service</span></span><br><span class="line">        shippingCost = _discountService.ApplyDiscount(order, shippingCost);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> shippingCost;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>To summarize, in the first example, we saw change amplification where a simple change to discount logic required modifying multiple services. By centralizing the logic in <code>DiscountService</code>, we eliminate this duplication, making it easier to maintain and evolve the system.</p></blockquote><div class="note info simple"><p>如上述的例子，通过将重复的逻辑封装在自己的类里，修改时只需修改一个地方就好了，使维护和改进系统变得更加容易。</p></div><h2 id="Idea-2-Smaller-components-are-not-necessarily-better-for-modularity"><a href="#Idea-2-Smaller-components-are-not-necessarily-better-for-modularity" class="headerlink" title="Idea 2: Smaller components are not necessarily better for modularity"></a>Idea 2: Smaller components are not necessarily better for modularity</h2><blockquote><p>“Given two pieces of functionality, should they be implemented together, or should their implementations be separated?” - This question was chapter’s 9 focus.</p><p>The author argues, while keeping in mind reducing the system’s complexity is our goal, that smaller components are not necessarily better for modularity, and mentions a few cons of splitting out functionality across more components:</p><ul><li>“Some complexity comes just from the number of components”</li><li>“Subdivision can result in additional code to manage the components”</li><li>“Separation makes it harder for developers to see the components at the same time, or even to be aware of their existence.”</li><li>“Subdivision can result in duplication”</li></ul><p>The author also offers a few indications that two pieces of code should be merged.</p><ul><li>“They share information.”</li><li>“They are used together”, this has to be bidirectional. For example, if whenever I use method A, I always use method B and vice versa, then the methods should be merged.</li><li>“They overlap conceptually, in that there is a simple higher-level category that includes both of the pieces of code”</li><li>“It is hard to understand one of the pieces of code without looking at the other.”</li></ul><p>The author mentions the common “clean tip”: “Split up any method longer than X lines.” He adds that “length by itself is rarely a good reason for splitting up a method.” […] Splitting up a method introduces additional interfaces, which add to complexity. […] You shouldn’t break up a method unless it makes the overall system simpler”.</p></blockquote><div class="note info simple"><p><strong>更小的组件并不一定更有利于模板化</strong>。“给定两个功能，应该一起实现它们，还是应该分开实现？”</p><p><em>过小的组件划分的缺点：</em></p><ul><li>组件的数量会提升复杂性</li><li>细分可能会导致额外的代码来管理</li><li>细分可能会导致重复的代码</li></ul><p><em>两段代码应合并的迹象：</em></p><ul><li>共享同一信息</li><li>总是一起使用（例如，如果我每次使用方法 A，我都会使用方法 B，反之亦然，那么这些方法应该合并）</li><li>如果不看另一段代码就很难理解其中一段代码</li><li>它们在概念上重叠，因为有一个简单的高级类别，包含这两部分代码</li></ul><p>长度本身很少是拆分方法的充分理由。拆分方法会引入额外的接口，这会增加复杂性。除非拆分方法可以使整个系统更简单，否则不应拆分方法</p></div><h3 id="Example-1"><a href="#Example-1" class="headerlink" title="Example"></a>Example</h3><blockquote><p>In this example, let’s say we have a user registration process in a system. The developer has over-split the logic into multiple methods, separating each step of the registration, such as validating the user, saving the user to the database, and sending a welcome email. While each method is doing its own thing, they all share information and are conceptually related. This over-splitting leads to unnecessary complexity and overhead.</p><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">UserService</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="built_in">bool</span> <span class="title">ValidateUser</span>(<span class="params">User user</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="built_in">string</span>.IsNullOrEmpty(user.Email))</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> ArgumentException(<span class="string">&quot;Email is required.&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">SaveUserToDatabase</span>(<span class="params">User user</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        Database.Save(user);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">SendWelcomeEmail</span>(<span class="params">User user</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        EmailService.Send(<span class="string">&quot;Welcome to our platform!&quot;</span>, user.Email);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">RegisterUser</span>(<span class="params">User user</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (ValidateUser(user))</span><br><span class="line">        &#123;</span><br><span class="line">            SaveUserToDatabase(user);</span><br><span class="line">            SendWelcomeEmail(user);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></blockquote><h3 id="Why-is-it-bad-1"><a href="#Why-is-it-bad-1" class="headerlink" title="Why is it bad?"></a>Why is it bad?</h3><blockquote><ul><li><strong>Unnecessary Subdivision</strong>: The <code>ValidateUser</code>, <code>SaveUserToDatabase</code>, and <code>SendWelcomeEmail</code> methods are too granular and are always used together in a strict sequence. Splitting these steps adds unnecessary interfaces to the system without offering any real flexibility.</li><li><strong>Increased Cognitive Load</strong>: The developer now has to mentally track multiple methods, which are tightly related but unnecessarily split apart. This subdivision introduces unnecessary complexity in understanding the registration process.</li><li><strong>Information Overlap</strong>: All three methods are directly related to the user registration process. They share the same user object and are always invoked together. It’s hard to reason about one step in the process without considering the others.</li></ul></blockquote><div class="note info simple"><p>如上述的例子：</p><ul><li><code>ValidateUser</code> 、 <code>SaveUserToDatabase</code>和<code>SendWelcomeEmail</code>方法过于细化，并且始终按照严格的顺序一起使用。拆分这些步骤会给系统添加不必要的接口，而不会提供任何实际灵活性。</li><li>开发人员现在必须在脑中追踪多个方法，这些方法紧密相关，但又不必要地被分开。这种细分为理解注册过程带来了不必要的复杂性。</li><li>这三种方法都与用户注册过程直接相关。它们共享同一个用户对象，并且总是一起调用。如果不考虑其他步骤，很难推断出过程中的某一步骤。</li></ul></div><h3 id="How-to-improve-it-1"><a href="#How-to-improve-it-1" class="headerlink" title="How to improve it?"></a>How to improve it?</h3><blockquote><p>Simple, in that case we simply can “inline” the methods, like the following</p><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">UserService</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">RegisterUser</span>(<span class="params">User user</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="built_in">string</span>.IsNullOrEmpty(user.Email))</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> ArgumentException(<span class="string">&quot;Email is required.&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        Database.Save(user);</span><br><span class="line"></span><br><span class="line">        EmailService.Send(<span class="string">&quot;Welcome to our platform!&quot;</span>, user.Email);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure><p>To summarize, splitting up functionality just for the sake of making smaller methods can actually add complexity, as shown in the first example. By merging related steps that share information and are always used together, we reduce subdivision overhead, simplify the interface, and make the code easier to understand and maintain.</p></blockquote><h2 id="Idea-3-Exception-handling-accounts-for-a-lot-of-complexity"><a href="#Idea-3-Exception-handling-accounts-for-a-lot-of-complexity" class="headerlink" title="Idea 3: Exception handling accounts for a lot of complexity"></a>Idea 3: Exception handling accounts for a lot of complexity</h2><blockquote><p>In chapter 10 the author argues that “Exception handling is one of the worst sources of complexity in software systems.”.</p><p>There are two ways to handle exceptions:</p><ul><li>Try to complete the work in progress (i.e., network packet lost? Resend; data corrupted? Recover from snapshot).</li><li>Abort the operation and pass the exception upward.</li></ul><p>The author mentions that aborting can add much more complexity. For example, if a data structure has been partially initialized, then an exception occurs - “The exception handling code must restore consistency, such as by unwinding any changes made before the exception occurred.”</p><p>The author notes how easy and tempting it is to throw an exception and let the caller handle it. He argues that, as the developer of a certain method, if you are having trouble handling a certain exception, there’s a good chance the caller won’t know how to deal with it either.</p><p>“The best way to reduce the complexity damage caused by exception handling is to reduce the number of places where exceptions have to be handled.”</p><p>From here, the author shares a few techniques on how to reduce the number of exception handlers.</p><ul><li>Define errors out of existence - “The best way to eliminate exception handling complexity is to define your APIs so that there are no exceptions to handle.” As an example, we can look at how file deletion is done on Windows compared to Linux. If you want to delete a file and it is open in another process, you will get an exception; you can’t perform the operation. In Linux, we can delete an open file - since we mark it for deletion at first.</li><li>Mask exceptions - “An exceptional condition is detected and handled at a low level in the system so that higher levels of software need not be aware of the condition.” For example, TCP masks packet loss by resending packets. So, higher-level software doesn’t need to know about the lost packets. It is guaranteed to have all packets.</li><li>Exception aggregation - “The idea behind exception aggregation is to handle many exceptions with a single piece of code; rather than writing distinct handlers for many individual exceptions, handle them all in one place with a single handler.”</li></ul></blockquote><div class="note info simple"><p><strong>减少异常处理造成的复杂性损害的最佳方法是减少需要处理异常的地方的数量。</strong></p><p>如何减少处理异常的地方的数量呢？</p><ul><li>将错误定义得不存在。消除异常处理复杂性的最佳方法是定义 API，以便没有异常需要处理（比较Windows 和 Linux 上的文件删除方式：如果你想删除一个文件，而该文件在另一个进程中打开，你将收到异常：你无法执行该操作。在 Linux 中，我们可以删除一个打开的文件 ，因为我们首先将其标记为删除。）</li><li>屏蔽异常。在系统的低层检测和处理异常情况，这样较高级别的软件就无需了解该情况</li><li>异常聚合。不是为许多单独的异常编写不同的处理程序，而是用一个处理程序在一个地方处理它们</li></ul></div><h3 id="Example-例子"><a href="#Example-例子" class="headerlink" title="Example 例子"></a>Example 例子</h3><blockquote><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">FileProcessor</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">ProcessFile</span>(<span class="params"><span class="built_in">string</span> filePath</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">try</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">var</span> config = ReadConfigFile(filePath);</span><br><span class="line">            <span class="keyword">var</span> processedData = ProcessData(config);</span><br><span class="line">            WriteDataToFile(processedData, filePath);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">catch</span> (FileNotFoundException ex)</span><br><span class="line">        &#123;</span><br><span class="line">            Console.WriteLine(<span class="string">$&quot;Config file not found: <span class="subst">&#123;ex.Message&#125;</span>&quot;</span>);</span><br><span class="line">            <span class="keyword">throw</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">catch</span> (IOException ex)</span><br><span class="line">        &#123;</span><br><span class="line">            Console.WriteLine(<span class="string">$&quot;I/O error: <span class="subst">&#123;ex.Message&#125;</span>&quot;</span>);</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> ApplicationException(<span class="string">&quot;I/O failure during file processing&quot;</span>, ex);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">catch</span> (Exception ex)</span><br><span class="line">        &#123;</span><br><span class="line">            Console.WriteLine(<span class="string">$&quot;Unexpected error: <span class="subst">&#123;ex.Message&#125;</span>&quot;</span>);</span><br><span class="line">            <span class="keyword">throw</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> Config <span class="title">ReadConfigFile</span>(<span class="params"><span class="built_in">string</span> filePath</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (!File.Exists(filePath))</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> FileNotFoundException(<span class="string">&quot;The configuration file was not found.&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> Config(filePath);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">WriteDataToFile</span>(<span class="params">ProcessedData data, <span class="built_in">string</span> filePath</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">try</span></span><br><span class="line">        &#123;</span><br><span class="line">            File.WriteAllText(filePath, data.ToString());</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">catch</span> (IOException ex)</span><br><span class="line">        &#123;</span><br><span class="line">            Console.WriteLine(<span class="string">&quot;Failed to write file&quot;</span>);</span><br><span class="line">            <span class="keyword">throw</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure></blockquote><h3 id="Why-is-it-bad-2"><a href="#Why-is-it-bad-2" class="headerlink" title="Why is it bad?"></a>Why is it bad?</h3><blockquote><ul><li><strong>Too Many Exception Handlers</strong>: There are multiple try-catch blocks in various parts of the code, which introduces duplication and complexity. Each method has its own error-handling logic, and exceptions are passed upwards without properly addressing the core issue.</li><li><strong>Aborting Too Much</strong>: The <code>ProcessFile</code> method passes the responsibility of handling certain exceptions (like <code>FileNotFoundException</code>) back to the caller, increasing complexity. A caller may not know how to handle these errors, and passing them upwards creates more handlers across the system.</li></ul></blockquote><h3 id="Fix-1-Define-Errors-Out-of-Existence"><a href="#Fix-1-Define-Errors-Out-of-Existence" class="headerlink" title="Fix 1: Define Errors Out of Existence"></a>Fix 1: Define Errors Out of Existence</h3><blockquote><p>The first technique is to design the system to avoid exceptions altogether. Instead of throwing exceptions for things like missing files, we can redesign the <code>ReadConfigFile</code> method to treat the absence of a file as a normal condition, not an exceptional one.</p><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">private</span> Config <span class="title">ReadConfigFile</span>(<span class="params"><span class="built_in">string</span> filePath</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">if</span> (!File.Exists(filePath))</span><br><span class="line">    &#123;</span><br><span class="line">        Console.WriteLine(<span class="string">&quot;Config file not found, using default settings.&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> Config.GetDefaultConfig();  <span class="comment">// Default behavior instead of exception</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> Config(filePath);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure></blockquote><h4 id="Why-is-it-better"><a href="#Why-is-it-better" class="headerlink" title="Why is it better?"></a>Why is it better?</h4><blockquote><ul><li><strong>No Exception Handling Needed</strong>: We avoid throwing <code>FileNotFoundException</code> entirely by defining the absence of a config file as an acceptable condition, with a default fallback.</li><li><strong>Simplified Code</strong>: The caller doesn’t need to handle missing files—it simply gets a default configuration when no file is found.</li></ul></blockquote><div class="note info simple"><p><strong>无需异常处理</strong>：我们通过将配置文件的缺失定义为可接受条件并使用默认后备，完全避免抛出<code>FileNotFoundException</code></p><p><strong>简化代码</strong>：调用者不需要处理丢失的文件 - 当找不到文件时它只会获取默认配置。</p></div><h3 id="Fix-2-Mask-Exceptions"><a href="#Fix-2-Mask-Exceptions" class="headerlink" title="Fix 2: Mask Exceptions"></a>Fix 2: Mask Exceptions</h3><blockquote><p>Next, we handle lower-level exceptions internally so that higher levels don’t need to worry about them. This is commonly used for network failures, file I/O, or similar situations where retrying or fallback mechanisms can mask the issue.</p><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">WriteDataToFile</span>(<span class="params">ProcessedData data, <span class="built_in">string</span> filePath</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">// Mask exceptions: Retry writing the file instead of throwing an exception</span></span><br><span class="line">    <span class="built_in">int</span> retryCount = <span class="number">3</span>;</span><br><span class="line">    <span class="keyword">while</span> (retryCount &gt; <span class="number">0</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">try</span></span><br><span class="line">        &#123;</span><br><span class="line">            File.WriteAllText(filePath, data.ToString());</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">catch</span> (IOException)</span><br><span class="line">        &#123;</span><br><span class="line">            retryCount--;</span><br><span class="line">            <span class="keyword">if</span> (retryCount == <span class="number">0</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                Console.WriteLine(<span class="string">&quot;Failed to write after retries. Aborting.&quot;</span>);</span><br><span class="line">                <span class="comment">// Depending on the system requirements, you might have to throw</span></span><br><span class="line">                <span class="comment">// an exception here as the issue was not transient,</span></span><br><span class="line">                <span class="comment">// or for example save the data to a tmp file, </span></span><br><span class="line">                <span class="comment">// then try to write it to filePath at a later stage.</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure></blockquote><h4 id="Why-is-it-better-1"><a href="#Why-is-it-better-1" class="headerlink" title="Why is it better?"></a>Why is it better?</h4><blockquote><ul><li><strong>Retries with Masking</strong>: We attempt to retry the file write operation up to three times. This masks the <code>IOException</code> for transient errors (such as temporary file system issues), meaning higher-level code won’t need to worry about these exceptions.</li></ul></blockquote><div class="note info simple"><p><strong>屏蔽并重试</strong>：我们最多尝试重试三次文件写入操作。这会屏蔽瞬时错误（例如临时文件系统问题）的<code>IOException</code> ，这意味着更高级别的代码无需担心这些异常。</p></div><h3 id="Fix-3-Exception-Aggregation"><a href="#Fix-3-Exception-Aggregation" class="headerlink" title="Fix 3: Exception Aggregation"></a>Fix 3: Exception Aggregation</h3><blockquote><p>Instead of writing separate exception handlers for every possible error, we can aggregate exceptions and handle them in one place. This avoids duplicating exception handling logic.</p><p>Given that we still throw <code>IOException</code>, here’s how you might want to aggregate the exceptions.</p><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">ProcessFile</span>(<span class="params"><span class="built_in">string</span> filePath</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">try</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">var</span> config = ReadConfigFile(filePath);</span><br><span class="line">        <span class="keyword">var</span> processedData = ProcessData(config);</span><br><span class="line">        WriteDataToFile(processedData, filePath);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">catch</span> (IOException ex) <span class="keyword">when</span> (ex <span class="keyword">is</span> FileNotFoundException || ex <span class="keyword">is</span> UnauthorizedAccessException)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">// Aggregated exception handler for all I/O-related exceptions</span></span><br><span class="line">        Console.WriteLine(<span class="string">$&quot;I/O failure: <span class="subst">&#123;ex.Message&#125;</span>&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">catch</span> (Exception ex)</span><br><span class="line">    &#123;</span><br><span class="line">        Console.WriteLine(<span class="string">$&quot;Unexpected error: <span class="subst">&#123;ex.Message&#125;</span>&quot;</span>);</span><br><span class="line">        <span class="keyword">throw</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure></blockquote><h4 id="Why-is-it-better-2"><a href="#Why-is-it-better-2" class="headerlink" title="Why is it better?"></a>Why is it better?</h4><blockquote><ul><li><strong>Aggregated Exceptions</strong>: We handle all <code>IOException</code>-related errors (such as file not found or access denied) in a single handler, avoiding duplicated error-handling logic.</li><li><strong>Simpler Code</strong>: Instead of writing multiple catch blocks, we handle multiple related exceptions in one place, reducing the number of handlers.</li></ul></blockquote><div class="note info simple"><p><strong>聚合异常</strong>：我们在单个处理程序中处理所有与<code>IOException</code>相关的错误（例如找不到文件或拒绝访问），避免重复的错误处理逻辑。</p><p><strong>更简单的代码</strong>：我们不需要编写多个 catch 块，而是在一个地方处理多个相关异常，从而减少了处理程序的数量。</p></div>]]></content>
    
    
    <summary type="html">Ideas from &quot;A Philosophy of Software Design&quot;</summary>
    
    
    
    <category term="编程基础" scheme="https://stack2005.github.io/categories/%E7%BC%96%E7%A8%8B%E5%9F%BA%E7%A1%80/"/>
    
    
    <category term="软件设计" scheme="https://stack2005.github.io/tags/%E8%BD%AF%E4%BB%B6%E8%AE%BE%E8%AE%A1/"/>
    
  </entry>
  
  <entry>
    <title>Go的内存分配机制</title>
    <link href="https://stack2005.github.io/posts/5c903a76.html"/>
    <id>https://stack2005.github.io/posts/5c903a76.html</id>
    <published>2025-03-04T16:00:00.000Z</published>
    <updated>2025-03-04T16:00:00.000Z</updated>
    
    <content type="html"><![CDATA[<h2 id="内存分配概述"><a href="#内存分配概述" class="headerlink" title="内存分配概述"></a>内存分配概述</h2><p>Go 语言的设计哲学是将内存管理的复杂性交给编译器和运行时，开发者无需手动指定变量的分配位置。这种自动管理基于栈和堆的分配，结合逃逸分析来决定变量的存储位置。</p><h2 id="栈与堆的内存管理"><a href="#栈与堆的内存管理" class="headerlink" title="栈与堆的内存管理"></a>栈与堆的内存管理</h2><p>Go 的内存模型将内存分为栈和堆两种区域：</p><ul><li><strong>栈</strong>：每个 goroutine 初始化时分配一个栈，用于存储函数调用栈帧，包括局部变量和参数。栈的内存管理是自动的，函数返回时栈帧被弹出，内存立即回收。栈分配的优点是速度快，适合短生命周期的数据。</li><li><strong>堆</strong>：堆是程序全局共享的内存区域，用于存储需要持久化或跨 goroutine 访问的数据。堆内存的分配和回收由垃圾回收器（GC）管理，采用并发三色标记-清除算法，确保内存高效回收，但可能因 GC 暂停而影响性能。</li></ul><h2 id="逃逸分析的原理与实现"><a href="#逃逸分析的原理与实现" class="headerlink" title="逃逸分析的原理与实现"></a>逃逸分析的原理与实现</h2><p>逃逸分析是 Go 编译器的一个关键优化技术，旨在减少不必要的堆分配。其核心思想是分析变量的动态作用域，判断是否需要分配到堆上：</p><ul><li><strong>不逃逸的变量</strong>：如果变量仅在定义它的函数内部使用，且其引用不会被返回或传递到外部，编译器会将其分配在栈上。例如：</li></ul><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">foo</span><span class="params">()</span></span> &#123;</span><br><span class="line">    x := <span class="number">42</span></span><br><span class="line">    fmt.Println(x)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>这里 x 不逃逸，分配在栈上。</p><ul><li><strong>逃逸的变量</strong>：如果变量的引用被返回、传递给其他函数或捕获在闭包中，编译器会将其分配在堆上。例如：</li></ul><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">bar</span><span class="params">()</span></span> *<span class="type">int</span> &#123;</span><br><span class="line">    x := <span class="number">42</span></span><br><span class="line">    <span class="keyword">return</span> &amp;x</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>这里 <code>x</code> 的指针被返回，逃逸到堆上。</p><h2 id="实例"><a href="#实例" class="headerlink" title="实例"></a>实例</h2><p>以下是常见场景的分配行为：</p><ul><li><strong>切片和映射</strong>：使用 make([]int, 10) 创建的切片，如果返回或传递给其他函数，其底层数组通常分配在堆上。例如：</li></ul><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">baz</span><span class="params">()</span></span> []<span class="type">int</span> &#123;</span><br><span class="line">    s := <span class="built_in">make</span>([]<span class="type">int</span>, <span class="number">10</span>)</span><br><span class="line">    <span class="keyword">return</span> s</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>这里 <code>s</code> 逃逸，分配在堆上。</p><ul><li><strong>局部变量</strong>：如果局部变量未被引用外部，分配在栈上。例如：</li></ul><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">local</span><span class="params">()</span></span> &#123;</span><br><span class="line">    y := <span class="number">42</span></span><br><span class="line">    fmt.Println(y)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>y</code>不逃逸，分配在栈上。</p><h2 id="性能影响与优化"><a href="#性能影响与优化" class="headerlink" title="性能影响与优化"></a>性能影响与优化</h2><p>栈分配比堆分配更高效，因为栈操作是 O(1)，而堆分配涉及更复杂的内存管理（如 tcmalloc 算法）和 GC 开销。Go 的内存分配器基于 tcmalloc，优化了多线程场景下的锁竞争，但堆分配仍可能因 GC 暂停影响性能。</p><div class="note success simple"><p><strong>减少逃逸</strong>：避免不必要的指针返回，优先使用值传递。例如，使用 <code>func(x int)</code> 而非 <code>func(*int)</code>。</p><p><strong>对象池</strong>：利用 <code>sync.Pool</code>复用对象，减少频繁的堆分配。例如：</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> pool = sync.Pool&#123;</span><br><span class="line">    New: <span class="function"><span class="keyword">func</span><span class="params">()</span></span> <span class="keyword">interface</span>&#123;&#125; &#123; <span class="keyword">return</span> <span class="built_in">make</span>([]<span class="type">int</span>, <span class="number">0</span>, <span class="number">10</span>) &#125;,</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>]]></content>
    
    
    <summary type="html">介绍Go的内存分配机制，认识逃逸机制的设计</summary>
    
    
    
    <category term="编程基础" scheme="https://stack2005.github.io/categories/%E7%BC%96%E7%A8%8B%E5%9F%BA%E7%A1%80/"/>
    
    
    <category term="Go" scheme="https://stack2005.github.io/tags/Go/"/>
    
  </entry>
  
  <entry>
    <title>文盲程序员：思考依赖性</title>
    <link href="https://stack2005.github.io/posts/d8e577bf.html"/>
    <id>https://stack2005.github.io/posts/d8e577bf.html</id>
    <published>2025-03-02T16:00:00.000Z</published>
    <updated>2025-03-02T16:00:00.000Z</updated>
    
    <content type="html"><![CDATA[<p>​    2025年1月24日，一名叫做neo的作者，在他的博客写了一篇文章：AI is Creating a Generation of Illiterate Programmers。文章立刻在全网引起了轰动，很抱歉我到现在才发现了这篇文章。</p><p>​    <div calss='anzhiyu-tag-link'><a class="tag-Link" target="_blank" href="https://nmn.gl/blog/ai-illiterate-programmers ">    <div class="tag-link-tips">引用站外地址</div>    <div class="tag-link-bottom">        <div class="tag-link-left" style="background-image: url(https://bu.dusays.com/2025/03/03/67c59b2d8ca62.png);"></div>        <div class="tag-link-right">            <div class="tag-link-title">AI is Creating a Generation of Illiterate Programmers</div>            <div class="tag-link-sitename">neo</div>        </div>        <i class="fa-solid fa-angle-right"></i>    </div>    </a></div></p><p>​    文章写到：</p><blockquote><p>It crept up on me <em>subtly</em>.</p><p>First, I stopped reading documentation. Why bother when AI could explain things instantly?</p><p>Then, my debugging skills took the hit. Stack traces now feel unapproachable without AI. I don’t even read error messages anymore, I just copy and paste them.</p><p>I’ve become a human clipboard, a mere intermediary between my code and an LLM.</p><p>Previously, every error message used to teach me something. Now? The solution appears magically, and I learn nothing. The dopamine hit of instant answers has replaced the satisfaction of genuine understanding.</p><p>Deep comprehension is the next thing that was affected. Remember spending hours understanding why a solution works? Now, I simply implement AI suggestions. If they don’t work, I improve the context, and just ask the AI again. It’s a cycle of increasing dependency.</p><p>Then come the emotional changes. Previously, it was a part of the <em>joy</em> of programming to solve new problems. Now, I get frustrated if AI doesn’t give me a solution in 5 minutes.</p><p>The scariest part? I’m building an AI-powered development tool, but I can’t shake the feeling I’m contributing to the very problem that’s eroding our collective skills.</p></blockquote><p>这段感触到笔者的灵魂，引发笔者的思考：这不就是我吗？我已经成为了一个剪贴板，不停的从程序搬运到ai，即时答案的获取让我尝到了甜头，我不再第一时间自己阅读错误，找出解决问题，而是打开ai，询问如何去做。</p><p>​    值得一提的是，作者并不是反对ai的使用，而是提醒我们去反思对ai形成的依赖性，并对此现象进行了对抗：</p><blockquote><ul><li>No AI for problems that you haven’t tried to understand first</li><li>Read and understand all AI-suggested solutions</li><li>Regular periods of coding without AI assistance</li><li>Focus on learning patterns, not just fixing immediate issues</li></ul></blockquote><span class='p red'>The real question isn’t whether AI will replace programmers. It’s whether we’re replacing ourselves.</span><p>如何更好地使用ai进行学习工作，可能是我们接下来要思考的问题。</p>]]></content>
    
    
    <summary type="html">思考对ai的依赖性，你是这样的“文盲程序员吗”？</summary>
    
    
    
    <category term="文章推荐" scheme="https://stack2005.github.io/categories/%E6%96%87%E7%AB%A0%E6%8E%A8%E8%8D%90/"/>
    
    
    <category term="AI" scheme="https://stack2005.github.io/tags/AI/"/>
    
    <category term="文章推荐" scheme="https://stack2005.github.io/tags/%E6%96%87%E7%AB%A0%E6%8E%A8%E8%8D%90/"/>
    
  </entry>
  
  <entry>
    <title>Docker学习（三）：编写自己的镜像</title>
    <link href="https://stack2005.github.io/posts/172281ba.html"/>
    <id>https://stack2005.github.io/posts/172281ba.html</id>
    <published>2025-03-02T16:00:00.000Z</published>
    <updated>2025-03-02T16:00:00.000Z</updated>
    
    <content type="html"><![CDATA[<h2 id="什么是DockerFile"><a href="#什么是DockerFile" class="headerlink" title="什么是DockerFile"></a>什么是DockerFile</h2><p>Dockerfile 是一个文本文件，包含了构建 Docker 镜像的所有指令。</p><p>Dockerfile 是一个用来构建镜像的文本文件，文本内容包含了一条条构建镜像所需的指令和说明。</p><p>通过定义一系列命令和参数，Dockerfile 指导 Docker 构建一个自定义的镜像。</p><h2 id="DockerFile指令"><a href="#DockerFile指令" class="headerlink" title="DockerFile指令"></a>DockerFile指令</h2><div class="table-container"><table><thead><tr><th><strong>Dockerfile 指令</strong></th><th>说明</th></tr></thead><tbody><tr><td>FROM</td><td>指定基础镜像，用于后续的指令构建。</td></tr><tr><td>MAINTAINER</td><td>指定Dockerfile的作者/维护者。（已弃用，推荐使用LABEL指令）</td></tr><tr><td>LABEL</td><td>添加镜像的元数据，使用键值对的形式。</td></tr><tr><td>RUN</td><td>在构建过程中在镜像中执行命令。</td></tr><tr><td>CMD</td><td>指定容器创建时的默认命令。（可以被覆盖）</td></tr><tr><td>ENTRYPOINT</td><td>设置容器创建时的主要命令。（不可被覆盖）</td></tr><tr><td>EXPOSE</td><td>声明容器运行时监听的特定网络端口。</td></tr><tr><td>ENV</td><td>在容器内部设置环境变量。</td></tr><tr><td>ADD</td><td>将文件、目录或远程URL复制到镜像中。</td></tr><tr><td>COPY</td><td>将文件或目录复制到镜像中。</td></tr><tr><td>VOLUME</td><td>为容器创建挂载点或声明卷。</td></tr><tr><td>WORKDIR</td><td>设置后续指令的工作目录。</td></tr><tr><td>USER</td><td>指定后续指令的用户上下文。</td></tr><tr><td>ARG</td><td>定义在构建过程中传递给构建器的变量，可使用 “docker build” 命令设置。</td></tr><tr><td>ONBUILD</td><td>当该镜像被用作另一个构建过程的基础时，添加触发器。</td></tr><tr><td>STOPSIGNAL</td><td>设置发送给容器以退出的系统调用信号。</td></tr><tr><td>HEALTHCHECK</td><td>定义周期性检查容器健康状态的命令。</td></tr><tr><td>SHELL</td><td>覆盖Docker中默认的shell，用于RUN、CMD和ENTRYPOINT指令。</td></tr></tbody></table></div><h2 id="例：编写DockerFile"><a href="#例：编写DockerFile" class="headerlink" title="例：编写DockerFile"></a>例：编写DockerFile</h2><p>以一个提供了简单的两个演示页面的Nodejs + Koa2 写的 Web 项目为例。</p><p>软件依赖：<a href="https://nodejs.org/zh-cn/">nodejs</a><br>项目依赖库：koa、log4js、koa-router</p><figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">FROM</span> node:<span class="number">11</span></span><br><span class="line"><span class="keyword">LABEL</span><span class="language-bash"> maintainer=<span class="string">&quot;stack&quot;</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 复制代码</span></span><br><span class="line"><span class="keyword">ADD</span><span class="language-bash"> . /app</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 设置容器启动后的默认运行目录</span></span><br><span class="line"><span class="keyword">WORKDIR</span><span class="language-bash"> /app</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 运行命令，安装依赖</span></span><br><span class="line"><span class="comment"># RUN 命令可以有多个，但是可以用 &amp;&amp; 连接多个命令来减少层级。</span></span><br><span class="line"><span class="comment"># 例如 RUN npm install &amp;&amp; cd /app &amp;&amp; mkdir logs</span></span><br><span class="line"><span class="keyword">RUN</span><span class="language-bash"> npm install --registry=https://registry.npm.taobao.org</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 暴露端口，允许外部访问</span></span><br><span class="line"><span class="keyword">EXPOSE</span> <span class="number">8080</span></span><br><span class="line"><span class="comment"># CMD 指令只能一个，是容器启动后执行的命令，算是程序的入口。</span></span><br><span class="line"><span class="comment"># 如果还需要运行其他命令可以用 &amp;&amp; 连接，也可以写成一个shell脚本去执行。</span></span><br><span class="line"><span class="comment"># 例如 CMD cd /app &amp;&amp; ./start.sh</span></span><br><span class="line"><span class="keyword">CMD</span><span class="language-bash"> node app.js</span></span><br></pre></td></tr></table></figure><p>编译 <code>docker build -t test:v1 .</code></p><p><img src="https://bu.dusays.com/2025/03/03/67c5b36a058b7.png" alt="image-20250303214903480"></p><blockquote><p><code>-t</code> 设置镜像名字和版本号</p><p>最后的那个点表示 Dockerfile 文件所在的路径，上例是当前路径，所以是一个点。</p><p>命令参考：<a href="https://docs.docker.com/engine/reference/commandline/build/">https://docs.docker.com/engine/reference/commandline/build/</a></p></blockquote><p>运行 <code>docker run -p 8080:8080 --name test-hello test:v1</code></p><blockquote><p><code>-p</code> 映射容器内端口到宿主机<br><code>--name</code> 容器名字<br><code>-d</code> 后台运行<br>命令参考文档：<a href="https://docs.docker.com/engine/reference/run/">https://docs.docker.com/engine/reference/run/</a></p></blockquote><span class='p red'>成功创建自己的容器！</span><div class="note warning modern"><p>如果遇到因网络问题或镜像源失效无法FROM时，可以直接pull下你所需要的镜像</p></div><p>你可能会问，<code>RUN</code>命令与<code>CMD</code>命令的区别在哪里？简单说，<code>RUN</code>命令在 image 文件的构建阶段执行，执行结果都会打包进入 image 文件；<code>CMD</code>命令则是在容器启动后执行。另外，一个 Dockerfile 可以包含多个<code>RUN</code>命令，但是只能有一个<code>CMD</code>命令。</p><p>注意，指定了<code>CMD</code>命令以后，<code>docker container run</code>命令就不能附加命令了（比如前面的<code>/bin/bash</code>），否则它会覆盖<code>CMD</code>命令。</p>]]></content>
    
    
    <summary type="html">介绍DockerFile，学会创建自己的镜像</summary>
    
    
    
    <category term="编程基础" scheme="https://stack2005.github.io/categories/%E7%BC%96%E7%A8%8B%E5%9F%BA%E7%A1%80/"/>
    
    
    <category term="Docker" scheme="https://stack2005.github.io/tags/Docker/"/>
    
  </entry>
  
  <entry>
    <title>Docker学习（二）：常用命令</title>
    <link href="https://stack2005.github.io/posts/9221348a.html"/>
    <id>https://stack2005.github.io/posts/9221348a.html</id>
    <published>2025-02-28T16:00:00.000Z</published>
    <updated>2025-02-28T16:00:00.000Z</updated>
    
    <content type="html"><![CDATA[<h2 id="官方docs"><a href="#官方docs" class="headerlink" title="官方docs"></a>官方docs</h2><p><a href="https://docs.docker.com/reference/">Reference | Docker Docs</a></p><p>常看常新（×</p><h2 id="帮助命令"><a href="#帮助命令" class="headerlink" title="帮助命令"></a>帮助命令</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">docker version #显示docker版本信息</span><br><span class="line">docker info #显示docker的系统信息，包括镜像和容器的数量</span><br><span class="line">docker 命令 --help #帮助</span><br></pre></td></tr></table></figure><h2 id="镜像命令"><a href="#镜像命令" class="headerlink" title="镜像命令"></a>镜像命令</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">列出本机的所有 image 文件。</span></span><br><span class="line"> docker image ls</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">删除 image 文件</span></span><br><span class="line"> docker image rm [imageName]</span><br><span class="line"> docker rmi image-id</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">搜索 image 文件</span></span><br><span class="line"> docker search [name]</span><br><span class="line"><span class="meta prompt_"> </span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">拉取 image 文件</span></span><br><span class="line"> docker pull NAME[:tag]</span><br></pre></td></tr></table></figure><div class="tip sync"><p>用<code>docker image</code>可查看所拥有的命令</p></div><p><img src="https://bu.dusays.com/2025/03/01/67c2fdc7a1f13.png" alt="image-20250301202936288"></p><p>最后一行为仓库内镜像地址，也就是说：</p><p><code>docker pull mysql:latest</code>与<code>docker pull docker.io/library/mysql:latest</code>是等价的</p><h2 id="容器命令"><a href="#容器命令" class="headerlink" title="容器命令"></a>容器命令</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">列出本机正在运行的容器</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">docker ps</span> </span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">docker container <span class="built_in">ls</span></span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">列出本机所有容器，包括终止运行的容器</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">docker container <span class="built_in">ls</span> --all</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">docker ps  --all</span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">新建容器并启动</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">docker run [可选参数] image</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">参数说明</span></span><br><span class="line">--name=&quot;NAME&quot;   容器名字</span><br><span class="line">-d              后台运行</span><br><span class="line">-it             使用交互方式运行，进入容器查看内容</span><br><span class="line">-p              指定容器的端口（本机端口：容器端口）</span><br><span class="line">-P              随机指定端口</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">停止/启动指定 <span class="built_in">id</span> 的容器</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">docker stop/start container-id</span> </span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">重启容器</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">docker restart</span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">删除指定 <span class="built_in">id</span> 的容器</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">docker <span class="built_in">rm</span> container-id</span> </span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">手动终止容器</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">docker container <span class="built_in">kill</span> [containID]</span></span><br></pre></td></tr></table></figure><div class="tip sync"><p>用<code>docker container</code>可查看所拥有的命令</p></div><h2 id="其他命令"><a href="#其他命令" class="headerlink" title="其他命令"></a>其他命令</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">查看信息</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">docker inspect</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">进入当前正在运行的容器（开启新终端）</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">docker <span class="built_in">exec</span> [OPTIONS] CONTAINER COMMAND [ARG...]</span></span><br><span class="line">例：</span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">docker <span class="built_in">exec</span> -it fd11cbbc7b12 /bin/bash <span class="comment"># exit 退出</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">进入当前正在运行的容器（进入容器正在执行的终端，不会启动新的进程）</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">docker attach CONTAINER</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">从容器内拷贝文件到主机上</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">docker <span class="built_in">cp</span> 容器<span class="built_in">id</span>:容器内路径 主机路径</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">查看 docker 容器的输出，即容器里面 Shell 的标准输出</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">docker container logs [containerID]</span></span><br></pre></td></tr></table></figure><div class="tip info"><p><code>/bin/bash</code>：容器启动以后，内部第一个执行的命令。这里是启动 Bash，保证用户可以使用 Shell</p></div><div class="tip info"><p><code>-it</code>参数：容器的 Shell 映射到当前的 Shell，然后你在本机窗口输入的命令，就会传入容器。</p></div><h2 id="图图"><a href="#图图" class="headerlink" title="图图"></a>图图</h2><p><img src="https://bu.dusays.com/2025/03/01/67c3119b5c889.png" alt=""></p>]]></content>
    
    
    <summary type="html">介绍Docker的常用命令，学会镜像和容器的各种基本命令</summary>
    
    
    
    <category term="编程基础" scheme="https://stack2005.github.io/categories/%E7%BC%96%E7%A8%8B%E5%9F%BA%E7%A1%80/"/>
    
    
    <category term="Docker" scheme="https://stack2005.github.io/tags/Docker/"/>
    
  </entry>
  
  <entry>
    <title>Docker学习（一）：介绍及简单使用安装</title>
    <link href="https://stack2005.github.io/posts/b4dcf402.html"/>
    <id>https://stack2005.github.io/posts/b4dcf402.html</id>
    <published>2025-02-27T16:00:00.000Z</published>
    <updated>2025-02-27T16:00:00.000Z</updated>
    
    <content type="html"><![CDATA[<h2 id="Docker是什么？"><a href="#Docker是什么？" class="headerlink" title="Docker是什么？"></a>Docker是什么？</h2><p>引用官方的解释：</p><blockquote><p>Docker is an open platform for <strong>developing</strong>, <strong>shipping</strong>, and <strong>running applications</strong>. Docker enables you to separate your applications from your infrastructure so you can deliver software quickly. With Docker, you can manage your infrastructure in the same ways you manage your applications. By taking advantage of Docker’s methodologies for shipping, testing, and deploying code, you can significantly reduce the delay between writing code and running it in production.</p></blockquote><p><strong>Docker 属于 Linux 容器的一种封装，提供简单易用的容器使用接口。</strong>它是目前最流行的 Linux 容器解决方案。</p><p>Docker 将应用程序与该程序的依赖，打包在一个文件里面。运行这个文件，就会生成一个虚拟容器。程序在这个虚拟容器里运行，就好像在真实的物理机上运行一样。有了 Docker，就不用担心环境问题。</p><p>总体来说，Docker 的接口相当简单，用户可以方便地创建和使用容器，把自己的应用放入容器。容器还可以进行版本管理、复制、分享、修改，就像管理普通的代码一样。</p><p><strong>简单来说，Docker 是一个应用<u>打包、分发、部署</u>的工具。</strong></p><div class="note info simple"><p><strong>打包</strong>：就是把你软件运行所需的依赖、第三方库、软件打包到一起，变成一个安装包<br><strong>分发</strong>：你可以把你打包好的“安装包”上传到一个镜像仓库，其他人可以非常方便的获取和安装<br><strong>部署</strong>：拿着“安装包”就可以一个命令运行起来你的应用，自动模拟出一摸一样的运行环境，不管是在 Windows/Mac/Linux。</p></div><h2 id="Docker部署的优点"><a href="#Docker部署的优点" class="headerlink" title="Docker部署的优点"></a>Docker部署的优点</h2><p>常规应用开发部署方式：自己在 Windows 上开发、测试 —&gt; 到 Linux 服务器配置运行环境部署。</p><div class="note default flat"><p>问题：我机器上跑都没问题，怎么到服务器就各种问题了</p></div><p>用 Docker 开发部署流程：自己在 Windows 上开发、测试 —&gt; 打包为 Docker 镜像（可以理解为软件安装包） —&gt; 各种服务器上只需要一个命令部署好</p><div class="note success flat"><p>优点：确保了不同机器上跑都是一致的运行环境，不会出现我机器上跑正常，你机器跑就有问题的情况。</p></div><h2 id="Docker的用处"><a href="#Docker的用处" class="headerlink" title="Docker的用处"></a>Docker的用处</h2><ul><li>应用分发、部署，方便传播给他人安装。特别是开源软件和提供私有部署的应用</li><li>快速安装测试/学习软件，用完就丢（类似小程序），不把时间浪费在安装软件上。例如 Redis / MongoDB / ElasticSearch / ELK</li><li>多个版本软件共存，不污染系统，例如 Python2、Python3，Redis4.0，Redis5.0</li><li>Windows 上体验/学习各种 Linux 系统</li></ul><h2 id="Docker的安装"><a href="#Docker的安装" class="headerlink" title="Docker的安装"></a>Docker的安装</h2><p>笔者是Windows系统，采用的是wsl2安装Docker桌面版，推荐阅读Windows官方教程：<a href="https://learn.microsoft.com/zh-cn/windows/wsl/tutorials/wsl-containers">WSL 上的 Docker 容器入门 | Microsoft Learn</a></p><h2 id="镜像加速源"><a href="#镜像加速源" class="headerlink" title="镜像加速源"></a>镜像加速源</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  &quot;builder&quot;: &#123;</span><br><span class="line">    &quot;gc&quot;: &#123;</span><br><span class="line">      &quot;defaultKeepStorage&quot;: &quot;20GB&quot;,</span><br><span class="line">      &quot;enabled&quot;: true</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  &quot;experimental&quot;: false,</span><br><span class="line">  &quot;registry-mirrors&quot;: [</span><br><span class="line">    &quot;https://registry.docker-cn.com&quot;,</span><br><span class="line">    &quot;https://mirror.ccs.tencentyun.com&quot;,</span><br><span class="line">    &quot;https://docker.mirrors.ustc.edu.cn&quot;</span><br><span class="line">  ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="简单的开始"><a href="#简单的开始" class="headerlink" title="简单的开始"></a>简单的开始</h2><p>以下均以nginx为例，打开docker desktop，搜索nginx或者上<a href="https://hub.docker.com/">Docker Hub</a>搜索各种镜像</p><p><img src="https://bu.dusays.com/2025/02/28/67c1be0c49722.png" alt="image-20250228214532817"></p><p>点击查看官方文档，这里我们直接Run</p><div class="img-wrap"><div class="img-bg"><img class="img" src="https://bu.dusays.com/2025/02/28/67c1bf309a9db.png" alt="点击images，简单配置后开始运行容器"/></div><span class="image-caption">点击images，简单配置后开始运行容器</span></div><span class='p center'>点击运行的端口，可以看见运行成功</span><p><img src="https://bu.dusays.com/2025/02/28/67c1bfb903903.png" alt="image-20250228215242211"></p><h2 id="配合vscode修改容器中的文件"><a href="#配合vscode修改容器中的文件" class="headerlink" title="配合vscode修改容器中的文件"></a>配合vscode修改容器中的文件</h2><p>打开VScode安装Docker拓展，安装完毕可以看到左边侧栏多了一个可爱的小鲸鱼，点击，可以看见正在运行的nginx容器和拥有的镜像。</p><p><img src="https://bu.dusays.com/2025/02/28/67c1c168b6b88.png" alt="image-20250228215953851"></p><p>点击运行的容器，点击File，找到<code>usr\share\nginx\html\index.html</code>,修改内容，刷新一下页面，可以看见修改成功</p><p><img src="https://bu.dusays.com/2025/02/28/67c1c208981ed.png" alt="image-20250228220233837"></p>]]></content>
    
    
    <summary type="html">介绍Docker的运用背景，重要名词的解释及如何使用Docker快速安装软件</summary>
    
    
    
    <category term="编程基础" scheme="https://stack2005.github.io/categories/%E7%BC%96%E7%A8%8B%E5%9F%BA%E7%A1%80/"/>
    
    
    <category term="Docker" scheme="https://stack2005.github.io/tags/Docker/"/>
    
  </entry>
  
  <entry>
    <title>小站搭建过程：基于Hexo+Github Page</title>
    <link href="https://stack2005.github.io/posts/9d48c7ab.html"/>
    <id>https://stack2005.github.io/posts/9d48c7ab.html</id>
    <published>2025-02-24T16:00:00.000Z</published>
    <updated>2025-02-24T16:00:00.000Z</updated>
    
    <content type="html"><![CDATA[<h2 id="环境前提"><a href="#环境前提" class="headerlink" title="环境前提"></a>环境前提</h2><p>需安装<span class='p green'>node.js</span>和<span class='p gray'>Git</span>，笔者之前安装过了，这里放一下官网</p><h3 id="node-js"><a href="#node-js" class="headerlink" title="node.js"></a>node.js</h3><details class="folding-tag" green><summary> node.js </summary>              <div class='content'>              <p>进入 node.js 官网：<a href="https://nodejs.org/en/download/">Node.js 官网</a><br>按照自己的电脑选择对应的版本下载</p>              </div>            </details><h3 id="Git"><a href="#Git" class="headerlink" title="Git"></a>Git</h3><details class="folding-tag" ><summary> Git </summary>              <div class='content'>              <p>这是 Git 官网：<a href="https://git-scm.com/downloads">Git 官网</a></p><p>Git 的安装请参考：<a href="https://www.cnblogs.com/jytx/p/5602927.html">Git 安装教程</a></p>              </div>            </details><h3 id="检验是否安装成功"><a href="#检验是否安装成功" class="headerlink" title="检验是否安装成功"></a>检验是否安装成功</h3><p>按下<kbd>Win</kbd> + <kbd>R</kbd>，输入<code>cmd</code>，输入以下代码检验：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">git --version</span><br><span class="line">node -v</span><br><span class="line">npm -v</span><br></pre></td></tr></table></figure><h2 id="安装Hexo"><a href="#安装Hexo" class="headerlink" title="安装Hexo"></a>安装Hexo</h2><p>选择一个磁盘，新建一个文件夹，博客相关文件将储存在此文件夹下，在该文件夹下右键鼠标，点击 Git Bash Here，输入以下 <code>npm</code> 命令即可安装<strong>脚手架</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install hexo-cli -g</span><br></pre></td></tr></table></figure><h2 id="初始化Hexo"><a href="#初始化Hexo" class="headerlink" title="初始化Hexo"></a>初始化Hexo</h2><details class="folding-tag" blue><summary> 初始化Hexo </summary>              <div class='content'>              <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">hexo init</span><br><span class="line">npm install hexo-deployer-git --save</span><br></pre></td></tr></table></figure><p>第二个命令表示安装 hexo 部署到 git page 的 deployer</p><p>然后可以看见文件夹中多了许多文件和文件夹，其中要了解：</p><div class="note info modern"><p>node_modules： 存放安装的插件依赖</p></div><div class="note info modern"><p>scaffolds：存放文章或页面等的初始化板式</p></div><div class="note info modern"><p>source：源码，存放文章等</p></div><div class="note info modern"><p>themes：存放安装的主题</p></div><div class="note info modern"><p>_config.yml：Hexo配置文件</p></div>              </div>            </details><h2 id="部署到Github-Page"><a href="#部署到Github-Page" class="headerlink" title="部署到Github Page"></a>部署到Github Page</h2><p>注册好<code>github</code>账号后，我们还需要把我们本地的 <code>SSH Key</code> 添加到 <code>github</code> 中去，这样我们之后才能有权限将本地代码推送到 <code>github</code> 中。</p><p>先本地生成一对 <code>RSA</code> 密钥：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ssh-keygen -t rsa -b 4096 -C <span class="string">&quot;你的邮箱&quot;</span></span><br></pre></td></tr></table></figure><p>找到你刚才创建的密钥，<code>windows</code> 用户可以在 <code>C://用户//admin//.ssh</code> 目录下查找，mac 用户可以在 <code>~/.ssh</code> 目录下找到。复制 <code>id_rsa.pub</code> 文件里的信息，然后到<a href="https://github.com/settings/keys">这里</a>添加新的 <code>SSHKEY</code> 。</p><div class="img-wrap"><div class="img-bg"><img class="img" src="https://img.picui.cn/free/2025/02/25/67bdafdab87fc.png" alt="添加新的SSH Key"/></div><span class="image-caption">添加新的SSH Key</span></div><p>把我们刚才的 <code>key</code> 复制进行后保存即可。</p><details class="folding-tag" red><summary> 部署到Github Page </summary>              <div class='content'>              <p>创建并打开项目<code>yourname.github.io</code>，点击右上方的<mark class="hl-label green">Code</mark>，复制SSH，打开_config.yml文件，找到：</p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">deploy:</span></span><br><span class="line">  <span class="attr">type:</span> <span class="string">git</span></span><br><span class="line">  <span class="attr">repository:</span> </span><br><span class="line">  <span class="attr">branch:</span> <span class="string">main</span></span><br></pre></td></tr></table></figure><p>将你复制的内容复制到<code>repository:</code>这行，注意冒号后面跟一个空格</p><p>然后执行</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">hexo g</span><br><span class="line">hexo d</span><br></pre></td></tr></table></figure><p>你的页面就已经提交到Github Page上了</p>              </div>            </details><h2 id="发表文章或页面"><a href="#发表文章或页面" class="headerlink" title="发表文章或页面"></a>发表文章或页面</h2><p>一、新建一个空文章，输入以下命令，会在项目 \Hexo\source\_posts 中生成 文章标题.md 文件，文章标题根据需要命名</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hexo n <span class="string">&quot;文章标题&quot;</span></span><br></pre></td></tr></table></figure><p>也可以直接在 \Hexo\source\_posts 目录下右键鼠标新建文本文档，改后缀为 .md 即可</p><p>二、新建一个页面，输入以下命令,会在项目 \Hexo\source\下生成“页面标题”的文件夹，文件夹会有index.md</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hexo n page <span class="string">&quot;页面标题&quot;</span></span><br></pre></td></tr></table></figure><p>同理你也可以直接自己建</p><h2 id="手动部署三剑客"><a href="#手动部署三剑客" class="headerlink" title="手动部署三剑客"></a>手动部署三剑客</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">hexo cl</span><br><span class="line">hexo generate</span><br><span class="line">hexo d</span><br></pre></td></tr></table></figure><p>其中<code>hexo cl</code>会clean本地文件，删除public文件</p><p><code>hexo generate</code>会将源文件的形成静态文件资源，生成并存放在public文件夹中</p><p><code>hexo d</code>生成<code>.deploy_git</code>文件夹，并提交到github</p><h2 id="无法删除文件怎么办"><a href="#无法删除文件怎么办" class="headerlink" title="无法删除文件怎么办"></a>无法删除文件怎么办</h2><h3 id="解决步骤"><a href="#解决步骤" class="headerlink" title="解决步骤"></a>解决步骤</h3><ul><li>第一步：在文件夹<code>source/_posts</code>下删除你想要删除的文章</li><li>第二步：删除<code>.deploy_git</code>文件夹</li><li>第三步：执行<code>hexo cl</code>，再执行<code>hexo g -d</code></li></ul><h3 id="原因"><a href="#原因" class="headerlink" title="原因"></a>原因</h3><p>因为在本地在执行 <code>hexo g</code> 后,会在博客根目录下生成一个<code>public</code>文件夹,这个文件夹里的文件组合起来就是一个完整的静态博客。</p><p>接着如果执行 <code>hexo d</code>,就会把这个<code>public</code>文件夹的东西完完整整地拷贝到<code>.deploy_git</code> 文件夹里,并把该文件夹里的所有文件全部推送 push 到远程库。</p><p>之后会触发Pages服务的钩子去build项目,然后部署到网站上。</p><p>markdown文章在之前的 <code>hexo g</code> 之后,把生成的静态文件拷贝到了<code>.deploy_git</code>文件,但<code>hexo clean</code>并没能删除，<code>.deploy_git</code> 里的markdown的静态文件,所以每次部署的时候,它还会冒出来。</p>]]></content>
    
    
    <summary type="html">基于Hexo + Github Page 建立自己的博客</summary>
    
    
    
    <category term="博客" scheme="https://stack2005.github.io/categories/%E5%8D%9A%E5%AE%A2/"/>
    
    
    <category term="Hexo" scheme="https://stack2005.github.io/tags/Hexo/"/>
    
  </entry>
  
  <entry>
    <title>美化博客：butterfly主题魔改</title>
    <link href="https://stack2005.github.io/posts/75b205f.html"/>
    <id>https://stack2005.github.io/posts/75b205f.html</id>
    <published>2025-02-24T16:00:00.000Z</published>
    <updated>2025-02-24T16:00:00.000Z</updated>
    
    <content type="html"><![CDATA[<h2 id="写在前面"><a href="#写在前面" class="headerlink" title="写在前面"></a>写在前面</h2><p>特别感谢anzhiyu大佬和店长的指导贴</p><h2 id="安装-Butterfly"><a href="#安装-Butterfly" class="headerlink" title="安装 Butterfly"></a>安装 Butterfly</h2><p>参考教程: <a href="https://butterfly.js.org/posts/21cfbf15/#安裝">https://butterfly.js.org/posts/21cfbf15/#%E5%AE%89%E8%A3%9D</a></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install hexo-theme-butterfly</span><br></pre></td></tr></table></figure><div class="note primary flat"><p>详细安装及使用方法请仔细阅读店长方案</p></div><h2 id="修改-config-yml"><a href="#修改-config-yml" class="headerlink" title="修改_config.yml"></a>修改_config.yml</h2><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Hexo Configuration</span></span><br><span class="line"><span class="comment">## Docs: https://hexo.io/docs/configuration.html</span></span><br><span class="line"><span class="comment">## Source: https://github.com/hexojs/hexo/</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Site</span></span><br><span class="line"><span class="attr">title:</span> <span class="string">Stack&#x27;s</span> <span class="string">Blog</span></span><br><span class="line"><span class="attr">subtitle:</span> <span class="string">&#x27;The spreading wide of narrow hands To gather paradise-&#x27;</span></span><br><span class="line"><span class="attr">description:</span> <span class="string">&#x27;The spreading wide of narrow hands To gather paradise-&#x27;</span></span><br><span class="line"><span class="attr">keywords:</span></span><br><span class="line"><span class="attr">author:</span> <span class="string">Stack</span></span><br><span class="line"><span class="attr">language:</span> <span class="string">zh-CN</span></span><br><span class="line"><span class="attr">timezone:</span> <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="attr">email:</span> <span class="string">liuruiqi2005@yeah.net</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># URL</span></span><br><span class="line"><span class="comment">## Set your site url here. For example, if you use GitHub Page, set url as &#x27;https://username.github.io/project&#x27;</span></span><br><span class="line"><span class="attr">url:</span> <span class="string">https://stack2005.github.io/</span></span><br><span class="line"><span class="attr">permalink:</span> <span class="string">posts/:abbrlink.html</span></span><br><span class="line"><span class="attr">permalink_defaults:</span></span><br><span class="line"><span class="attr">pretty_urls:</span></span><br><span class="line">  <span class="attr">trailing_index:</span> <span class="literal">true</span> <span class="comment"># Set to false to remove trailing &#x27;index.html&#x27; from permalinks</span></span><br><span class="line">  <span class="attr">trailing_html:</span> <span class="literal">true</span> <span class="comment"># Set to false to remove trailing &#x27;.html&#x27; from permalinks</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Directory</span></span><br><span class="line"><span class="attr">source_dir:</span> <span class="string">source</span></span><br><span class="line"><span class="attr">public_dir:</span> <span class="string">public</span></span><br><span class="line"><span class="attr">tag_dir:</span> <span class="string">tags</span></span><br><span class="line"><span class="attr">archive_dir:</span> <span class="string">archives</span></span><br><span class="line"><span class="attr">category_dir:</span> <span class="string">categories</span></span><br><span class="line"><span class="attr">code_dir:</span> <span class="string">downloads/code</span></span><br><span class="line"><span class="attr">i18n_dir:</span> <span class="string">:lang</span></span><br><span class="line"><span class="attr">skip_render:</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Writing</span></span><br><span class="line"><span class="attr">new_post_name:</span> <span class="string">:title.md</span> <span class="comment"># File name of new posts</span></span><br><span class="line"><span class="attr">default_layout:</span> <span class="string">post</span></span><br><span class="line"><span class="attr">titlecase:</span> <span class="literal">false</span> <span class="comment"># Transform title into titlecase</span></span><br><span class="line"><span class="attr">external_link:</span></span><br><span class="line">  <span class="attr">enable:</span> <span class="literal">true</span> <span class="comment"># Open external links in new tab</span></span><br><span class="line">  <span class="attr">field:</span> <span class="string">site</span> <span class="comment"># Apply to the whole site</span></span><br><span class="line">  <span class="attr">exclude:</span> <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="attr">filename_case:</span> <span class="number">0</span></span><br><span class="line"><span class="attr">render_drafts:</span> <span class="literal">false</span></span><br><span class="line"><span class="attr">post_asset_folder:</span> <span class="literal">false</span></span><br><span class="line"><span class="attr">relative_link:</span> <span class="literal">false</span></span><br><span class="line"><span class="attr">future:</span> <span class="literal">true</span></span><br><span class="line"><span class="attr">syntax_highlighter:</span> <span class="string">highlight.js</span></span><br><span class="line"><span class="attr">highlight:</span></span><br><span class="line">  <span class="attr">line_number:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">auto_detect:</span> <span class="literal">false</span></span><br><span class="line">  <span class="attr">tab_replace:</span> <span class="string">&#x27;&#x27;</span></span><br><span class="line">  <span class="attr">wrap:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">hljs:</span> <span class="literal">false</span></span><br><span class="line"><span class="attr">prismjs:</span></span><br><span class="line">  <span class="attr">preprocess:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">line_number:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">tab_replace:</span> <span class="string">&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Home page setting</span></span><br><span class="line"><span class="comment"># path: Root path for your blogs index page. (default = &#x27;&#x27;)</span></span><br><span class="line"><span class="comment"># per_page: Posts displayed per page. (0 = disable pagination)</span></span><br><span class="line"><span class="comment"># order_by: Posts order. (Order by date descending by default)</span></span><br><span class="line"><span class="attr">index_generator:</span></span><br><span class="line">  <span class="attr">path:</span> <span class="string">&#x27;&#x27;</span></span><br><span class="line">  <span class="attr">per_page:</span> <span class="number">10</span></span><br><span class="line">  <span class="attr">order_by:</span> <span class="string">-date</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Category &amp; Tag</span></span><br><span class="line"><span class="attr">default_category:</span> <span class="string">uncategorized</span></span><br><span class="line"><span class="attr">category_map:</span></span><br><span class="line"><span class="attr">tag_map:</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Metadata elements</span></span><br><span class="line"><span class="comment">## https://developer.mozilla.org/en-US/docs/Web/HTML/Element/meta</span></span><br><span class="line"><span class="attr">meta_generator:</span> <span class="literal">true</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Date / Time format</span></span><br><span class="line"><span class="comment">## Hexo uses Moment.js to parse and display date</span></span><br><span class="line"><span class="comment">## You can customize the date format as defined in</span></span><br><span class="line"><span class="comment">## http://momentjs.com/docs/#/displaying/format/</span></span><br><span class="line"><span class="attr">date_format:</span> <span class="string">YYYY-MM-DD</span></span><br><span class="line"><span class="attr">time_format:</span> <span class="string">HH:mm:ss</span></span><br><span class="line"><span class="comment">## updated_option supports &#x27;mtime&#x27;, &#x27;date&#x27;, &#x27;empty&#x27;</span></span><br><span class="line"><span class="attr">updated_option:</span> <span class="string">&#x27;mtime&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Pagination</span></span><br><span class="line"><span class="comment">## Set per_page to 0 to disable pagination</span></span><br><span class="line"><span class="attr">per_page:</span> <span class="number">10</span></span><br><span class="line"><span class="attr">pagination_dir:</span> <span class="string">page</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Include / Exclude file(s)</span></span><br><span class="line"><span class="comment">## include:/exclude: options only apply to the &#x27;source/&#x27; folder</span></span><br><span class="line"><span class="attr">include:</span></span><br><span class="line"><span class="attr">exclude:</span></span><br><span class="line"><span class="attr">ignore:</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Extensions</span></span><br><span class="line"><span class="comment">## Plugins: https://hexo.io/plugins/</span></span><br><span class="line"><span class="comment">## Themes: https://hexo.io/themes/</span></span><br><span class="line"><span class="attr">theme:</span> <span class="string">butterfly</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Deployment</span></span><br><span class="line"><span class="comment">## Docs: https://hexo.io/docs/one-command-deployment</span></span><br><span class="line"><span class="attr">deploy:</span></span><br><span class="line">  <span class="attr">type:</span> <span class="string">git</span></span><br><span class="line">  <span class="attr">repository:</span> <span class="string">git@github.com:stack2005/stack2005.github.io.git</span></span><br><span class="line">  <span class="attr">branch:</span> <span class="string">main</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 文章链接转数字或字母：https://github.com/rozbo/hexo-abbrlink</span></span><br><span class="line"><span class="comment"># abbrlink config</span></span><br><span class="line"><span class="attr">abbrlink:</span></span><br><span class="line">  <span class="attr">alg:</span> <span class="string">crc32</span>      <span class="comment"># Algorithm used to calc abbrlink. Support crc16(default) and crc32</span></span><br><span class="line">  <span class="attr">rep:</span> <span class="string">hex</span>        <span class="comment"># Representation of abbrlink in URLs. Support dec(default) and hex</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 本地搜索：https://github.com/wzpan/hexo-generator-search</span></span><br><span class="line"><span class="attr">search:</span></span><br><span class="line">  <span class="attr">path:</span> <span class="string">search.xml</span></span><br><span class="line">  <span class="attr">field:</span> <span class="string">post</span></span><br><span class="line">  <span class="attr">content:</span> <span class="literal">true</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Live2D(OhMyLive2d)</span></span><br><span class="line"><span class="attr">OhMyLive2d:</span></span><br><span class="line">  <span class="attr">enable:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">CDN:</span> <span class="string">https://registry.npmmirror.com/oh-my-live2d/latest/files</span></span><br><span class="line">  <span class="comment"># CDN: https://registry.npmmirror.com/oh-my-live2d/0.13/files/dist/index.min.js</span></span><br><span class="line">  <span class="attr">option:</span></span><br><span class="line">    <span class="comment"># importType: &#x27;cubism2&#x27; #  导入类型, 默认使用全量导入: complete , 可选值: complete, cubism2, cubism5</span></span><br><span class="line">    <span class="attr">libraryUrls:</span> <span class="comment"># 自定义 Cubism SDK 外部资源地址</span></span><br><span class="line">      <span class="attr">complete:</span> <span class="string">https://registry.npmmirror.com/oh-my-live2d/latest/files/lib/complete.js</span></span><br><span class="line">      <span class="attr">cubism2:</span> <span class="string">https://registry.npmmirror.com/oh-my-live2d/latest/files/lib/cubism2.js</span></span><br><span class="line">      <span class="attr">cubism5:</span> <span class="string">https://registry.npmmirror.com/oh-my-live2d/latest/files/lib/cubism5.js</span></span><br><span class="line">    <span class="comment"># menus:</span></span><br><span class="line">    <span class="comment"># items: |</span></span><br><span class="line">    <span class="comment">#   (defaultItems)=&gt;&#123;</span></span><br><span class="line">    <span class="comment">#    return [</span></span><br><span class="line">    <span class="comment">#      ...defaultItems,</span></span><br><span class="line">    <span class="comment">#      &#123;</span></span><br><span class="line">    <span class="comment">#        id: &#x27;github&#x27;,</span></span><br><span class="line">    <span class="comment">#        icon: &#x27;github-fill&#x27;,</span></span><br><span class="line">    <span class="comment">#        title: &#x27;我的github&#x27;,</span></span><br><span class="line">    <span class="comment">#        onClick: ()=&gt;window.open(&#x27;https://github.com/hacxy&#x27;)</span></span><br><span class="line">    <span class="comment">#      &#125;</span></span><br><span class="line">    <span class="comment">#    ]</span></span><br><span class="line">    <span class="comment">#   &#125;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># items:</span></span><br><span class="line">    <span class="comment">#   - id: &#x27;github&#x27;</span></span><br><span class="line">    <span class="comment">#     icon: &#x27;github-fill&#x27;</span></span><br><span class="line">    <span class="comment">#     title: &#x27;我的github&#x27;</span></span><br><span class="line">    <span class="comment">#     onClick: ()=&gt;window.open(&#x27;https://github.com/hacxy&#x27;)</span></span><br><span class="line"></span><br><span class="line">    <span class="attr">mobileDisplay:</span> <span class="literal">true</span> <span class="comment"># 是否在移动端显示</span></span><br><span class="line">    <span class="attr">dockedPosition:</span> <span class="string">&quot;right&quot;</span> <span class="comment"># 悬浮模型的位置 默认值: right 可选值: left | right</span></span><br><span class="line">    <span class="attr">models:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">path:</span> <span class="string">&#x27;https://cdn.statically.io/gh/stack2005/live-2d-resource-bed/main/%E7%BA%B1%E9%9B%BElive2d/model/sagiri/sagiri.model.json&#x27;</span></span><br><span class="line">        <span class="attr">mobilePosition:</span> [<span class="number">0</span>, <span class="number">0</span>] <span class="comment"># 移动端时模型在舞台中的位置。 默认值: [0,0] [横坐标, 纵坐标]</span></span><br><span class="line">        <span class="attr">mobileScale:</span> <span class="number">0.1</span> <span class="comment"># 移动端时模型的缩放比例 默认值: 0.1</span></span><br><span class="line">        <span class="attr">mobileStageStyle:</span> <span class="comment"># 移动端时舞台的样式</span></span><br><span class="line">          <span class="attr">width:</span> <span class="number">180</span></span><br><span class="line">          <span class="attr">height:</span> <span class="number">166</span></span><br><span class="line">        <span class="attr">motionPreloadStrategy:</span> <span class="string">IDLE</span> <span class="comment"># 动作预加载策略 默认值: IDLE 可选值: ALL | IDLE | NONE</span></span><br><span class="line">        <span class="attr">position:</span> [<span class="number">30</span>, <span class="number">0</span>] <span class="comment"># 模型在舞台中的位置。 默认值: [0,0] [横坐标, 纵坐标]</span></span><br><span class="line">        <span class="attr">scale:</span> <span class="number">0.13</span> <span class="comment"># 模型的缩放比例 默认值: 0.1</span></span><br><span class="line">        <span class="comment"># showHitAreaFrames: false # 是否显示点击区域 默认值: false</span></span><br><span class="line">        <span class="attr">stageStyle:</span></span><br><span class="line">          <span class="attr">width:</span> <span class="number">270</span></span><br><span class="line">          <span class="attr">height:</span> <span class="number">200</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">path:</span> <span class="string">&#x27;https://cdn.statically.io/gh/stack2005/live-2d-resource-bed/main/%E5%8A%A0%E8%97%A4%E6%83%A0live2d/model/katou_01/katou_01.model.json&#x27;</span></span><br><span class="line">        <span class="attr">scale:</span> <span class="number">0.12</span></span><br><span class="line">        <span class="attr">position:</span> [<span class="number">-15</span>, <span class="number">-120</span>]</span><br><span class="line">        <span class="attr">stageStyle:</span></span><br><span class="line">          <span class="attr">width:</span> <span class="number">270</span></span><br><span class="line">          <span class="attr">height:</span> <span class="number">270</span></span><br><span class="line">        <span class="attr">mobileScale:</span> <span class="number">0.08</span></span><br><span class="line">        <span class="attr">mobilePosition:</span> [<span class="number">0</span>, <span class="number">0</span>]</span><br><span class="line">        <span class="attr">mobileStageStyle:</span> <span class="comment"># 移动端时舞台的样式</span></span><br><span class="line">          <span class="attr">width:</span> <span class="number">180</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">path:</span> <span class="string">&#x27;https://cdn.statically.io/gh/stack2005/live-2d-resource-bed/main/abeikelongbi_3/abeikelongbi_3.model3.json&#x27;</span></span><br><span class="line">        <span class="attr">scale:</span> <span class="number">0.05</span></span><br><span class="line">        <span class="attr">position:</span> [<span class="number">-50</span>,<span class="number">10</span>]</span><br><span class="line">        <span class="attr">mobileScale:</span> <span class="number">0.08</span></span><br><span class="line">        <span class="attr">mobilePosition:</span> [<span class="number">0</span>, <span class="number">0</span>]</span><br><span class="line">        <span class="attr">mobileStageStyle:</span> <span class="comment"># 移动端时舞台的样式</span></span><br><span class="line">          <span class="attr">width:</span> <span class="number">180</span></span><br><span class="line">        <span class="attr">stageStyle:</span></span><br><span class="line">          <span class="attr">width:</span> <span class="number">270</span></span><br><span class="line">          <span class="attr">height:</span> <span class="number">350</span></span><br><span class="line">    <span class="attr">parentElement:</span> <span class="string">document.body</span> <span class="comment">#为组件提供一个父元素，如果未指定则默认挂载到 body 中</span></span><br><span class="line">    <span class="attr">primaryColor:</span> <span class="string">&#x27;var(--btn-bg)&#x27;</span> <span class="comment"># 主题色 支持变量</span></span><br><span class="line">    <span class="attr">sayHello:</span> <span class="literal">false</span> <span class="comment"># 是否在初始化阶段打印项目信息</span></span><br><span class="line">    <span class="attr">tips:</span></span><br><span class="line">      <span class="attr">style:</span></span><br><span class="line">        <span class="attr">width:</span> <span class="number">230</span></span><br><span class="line">        <span class="attr">height:</span> <span class="number">120</span></span><br><span class="line">        <span class="attr">left:</span> <span class="string">calc(50%</span> <span class="bullet">-</span> <span class="string">20px)</span></span><br><span class="line">        <span class="attr">top:</span> <span class="string">-100px</span></span><br><span class="line">      <span class="attr">mobileStyle:</span></span><br><span class="line">        <span class="attr">width:</span> <span class="number">180</span></span><br><span class="line">        <span class="attr">height:</span> <span class="number">80</span></span><br><span class="line">        <span class="attr">left:</span> <span class="string">calc(50%</span> <span class="bullet">-</span> <span class="string">30px)</span></span><br><span class="line">        <span class="attr">top:</span> <span class="string">-100px</span></span><br><span class="line">      <span class="attr">idleTips:</span></span><br><span class="line">        <span class="attr">interval:</span> <span class="number">15000</span></span><br><span class="line">        <span class="comment"># message:</span></span><br><span class="line">        <span class="comment">#   - 你好呀~</span></span><br><span class="line">        <span class="comment">#   - 欢迎来到我的小站~</span></span><br><span class="line">        <span class="comment"># 自定义提示语 需要 引入 axios 库 ,也可以使用其他方法</span></span><br><span class="line">        <span class="attr">message:</span> <span class="string">|</span></span><br><span class="line"><span class="string">          function()&#123;</span></span><br><span class="line"><span class="string">            return axios.get(&#x27;https://v1.hitokoto.cn?c=i&#x27;)</span></span><br><span class="line"><span class="string">              .then(function (response) &#123;</span></span><br><span class="line"><span class="string">                return response.data.hitokoto ;</span></span><br><span class="line"><span class="string">              &#125;)</span></span><br><span class="line"><span class="string">              .catch(function (error) &#123;</span></span><br><span class="line"><span class="string">                console.error(error);</span></span><br><span class="line"><span class="string">              &#125;);</span></span><br><span class="line"><span class="string">          &#125;</span></span><br><span class="line"><span class="string"></span>        <span class="comment"># wordTheDay: true</span></span><br><span class="line">        <span class="comment"># 自定义  https://v1.hitokoto.cn  数据</span></span><br><span class="line">        <span class="comment"># wordTheDay: |</span></span><br><span class="line">        <span class="comment">#   function(wordTheDayData)&#123;</span></span><br><span class="line">        <span class="comment">#     return `$&#123;wordTheDayData.hitokoto&#125;    by.$&#123;wordTheDayData.from&#125;`;</span></span><br><span class="line">        <span class="comment">#   &#125;</span></span><br><span class="line">  <span class="comment"># then: |</span></span><br><span class="line">  <span class="comment">#   (oml2d)=&gt;&#123;</span></span><br><span class="line">  <span class="comment">#      setTimeout(() =&gt; &#123;</span></span><br><span class="line">  <span class="comment">#     oml2d.tipsMessage(&#x27;hello world&#x27;, 3000, 10);</span></span><br><span class="line">  <span class="comment">#   &#125;, 8000);</span></span><br><span class="line">  <span class="comment">#   &#125;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Live2D</span></span><br><span class="line"><span class="comment">## https://github.com/EYHN/hexo-helper-live2d</span></span><br><span class="line"><span class="attr">live2d:</span></span><br><span class="line">  <span class="attr">enable:</span> <span class="literal">false</span> <span class="comment">#开关插件版看板娘</span></span><br><span class="line">  <span class="attr">scriptFrom:</span> <span class="string">local</span> <span class="comment"># 默认</span></span><br><span class="line">  <span class="comment"># scriptFrom: https://cdn.cbd.int/live2d-widget@3.x/lib/L2Dwidget.min.js # 你的自定义 url</span></span><br><span class="line">  <span class="attr">tagMode:</span> <span class="literal">false</span> <span class="comment"># 标签模式, 是否仅替换 live2d tag标签而非插入到所有页面中</span></span><br><span class="line">  <span class="attr">debug:</span> <span class="literal">false</span> <span class="comment"># 调试, 是否在控制台输出日志</span></span><br><span class="line">  <span class="attr">model:</span></span><br><span class="line">    <span class="attr">use:</span> <span class="string">live2d-widget-model-koharu</span> <span class="comment"># npm-module package name</span></span><br><span class="line">    <span class="comment"># use: https://unpkg.com/live2d-widget-model-koharu@1.0.5/assets/koharu.model.json # 你的自定义 url</span></span><br><span class="line">  <span class="attr">display:</span></span><br><span class="line">    <span class="attr">position:</span> <span class="string">left</span> <span class="comment">#控制看板娘位置</span></span><br><span class="line">    <span class="attr">width:</span> <span class="number">150</span> <span class="comment">#控制看板娘大小</span></span><br><span class="line">    <span class="attr">height:</span> <span class="number">300</span> <span class="comment">#控制看板娘大小</span></span><br><span class="line">  <span class="attr">mobile:</span></span><br><span class="line">    <span class="attr">show:</span> <span class="literal">false</span> <span class="comment"># 手机中是否展示</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># https://github.com/hexojs/hexo-generator-sitemap</span></span><br><span class="line"><span class="attr">sitemap:</span></span><br><span class="line">  <span class="attr">path:</span> <span class="string">sitemap.xml</span></span><br><span class="line">  <span class="attr">rel:</span> <span class="literal">false</span></span><br><span class="line">  <span class="attr">tags:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">categories:</span> <span class="literal">true</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># https://github.com/coneycode/hexo-generator-baidu-sitemap</span></span><br><span class="line"><span class="attr">baidusitemap:</span></span><br><span class="line">    <span class="attr">path:</span> <span class="string">baidusitemap.xml</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># https://github.com/hexojs/hexo-generator-feed</span></span><br><span class="line"><span class="comment">#Feed Atom</span></span><br><span class="line"><span class="attr">feed:</span></span><br><span class="line">    <span class="attr">type:</span> <span class="string">atom</span></span><br><span class="line">    <span class="attr">path:</span> <span class="string">atom.xml</span></span><br><span class="line">    <span class="attr">limit:</span> <span class="number">20</span></span><br><span class="line"><span class="attr">rss:</span> <span class="string">/atom.xml</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Extensions</span></span><br><span class="line"><span class="attr">plugins:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">hexo-generator-feed</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">hexo-generator-baidu-sitemap</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">hexo-generator-sitemap</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 追番插件</span></span><br><span class="line"><span class="comment"># https://github.com/HCLonely/hexo-bilibili-bangumi</span></span><br><span class="line"><span class="attr">bangumi:</span> <span class="comment"># 追番设置</span></span><br><span class="line">  <span class="attr">enable:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">source:</span> <span class="string">&#x27;bangumi&#x27;</span> <span class="comment"># 数据源</span></span><br><span class="line">  <span class="attr">bamInfoApi:</span> <span class="string">bgmApi</span></span><br><span class="line">  <span class="attr">path:</span> <span class="string">bangumis/index.html</span></span><br><span class="line">  <span class="attr">vmid:</span> <span class="number">922968</span></span><br><span class="line">  <span class="attr">title:</span> <span class="string">&#x27;追番列表&#x27;</span></span><br><span class="line">  <span class="attr">quote:</span> <span class="string">&#x27;生命不息，追番不止！&#x27;</span></span><br><span class="line">  <span class="attr">show:</span> <span class="number">1</span></span><br><span class="line">  <span class="attr">lazyload:</span> <span class="literal">false</span></span><br><span class="line">  <span class="attr">loading:</span></span><br><span class="line">  <span class="attr">metaColor:</span></span><br><span class="line">  <span class="attr">color:</span></span><br><span class="line">  <span class="attr">webp:</span></span><br><span class="line">  <span class="attr">progress:</span></span><br><span class="line">  <span class="attr">extra_options:</span></span><br><span class="line">    <span class="attr">key:</span> <span class="string">value</span></span><br><span class="line"><span class="attr">cinema:</span> <span class="comment"># 追剧设置</span></span><br><span class="line">  <span class="attr">enable:</span> <span class="literal">false</span></span><br><span class="line">  <span class="attr">path:</span></span><br><span class="line">  <span class="attr">vmid:</span> <span class="number">893746</span></span><br><span class="line">  <span class="attr">title:</span> <span class="string">&#x27;追剧列表&#x27;</span></span><br><span class="line">  <span class="attr">quote:</span> <span class="string">&#x27;生命不息，追剧不止！&#x27;</span></span><br><span class="line">  <span class="attr">show:</span> <span class="number">1</span></span><br><span class="line">  <span class="attr">lazyload:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">loading:</span></span><br><span class="line">  <span class="attr">metaColor:</span></span><br><span class="line">  <span class="attr">color:</span></span><br><span class="line">  <span class="attr">webp:</span></span><br><span class="line">  <span class="attr">progress:</span></span><br><span class="line">  <span class="attr">extra_options:</span></span><br><span class="line">    <span class="attr">key:</span> <span class="string">value</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># APlayer</span></span><br><span class="line"><span class="comment"># https://github.com/MoePlayer/hexo-tag-aplayer/blob/master/docs/README-zh_cn.md</span></span><br><span class="line"><span class="attr">aplayer:</span></span><br><span class="line">  <span class="attr">meting:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">asset_inject:</span> <span class="literal">false</span></span><br></pre></td></tr></table></figure><h2 id="配置文章链接转数字或字母"><a href="#配置文章链接转数字或字母" class="headerlink" title="配置文章链接转数字或字母"></a>配置文章链接转数字或字母</h2><p>参考: <a href="https://github.com/rozbo/hexo-abbrlink">https://github.com/rozbo/hexo-abbrlink</a></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install hexo-abbrlink --save</span><br></pre></td></tr></table></figure><h2 id="本地搜索依赖"><a href="#本地搜索依赖" class="headerlink" title="本地搜索依赖"></a>本地搜索依赖</h2><p>参考：<a href="https://github.com/wzpan/hexo-generator-search">https://github.com/wzpan/hexo-generator-search</a></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install hexo-generator-search --save</span><br></pre></td></tr></table></figure><h2 id="live2d"><a href="#live2d" class="headerlink" title="live2d"></a>live2d</h2><h3 id="oh-my-live2d"><a href="#oh-my-live2d" class="headerlink" title="oh-my-live2d"></a>oh-my-live2d</h3><p>详见<a href="https://github.com/oh-my-live2d/oh-my-live2d">oh-my-live2d</a></p><p>可配合<a href="https://www.bilibili.com/video/BV1ptPkebEqZ/?spm_id_from=333.1391.0.0&amp;vd_source=454daec0d47ca18c274839cc9cff23ca">2025最新hexo配置live2d看板娘</a>观看</p><h3 id="helper-live2d"><a href="#helper-live2d" class="headerlink" title="helper-live2d"></a>helper-live2d</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 安装live2d</span></span><br><span class="line">npm install --save hexo-helper-live2d</span><br></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 安装模型</span></span><br><span class="line">npm install --save live2d-widget-model-koharu</span><br></pre></td></tr></table></figure><h2 id="sitemap"><a href="#sitemap" class="headerlink" title="sitemap"></a>sitemap</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">npm install hexo-generator-sitemap --save</span><br><span class="line">npm install hexo-generator-baidu-sitemap --save-dev</span><br></pre></td></tr></table></figure><h2 id="Rss"><a href="#Rss" class="headerlink" title="Rss"></a>Rss</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install hexo-generator-feed --save</span><br></pre></td></tr></table></figure><h2 id="追番插件"><a href="#追番插件" class="headerlink" title="追番插件"></a>追番插件</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install hexo-bilibili-bangumi --save</span><br></pre></td></tr></table></figure><p>详见<a href="https://github.com/HCLonely/hexo-bilibili-bangumi?tab=readme-ov-file#获取-bangumi-id">HCLonely/hexo-bilibili-bangumi: hexo 番剧页面插件，可选数据源：Bilibili, Bangumi</a></p><div class="note info flat"><p>记得<code>hexo bangumi -u</code>命令更新追番数据哦</p></div><h2 id="aplayer-音乐播放器"><a href="#aplayer-音乐播放器" class="headerlink" title="aplayer 音乐播放器"></a>aplayer 音乐播放器</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install hexo-tag-aplayer --save</span><br></pre></td></tr></table></figure><p>找到_config.butterfly.yml修改</p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">aplayerInject:</span></span><br><span class="line">  <span class="attr">enable:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">per_page:</span> <span class="literal">true</span></span><br></pre></td></tr></table></figure><p>在同文件下找到<strong>inject</strong>，在bottom下引入</p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># aplayer音乐</span></span><br><span class="line"><span class="bullet">-</span> <span class="string">&lt;div</span> <span class="string">class=&quot;aplayer</span> <span class="literal">no</span><span class="string">-destroy&quot;</span> <span class="string">data-id=&quot;8152976493&quot;</span> <span class="string">data-server=&quot;netease&quot;</span> <span class="string">data-type=&quot;playlist&quot;</span>   <span class="string">data-order=&quot;list&quot;</span> <span class="string">data-fixed=&quot;true&quot;</span> <span class="string">data-preload=&quot;auto&quot;</span> <span class="string">data-autoplay=&quot;false&quot;</span> <span class="string">data-mutex=&quot;true&quot;</span> <span class="string">&gt;&lt;/div&gt;</span></span><br></pre></td></tr></table></figure><blockquote><p>server可选：netease（网易云音乐），tencent（QQ音乐），kugou（酷狗音乐），xiami（虾米音乐），baidu（百度音乐）。建议网易云<br>type可选：song（歌曲），playlist（歌单），album（专辑），search（搜索关键字），artist（歌手）。添加单曲选的歌曲，歌单选择playlist，可以自行尝试。<br>id获取示例: 打开网易云音乐，选择喜欢的歌单，在网页版打开，获取歌单list，填入即可。使用的时候将上边的ID号换为自己喜欢的歌单即可。注意歌单中不能包括VIP音乐，否则无法解析。建议单独建立一个歌单，以后有喜欢的音乐添加进去，网页也会自动同步添加。<br>lrcType设置为 -1默认显示歌词，放在fixed模式下比较合适。</p></blockquote><h2 id="配置自定义-css"><a href="#配置自定义-css" class="headerlink" title="配置自定义 css"></a>配置自定义 css</h2><p>新建文件<code>[Blogroot]/source/css/custom.css</code>,在 custom.css 中填入以下内容</p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br><span class="line">407</span><br><span class="line">408</span><br><span class="line">409</span><br><span class="line">410</span><br><span class="line">411</span><br><span class="line">412</span><br><span class="line">413</span><br><span class="line">414</span><br><span class="line">415</span><br><span class="line">416</span><br><span class="line">417</span><br><span class="line">418</span><br><span class="line">419</span><br><span class="line">420</span><br><span class="line">421</span><br><span class="line">422</span><br><span class="line">423</span><br><span class="line">424</span><br><span class="line">425</span><br><span class="line">426</span><br><span class="line">427</span><br><span class="line">428</span><br><span class="line">429</span><br><span class="line">430</span><br><span class="line">431</span><br><span class="line">432</span><br><span class="line">433</span><br><span class="line">434</span><br><span class="line">435</span><br><span class="line">436</span><br><span class="line">437</span><br><span class="line">438</span><br><span class="line">439</span><br><span class="line">440</span><br><span class="line">441</span><br><span class="line">442</span><br><span class="line">443</span><br><span class="line">444</span><br><span class="line">445</span><br><span class="line">446</span><br><span class="line">447</span><br><span class="line">448</span><br><span class="line">449</span><br><span class="line">450</span><br><span class="line">451</span><br><span class="line">452</span><br><span class="line">453</span><br><span class="line">454</span><br><span class="line">455</span><br><span class="line">456</span><br><span class="line">457</span><br><span class="line">458</span><br><span class="line">459</span><br><span class="line">460</span><br><span class="line">461</span><br><span class="line">462</span><br><span class="line">463</span><br><span class="line">464</span><br><span class="line">465</span><br><span class="line">466</span><br><span class="line">467</span><br><span class="line">468</span><br><span class="line">469</span><br><span class="line">470</span><br><span class="line">471</span><br><span class="line">472</span><br><span class="line">473</span><br><span class="line">474</span><br><span class="line">475</span><br><span class="line">476</span><br><span class="line">477</span><br><span class="line">478</span><br><span class="line">479</span><br><span class="line">480</span><br><span class="line">481</span><br><span class="line">482</span><br><span class="line">483</span><br><span class="line">484</span><br><span class="line">485</span><br><span class="line">486</span><br><span class="line">487</span><br><span class="line">488</span><br><span class="line">489</span><br><span class="line">490</span><br><span class="line">491</span><br><span class="line">492</span><br><span class="line">493</span><br><span class="line">494</span><br><span class="line">495</span><br><span class="line">496</span><br><span class="line">497</span><br><span class="line">498</span><br><span class="line">499</span><br><span class="line">500</span><br><span class="line">501</span><br><span class="line">502</span><br><span class="line">503</span><br><span class="line">504</span><br><span class="line">505</span><br><span class="line">506</span><br><span class="line">507</span><br><span class="line">508</span><br><span class="line">509</span><br><span class="line">510</span><br><span class="line">511</span><br><span class="line">512</span><br><span class="line">513</span><br><span class="line">514</span><br><span class="line">515</span><br><span class="line">516</span><br><span class="line">517</span><br><span class="line">518</span><br><span class="line">519</span><br><span class="line">520</span><br><span class="line">521</span><br><span class="line">522</span><br><span class="line">523</span><br><span class="line">524</span><br><span class="line">525</span><br><span class="line">526</span><br><span class="line">527</span><br><span class="line">528</span><br><span class="line">529</span><br><span class="line">530</span><br><span class="line">531</span><br><span class="line">532</span><br><span class="line">533</span><br><span class="line">534</span><br><span class="line">535</span><br><span class="line">536</span><br><span class="line">537</span><br><span class="line">538</span><br><span class="line">539</span><br><span class="line">540</span><br><span class="line">541</span><br><span class="line">542</span><br><span class="line">543</span><br><span class="line">544</span><br><span class="line">545</span><br><span class="line">546</span><br><span class="line">547</span><br><span class="line">548</span><br><span class="line">549</span><br><span class="line">550</span><br><span class="line">551</span><br><span class="line">552</span><br><span class="line">553</span><br><span class="line">554</span><br><span class="line">555</span><br><span class="line">556</span><br><span class="line">557</span><br><span class="line">558</span><br><span class="line">559</span><br><span class="line">560</span><br><span class="line">561</span><br><span class="line">562</span><br><span class="line">563</span><br><span class="line">564</span><br><span class="line">565</span><br><span class="line">566</span><br><span class="line">567</span><br><span class="line">568</span><br><span class="line">569</span><br><span class="line">570</span><br><span class="line">571</span><br><span class="line">572</span><br><span class="line">573</span><br><span class="line">574</span><br><span class="line">575</span><br><span class="line">576</span><br><span class="line">577</span><br><span class="line">578</span><br><span class="line">579</span><br><span class="line">580</span><br><span class="line">581</span><br><span class="line">582</span><br><span class="line">583</span><br><span class="line">584</span><br><span class="line">585</span><br><span class="line">586</span><br><span class="line">587</span><br><span class="line">588</span><br><span class="line">589</span><br><span class="line">590</span><br><span class="line">591</span><br><span class="line">592</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">/*</span> <span class="string">@font-face</span> &#123;</span><br><span class="line">  <span class="attr">font-family:</span> <span class="string">Candyhome;</span></span><br><span class="line">  <span class="attr">src:</span> <span class="string">url(https://npm.elemecdn.com/anzhiyu-blog@1.1.6/fonts/Candyhome.ttf);</span></span><br><span class="line">  <span class="attr">font-display:</span> <span class="string">swap;</span></span><br><span class="line">  <span class="attr">font-weight:</span> <span class="string">lighter;</span></span><br><span class="line">&#125; <span class="string">*/</span></span><br><span class="line"><span class="string">@font-face</span> &#123;</span><br><span class="line">  <span class="attr">font-family:</span> <span class="string">ZhuZiAYuanJWD;</span></span><br><span class="line">  <span class="attr">src:</span> <span class="string">url(https://npm.elemecdn.com/anzhiyu-blog@1.1.6/fonts/ZhuZiAWan.woff2);</span></span><br><span class="line">  <span class="attr">font-display:</span> <span class="string">swap;</span></span><br><span class="line">  <span class="attr">font-weight:</span> <span class="string">lighter;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="string">div#menus</span> &#123;</span><br><span class="line">  <span class="attr">font-family:</span> <span class="string">&quot;ZhuZiAYuanJWD&quot;</span><span class="string">;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="string">h1#site-title</span> &#123;</span><br><span class="line">  <span class="attr">font-family:</span> <span class="string">ZhuZiAYuanJWD;</span></span><br><span class="line">  <span class="attr">font-size:</span> <span class="string">3em</span> <span class="type">!important;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="string">a.article-title,</span></span><br><span class="line"><span class="string">a.blog-slider__title,</span></span><br><span class="line"><span class="string">a.categoryBar-list-link,</span></span><br><span class="line"><span class="string">h1.post-title</span> &#123;</span><br><span class="line">  <span class="attr">font-family:</span> <span class="string">ZhuZiAYuanJWD;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="string">.iconfont</span> &#123;</span><br><span class="line">  <span class="attr">font-family:</span> <span class="string">&quot;iconfont&quot;</span> <span class="type">!important;</span></span><br><span class="line">  <span class="attr">font-size:</span> <span class="string">3em;</span></span><br><span class="line">  <span class="string">/*</span> <span class="string">可以定义图标大小</span> <span class="string">*/</span></span><br><span class="line">  <span class="attr">font-style:</span> <span class="string">normal;</span></span><br><span class="line">  <span class="string">-webkit-font-smoothing:</span> <span class="string">antialiased;</span></span><br><span class="line">  <span class="string">-moz-osx-font-smoothing:</span> <span class="string">grayscale;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="string">/*</span> <span class="string">时间轴生肖icon</span> <span class="string">*/</span></span><br><span class="line"><span class="string">svg.icon</span> &#123;</span><br><span class="line">  <span class="string">/*</span> <span class="string">这里定义svg.icon，避免和Butterfly自带的note标签冲突</span> <span class="string">*/</span></span><br><span class="line">  <span class="attr">width:</span> <span class="string">1em;</span></span><br><span class="line">  <span class="attr">height:</span> <span class="string">1em;</span></span><br><span class="line">  <span class="string">/*</span> <span class="string">width和height定义图标的默认宽度和高度*/</span></span><br><span class="line">  <span class="attr">vertical-align:</span> <span class="number">-0.</span><span class="string">15em;</span></span><br><span class="line">  <span class="attr">fill:</span> <span class="string">currentColor;</span></span><br><span class="line">  <span class="attr">overflow:</span> <span class="string">hidden;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="string">.icon-zhongbiao::before</span> &#123;</span><br><span class="line">  <span class="attr">color:</span> <span class="comment">#f7c768;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="string">/*</span> <span class="string">bilibli番剧插件</span> <span class="string">*/</span></span><br><span class="line"><span class="comment">#article-container .bangumi-tab.bangumi-active &#123;</span></span><br><span class="line">  <span class="attr">background:</span> <span class="string">var(--anzhiyu-theme);</span></span><br><span class="line">  <span class="attr">color:</span> <span class="string">var(--anzhiyu-ahoverbg);</span></span><br><span class="line">  <span class="attr">border-radius:</span> <span class="string">10px;</span></span><br><span class="line"><span class="string">&#125;</span></span><br><span class="line"></span><br><span class="line"><span class="string">a.bangumi-tab:hover</span> &#123;</span><br><span class="line">  <span class="attr">text-decoration:</span> <span class="string">none</span> <span class="type">!important;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="string">.bangumi-button:hover</span> &#123;</span><br><span class="line">  <span class="attr">background:</span> <span class="string">var(--anzhiyu-theme)</span> <span class="type">!important;</span></span><br><span class="line">  <span class="attr">border-radius:</span> <span class="string">10px</span> <span class="type">!important;</span></span><br><span class="line">  <span class="attr">color:</span> <span class="string">var(--anzhiyu-ahoverbg)</span> <span class="type">!important;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="string">a.bangumi-button.bangumi-nextpage:hover</span> &#123;</span><br><span class="line">  <span class="attr">text-decoration:</span> <span class="string">none</span> <span class="type">!important;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="string">.bangumi-button</span> &#123;</span><br><span class="line">  <span class="attr">padding:</span> <span class="string">5px</span> <span class="string">10px</span> <span class="type">!important;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="string">a.bangumi-tab</span> &#123;</span><br><span class="line">  <span class="attr">padding:</span> <span class="string">5px</span> <span class="string">10px</span> <span class="type">!important;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="string">svg.icon.faa-tada</span> &#123;</span><br><span class="line">  <span class="attr">font-size:</span> <span class="number">1.</span><span class="string">1em;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="string">.bangumi-info-item</span> &#123;</span><br><span class="line">  <span class="attr">border-right:</span> <span class="string">1px</span> <span class="string">solid</span> <span class="comment">#f2b94b;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="string">.bangumi-info-item</span> <span class="string">span</span> &#123;</span><br><span class="line">  <span class="attr">color:</span> <span class="comment">#f2b94b;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="string">.bangumi-info-item</span> <span class="string">em</span> &#123;</span><br><span class="line">  <span class="attr">color:</span> <span class="comment">#f2b94b;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="string">/*</span> <span class="string">解决artitalk的图标问题</span> <span class="string">*/</span></span><br><span class="line"><span class="comment">#uploadSource&gt;svg &#123;</span></span><br><span class="line">  <span class="attr">width:</span> <span class="number">1.</span><span class="string">19em;</span></span><br><span class="line">  <span class="attr">height:</span> <span class="number">1.</span><span class="string">5em;</span></span><br><span class="line"><span class="string">&#125;</span></span><br><span class="line"></span><br><span class="line"><span class="string">/*top-img黑色透明玻璃效果移除，不建议加，除非你执着于完全一图流或者背景图对比色明显</span> <span class="string">*/</span></span><br><span class="line"><span class="comment">#page-header:not(.not-top-img):before &#123;</span></span><br><span class="line">  <span class="attr">background-color:</span> <span class="string">transparent</span> <span class="type">!important;</span></span><br><span class="line"><span class="string">&#125;</span></span><br><span class="line"></span><br><span class="line"><span class="string">/*</span> <span class="string">首页文章卡片</span> <span class="string">*/</span></span><br><span class="line"><span class="comment">#recent-posts&gt;.recent-post-item &#123;</span></span><br><span class="line">  <span class="attr">background:</span> <span class="string">rgba(255,</span> <span class="number">255</span><span class="string">,</span> <span class="number">255</span><span class="string">,</span> <span class="number">0.9</span><span class="string">);</span></span><br><span class="line"><span class="string">&#125;</span></span><br><span class="line"></span><br><span class="line"><span class="string">/*</span> <span class="string">首页侧栏卡片</span> <span class="string">*/</span></span><br><span class="line"><span class="comment">#aside-content .card-widget &#123;</span></span><br><span class="line">  <span class="attr">background:</span> <span class="string">rgba(255,</span> <span class="number">255</span><span class="string">,</span> <span class="number">255</span><span class="string">,</span> <span class="number">0.9</span><span class="string">);</span></span><br><span class="line"><span class="string">&#125;</span></span><br><span class="line"></span><br><span class="line"><span class="string">/*</span> <span class="string">文章页面正文背景</span> <span class="string">*/</span></span><br><span class="line"><span class="string">div#post</span> &#123;</span><br><span class="line">  <span class="attr">background:</span> <span class="string">rgba(255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">0.9</span><span class="string">);</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="string">/*</span> <span class="string">分页页面</span> <span class="string">*/</span></span><br><span class="line"><span class="string">div#page</span> &#123;</span><br><span class="line">  <span class="attr">background:</span> <span class="string">rgba(255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">0.9</span><span class="string">);</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="string">/*</span> <span class="string">归档页面</span> <span class="string">*/</span></span><br><span class="line"><span class="string">div#archive</span> &#123;</span><br><span class="line">  <span class="attr">background:</span> <span class="string">rgba(255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">0.9</span><span class="string">);</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="string">/*</span> <span class="string">标签页面</span> <span class="string">*/</span></span><br><span class="line"><span class="string">div#tag</span> &#123;</span><br><span class="line">  <span class="attr">background:</span> <span class="string">rgba(255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">0.9</span><span class="string">);</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="string">/*</span> <span class="string">分类页面</span> <span class="string">*/</span></span><br><span class="line"><span class="string">div#category</span> &#123;</span><br><span class="line">  <span class="attr">background:</span> <span class="string">rgba(255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">0.9</span><span class="string">);</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="string">/*夜间模式伪类遮罩层透明*/</span></span><br><span class="line">[<span class="string">data-theme=&quot;dark&quot;</span>] <span class="comment">#recent-posts&gt;.recent-post-item &#123;</span></span><br><span class="line">  <span class="attr">background:</span> <span class="comment">#121212;</span></span><br><span class="line"><span class="string">&#125;</span></span><br><span class="line"></span><br><span class="line">[<span class="string">data-theme=&quot;dark&quot;</span>] <span class="string">.card-widget</span> &#123;</span><br><span class="line">  <span class="attr">background:</span> <span class="comment">#121212 !important;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">[<span class="string">data-theme=&quot;dark&quot;</span>] <span class="string">div#post</span> &#123;</span><br><span class="line">  <span class="attr">background:</span> <span class="comment">#121212 !important;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">[<span class="string">data-theme=&quot;dark&quot;</span>] <span class="string">div#tag</span> &#123;</span><br><span class="line">  <span class="attr">background:</span> <span class="comment">#121212 !important;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">[<span class="string">data-theme=&quot;dark&quot;</span>] <span class="string">div#archive</span> &#123;</span><br><span class="line">  <span class="attr">background:</span> <span class="comment">#121212 !important;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">[<span class="string">data-theme=&quot;dark&quot;</span>] <span class="string">div#page</span> &#123;</span><br><span class="line">  <span class="attr">background:</span> <span class="comment">#121212 !important;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">[<span class="string">data-theme=&quot;dark&quot;</span>] <span class="string">div#category</span> &#123;</span><br><span class="line">  <span class="attr">background:</span> <span class="comment">#121212 !important;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">[<span class="string">data-theme=&quot;dark&quot;</span>] <span class="string">div#category</span> &#123;</span><br><span class="line">  <span class="attr">background:</span> <span class="string">transparent</span> <span class="type">!important;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="string">/*</span> <span class="string">页脚透明</span> <span class="string">*/</span></span><br><span class="line"><span class="comment">#footer &#123;</span></span><br><span class="line">  <span class="attr">background:</span> <span class="string">transparent</span> <span class="type">!important;</span></span><br><span class="line"><span class="string">&#125;</span></span><br><span class="line"></span><br><span class="line"><span class="string">/*</span> <span class="string">头图透明</span> <span class="string">*/</span></span><br><span class="line"><span class="comment">#page-header &#123;</span></span><br><span class="line">  <span class="attr">background:</span> <span class="string">transparent</span> <span class="type">!important;</span></span><br><span class="line"><span class="string">&#125;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#rightside&gt;div&gt;button &#123;</span></span><br><span class="line">  <span class="attr">border-radius:</span> <span class="string">5px;</span></span><br><span class="line"><span class="string">&#125;</span></span><br><span class="line"></span><br><span class="line"><span class="string">/*</span> <span class="string">滚动条</span> <span class="string">*/</span></span><br><span class="line"></span><br><span class="line"><span class="string">::-webkit-scrollbar</span> &#123;</span><br><span class="line">  <span class="attr">width:</span> <span class="string">10px;</span></span><br><span class="line">  <span class="attr">height:</span> <span class="string">10px;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="string">::-webkit-scrollbar-thumb</span> &#123;</span><br><span class="line">  <span class="attr">background-color:</span> <span class="comment">#3b70fc;</span></span><br><span class="line">  <span class="attr">border-radius:</span> <span class="string">2em;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="string">::-webkit-scrollbar-corner</span> &#123;</span><br><span class="line">  <span class="attr">background-color:</span> <span class="string">transparent;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="string">::-moz-selection</span> &#123;</span><br><span class="line">  <span class="attr">color:</span> <span class="comment">#fff;</span></span><br><span class="line">  <span class="attr">background-color:</span> <span class="comment">#3b70fc;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="string">/*</span> <span class="string">音乐播放器</span> <span class="string">*/</span></span><br><span class="line"></span><br><span class="line"><span class="string">/*</span> <span class="string">.aplayer</span> <span class="string">.aplayer-lrc</span> &#123;</span><br><span class="line">    <span class="attr">display:</span> <span class="string">none</span> <span class="type">!important;</span></span><br><span class="line">  &#125; <span class="string">*/</span></span><br><span class="line"></span><br><span class="line"><span class="string">.aplayer.aplayer-fixed.aplayer-narrow</span> <span class="string">.aplayer-body</span> &#123;</span><br><span class="line">  <span class="attr">left:</span> <span class="string">-66px</span> <span class="type">!important;</span></span><br><span class="line">  <span class="attr">transition:</span> <span class="string">all</span> <span class="number">0.</span><span class="string">3s;</span></span><br><span class="line">  <span class="string">/*</span> <span class="string">默认情况下缩进左侧66px，只留一点箭头部分</span> <span class="string">*/</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="string">.aplayer.aplayer-fixed.aplayer-narrow</span> <span class="string">.aplayer-body:hover</span> &#123;</span><br><span class="line">  <span class="attr">left:</span> <span class="number">0</span> <span class="type">!important;</span></span><br><span class="line">  <span class="attr">transition:</span> <span class="string">all</span> <span class="number">0.</span><span class="string">3s;</span></span><br><span class="line">  <span class="string">/*</span> <span class="string">鼠标悬停是左侧缩进归零，完全显示按钮</span> <span class="string">*/</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="string">.aplayer.aplayer-fixed</span> &#123;</span><br><span class="line">  <span class="attr">z-index:</span> <span class="number">999999</span> <span class="type">!important;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="string">/*</span> <span class="string">评论框</span>  <span class="string">*/</span></span><br><span class="line"><span class="string">.vwrap</span> &#123;</span><br><span class="line">  <span class="attr">box-shadow:</span> <span class="string">2px</span> <span class="string">2px</span> <span class="string">5px</span> <span class="comment">#bbb;</span></span><br><span class="line">  <span class="attr">background:</span> <span class="string">rgba(255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">0.3</span><span class="string">);</span></span><br><span class="line">  <span class="attr">border-radius:</span> <span class="string">8px;</span></span><br><span class="line">  <span class="attr">padding:</span> <span class="string">30px;</span></span><br><span class="line">  <span class="attr">margin:</span> <span class="string">30px</span> <span class="string">0px</span> <span class="string">30px</span> <span class="string">0px;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="string">/*</span> <span class="string">设置评论框</span> <span class="string">*/</span></span><br><span class="line"></span><br><span class="line"><span class="string">.vcard</span> &#123;</span><br><span class="line">  <span class="attr">box-shadow:</span> <span class="string">2px</span> <span class="string">2px</span> <span class="string">5px</span> <span class="comment">#bbb;</span></span><br><span class="line">  <span class="attr">background:</span> <span class="string">rgba(255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">0.3</span><span class="string">);</span></span><br><span class="line">  <span class="attr">border-radius:</span> <span class="string">8px;</span></span><br><span class="line">  <span class="attr">padding:</span> <span class="string">30px;</span></span><br><span class="line">  <span class="attr">margin:</span> <span class="string">30px</span> <span class="string">0px</span> <span class="string">0px</span> <span class="string">0px;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="string">/*</span> <span class="string">md网站下划线</span> <span class="string">*/</span></span><br><span class="line"><span class="comment">#article-container a:hover &#123;</span></span><br><span class="line">  <span class="attr">text-decoration:</span> <span class="string">none</span> <span class="type">!important;</span></span><br><span class="line"><span class="string">&#125;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#article-container #hpp_talk p img &#123;</span></span><br><span class="line">  <span class="attr">display:</span> <span class="string">inline;</span></span><br><span class="line"><span class="string">&#125;</span></span><br><span class="line"></span><br><span class="line"><span class="string">/*</span> <span class="number">404</span><span class="string">页面</span> <span class="string">*/</span></span><br><span class="line"><span class="comment">#error-wrap &#123;</span></span><br><span class="line">  <span class="attr">position:</span> <span class="string">absolute;</span></span><br><span class="line">  <span class="attr">top:</span> <span class="number">40</span><span class="string">%;</span></span><br><span class="line">  <span class="attr">right:</span> <span class="number">0</span><span class="string">;</span></span><br><span class="line">  <span class="attr">left:</span> <span class="number">0</span><span class="string">;</span></span><br><span class="line">  <span class="attr">margin:</span> <span class="number">0</span> <span class="string">auto;</span></span><br><span class="line">  <span class="attr">padding:</span> <span class="number">0</span> <span class="string">1rem;</span></span><br><span class="line">  <span class="attr">max-width:</span> <span class="string">1000px;</span></span><br><span class="line">  <span class="attr">transform:</span> <span class="string">translate(0,</span> <span class="number">-50</span><span class="string">%);</span></span><br><span class="line"><span class="string">&#125;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#error-wrap .error-content &#123;</span></span><br><span class="line">  <span class="attr">display:</span> <span class="string">flex;</span></span><br><span class="line">  <span class="attr">flex-direction:</span> <span class="string">row;</span></span><br><span class="line">  <span class="attr">justify-content:</span> <span class="string">center;</span></span><br><span class="line">  <span class="attr">align-items:</span> <span class="string">center;</span></span><br><span class="line">  <span class="attr">margin:</span> <span class="number">0</span> <span class="string">1rem;</span></span><br><span class="line">  <span class="attr">height:</span> <span class="string">18rem;</span></span><br><span class="line">  <span class="attr">border-radius:</span> <span class="string">8px;</span></span><br><span class="line">  <span class="attr">background:</span> <span class="string">var(--card-bg);</span></span><br><span class="line">  <span class="attr">box-shadow:</span> <span class="string">var(--card-box-shadow);</span></span><br><span class="line">  <span class="attr">transition:</span> <span class="string">all</span> <span class="number">0.</span><span class="string">3s;</span></span><br><span class="line"><span class="string">&#125;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#error-wrap .error-content .error-img &#123;</span></span><br><span class="line">  <span class="attr">box-flex:</span> <span class="number">1</span><span class="string">;</span></span><br><span class="line">  <span class="attr">flex:</span> <span class="number">1</span><span class="string">;</span></span><br><span class="line">  <span class="attr">height:</span> <span class="number">100</span><span class="string">%;</span></span><br><span class="line">  <span class="attr">border-top-left-radius:</span> <span class="string">8px;</span></span><br><span class="line">  <span class="attr">border-bottom-left-radius:</span> <span class="string">8px;</span></span><br><span class="line">  <span class="attr">background-color:</span> <span class="comment">#3b70fc;</span></span><br><span class="line">  <span class="attr">background-position:</span> <span class="string">center;</span></span><br><span class="line">  <span class="attr">background-size:</span> <span class="string">cover;</span></span><br><span class="line"><span class="string">&#125;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#error-wrap .error-content .error-info &#123;</span></span><br><span class="line">  <span class="attr">box-flex:</span> <span class="number">1</span><span class="string">;</span></span><br><span class="line">  <span class="attr">flex:</span> <span class="number">1</span><span class="string">;</span></span><br><span class="line">  <span class="attr">padding:</span> <span class="number">0.</span><span class="string">5rem;</span></span><br><span class="line">  <span class="attr">text-align:</span> <span class="string">center;</span></span><br><span class="line">  <span class="attr">font-size:</span> <span class="string">14px;</span></span><br><span class="line">  <span class="attr">font-family:</span> <span class="string">Titillium</span> <span class="string">Web,</span> <span class="string">&quot;PingFang SC&quot;</span><span class="string">,</span> <span class="string">&quot;Hiragino Sans GB&quot;</span><span class="string">,</span> <span class="string">&quot;Microsoft JhengHei&quot;</span><span class="string">,</span> <span class="string">&quot;Microsoft YaHei&quot;</span><span class="string">,</span> <span class="string">sans-serif;</span></span><br><span class="line"><span class="string">&#125;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#error-wrap .error-content .error-info .error_title &#123;</span></span><br><span class="line">  <span class="attr">margin-top:</span> <span class="string">-4rem;</span></span><br><span class="line">  <span class="attr">font-size:</span> <span class="string">9em;</span></span><br><span class="line"><span class="string">&#125;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#error-wrap .error-content .error-info .error_subtitle &#123;</span></span><br><span class="line">  <span class="attr">margin-top:</span> <span class="number">-3.</span><span class="string">5rem;</span></span><br><span class="line">  <span class="attr">word-break:</span> <span class="string">break-word;</span></span><br><span class="line">  <span class="attr">font-size:</span> <span class="number">1.</span><span class="string">6em;</span></span><br><span class="line"><span class="string">&#125;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#error-wrap .error-content .error-info a &#123;</span></span><br><span class="line">  <span class="attr">display:</span> <span class="string">inline-block;</span></span><br><span class="line">  <span class="attr">margin-top:</span> <span class="number">0.</span><span class="string">5rem;</span></span><br><span class="line">  <span class="attr">padding:</span> <span class="number">0.</span><span class="string">3rem</span> <span class="number">1.</span><span class="string">5rem;</span></span><br><span class="line">  <span class="attr">background:</span> <span class="string">var(--btn-bg);</span></span><br><span class="line">  <span class="attr">color:</span> <span class="string">var(--btn-color);</span></span><br><span class="line"><span class="string">&#125;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#body-wrap.error .aside-list &#123;</span></span><br><span class="line">  <span class="attr">display:</span> <span class="string">flex;</span></span><br><span class="line">  <span class="attr">flex-direction:</span> <span class="string">row;</span></span><br><span class="line">  <span class="attr">flex-wrap:</span> <span class="string">nowrap;</span></span><br><span class="line">  <span class="attr">bottom:</span> <span class="string">0px;</span></span><br><span class="line">  <span class="attr">position:</span> <span class="string">absolute;</span></span><br><span class="line">  <span class="attr">padding:</span> <span class="string">1rem;</span></span><br><span class="line">  <span class="attr">width:</span> <span class="number">100</span><span class="string">%;</span></span><br><span class="line">  <span class="attr">overflow:</span> <span class="string">scroll;</span></span><br><span class="line"><span class="string">&#125;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#body-wrap.error .aside-list .aside-list-group &#123;</span></span><br><span class="line">  <span class="attr">display:</span> <span class="string">flex;</span></span><br><span class="line">  <span class="attr">flex-direction:</span> <span class="string">row;</span></span><br><span class="line">  <span class="attr">flex-wrap:</span> <span class="string">nowrap;</span></span><br><span class="line">  <span class="attr">max-width:</span> <span class="string">1200px;</span></span><br><span class="line">  <span class="attr">margin:</span> <span class="number">0</span> <span class="string">auto;</span></span><br><span class="line"><span class="string">&#125;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#body-wrap.error .aside-list .aside-list-item &#123;</span></span><br><span class="line">  <span class="attr">padding:</span> <span class="number">0.</span><span class="string">5rem;</span></span><br><span class="line"><span class="string">&#125;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#body-wrap.error .aside-list .aside-list-item img &#123;</span></span><br><span class="line">  <span class="attr">width:</span> <span class="number">100</span><span class="string">%;</span></span><br><span class="line">  <span class="attr">object-fit:</span> <span class="string">cover;</span></span><br><span class="line">  <span class="attr">border-radius:</span> <span class="string">12px;</span></span><br><span class="line"><span class="string">&#125;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#body-wrap.error .aside-list .aside-list-item .thumbnail &#123;</span></span><br><span class="line">  <span class="attr">overflow:</span> <span class="string">hidden;</span></span><br><span class="line">  <span class="attr">width:</span> <span class="string">230px;</span></span><br><span class="line">  <span class="attr">height:</span> <span class="string">143px;</span></span><br><span class="line">  <span class="attr">background:</span> <span class="string">var(--anzhiyu-card-bg);</span></span><br><span class="line">  <span class="attr">display:</span> <span class="string">flex;</span></span><br><span class="line"><span class="string">&#125;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#body-wrap.error .aside-list .aside-list-item .content .title &#123;</span></span><br><span class="line">  <span class="string">-webkit-line-clamp:</span> <span class="number">2</span><span class="string">;</span></span><br><span class="line">  <span class="attr">overflow:</span> <span class="string">hidden;</span></span><br><span class="line">  <span class="attr">display:</span> <span class="string">-webkit-box;</span></span><br><span class="line">  <span class="string">-webkit-box-orient:</span> <span class="string">vertical;</span></span><br><span class="line">  <span class="attr">line-height:</span> <span class="number">1.5</span><span class="string">;</span></span><br><span class="line">  <span class="attr">justify-content:</span> <span class="string">center;</span></span><br><span class="line">  <span class="attr">align-items:</span> <span class="string">flex-end;</span></span><br><span class="line">  <span class="attr">align-content:</span> <span class="string">center;</span></span><br><span class="line">  <span class="attr">padding-top:</span> <span class="number">0.</span><span class="string">5rem;</span></span><br><span class="line">  <span class="attr">color:</span> <span class="string">white;</span></span><br><span class="line"><span class="string">&#125;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#body-wrap.error .aside-list .aside-list-item .content time &#123;</span></span><br><span class="line">  <span class="attr">display:</span> <span class="string">none;</span></span><br><span class="line"><span class="string">&#125;</span></span><br><span class="line"></span><br><span class="line"><span class="string">/*</span> <span class="string">代码框主题</span> <span class="string">*/</span></span><br><span class="line"><span class="comment">#article-container figure.highlight &#123;</span></span><br><span class="line">  <span class="attr">border-radius:</span> <span class="string">10px;</span></span><br><span class="line"><span class="string">&#125;</span></span><br><span class="line"></span><br><span class="line"><span class="string">/*</span> <span class="string">鼠标样式</span> <span class="string">*/</span></span><br><span class="line"><span class="comment">#cursor &#123;</span></span><br><span class="line">  <span class="attr">position:</span> <span class="string">fixed;</span></span><br><span class="line">  <span class="attr">width:</span> <span class="string">16px;</span></span><br><span class="line">  <span class="attr">height:</span> <span class="string">16px;</span></span><br><span class="line">  <span class="string">/*</span> <span class="string">这里改变跟随的底色</span> <span class="string">*/</span></span><br><span class="line">  <span class="attr">background:</span> <span class="string">rgb(234,</span> <span class="number">255</span><span class="string">,</span> <span class="number">5</span><span class="string">);</span></span><br><span class="line">  <span class="attr">border-radius:</span> <span class="string">8px;</span></span><br><span class="line">  <span class="attr">opacity:</span> <span class="number">0.25</span><span class="string">;</span></span><br><span class="line">  <span class="attr">z-index:</span> <span class="number">10086</span><span class="string">;</span></span><br><span class="line">  <span class="attr">pointer-events:</span> <span class="string">none;</span></span><br><span class="line">  <span class="attr">transition:</span> <span class="number">0.</span><span class="string">2s</span> <span class="string">ease-in-out;</span></span><br><span class="line">  <span class="attr">transition-property:</span> <span class="string">background,</span> <span class="string">opacity,</span> <span class="string">transform;</span></span><br><span class="line"><span class="string">&#125;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#cursor.hidden &#123;</span></span><br><span class="line">  <span class="attr">opacity:</span> <span class="number">0</span><span class="string">;</span></span><br><span class="line"><span class="string">&#125;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#cursor.hover &#123;</span></span><br><span class="line">  <span class="attr">opacity:</span> <span class="number">0.1</span><span class="string">;</span></span><br><span class="line">  <span class="attr">transform:</span> <span class="string">scale(2.5);</span></span><br><span class="line">  <span class="string">-webkit-transform:</span> <span class="string">scale(2.5);</span></span><br><span class="line">  <span class="string">-moz-transform:</span> <span class="string">scale(2.5);</span></span><br><span class="line">  <span class="string">-ms-transform:</span> <span class="string">scale(2.5);</span></span><br><span class="line">  <span class="string">-o-transform:</span> <span class="string">scale(2.5);</span></span><br><span class="line"><span class="string">&#125;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#cursor.active &#123;</span></span><br><span class="line">  <span class="attr">opacity:</span> <span class="number">0.5</span><span class="string">;</span></span><br><span class="line">  <span class="attr">transform:</span> <span class="string">scale(0.5);</span></span><br><span class="line">  <span class="string">-webkit-transform:</span> <span class="string">scale(0.5);</span></span><br><span class="line">  <span class="string">-moz-transform:</span> <span class="string">scale(0.5);</span></span><br><span class="line">  <span class="string">-ms-transform:</span> <span class="string">scale(0.5);</span></span><br><span class="line">  <span class="string">-o-transform:</span> <span class="string">scale(0.5);</span></span><br><span class="line"><span class="string">&#125;</span></span><br><span class="line"></span><br><span class="line"><span class="string">/*</span> <span class="string">波浪css</span> <span class="string">*/</span></span><br><span class="line"><span class="string">.main-hero-waves-area</span> &#123;</span><br><span class="line">  <span class="attr">width:</span> <span class="number">100</span><span class="string">%;</span></span><br><span class="line">  <span class="attr">position:</span> <span class="string">absolute;</span></span><br><span class="line">  <span class="attr">left:</span> <span class="number">0</span><span class="string">;</span></span><br><span class="line">  <span class="attr">bottom:</span> <span class="string">-11px;</span></span><br><span class="line">  <span class="attr">z-index:</span> <span class="number">5</span><span class="string">;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="string">.waves-area</span> <span class="string">.waves-svg</span> &#123;</span><br><span class="line">  <span class="attr">width:</span> <span class="number">100</span><span class="string">%;</span></span><br><span class="line">  <span class="attr">height:</span> <span class="string">5rem;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="string">/*</span> <span class="string">Animation</span> <span class="string">*/</span></span><br><span class="line"></span><br><span class="line"><span class="string">.parallax&gt;use</span> &#123;</span><br><span class="line">  <span class="attr">animation:</span> <span class="string">move-forever</span> <span class="string">25s</span> <span class="string">cubic-bezier(0.55</span>, <span class="number">0.5</span>, <span class="number">0.45</span>, <span class="number">0.5</span><span class="string">)</span> <span class="string">infinite;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="string">.parallax&gt;use:nth-child(1)</span> &#123;</span><br><span class="line">  <span class="attr">animation-delay:</span> <span class="string">-2s;</span></span><br><span class="line">  <span class="attr">animation-duration:</span> <span class="string">7s;</span></span><br><span class="line">  <span class="attr">fill:</span> <span class="comment">#f7f9febd;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="string">.parallax&gt;use:nth-child(2)</span> &#123;</span><br><span class="line">  <span class="attr">animation-delay:</span> <span class="string">-3s;</span></span><br><span class="line">  <span class="attr">animation-duration:</span> <span class="string">10s;</span></span><br><span class="line">  <span class="attr">fill:</span> <span class="comment">#f7f9fe82;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="string">.parallax&gt;use:nth-child(3)</span> &#123;</span><br><span class="line">  <span class="attr">animation-delay:</span> <span class="string">-4s;</span></span><br><span class="line">  <span class="attr">animation-duration:</span> <span class="string">13s;</span></span><br><span class="line">  <span class="attr">fill:</span> <span class="comment">#f7f9fe36;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="string">.parallax&gt;use:nth-child(4)</span> &#123;</span><br><span class="line">  <span class="attr">animation-delay:</span> <span class="string">-5s;</span></span><br><span class="line">  <span class="attr">animation-duration:</span> <span class="string">20s;</span></span><br><span class="line">  <span class="attr">fill:</span> <span class="comment">#f7f9fe;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="string">/*</span> <span class="string">黑色模式背景</span> <span class="string">*/</span></span><br><span class="line">[<span class="string">data-theme=&quot;dark&quot;</span>] <span class="string">.parallax&gt;use:nth-child(1)</span> &#123;</span><br><span class="line">  <span class="attr">animation-delay:</span> <span class="string">-2s;</span></span><br><span class="line">  <span class="attr">animation-duration:</span> <span class="string">7s;</span></span><br><span class="line">  <span class="attr">fill:</span> <span class="comment">#18171dc8;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">[<span class="string">data-theme=&quot;dark&quot;</span>] <span class="string">.parallax&gt;use:nth-child(2)</span> &#123;</span><br><span class="line">  <span class="attr">animation-delay:</span> <span class="string">-3s;</span></span><br><span class="line">  <span class="attr">animation-duration:</span> <span class="string">10s;</span></span><br><span class="line">  <span class="attr">fill:</span> <span class="comment">#18171d80;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">[<span class="string">data-theme=&quot;dark&quot;</span>] <span class="string">.parallax&gt;use:nth-child(3)</span> &#123;</span><br><span class="line">  <span class="attr">animation-delay:</span> <span class="string">-4s;</span></span><br><span class="line">  <span class="attr">animation-duration:</span> <span class="string">13s;</span></span><br><span class="line">  <span class="attr">fill:</span> <span class="comment">#18171d3e;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">[<span class="string">data-theme=&quot;dark&quot;</span>] <span class="string">.parallax&gt;use:nth-child(4)</span> &#123;</span><br><span class="line">  <span class="attr">animation-delay:</span> <span class="string">-5s;</span></span><br><span class="line">  <span class="attr">animation-duration:</span> <span class="string">20s;</span></span><br><span class="line">  <span class="attr">fill:</span> <span class="comment">#18171d;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="string">@keyframes</span> <span class="string">move-forever</span> &#123;</span><br><span class="line">  <span class="number">0</span><span class="string">%</span> &#123;</span><br><span class="line">    <span class="attr">transform:</span> <span class="string">translate3d(-90px</span>, <span class="number">0</span>, <span class="number">0</span><span class="string">);</span></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="number">100</span><span class="string">%</span> &#123;</span><br><span class="line">    <span class="attr">transform:</span> <span class="string">translate3d(85px</span>, <span class="number">0</span>, <span class="number">0</span><span class="string">);</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="string">/*Shrinking</span> <span class="string">for</span> <span class="string">mobile*/</span></span><br><span class="line"><span class="attr">@media (max-width:</span> <span class="string">768px)</span> &#123;</span><br><span class="line">  <span class="string">.waves-area</span> <span class="string">.waves-svg</span> &#123;</span><br><span class="line">    <span class="attr">height:</span> <span class="string">40px;</span></span><br><span class="line">    <span class="attr">min-height:</span> <span class="string">40px;</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="string">/*</span> <span class="string">文章页H1-H6图标样式效果</span> <span class="string">*/</span></span><br><span class="line"><span class="string">h1::before,</span></span><br><span class="line"><span class="string">h2::before,</span></span><br><span class="line"><span class="string">h3::before,</span></span><br><span class="line"><span class="string">h4::before,</span></span><br><span class="line"><span class="string">h5::before,</span></span><br><span class="line"><span class="string">h6::before</span> &#123;</span><br><span class="line">  <span class="string">-webkit-animation:</span> <span class="string">ccc</span> <span class="number">1.</span><span class="string">6s</span> <span class="string">linear</span> <span class="string">infinite;</span></span><br><span class="line">  <span class="attr">animation:</span> <span class="string">ccc</span> <span class="number">1.</span><span class="string">6s</span> <span class="string">linear</span> <span class="string">infinite;</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="string">@-webkit-keyframes</span> <span class="string">ccc</span> &#123;</span><br><span class="line">  <span class="number">0</span><span class="string">%</span> &#123;</span><br><span class="line">    <span class="string">-webkit-transform:</span> <span class="string">rotate(0deg);</span></span><br><span class="line">    <span class="attr">transform:</span> <span class="string">rotate(0deg);</span></span><br><span class="line">  &#125;</span><br><span class="line">  <span class="string">to</span> &#123;</span><br><span class="line">    <span class="string">-webkit-transform:</span> <span class="string">rotate(-1turn);</span></span><br><span class="line">    <span class="attr">transform:</span> <span class="string">rotate(-1turn);</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="string">@keyframes</span> <span class="string">ccc</span> &#123;</span><br><span class="line">  <span class="number">0</span><span class="string">%</span> &#123;</span><br><span class="line">    <span class="string">-webkit-transform:</span> <span class="string">rotate(0deg);</span></span><br><span class="line">    <span class="attr">transform:</span> <span class="string">rotate(0deg);</span></span><br><span class="line">  &#125;</span><br><span class="line">  <span class="string">to</span> &#123;</span><br><span class="line">    <span class="string">-webkit-transform:</span> <span class="string">rotate(-1turn);</span></span><br><span class="line">    <span class="attr">transform:</span> <span class="string">rotate(-1turn);</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">#content-inner.layout h1::before &#123;</span></span><br><span class="line">  <span class="attr">color:</span> <span class="comment">#ef50a8;</span></span><br><span class="line">  <span class="attr">margin-left:</span> <span class="number">-1.</span><span class="string">55rem;</span></span><br><span class="line">  <span class="attr">font-size:</span> <span class="number">1.</span><span class="string">3rem;</span></span><br><span class="line">  <span class="attr">margin-top:</span> <span class="number">-0.</span><span class="string">23rem;</span></span><br><span class="line"><span class="string">&#125;</span></span><br><span class="line"><span class="comment">#content-inner.layout h2::before &#123;</span></span><br><span class="line">  <span class="attr">color:</span> <span class="comment">#fb7061;</span></span><br><span class="line">  <span class="attr">margin-left:</span> <span class="number">-1.</span><span class="string">35rem;</span></span><br><span class="line">  <span class="attr">font-size:</span> <span class="number">1.</span><span class="string">1rem;</span></span><br><span class="line">  <span class="attr">margin-top:</span> <span class="number">-0.</span><span class="string">12rem;</span></span><br><span class="line"><span class="string">&#125;</span></span><br><span class="line"><span class="comment">#content-inner.layout h3::before &#123;</span></span><br><span class="line">  <span class="attr">color:</span> <span class="comment">#ffbf00;</span></span><br><span class="line">  <span class="attr">margin-left:</span> <span class="number">-1.</span><span class="string">22rem;</span></span><br><span class="line">  <span class="attr">font-size:</span> <span class="number">0.</span><span class="string">95rem;</span></span><br><span class="line">  <span class="attr">margin-top:</span> <span class="number">-0.</span><span class="string">09rem;</span></span><br><span class="line"><span class="string">&#125;</span></span><br><span class="line"><span class="comment">#content-inner.layout h4::before &#123;</span></span><br><span class="line">  <span class="attr">color:</span> <span class="comment">#a9e000;</span></span><br><span class="line">  <span class="attr">margin-left:</span> <span class="number">-1.</span><span class="string">05rem;</span></span><br><span class="line">  <span class="attr">font-size:</span> <span class="number">0.</span><span class="string">8rem;</span></span><br><span class="line">  <span class="attr">margin-top:</span> <span class="number">-0.</span><span class="string">09rem;</span></span><br><span class="line"><span class="string">&#125;</span></span><br><span class="line"><span class="comment">#content-inner.layout h5::before &#123;</span></span><br><span class="line">  <span class="attr">color:</span> <span class="comment">#57c850;</span></span><br><span class="line">  <span class="attr">margin-left:</span> <span class="number">-0.</span><span class="string">9rem;</span></span><br><span class="line">  <span class="attr">font-size:</span> <span class="number">0.</span><span class="string">7rem;</span></span><br><span class="line">  <span class="attr">margin-top:</span> <span class="string">0rem;</span></span><br><span class="line"><span class="string">&#125;</span></span><br><span class="line"><span class="comment">#content-inner.layout h6::before &#123;</span></span><br><span class="line">  <span class="attr">color:</span> <span class="comment">#5ec1e0;</span></span><br><span class="line">  <span class="attr">margin-left:</span> <span class="number">-0.</span><span class="string">9rem;</span></span><br><span class="line">  <span class="attr">font-size:</span> <span class="number">0.</span><span class="string">66rem;</span></span><br><span class="line">  <span class="attr">margin-top:</span> <span class="string">0rem;</span></span><br><span class="line"><span class="string">&#125;</span></span><br><span class="line"><span class="comment">#content-inner.layout h1:hover,</span></span><br><span class="line"><span class="comment">#content-inner.layout h2:hover,</span></span><br><span class="line"><span class="comment">#content-inner.layout h3:hover,</span></span><br><span class="line"><span class="comment">#content-inner.layout h4:hover,</span></span><br><span class="line"><span class="comment">#content-inner.layout h5:hover,</span></span><br><span class="line"><span class="comment">#content-inner.layout h6:hover &#123;</span></span><br><span class="line">  <span class="attr">color:</span> <span class="comment">#3b70fc;</span></span><br><span class="line"><span class="string">&#125;</span></span><br><span class="line"><span class="comment">#content-inner.layout h1:hover::before,</span></span><br><span class="line"><span class="comment">#content-inner.layout h2:hover::before,</span></span><br><span class="line"><span class="comment">#content-inner.layout h3:hover::before,</span></span><br><span class="line"><span class="comment">#content-inner.layout h4:hover::before,</span></span><br><span class="line"><span class="comment">#content-inner.layout h5:hover::before,</span></span><br><span class="line"><span class="comment">#content-inner.layout h6:hover::before &#123;</span></span><br><span class="line">  <span class="attr">color:</span> <span class="comment">#3b70fc;</span></span><br><span class="line">  <span class="string">-webkit-animation:</span> <span class="string">ccc</span> <span class="number">3.</span><span class="string">2s</span> <span class="string">linear</span> <span class="string">infinite;</span></span><br><span class="line">  <span class="attr">animation:</span> <span class="string">ccc</span> <span class="number">3.</span><span class="string">2s</span> <span class="string">linear</span> <span class="string">infinite;</span></span><br><span class="line"><span class="string">&#125;</span></span><br></pre></td></tr></table></figure><p>在<code>_config.butterfly.yml</code>中搜索 Inject 添加以下代码，将自定义 css<code>custom.css</code>引入</p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">inject:</span></span><br><span class="line"><span class="attr">head:</span></span><br><span class="line">  <span class="bullet">-</span> <span class="string">&lt;link</span> <span class="string">rel=&quot;stylesheet&quot;</span> <span class="string">href=&quot;/css/custom.css&quot;</span> <span class="string">media=&quot;defer&quot;</span> <span class="string">onload=&quot;this.media=&#x27;all&#x27;&quot;&gt;</span></span><br></pre></td></tr></table></figure><p>如果不需要一图流，请删除<code>157行</code>这一部分代码</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* 页脚透明 */</span></span><br><span class="line"><span class="selector-id">#footer</span> &#123;</span><br><span class="line">  <span class="attribute">background</span>: transparent <span class="meta">!important</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 头图透明 */</span></span><br><span class="line"><span class="selector-id">#page-header</span> &#123;</span><br><span class="line">  <span class="attribute">background</span>: transparent <span class="meta">!important</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="配置-pwa"><a href="#配置-pwa" class="headerlink" title="配置 pwa"></a>配置 pwa</h2><details class="folding-tag" ><summary> 查看教程 </summary>              <div class='content'>              <p>安装必要插件</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">npm install --global gulp-cli <span class="comment"># 全局安装gulp命令集</span></span><br><span class="line">npm install workbox-build gulp --save <span class="comment"># 安装workbox和gulp插件</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 压缩html插件</span></span><br><span class="line">npm install gulp-htmlclean --save-dev</span><br><span class="line">npm install --save gulp-htmlmin</span><br><span class="line"><span class="comment"># 压缩css插件</span></span><br><span class="line">npm install gulp-clean-css --save-dev</span><br><span class="line"><span class="comment"># 压缩js插件</span></span><br><span class="line"><span class="comment"># 使用terser压缩js</span></span><br><span class="line">npm install gulp-terser --save-dev</span><br><span class="line">npm install --save-dev gulp-babel @babel/core @babel/preset-env</span><br><span class="line"><span class="comment"># 压缩图片插件</span></span><br><span class="line">npm install --save-dev gulp-imagemin</span><br><span class="line"><span class="comment"># 压缩字体插件(font-min仅支持压缩ttf格式的字体包)</span></span><br><span class="line">npm install gulp-fontmin --save-dev</span><br></pre></td></tr></table></figure><div class="note warning simple"><p>关于 font-min 的补充说明，在本文中，是通过读取所有编译好的 html 文件（./public/<em>*/</em>.html）中的字符，然后匹配原有字体包内./public/fonts/<em>.ttf 字体样式，输出压缩后的字体包到./public/fontsdest/目录。所以最终引用字体的相对路径应该是/fontsdest/</em>.ttf。而本地测试时，如果没有运行 gulp，自然也就不会输出压缩字体包到 public 目录，也就看不到字体样式。</p></div><p>在 package.json 中添加</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;module&quot;</span><span class="punctuation">,</span></span><br></pre></td></tr></table></figure><p>创建<code>gulpfile.js</code><br>在 Hexo 的根目录，创建一个<code>gulpfile.js</code>文件,打开<code>[Blogroot]/gulpfile.js</code>,</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">import</span> gulp <span class="keyword">from</span> <span class="string">&quot;gulp&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> cleanCSS <span class="keyword">from</span> <span class="string">&quot;gulp-clean-css&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> htmlmin <span class="keyword">from</span> <span class="string">&quot;gulp-htmlmin&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> htmlclean <span class="keyword">from</span> <span class="string">&quot;gulp-htmlclean&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> workbox <span class="keyword">from</span> <span class="string">&quot;workbox-build&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> fontmin <span class="keyword">from</span> <span class="string">&quot;gulp-fontmin&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 若使用babel压缩js，则取消下方注释，并注释terser的代码</span></span><br><span class="line"><span class="comment">// var uglify = require(&#x27;gulp-uglify&#x27;);</span></span><br><span class="line"><span class="comment">// var babel = require(&#x27;gulp-babel&#x27;);</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 若使用terser压缩js</span></span><br><span class="line"><span class="keyword">import</span> terser <span class="keyword">from</span> <span class="string">&quot;gulp-terser&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">//pwa</span></span><br><span class="line">gulp.<span class="title function_">task</span>(<span class="string">&quot;generate-service-worker&quot;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">return</span> workbox.<span class="title function_">injectManifest</span>(&#123;</span><br><span class="line">    <span class="attr">swSrc</span>: <span class="string">&quot;./sw-template.js&quot;</span>,</span><br><span class="line">    <span class="attr">swDest</span>: <span class="string">&quot;./public/sw.js&quot;</span>,</span><br><span class="line">    <span class="attr">globDirectory</span>: <span class="string">&quot;./public&quot;</span>,</span><br><span class="line">    <span class="attr">globPatterns</span>: [</span><br><span class="line">      <span class="comment">// 缓存所有以下类型的文件，极端不推荐</span></span><br><span class="line">      <span class="comment">// &quot;**/*.&#123;html,css,js,json,woff2,xml&#125;&quot;</span></span><br><span class="line">      <span class="comment">// 推荐只缓存404，主页和主要样式和脚本。</span></span><br><span class="line">      <span class="string">&quot;404.html&quot;</span>,</span><br><span class="line">      <span class="string">&quot;index.html&quot;</span>,</span><br><span class="line">      <span class="string">&quot;js/main.js&quot;</span>,</span><br><span class="line">      <span class="string">&quot;css/index.css&quot;</span>,</span><br><span class="line">    ],</span><br><span class="line">    <span class="attr">modifyURLPrefix</span>: &#123;</span><br><span class="line">      <span class="string">&quot;&quot;</span>: <span class="string">&quot;./&quot;</span>,</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">//minify js babel</span></span><br><span class="line"><span class="comment">// 若使用babel压缩js，则取消下方注释，并注释terser的代码</span></span><br><span class="line"><span class="comment">// gulp.task(&#x27;compress&#x27;, () =&gt;</span></span><br><span class="line"><span class="comment">//   gulp.src([&#x27;./public/**/*.js&#x27;, &#x27;!./public/**/*.min.js&#x27;])</span></span><br><span class="line"><span class="comment">// .pipe(babel(&#123;</span></span><br><span class="line"><span class="comment">// presets: [&#x27;@babel/preset-env&#x27;]</span></span><br><span class="line"><span class="comment">// &#125;))</span></span><br><span class="line"><span class="comment">//     .pipe(uglify().on(&#x27;error&#x27;, function(e)&#123;</span></span><br><span class="line"><span class="comment">//       console.log(e);</span></span><br><span class="line"><span class="comment">//     &#125;))</span></span><br><span class="line"><span class="comment">// .pipe(gulp.dest(&#x27;./public&#x27;))</span></span><br><span class="line"><span class="comment">// );</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// minify js - gulp-tester</span></span><br><span class="line"><span class="comment">// 若使用terser压缩js</span></span><br><span class="line">gulp.<span class="title function_">task</span>(<span class="string">&quot;compress&quot;</span>, <span class="function">() =&gt;</span></span><br><span class="line">  gulp</span><br><span class="line">    .<span class="title function_">src</span>([</span><br><span class="line">      <span class="string">&quot;./public/**/*.js&quot;</span>,</span><br><span class="line">      <span class="string">&quot;!./public/**/*.min.js&quot;</span>,</span><br><span class="line">      <span class="string">&quot;!./public/js/custom/galmenu.js&quot;</span>,</span><br><span class="line">      <span class="string">&quot;!./public/js/custom/gitcalendar.js&quot;</span>,</span><br><span class="line">    ])</span><br><span class="line">    .<span class="title function_">pipe</span>(<span class="title function_">terser</span>())</span><br><span class="line">    .<span class="title function_">pipe</span>(gulp.<span class="title function_">dest</span>(<span class="string">&quot;./public&quot;</span>))</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="comment">//css</span></span><br><span class="line">gulp.<span class="title function_">task</span>(<span class="string">&quot;minify-css&quot;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">return</span> gulp</span><br><span class="line">    .<span class="title function_">src</span>(<span class="string">&quot;./public/**/*.css&quot;</span>)</span><br><span class="line">    .<span class="title function_">pipe</span>(</span><br><span class="line">      <span class="title function_">cleanCSS</span>(&#123;</span><br><span class="line">        <span class="attr">compatibility</span>: <span class="string">&quot;ie11&quot;</span>,</span><br><span class="line">      &#125;)</span><br><span class="line">    )</span><br><span class="line">    .<span class="title function_">pipe</span>(gulp.<span class="title function_">dest</span>(<span class="string">&quot;./public&quot;</span>));</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 压缩 public 目录内 html</span></span><br><span class="line">gulp.<span class="title function_">task</span>(<span class="string">&quot;minify-html&quot;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">return</span> gulp</span><br><span class="line">    .<span class="title function_">src</span>(<span class="string">&quot;./public/**/*.html&quot;</span>)</span><br><span class="line">    .<span class="title function_">pipe</span>(<span class="title function_">htmlclean</span>())</span><br><span class="line">    .<span class="title function_">pipe</span>(</span><br><span class="line">      <span class="title function_">htmlmin</span>(&#123;</span><br><span class="line">        <span class="attr">removeComments</span>: <span class="literal">true</span>, <span class="comment">//清除 HTML 註释</span></span><br><span class="line">        <span class="attr">collapseWhitespace</span>: <span class="literal">true</span>, <span class="comment">//压缩 HTML</span></span><br><span class="line">        <span class="attr">collapseBooleanAttributes</span>: <span class="literal">true</span>, <span class="comment">//省略布尔属性的值 &lt;input checked=&quot;true&quot;/&gt; ==&gt; &lt;input /&gt;</span></span><br><span class="line">        <span class="attr">removeEmptyAttributes</span>: <span class="literal">true</span>, <span class="comment">//删除所有空格作属性值 &lt;input id=&quot;&quot; /&gt; ==&gt; &lt;input /&gt;</span></span><br><span class="line">        <span class="attr">removeScriptTypeAttributes</span>: <span class="literal">true</span>, <span class="comment">//删除 &lt;script&gt; 的 type=&quot;text/javascript&quot;</span></span><br><span class="line">        <span class="attr">removeStyleLinkTypeAttributes</span>: <span class="literal">true</span>, <span class="comment">//删除 &lt;style&gt; 和 &lt;link&gt; 的 type=&quot;text/css&quot;</span></span><br><span class="line">        <span class="attr">minifyJS</span>: <span class="literal">true</span>, <span class="comment">//压缩页面 JS</span></span><br><span class="line">        <span class="attr">minifyCSS</span>: <span class="literal">true</span>, <span class="comment">//压缩页面 CSS</span></span><br><span class="line">        <span class="attr">minifyURLs</span>: <span class="literal">true</span>,</span><br><span class="line">      &#125;)</span><br><span class="line">    )</span><br><span class="line">    .<span class="title function_">pipe</span>(gulp.<span class="title function_">dest</span>(<span class="string">&quot;./public&quot;</span>));</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">//压缩字体</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">minifyFont</span>(<span class="params">text, cb</span>) &#123;</span><br><span class="line">  gulp</span><br><span class="line">    .<span class="title function_">src</span>(<span class="string">&quot;./public/fonts/*.ttf&quot;</span>) <span class="comment">//原字体所在目录</span></span><br><span class="line">    .<span class="title function_">pipe</span>(</span><br><span class="line">      <span class="title function_">fontmin</span>(&#123;</span><br><span class="line">        <span class="attr">text</span>: text,</span><br><span class="line">      &#125;)</span><br><span class="line">    )</span><br><span class="line">    .<span class="title function_">pipe</span>(gulp.<span class="title function_">dest</span>(<span class="string">&quot;./public/fontsdest/&quot;</span>)) <span class="comment">//压缩后的输出目录</span></span><br><span class="line">    .<span class="title function_">on</span>(<span class="string">&quot;end&quot;</span>, cb);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">gulp.<span class="title function_">task</span>(<span class="string">&quot;mini-font&quot;</span>, <span class="function"><span class="params">cb</span> =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">var</span> buffers = [];</span><br><span class="line">  gulp</span><br><span class="line">    .<span class="title function_">src</span>([<span class="string">&quot;./public/**/*.html&quot;</span>]) <span class="comment">//HTML文件所在目录请根据自身情况修改</span></span><br><span class="line">    .<span class="title function_">on</span>(<span class="string">&quot;data&quot;</span>, <span class="keyword">function</span> (<span class="params">file</span>) &#123;</span><br><span class="line">      buffers.<span class="title function_">push</span>(file.<span class="property">contents</span>);</span><br><span class="line">    &#125;)</span><br><span class="line">    .<span class="title function_">on</span>(<span class="string">&quot;end&quot;</span>, <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">      <span class="keyword">var</span> text = <span class="title class_">Buffer</span>.<span class="title function_">concat</span>(buffers).<span class="title function_">toString</span>(<span class="string">&quot;utf-8&quot;</span>);</span><br><span class="line">      <span class="title function_">minifyFont</span>(text, cb);</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 执行 gulp 命令时执行的任务</span></span><br><span class="line">gulp.<span class="title function_">task</span>(</span><br><span class="line">  <span class="string">&quot;default&quot;</span>,</span><br><span class="line">  gulp.<span class="title function_">series</span>(<span class="string">&quot;generate-service-worker&quot;</span>, gulp.<span class="title function_">parallel</span>(<span class="string">&quot;compress&quot;</span>, <span class="string">&quot;minify-html&quot;</span>, <span class="string">&quot;minify-css&quot;</span>, <span class="string">&quot;mini-font&quot;</span>))</span><br><span class="line">);</span><br></pre></td></tr></table></figure><p>创建在 Hexo 的根目录，创建一个<code>sw-template.js</code>文件,打开<code>[Blogroot]/sw-template.js</code>,输入以下内容：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">const</span> workboxVersion = <span class="string">&quot;5.1.3&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="title function_">importScripts</span>(<span class="string">`https://storage.googleapis.com/workbox-cdn/releases/<span class="subst">$&#123;workboxVersion&#125;</span>/workbox-sw.js`</span>);</span><br><span class="line"></span><br><span class="line">workbox.<span class="property">core</span>.<span class="title function_">setCacheNameDetails</span>(&#123;</span><br><span class="line">  <span class="attr">prefix</span>: <span class="string">&quot;stack&quot;</span>,</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">workbox.<span class="property">core</span>.<span class="title function_">skipWaiting</span>();</span><br><span class="line"></span><br><span class="line">workbox.<span class="property">core</span>.<span class="title function_">clientsClaim</span>();</span><br><span class="line"></span><br><span class="line"><span class="comment">// 注册成功后要立即缓存的资源列表</span></span><br><span class="line"><span class="comment">// 具体缓存列表在gulpfile.js中配置，见下文</span></span><br><span class="line">workbox.<span class="property">precaching</span>.<span class="title function_">precacheAndRoute</span>(self.<span class="property">__WB_MANIFEST</span>, &#123;</span><br><span class="line">  <span class="attr">directoryIndex</span>: <span class="literal">null</span>,</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 清空过期缓存</span></span><br><span class="line">workbox.<span class="property">precaching</span>.<span class="title function_">cleanupOutdatedCaches</span>();</span><br><span class="line"></span><br><span class="line"><span class="comment">// 图片资源（可选，不需要就注释掉）</span></span><br><span class="line"><span class="comment">// workbox.routing.registerRoute(</span></span><br><span class="line"><span class="comment">//   /\.(?:png|jpg|jpeg|gif|bmp|webp|svg|ico)$/,</span></span><br><span class="line"><span class="comment">//   new workbox.strategies.CacheFirst(&#123;</span></span><br><span class="line"><span class="comment">//     cacheName: &#x27;images&#x27;,</span></span><br><span class="line"><span class="comment">//     plugins: [</span></span><br><span class="line"><span class="comment">//       new workbox.expiration.ExpirationPlugin(&#123;</span></span><br><span class="line"><span class="comment">//         maxEntries: 1000,</span></span><br><span class="line"><span class="comment">//         maxAgeSeconds: 60 * 60 * 24 * 30,</span></span><br><span class="line"><span class="comment">//       &#125;),</span></span><br><span class="line"><span class="comment">//       new workbox.cacheableResponse.CacheableResponsePlugin(&#123;</span></span><br><span class="line"><span class="comment">//         statuses: [0, 200],</span></span><br><span class="line"><span class="comment">//       &#125;),</span></span><br><span class="line"><span class="comment">//     ],</span></span><br><span class="line"><span class="comment">//   &#125;)</span></span><br><span class="line"><span class="comment">// )</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 字体文件（可选，不需要就注释掉）</span></span><br><span class="line">workbox.<span class="property">routing</span>.<span class="title function_">registerRoute</span>(</span><br><span class="line">  <span class="regexp">/\.(?:eot|ttf|woff|woff2)$/</span>,</span><br><span class="line">  <span class="keyword">new</span> workbox.<span class="property">strategies</span>.<span class="title class_">CacheFirst</span>(&#123;</span><br><span class="line">    <span class="attr">cacheName</span>: <span class="string">&quot;fonts&quot;</span>,</span><br><span class="line">    <span class="attr">plugins</span>: [</span><br><span class="line">      <span class="keyword">new</span> workbox.<span class="property">expiration</span>.<span class="title class_">ExpirationPlugin</span>(&#123;</span><br><span class="line">        <span class="attr">maxEntries</span>: <span class="number">1000</span>,</span><br><span class="line">        <span class="attr">maxAgeSeconds</span>: <span class="number">60</span> * <span class="number">60</span> * <span class="number">24</span> * <span class="number">30</span>,</span><br><span class="line">      &#125;),</span><br><span class="line">      <span class="keyword">new</span> workbox.<span class="property">cacheableResponse</span>.<span class="title class_">CacheableResponsePlugin</span>(&#123;</span><br><span class="line">        <span class="attr">statuses</span>: [<span class="number">0</span>, <span class="number">200</span>],</span><br><span class="line">      &#125;),</span><br><span class="line">    ],</span><br><span class="line">  &#125;)</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 谷歌字体（可选，不需要就注释掉）</span></span><br><span class="line">workbox.<span class="property">routing</span>.<span class="title function_">registerRoute</span>(</span><br><span class="line">  <span class="regexp">/^https:\/\/fonts\.googleapis\.com/</span>,</span><br><span class="line">  <span class="keyword">new</span> workbox.<span class="property">strategies</span>.<span class="title class_">StaleWhileRevalidate</span>(&#123;</span><br><span class="line">    <span class="attr">cacheName</span>: <span class="string">&quot;google-fonts-stylesheets&quot;</span>,</span><br><span class="line">  &#125;)</span><br><span class="line">);</span><br><span class="line">workbox.<span class="property">routing</span>.<span class="title function_">registerRoute</span>(</span><br><span class="line">  <span class="regexp">/^https:\/\/fonts\.gstatic\.com/</span>,</span><br><span class="line">  <span class="keyword">new</span> workbox.<span class="property">strategies</span>.<span class="title class_">CacheFirst</span>(&#123;</span><br><span class="line">    <span class="attr">cacheName</span>: <span class="string">&quot;google-fonts-webfonts&quot;</span>,</span><br><span class="line">    <span class="attr">plugins</span>: [</span><br><span class="line">      <span class="keyword">new</span> workbox.<span class="property">expiration</span>.<span class="title class_">ExpirationPlugin</span>(&#123;</span><br><span class="line">        <span class="attr">maxEntries</span>: <span class="number">1000</span>,</span><br><span class="line">        <span class="attr">maxAgeSeconds</span>: <span class="number">60</span> * <span class="number">60</span> * <span class="number">24</span> * <span class="number">30</span>,</span><br><span class="line">      &#125;),</span><br><span class="line">      <span class="keyword">new</span> workbox.<span class="property">cacheableResponse</span>.<span class="title class_">CacheableResponsePlugin</span>(&#123;</span><br><span class="line">        <span class="attr">statuses</span>: [<span class="number">0</span>, <span class="number">200</span>],</span><br><span class="line">      &#125;),</span><br><span class="line">    ],</span><br><span class="line">  &#125;)</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="comment">// jsdelivr的CDN资源（可选，不需要就注释掉）</span></span><br><span class="line"><span class="comment">// workbox.routing.registerRoute(</span></span><br><span class="line"><span class="comment">//   /^https:\/\/cdn\.jsdelivr\.net/,</span></span><br><span class="line"><span class="comment">//   new workbox.strategies.CacheFirst(&#123;</span></span><br><span class="line"><span class="comment">//     cacheName: &#x27;static-libs&#x27;,</span></span><br><span class="line"><span class="comment">//     plugins: [</span></span><br><span class="line"><span class="comment">//       new workbox.expiration.ExpirationPlugin(&#123;</span></span><br><span class="line"><span class="comment">//         maxEntries: 1000,</span></span><br><span class="line"><span class="comment">//         maxAgeSeconds: 60 * 60 * 24 * 30,</span></span><br><span class="line"><span class="comment">//       &#125;),</span></span><br><span class="line"><span class="comment">//       new workbox.cacheableResponse.CacheableResponsePlugin(&#123;</span></span><br><span class="line"><span class="comment">//         statuses: [0, 200],</span></span><br><span class="line"><span class="comment">//       &#125;),</span></span><br><span class="line"><span class="comment">//     ],</span></span><br><span class="line"><span class="comment">//   &#125;)</span></span><br><span class="line"><span class="comment">// )</span></span><br><span class="line"></span><br><span class="line">workbox.<span class="property">googleAnalytics</span>.<span class="title function_">initialize</span>();</span><br></pre></td></tr></table></figure><p>在<code>[Blogroot]\themes\butterfly\layout\includes\third-party\</code>目录下新建<code>pwanotice.pug</code>文件，<br>打开<code>[Blogroot]\themes\butterfly\layout\includes\third-party\pwanotice.pug</code>,输入：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line">#app-refresh.<span class="property">app</span>-<span class="title function_">refresh</span>(style=<span class="string">&#x27;position: fixed;top: -2.2rem;left: 0;right: 0;z-index: 99999;padding: 0 1rem;font-size: 15px;height: 2.2rem;transition: all 0.3s ease;&#x27;</span>)</span><br><span class="line">  .<span class="property">app</span>-refresh-<span class="title function_">wrap</span>(style=<span class="string">&#x27; display: flex;color: #fff;height: 100%;align-items: center;justify-content: center;&#x27;</span>)</span><br><span class="line">    label ✨ 有新文章啦！ 👉</span><br><span class="line">    <span class="title function_">a</span>(href=<span class="string">&#x27;javascript:void(0)&#x27;</span> onclick=<span class="string">&#x27;location.reload()&#x27;</span>)</span><br><span class="line">      <span class="title function_">span</span>(style=<span class="string">&#x27;color: #fff;text-decoration: underline;cursor: pointer;&#x27;</span>) 🍗点击食用🍔</span><br><span class="line">script.</span><br><span class="line">  <span class="keyword">if</span> (<span class="string">&#x27;serviceWorker&#x27;</span> <span class="keyword">in</span> navigator) &#123;</span><br><span class="line">  <span class="keyword">if</span> (navigator.<span class="property">serviceWorker</span>.<span class="property">controller</span>) &#123;</span><br><span class="line">  navigator.<span class="property">serviceWorker</span>.<span class="title function_">addEventListener</span>(<span class="string">&#x27;controllerchange&#x27;</span>, <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="title function_">showNotification</span>()</span><br><span class="line">  &#125;)</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="variable language_">window</span>.<span class="title function_">addEventListener</span>(<span class="string">&#x27;load&#x27;</span>, <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">  navigator.<span class="property">serviceWorker</span>.<span class="title function_">register</span>(<span class="string">&#x27;/sw.js&#x27;</span>)</span><br><span class="line">  &#125;)</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">function</span> <span class="title function_">showNotification</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">if</span> (<span class="variable constant_">GLOBAL_CONFIG</span>.<span class="property">Snackbar</span>) &#123;</span><br><span class="line">  <span class="keyword">var</span> snackbarBg =</span><br><span class="line">  <span class="variable language_">document</span>.<span class="property">documentElement</span>.<span class="title function_">getAttribute</span>(<span class="string">&#x27;data-theme&#x27;</span>) === <span class="string">&#x27;light&#x27;</span> ?</span><br><span class="line">  <span class="variable constant_">GLOBAL_CONFIG</span>.<span class="property">Snackbar</span>.<span class="property">bgLight</span> :</span><br><span class="line">  <span class="variable constant_">GLOBAL_CONFIG</span>.<span class="property">Snackbar</span>.<span class="property">bgDark</span></span><br><span class="line">  <span class="keyword">var</span> snackbarPos = <span class="variable constant_">GLOBAL_CONFIG</span>.<span class="property">Snackbar</span>.<span class="property">position</span></span><br><span class="line">  <span class="title class_">Snackbar</span>.<span class="title function_">show</span>(&#123;</span><br><span class="line">  <span class="attr">text</span>: <span class="string">&#x27;✨ 有新文章啦！ 👉&#x27;</span>,</span><br><span class="line">  <span class="attr">backgroundColor</span>: snackbarBg,</span><br><span class="line">  <span class="attr">duration</span>: <span class="number">500000</span>,</span><br><span class="line">  <span class="attr">pos</span>: snackbarPos,</span><br><span class="line">  <span class="attr">actionText</span>: <span class="string">&#x27;🍗点击食用🍔&#x27;</span>,</span><br><span class="line">  <span class="attr">actionTextColor</span>: <span class="string">&#x27;#fff&#x27;</span>,</span><br><span class="line">  <span class="attr">onActionClick</span>: <span class="keyword">function</span>(<span class="params">e</span>) &#123;</span><br><span class="line">  location.<span class="title function_">reload</span>()</span><br><span class="line">  &#125;,</span><br><span class="line">  &#125;)</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">  <span class="keyword">var</span> showBg =</span><br><span class="line">  <span class="variable language_">document</span>.<span class="property">documentElement</span>.<span class="title function_">getAttribute</span>(<span class="string">&#x27;data-theme&#x27;</span>) === <span class="string">&#x27;light&#x27;</span> ?</span><br><span class="line">  <span class="string">&#x27;#3b70fc&#x27;</span> :</span><br><span class="line">  <span class="string">&#x27;#1f1f1f&#x27;</span></span><br><span class="line">  <span class="keyword">var</span> cssText = <span class="string">`top: 0; background: <span class="subst">$&#123;showBg&#125;</span>;`</span></span><br><span class="line">  <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;app-refresh&#x27;</span>).<span class="property">style</span>.<span class="property">cssText</span> = cssText</span><br><span class="line">  &#125;</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure><p>修改<code>[Blogroot]\themes\butterfly\layout\includes\additional-js.pug</code>,在文件底部添加以下内容，注意缩进。<code>butterfly_v3.6.0</code>取消了缓存配置，转为完全默认，需要将<code>{cache:theme.fragment_cache}</code>改为<code>{cache: true}</code>:</p><figure class="highlight diff"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">      if theme.pjax.enable</span><br><span class="line">        !=partial(&#x27;includes/third-party/pjax&#x27;, &#123;&#125;, &#123;cache:theme.fragment_cache&#125;)</span><br><span class="line"></span><br><span class="line">      !=partial(&#x27;includes/third-party/baidu_push&#x27;, &#123;&#125;, &#123;cache:theme.fragment_cache&#125;)</span><br><span class="line"></span><br><span class="line"><span class="addition">+     if theme.pwa.enable</span></span><br><span class="line"><span class="addition">+       !=partial(&#x27;includes/third-party/pwanotice&#x27;, &#123;&#125;, &#123;cache: true&#125;)</span></span><br></pre></td></tr></table></figure><p>将你的图标包移入相应的目录，例如我是<code>/img/siteicon/</code>，所以放到<code>[Blogroot]/source/img/siteicon/</code>目录下。</p><p>新建文件名为<code>manifest.json</code>并将其放到<code>[Blogroot]/source</code>目录下，此时还不能直接用，需要添加一些内容，以下是我的<code>manifest.json</code>配置内容，权且作为参考，其中的<code>theme_color</code>建议用取色器取设计的图标的主色调，<strong>同时务必配置 start_url 和 name 的配置项，这关系到你之后能否看到浏览器的应用安装按钮</strong>。：</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;Stack&#x27;s Blog&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;short_name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;Stack&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;theme_color&quot;</span><span class="punctuation">:</span> <span class="string">&quot;#3b70fc&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;background_color&quot;</span><span class="punctuation">:</span> <span class="string">&quot;#3b70fc&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;display&quot;</span><span class="punctuation">:</span> <span class="string">&quot;standalone&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;scope&quot;</span><span class="punctuation">:</span> <span class="string">&quot;/&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;start_url&quot;</span><span class="punctuation">:</span> <span class="string">&quot;/&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;icons&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">      <span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;src&quot;</span><span class="punctuation">:</span> <span class="string">&quot;/img/siteicon/16.png&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;sizes&quot;</span><span class="punctuation">:</span> <span class="string">&quot;16x16&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;image/png&quot;</span></span><br><span class="line">      <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;src&quot;</span><span class="punctuation">:</span> <span class="string">&quot;/img/siteicon/32.png&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;sizes&quot;</span><span class="punctuation">:</span> <span class="string">&quot;32x32&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;image/png&quot;</span></span><br><span class="line">      <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;src&quot;</span><span class="punctuation">:</span> <span class="string">&quot;/img/siteicon/48.png&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;sizes&quot;</span><span class="punctuation">:</span> <span class="string">&quot;48x48&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;image/png&quot;</span></span><br><span class="line">      <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;src&quot;</span><span class="punctuation">:</span> <span class="string">&quot;/img/siteicon/64.png&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;sizes&quot;</span><span class="punctuation">:</span> <span class="string">&quot;64x64&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;image/png&quot;</span></span><br><span class="line">      <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;src&quot;</span><span class="punctuation">:</span> <span class="string">&quot;/img/siteicon/128.png&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;sizes&quot;</span><span class="punctuation">:</span> <span class="string">&quot;128x128&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;image/png&quot;</span></span><br><span class="line">      <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;src&quot;</span><span class="punctuation">:</span> <span class="string">&quot;/img/siteicon/144.png&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;sizes&quot;</span><span class="punctuation">:</span> <span class="string">&quot;144x144&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;image/png&quot;</span></span><br><span class="line">      <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;src&quot;</span><span class="punctuation">:</span> <span class="string">&quot;/img/siteicon/512.png&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;sizes&quot;</span><span class="punctuation">:</span> <span class="string">&quot;512x512&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;image/png&quot;</span></span><br><span class="line">      <span class="punctuation">&#125;</span></span><br><span class="line">    <span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;splash_pages&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">null</span></span></span><br><span class="line">  <span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure><p>打开主题配置文件<code>[Blogroot]/_config.butterfly.yml</code>,找到<code>PWA</code>配置项。添加图标路径。这里的 theme_color 建议改成你图标的主色调，包括<code>manifest.json</code>中的<code>theme_color</code>也是如此。</p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">pwa:</span></span><br><span class="line">  <span class="attr">enable:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">manifest:</span> <span class="string">/manifest.json</span></span><br><span class="line">  <span class="attr">theme_color:</span> <span class="string">&quot;#3b70fc&quot;</span></span><br><span class="line">  <span class="attr">apple_touch_icon:</span> <span class="string">/img/siteicon/128.png</span></span><br><span class="line">  <span class="attr">favicon_32_32:</span> <span class="string">/img/siteicon/32.png</span></span><br><span class="line">  <span class="attr">favicon_16_16:</span> <span class="string">/img/siteicon/16.png</span></span><br><span class="line">  <span class="attr">mask_icon:</span> <span class="string">/img/siteicon/128.png</span></span><br></pre></td></tr></table></figure>              </div>            </details><h2 id="添加外挂标签"><a href="#添加外挂标签" class="headerlink" title="添加外挂标签"></a>添加外挂标签</h2><details class="folding-tag" ><summary> 查看教程 </summary>              <div class='content'>              <p>新建<code>[Blogroot]/source/js/ali_font.js</code>, 输入以下内容</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><span class="line">!(<span class="keyword">function</span> (<span class="params">c</span>) &#123;</span><br><span class="line">  <span class="keyword">var</span> l,</span><br><span class="line">    h,</span><br><span class="line">    a,</span><br><span class="line">    t,</span><br><span class="line">    i,</span><br><span class="line">    v =</span><br><span class="line">      <span class="string">&#x27;&lt;svg&gt;&lt;symbol id=&quot;icon-dragon_chen&quot; viewBox=&quot;0 0 1024 1024&quot;&gt;&lt;path d=&quot;M512 512m-296.421053 0a296.421053 296.421053 0 1 0 592.842106 0 296.421053 296.421053 0 1 0-592.842106 0Z&quot; fill=&quot;#D6B196&quot; &gt;&lt;/path&gt;&lt;path d=&quot;M970.105263 512c0 224.983579-163.166316 412.186947-377.263158 450.533053v-54.460632C777.135158 870.507789 916.210526 707.206737 916.210526 512c0-222.881684-181.328842-404.210526-404.210526-404.210526S107.789474 289.118316 107.789474 512s181.328842 404.210526 404.210526 404.210526c9.081263 0 18.000842-0.754526 26.947368-1.374315v53.894736c-8.973474 0.538947-17.866105 1.374316-26.947368 1.374316-252.604632 0-458.105263-205.500632-458.105263-458.105263S259.395368 53.894737 512 53.894737s458.105263 205.500632 458.105263 458.105263z m-498.122105 265.620211L431.157895 754.526316V485.052632h-66.074948c-14.470737 110.645895-44.355368 197.066105-102.696421 260.742736l-39.747368-36.432842C306.526316 617.876211 323.368421 462.901895 323.368421 242.526316V215.578947h377.263158v53.894737H377.182316c-0.404211 58.260211-2.209684 112.128-6.359579 161.684211H700.631579v53.894737h-122.152421a481.172211 481.172211 0 0 0 76.826947 119.70021l66.479158-39.855158 27.728842 46.214737-54.460631 32.687158c29.507368 24.953263 63.757474 45.675789 102.80421 58.098526l-16.303158 51.361684c-134.224842-42.711579-222.773895-167.073684-261.551158-268.207157H485.052632v221.857684l68.985263-41.391158 27.728842 46.214737-109.783579 65.886316zM646.736842 377.263158h-215.578947v-53.894737h215.578947v53.894737z&quot; fill=&quot;#231F20&quot; &gt;&lt;/path&gt;&lt;/symbol&gt;&lt;symbol id=&quot;icon-dog_xu&quot; viewBox=&quot;0 0 1024 1024&quot;&gt;&lt;path d=&quot;M512 512m-296.421053 0a296.421053 296.421053 0 1 0 592.842106 0 296.421053 296.421053 0 1 0-592.842106 0Z&quot; fill=&quot;#D6B196&quot; &gt;&lt;/path&gt;&lt;path d=&quot;M970.105263 512c0 224.983579-163.166316 412.186947-377.263158 450.533053v-54.460632C777.135158 870.507789 916.210526 707.206737 916.210526 512c0-222.881684-181.328842-404.210526-404.210526-404.210526S107.789474 289.118316 107.789474 512s181.328842 404.210526 404.210526 404.210526c9.081263 0 18.000842-0.754526 26.947368-1.374315v53.894736c-8.973474 0.538947-17.866105 1.374316-26.947368 1.374316-252.604632 0-458.105263-205.500632-458.105263-458.105263S259.395368 53.894737 512 53.894737s458.105263 205.500632 458.105263 458.105263z m-375.592421 150.393263c33.684211 44.544 75.210105 74.698105 124.739369 90.812632l11.425684 3.718737 10.401684-6.009264C781.204211 727.740632 808.421053 622.565053 808.421053 592.842105h-53.894737c0 22.069895-19.132632 80.869053-33.711158 103.504842-34.816-14.605474-64.538947-39.262316-89.249684-74.13221 48.316632-55.269053 92.079158-117.328842 120.535579-179.900632l-49.044211-22.285473c-23.767579 52.250947-59.742316 104.717474-100.055579 152.656842-24.010105-50.930526-41.148632-115.927579-51.658105-195.395369H700.631579v-53.894737h-155.189895A1848.050526 1848.050526 0 0 1 538.947368 161.684211h-53.894736c0 58.206316 2.155789 112.074105 6.494315 161.68421H323.368421v26.947368c0 216.549053-13.177263 263.545263-100.702316 359.046737l39.747369 36.432842c63.326316-69.093053 92.806737-118.272 105.714526-206.848H485.052632v-53.894736h-111.319579a1742.147368 1742.147368 0 0 0 3.449263-107.789474h120.158316c12.611368 98.250105 35.031579 177.475368 67.395368 238.187789-61.978947 65.536-128.053895 117.975579-173.298526 142.282106l25.519158 47.481263c47.589053-25.573053 114.095158-77.446737 177.55621-142.821053z m125.170526-411.971368l-80.842105-80.842106-38.103579 38.103579 80.842105 80.842106 38.103579-38.103579z&quot; fill=&quot;#231F20&quot; &gt;&lt;/path&gt;&lt;/symbol&gt;&lt;symbol id=&quot;icon-dog&quot; viewBox=&quot;0 0 1024 1024&quot;&gt;&lt;path d=&quot;M894.814316 904.434526l83.240421-183.134315-13.824-13.204211c-0.485053-0.458105-45.648842-47.589053-47.939369-185.263158-0.134737-7.922526-0.134737-33.953684-0.134736-55.996631-30.693053 15.306105-70.090105 19.887158-106.09179 19.887157-92.752842 0-163.624421-23.983158-210.647579-71.275789a192.512 192.512 0 0 1-27.944421-36.513684H377.263158v377.263158c342.662737 0 403.105684 51.092211 494.592 128.377263 7.922526 6.682947 15.521684 13.312 22.959158 19.86021z&quot; fill=&quot;#85C3DE&quot; &gt;&lt;/path&gt;&lt;path d=&quot;M326.063158 282.947368c0 34.250105-13.231158 44.463158-29.642105 44.463158s-29.642105-10.213053-29.642106-44.463158c0-34.223158 13.231158-44.463158 29.642106-44.463157s29.642105 10.24 29.642105 44.463157zM269.473684 430.295579v311.646316L190.275368 916.210526h59.203369L323.368421 753.637053V377.263158h-26.947368c-119.403789 0-172.732632-53.382737-185.505685-107.789474h35.624421c51.092211 0 68.581053-15.764211 120.535579-62.544842 12.773053-11.506526 28.079158-25.276632 47.023158-41.741474l18.351158-15.952842-69.658947-99.139368-44.085895 30.989474 41.768421 59.472842c-11.183158 9.862737-20.884211 18.593684-29.480421 26.327579C180.736 212.156632 176.235789 215.578947 146.539789 215.578947H53.894737v26.947369c0 88.710737 66.910316 178.149053 215.578947 187.769263z m216.710737-161.414737c2.290526 71.733895 28.698947 136.326737 75.048421 182.918737C618.711579 509.628632 702.437053 538.947368 810.091789 538.947368c18.593684 0 36.190316-1.158737 52.628211-3.449263 3.745684 111.265684 33.630316 170.334316 51.496421 196.015158l-38.507789 84.722526C782.174316 742.049684 688.774737 700.631579 377.263158 700.631579v53.894737c34.277053 0 65.697684 0.512 94.639158 1.509052L374.595368 970.105263h59.203369l96.013474-211.240421c66.182737 4.338526 117.005474 11.829895 157.911578 22.016L626.229895 916.210526h59.176421l54.16421-119.134315c47.616 18.405053 79.737263 42.091789 113.125053 69.739789L805.753263 970.105263h59.203369l113.071157-248.778105-13.824-13.204211c-0.485053-0.458105-45.648842-47.589053-47.939368-185.263158C985.168842 498.553263 1024 447.811368 1024 377.263158c0-95.205053-66.506105-161.684211-161.684211-161.684211v53.894737c65.482105 0 107.789474 42.307368 107.789474 107.789474 0 89.088-87.013053 107.789474-160.013474 107.789474-92.752842 0-163.624421-23.983158-210.647578-71.27579-30.315789-30.504421-45.891368-65.832421-53.35579-98.735158 11.210105 6.952421 22.932211 13.338947 35.274105 19.186527l23.04-48.720843c-92.106105-43.654737-148.992-128.646737-219.243789-243.981473l-46.026105 28.05221c49.448421 81.246316 92.968421 148.506947 147.051789 199.302737z&quot; fill=&quot;#231F20&quot; &gt;&lt;/path&gt;&lt;/symbol&gt;&lt;symbol id=&quot;icon-goat&quot; viewBox=&quot;0 0 1024 1024&quot;&gt;&lt;path d=&quot;M548.378947 646.736842a952.32 952.32 0 0 1 140.90779-161.68421H107.789474c0 107.600842 0 107.600842-63.649685 169.283368l-13.069473 12.665263L66.721684 754.526316h417.172211c20.345263-41.472 43.654737-77.446737 64.485052-107.789474z&quot; fill=&quot;#F7C768&quot; &gt;&lt;/path&gt;&lt;path d=&quot;M608.256 144.734316C555.762526 115.577263 506.098526 107.789474 485.052632 107.789474V53.894737c32.579368 0 91.270737 11.452632 149.369263 43.735579 75.290947 41.822316 130.694737 94.531368 171.385263 150.878316C755.873684 288.013474 697.101474 323.368421 646.736842 323.368421h-107.789474v-53.894737h107.789474c20.506947 0 48.424421-11.210105 80.437895-31.285895a471.04 471.04 0 0 0-118.918737-93.453473zM832.673684 342.231579c-16.384 0-29.642105 10.24-29.642105 44.463158 0 34.250105 13.231158 44.463158 29.642105 44.463158s29.642105-10.213053 29.642105-44.463158c0-34.223158-13.231158-44.463158-29.642105-44.463158zM1024 619.789474C1024 347.109053 901.066105 122.448842 686.753684 3.395368l-26.165895 47.104C914.324211 191.461053 964.688842 440.400842 969.647158 592.842105h-84.506947c-17.92-35.624421-45.352421-69.12-87.013053-101.995789l-16.788211-13.285053-16.734315 13.392842c-66.128842 52.897684-134.629053 127.083789-187.311158 209.677474H102.965895l-8.272842-20.318316C159.043368 617.013895 161.684211 603.109053 161.684211 485.052632v-53.894737h485.052631v-53.894737H161.684211c0-80.384 14.309053-110.026105 66.586947-137.916632l-25.384421-47.535158C123.365053 234.226526 107.789474 291.920842 107.789474 377.263158v107.789474c0 107.600842 0 107.600842-63.649685 169.283368l-13.069473 12.665263L110.618947 862.315789h58.206316l-43.897263-107.789473h103.477895l43.897263 107.789473h58.206316l-43.897263-107.789473h259.47621C508.981895 824.939789 485.052632 899.152842 485.052632 970.105263h53.894736c0-68.688842 27.270737-144.060632 68.958316-215.578947H687.157895c7.410526 0 13.473684 6.063158 13.473684 13.473684V862.315789h53.894737v-94.315789c0-37.160421-30.208-67.368421-67.368421-67.368421h-44.65179c40.771368-58.017684 89.438316-111.427368 138.913684-153.626947C841.512421 600.037053 862.315789 655.225263 862.315789 754.526316h53.894737c0-38.912-2.748632-74.482526-11.102315-107.789474H1024v-26.947368z&quot; fill=&quot;#231F20&quot; &gt;&lt;/path&gt;&lt;/symbol&gt;&lt;symbol id=&quot;icon-goat_wei&quot; viewBox=&quot;0 0 1024 1024&quot;&gt;&lt;path d=&quot;M512 512m-296.421053 0a296.421053 296.421053 0 1 0 592.842106 0 296.421053 296.421053 0 1 0-592.842106 0Z&quot; fill=&quot;#D6B196&quot; &gt;&lt;/path&gt;&lt;path d=&quot;M970.105263 512c0 224.983579-163.166316 412.186947-377.263158 450.533053v-54.460632C777.135158 870.507789 916.210526 707.206737 916.210526 512c0-222.881684-181.328842-404.210526-404.210526-404.210526S107.789474 289.118316 107.789474 512s181.328842 404.210526 404.210526 404.210526c9.081263 0 18.000842-0.754526 26.947368-1.374315v53.894736c-8.973474 0.538947-17.866105 1.374316-26.947368 1.374316-252.604632 0-458.105263-205.500632-458.105263-458.105263S259.395368 53.894737 512 53.894737s458.105263 205.500632 458.105263 458.105263z m-431.157895 50.202947c52.304842 70.925474 136.973474 152.144842 232.528843 190.383158l19.994947-50.041263c-109.271579-43.708632-202.805895-152.629895-238.780632-217.49221H808.421053v-53.894737H538.947368v-53.894737h215.578948v-53.894737h-215.578948V161.684211h-53.894736v161.68421h-215.578948v53.894737h215.578948v53.894737H215.578947v53.894737h255.757474c-35.974737 64.862316-129.536 173.783579-238.807579 217.49221l20.021895 50.041263c95.528421-38.238316 180.197053-119.484632 232.501895-190.383158V808.421053h53.894736v-246.218106z&quot; fill=&quot;#231F20&quot; &gt;&lt;/path&gt;&lt;/symbol&gt;&lt;symbol id=&quot;icon-dragon&quot; viewBox=&quot;0 0 1024 1024&quot;&gt;&lt;path d=&quot;M366.376421 344.441263l152.980211-152.98021c43.142737-43.142737 141.204211-9.216 270.201263 115.738947-15.225263 9.835789-25.114947 15.818105-44.13979 32.256s-38.076632 35.489684-59.418947 56.832c-4.203789 4.203789-51.173053 53.221053-78.740211 82.027789-10.805895-12.126316-22.743579-24.171789-34.654315-36.082526L493.136842 362.792421l-54.218105 54.218105-72.542316-72.569263zM862.315789 512c0 46.834526-45.352421 80.842105-107.789473 80.842105-108.948211 0-189.359158-28.806737-267.129263-56.697263C414.100211 509.871158 344.872421 485.052632 258.182737 485.052632 80.788211 485.052632 0 588.126316 0 683.897263h53.894737C73.216 659.779368 135.302737 646.736842 177.340632 646.736842c77.338947 0 223.124211 23.282526 291.893894 47.912421C547.462737 722.701474 615.989895 754.526316 734.315789 754.526316 862.315789 754.526316 916.210526 670.315789 916.210526 512h-53.894737z&quot; fill=&quot;#FF8787&quot; &gt;&lt;/path&gt;&lt;path d=&quot;M552.421053 1024c-69.766737 0-113.825684-13.958737-156.402527-27.459368-54.487579-17.273263-110.807579-35.004632-232.421052-26.516211l-3.826527-53.733053c131.718737-9.458526 195.934316 10.967579 252.52379 28.887579 42.226526 13.365895 78.686316 24.926316 140.126316 24.926316 92.752842 0 148.210526-57.936842 148.210526-113.960421 0-16.949895-5.524211-101.618526-114.634105-101.618526-64.970105 0-112.747789 23.336421-163.328 48.02021C365.325474 830.571789 300.301474 862.315789 204.288 862.315789 85.908211 862.315789 0 787.294316 0 683.897263 0 588.126316 80.788211 485.052632 258.182737 485.052632c86.689684 0 155.917474 24.818526 229.214316 51.09221 45.810526 16.410947 92.564211 33.172211 145.488842 44.166737 9.000421-7.033263 13.850947-16.276211 13.850947-26.758737 0-37.187368-37.672421-74.859789-74.13221-111.265684l-3.287579-3.287579 38.103579-38.103579 3.260631 3.287579C652.853895 446.275368 700.631579 494.026105 700.631579 553.552842c0 12.719158-2.802526 24.926316-7.976421 36.109474A594.997895 594.997895 0 0 0 754.526316 592.842105c62.437053 0 107.789474-34.007579 107.789473-80.842105 0-58.853053-52.870737-110.268632-108.840421-164.702316l-8.057263-7.841684c-19.024842 16.437895-38.076632 35.489684-59.418947 56.832l-38.103579-38.103579c74.805895-74.832842 134.898526-134.898526 268.314947-141.931789V55.619368c-63.407158 7.787789-120.993684 39.424-121.667368 39.801264l-15.818105 8.811789-14.120421-11.344842C731.701895 66.452211 709.712842 53.894737 673.684211 53.894737c-41.418105 0-74.347789 25.869474-109.190737 53.301895-26.624 20.911158-54.137263 42.549895-86.851369 53.194105L469.342316 161.684211h-69.093053l-105.525895 105.525894-38.103579-38.130526L324.015158 161.684211H161.684211V107.789474h303.104c22.231579-8.272842 43.708632-25.168842 66.398315-42.981053C569.829053 34.438737 613.618526 0 673.684211 0c48.909474 0 81.408 17.946947 110.888421 40.097684C813.702737 26.300632 877.729684 0 943.157895 0h26.947368v323.368421h-53.894737v-53.167158c-54.164211 3.098947-92.914526 15.845053-127.002947 36.675369l1.832421 1.778526C852.587789 368.505263 916.210526 430.376421 916.210526 512c0 60.928-43.708632 109.945263-107.789473 127.622737V700.631579h53.894736v-53.894737h53.894737v53.894737h53.894737v53.894737h-53.894737v53.894737h-53.894737v-53.894737h-53.894736c-29.722947 0-53.894737-24.171789-53.894737-53.894737v-53.894737c-118.325895 0-207.063579-31.797895-285.318737-59.877053C400.437895 562.229895 335.494737 538.947368 258.182737 538.947368 117.059368 538.947368 53.894737 611.732211 53.894737 683.897263 53.894737 757.221053 115.738947 808.421053 204.288 808.421053c11.910737 0 23.228632-0.538947 34.034526-1.536C248.454737 796.321684 269.473684 770.640842 269.473684 739.166316c0-33.118316-43.088842-70.979368-58.152421-81.596632l30.935579-44.139789c8.299789 5.793684 81.111579 58.664421 81.111579 125.736421 0 19.429053-4.527158 37.052632-10.994526 52.304842 30.773895-10.051368 58.314105-23.498105 86.662737-37.349053C452.877474 727.848421 508.577684 700.631579 585.997474 700.631579 702.410105 700.631579 754.526316 778.725053 754.526316 856.144842 754.526316 938.657684 678.912 1024 552.421053 1024z m-21.180632-623.104L493.136842 362.792421l137.889684-137.889684 38.103579 38.103579-137.889684 137.889684z m-126.760421-18.351158l-38.103579-38.103579 152.980211-152.98021 38.103579 38.103579-152.980211 152.98021z m282.004211-218.624c15.494737-9.754947 43.331368-31.447579 43.331368-31.447579-25.734737-27.809684-49.556211-33.333895-67.368421-29.07621-19.240421 4.608-37.753263 24.602947-37.753263 24.602947s42.253474 22.447158 61.790316 35.920842z&quot; fill=&quot;#231F20&quot; &gt;&lt;/path&gt;&lt;/symbol&gt;&lt;symbol id=&quot;icon-horse&quot; viewBox=&quot;0 0 1024 1024&quot;&gt;&lt;path d=&quot;M776.003368 646.736842c16.599579-99.947789 43.439158-181.086316 83.213474-256.538947l6.817684-12.934737H269.473684c-36.756211 0-53.894737 54.945684-53.894737 92.05221 0 46.753684 6.656 77.527579 70.278737 176.074106l84.533895 128.269473L498.876632 646.736842h277.126736z&quot; fill=&quot;#FFAF6E&quot; &gt;&lt;/path&gt;&lt;path d=&quot;M1024 0v404.210526c0 33.333895 0 134.736842-92.079158 134.736842h-13.824l-78.362947-109.056c-22.743579 49.906526-40.340211 103.046737-53.490527 162.950737h115.092211C937.310316 592.842105 970.105263 625.637053 970.105263 661.638737c0 60.631579-69.389474 154.300632-77.312 164.75621l-43.008-32.471579C875.466105 759.861895 916.210526 693.813895 916.210526 661.638737c0-5.982316-8.919579-14.901895-14.901894-14.901895h-125.332211C761.128421 736.121263 754.526316 840.569263 754.526316 970.105263h-53.894737c0-283.971368 31.097263-453.605053 110.888421-605.049263l20.318316-38.534737 112.801684 156.995369c14.443789-4.419368 25.465263-20.938105 25.465263-79.306106V0h53.894737z m-161.684211 161.684211h53.894737V0h-53.894737v80.842105c-17.381053-14.955789-38.184421-26.947368-80.842105-26.947368h-134.736842v53.894737h134.736842c37.672421 0 80.842105 40.906105 80.842105 53.894737z m-107.789473 0h-215.578948v53.894736h161.684211l53.894737-53.894736zM300.894316 766.544842L400.680421 916.210526h64.754526l-95.043368-142.551579L498.876632 646.736842h167.855157a1212.631579 1212.631579 0 0 1 9.431579-53.894737h-199.383579l-175.885473 173.702737z m109.97221-184.400842l-37.861052-38.319158-132.419369 130.802526C173.729684 571.095579 161.684211 529.812211 161.684211 469.315368 161.684211 398.578526 199.464421 323.368421 269.473684 323.368421h323.368421l53.894737-53.894737H269.473684c-6.709895 0-13.258105 0.565895-19.698526 1.482105C234.927158 249.451789 204.638316 215.578947 160.633263 215.578947 65.967158 215.578947 0 349.291789 0 469.315368c0 70.170947 16.141474 136.650105 49.232842 202.671158L6.197895 723.833263l41.472 34.41179 66.128842-79.737264-8.704-16.033684C83.105684 622.133895 53.894737 558.214737 53.894737 469.315368 53.894737 368.451368 106.765474 269.473684 160.633263 269.473684c13.231158 0 25.815579 9.889684 35.43579 20.533895C142.874947 321.967158 107.789474 388.500211 107.789474 469.315368c0 78.201263 19.698526 130.937263 93.642105 243.981474l-55.296 54.622316L280.899368 970.105263h64.754527l-130.048-195.072 195.260631-192.889263z&quot; fill=&quot;#231F20&quot; &gt;&lt;/path&gt;&lt;/symbol&gt;&lt;symbol id=&quot;icon-monkey_shen&quot; viewBox=&quot;0 0 1024 1024&quot;&gt;&lt;path d=&quot;M512 512m-296.421053 0a296.421053 296.421053 0 1 0 592.842106 0 296.421053 296.421053 0 1 0-592.842106 0Z&quot; fill=&quot;#BBC4C9&quot; &gt;&lt;/path&gt;&lt;path d=&quot;M970.105263 512c0 224.983579-163.166316 412.186947-377.263158 450.533053v-54.460632C777.135158 870.507789 916.210526 707.206737 916.210526 512c0-222.881684-181.328842-404.210526-404.210526-404.210526S107.789474 289.118316 107.789474 512s181.328842 404.210526 404.210526 404.210526c9.081263 0 18.000842-0.754526 26.947368-1.374315v53.894736c-8.973474 0.538947-17.866105 1.374316-26.947368 1.374316-252.604632 0-458.105263-205.500632-458.105263-458.105263S259.395368 53.894737 512 53.894737s458.105263 205.500632 458.105263 458.105263z m-431.157895 134.736842h161.684211v53.894737h53.894737V269.473684h-215.578948V161.684211h-53.894736v107.789473h-215.578948v431.157895h53.894737v-53.894737h161.684211v215.578947h53.894736v-215.578947z m0-161.68421h161.684211v107.789473h-161.684211v-107.789473z m-215.578947 0h161.684211v107.789473h-161.684211v-107.789473z m215.578947-161.684211h161.684211v107.789474h-161.684211v-107.789474z m-215.578947 0h161.684211v107.789474h-161.684211v-107.789474z&quot; fill=&quot;#231F20&quot; &gt;&lt;/path&gt;&lt;/symbol&gt;&lt;symbol id=&quot;icon-ox_chou&quot; viewBox=&quot;0 0 1024 1024&quot;&gt;&lt;path d=&quot;M512 512m-296.421053 0a296.421053 296.421053 0 1 0 592.842106 0 296.421053 296.421053 0 1 0-592.842106 0Z&quot; fill=&quot;#D6B196&quot; &gt;&lt;/path&gt;&lt;path d=&quot;M970.105263 512c0 224.983579-163.166316 412.186947-377.263158 450.533053v-54.460632C777.135158 870.507789 916.210526 707.206737 916.210526 512c0-222.881684-181.328842-404.210526-404.210526-404.210526S107.789474 289.118316 107.789474 512s181.328842 404.210526 404.210526 404.210526c9.081263 0 18.000842-0.754526 26.947368-1.374315v53.894736c-8.973474 0.538947-17.866105 1.374316-26.947368 1.374316-252.604632 0-458.105263-205.500632-458.105263-458.105263S259.395368 53.894737 512 53.894737s458.105263 205.500632 458.105263 458.105263z m-161.68421 188.631579h-159.555369c13.985684-172.813474 43.115789-357.429895 70.817684-385.158737L700.631579 269.473684H323.368421v53.894737h107.169684c-1.940211 45.756632-8.192 103.962947-15.76421 161.684211H323.368421v53.894736h83.968c-9.862737 68.446316-20.264421 130.128842-25.734737 161.684211H215.578947v53.894737h592.842106v-53.894737z m-346.543158-161.684211h149.800421a3313.717895 3313.717895 0 0 0-16.842105 161.684211h-158.477474c6.036211-35.247158 16.114526-95.636211 25.519158-161.684211z m22.608842-215.578947h171.735579c-15.198316 41.121684-27.405474 100.594526-36.890948 161.684211h-150.123789c7.383579-57.505684 13.419789-115.361684 15.279158-161.684211z&quot; fill=&quot;#231F20&quot; &gt;&lt;/path&gt;&lt;/symbol&gt;&lt;symbol id=&quot;icon-monkey&quot; viewBox=&quot;0 0 1024 1024&quot;&gt;&lt;path d=&quot;M757.733053 485.052632H565.894737a80.842105 80.842105 0 0 0-80.842105 80.842105v215.578947c0 40.96 43.546947 99.678316 77.446736 139.210105C596.426105 960.215579 603.055158 970.105263 603.055158 970.105263H754.526316s15.144421-18.674526 45.891368-58.071579S862.315789 809.984 862.315789 717.608421c0-89.573053-47.993263-166.346105-104.582736-232.555789z&quot; fill=&quot;#C3D686&quot; &gt;&lt;/path&gt;&lt;path d=&quot;M538.947368 1024h-53.894736c0-32.794947 25.869474-87.417263 77.446736-103.316211C528.599579 881.152 485.052632 822.433684 485.052632 781.473684c0-44.570947 36.271158-80.842105 80.842105-80.842105h80.842105v53.894737h-80.842105a26.947368 26.947368 0 0 0-26.947369 26.947368c0 19.725474 36.675368 77.473684 92.133053 134.736842h88.602947c20.210526-14.147368 88.737684-71.464421 88.737685-198.602105 0-108.382316-93.237895-202.967579-168.151579-278.986105-49.502316-50.202947-88.576-89.842526-98.735158-128.61979-11.749053-44.732632-21.584842-112.586105-26.327579-148.318315H377.263158c-45.136842 0-89.519158 8.434526-121.802105 53.894736H431.157895v53.894737c-97.28 0-107.789474 113.071158-107.789474 161.684211v53.894737h53.894737v161.68421h-53.894737v-107.789474h-26.947368c-170.253474 0-188.631579-94.234947-188.631579-134.736842 0-31.043368 35.220211-72.326737 55.727158-93.722947 2.694737-14.686316 5.847579-28.348632 9.431579-41.013895H161.684211V215.578947h31.528421C239.642947 120.993684 317.224421 107.789474 377.263158 107.789474h185.640421l2.802526 23.794526c0.134737 1.050947 12.719158 106.657684 27.944421 164.756211 6.494316 24.872421 44.624842 63.514947 84.965053 104.448C760.481684 483.813053 862.315789 587.129263 862.315789 717.608421c0 92.375579-31.124211 155.028211-61.898105 194.425263C904.919579 892.146526 970.105263 803.004632 970.105263 673.684211c0-91.405474-42.819368-154.381474-84.237474-215.255579C847.791158 402.458947 808.421053 344.576 808.421053 269.473684c0-119.349895 87.093895-161.684211 161.68421-161.68421v53.894737c-32.417684 0-107.789474 10.509474-107.789474 107.789473 0 58.502737 31.555368 104.933053 68.096 158.639158C974.282105 492.597895 1024 565.679158 1024 673.684211c0 177.286737-108.301474 296.421053-269.473684 296.421052h-161.684211c-37.672421 0-53.894737 40.906105-53.894737 53.894737zM229.214316 269.473684a384.808421 384.808421 0 0 0-14.012632 58.341053l-1.401263 8.488421-6.090105 6.117053c-22.878316 22.932211-44.813474 52.601263-46.026105 62.275368 0 56.805053 53.76 75.264 107.789473 79.386947V431.157895c0-58.691368 13.473684-119.619368 46.511158-161.684211h-86.770526zM323.368421 1024h-53.894737c0-32.794947 25.869474-87.417263 77.446737-103.316211C313.020632 881.152 269.473684 822.433684 269.473684 781.473684c0-44.570947 36.271158-80.842105 80.842105-80.842105h45.16379A188.847158 188.847158 0 0 1 565.894737 592.842105h134.736842v53.894737h-134.736842c-74.293895 0-134.736842 60.442947-134.736842 134.736842v26.516211l-53.894737 0.377263V781.473684c0-9.162105 0.646737-18.135579 1.913263-26.947368H350.315789c-14.848 0-26.947368 12.072421-26.947368 26.947368 0 19.725474 36.675368 77.473684 92.133053 134.736842H431.157895v53.894737h-53.894737c-37.672421 0-53.894737 40.906105-53.894737 53.894737z&quot; fill=&quot;#231F20&quot; &gt;&lt;/path&gt;&lt;/symbol&gt;&lt;symbol id=&quot;icon-horse_wu&quot; viewBox=&quot;0 0 1024 1024&quot;&gt;&lt;path d=&quot;M512 512m-296.421053 0a296.421053 296.421053 0 1 0 592.842106 0 296.421053 296.421053 0 1 0-592.842106 0Z&quot; fill=&quot;#FF8787&quot; &gt;&lt;/path&gt;&lt;path d=&quot;M970.105263 512c0 224.983579-163.166316 412.186947-377.263158 450.533053v-54.460632C777.135158 870.507789 916.210526 707.206737 916.210526 512c0-222.881684-181.328842-404.210526-404.210526-404.210526S107.789474 289.118316 107.789474 512s181.328842 404.210526 404.210526 404.210526c9.081263 0 18.000842-0.754526 26.947368-1.374315v53.894736c-8.973474 0.538947-17.866105 1.374316-26.947368 1.374316-252.604632 0-458.105263-205.500632-458.105263-458.105263S259.395368 53.894737 512 53.894737s458.105263 205.500632 458.105263 458.105263z m-431.157895 26.947368h269.473685v-53.894736H538.947368v-161.684211h161.684211v-53.894737H411.001263c12.045474-33.28 20.156632-69.793684 20.156632-107.789473h-53.894737c0 121.963789-105.364211 233.391158-106.415158 234.496l38.858105 37.349052c2.883368-3.018105 43.816421-46.133895 77.392842-110.160842H485.052632v161.684211H215.578947v53.894736h269.473685v323.368421h53.894736V538.947368z&quot; fill=&quot;#231F20&quot; &gt;&lt;/path&gt;&lt;/symbol&gt;&lt;symbol id=&quot;icon-ox&quot; viewBox=&quot;0 0 1025 1024&quot;&gt;&lt;path d=&quot;M540.294737 754.526316h215.578947c20.210526 0 35.112421 1.374316 53.894737 4.581052 91.863579 15.656421 145.354105 67.691789 161.684211 86.069895V916.210526h53.894736V635.580632l-7.895579-7.895579c-9.269895-9.269895-36.513684-49.232842-44.032-196.527158H540.294737a161.684211 161.684211 0 0 0-161.684211 161.68421v131.098948c43.304421 20.210526 97.28 30.585263 161.684211 30.585263z&quot; fill=&quot;#FFAF6E&quot; &gt;&lt;/path&gt;&lt;path d=&quot;M1025.347368 635.580632V916.210526h-53.894736v-71.033263c-16.330105-18.405053-69.820632-70.413474-161.684211-86.069895V916.210526h-53.894737v-161.68421h-107.789473v215.578947h-53.894737V700.631579h161.68421c100.998737 0 172.570947 38.669474 215.578948 71.868632v-115.738948c-33.684211-43.627789-51.712-137.458526-53.706106-279.498105H701.978947c-76.934737 0-127.218526-26.219789-175.804631-51.550316a1556.048842 1556.048842 0 0 0-26.839579-13.743158c-26.839579 26.004211-66.209684 44.921263-115.738948 55.511579 24.441263 22.986105 60.874105 52.116211 106.469053 72.838737l-22.312421 49.044211c-76.584421-34.816-129.589895-88.926316-150.824421-113.125053-10.644211 0.619789-21.477053 1.024-32.687158 1.024a473.734737 473.734737 0 0 1-123.365053-15.952842l-93.022315 186.314105 68.581052 53.86779C167.882105 579.557053 237.891368 538.947368 324.715789 538.947368v53.894737c-95.986526 0-170.361263 62.490947-171.088842 63.137684l-16.78821 14.282106-136.838737-107.358316 109.729684-219.809684C46.430316 314.448842 1.347368 267.371789 1.347368 199.868632 1.347368 89.815579 121.586526 53.894737 163.031579 53.894737v53.894737c-14.120421 0-107.789474 17.165474-107.789474 92.079158C55.242105 290.465684 192.188632 323.368421 284.240842 323.368421c67.907368 0 122.421895-12.988632 157.696-35.624421-42.711579-14.336-95.097263-23.120842-169.337263-18.324211l-3.503158-53.786947c95.878737-6.117053 160.148211 8.515368 211.429053 28.833684C484.244211 235.439158 486.4 225.818947 486.4 215.578947c0-48.855579-57.829053-76.288-58.394947-76.557473l22.393263-49.017263C454.063158 91.648 540.294737 131.826526 540.294737 215.578947c0 18.566737-3.422316 35.84-9.997474 51.631158 7.060211 3.584 13.985684 7.168 20.776421 10.698106C597.854316 302.322526 638.248421 323.368421 701.978947 323.368421h269.473685v26.947368c0 214.689684 35.220211 266.590316 45.999157 277.369264l7.895579 7.895579z m-729.384421 25.141894l-98.789052 118.541474 86.797473 137.835789 45.594948-28.725894-65.913263-104.690527 37.052631-44.43621C358.642526 785.192421 439.080421 808.421053 540.294737 808.421053v-53.894737c-99.893895 0-175.077053-24.549053-223.474526-72.946527l-20.857264-20.857263z&quot; fill=&quot;#231F20&quot; &gt;&lt;/path&gt;&lt;/symbol&gt;&lt;symbol id=&quot;icon-rabbit_mao&quot; viewBox=&quot;0 0 1024 1024&quot;&gt;&lt;path d=&quot;M512 512m-296.421053 0a296.421053 296.421053 0 1 0 592.842106 0 296.421053 296.421053 0 1 0-592.842106 0Z&quot; fill=&quot;#7DD47F&quot; &gt;&lt;/path&gt;&lt;path d=&quot;M970.105263 512c0 224.983579-163.166316 412.186947-377.263158 450.533053v-54.460632C777.135158 870.507789 916.210526 707.206737 916.210526 512c0-222.881684-181.328842-404.210526-404.210526-404.210526S107.789474 289.118316 107.789474 512s181.328842 404.210526 404.210526 404.210526c9.081263 0 18.000842-0.754526 26.947368-1.374315v53.894736c-8.973474 0.538947-17.866105 1.374316-26.947368 1.374316-252.604632 0-458.105263-205.500632-458.105263-458.105263S259.395368 53.894737 512 53.894737s458.105263 205.500632 458.105263 458.105263z m-377.263158-188.631579h107.789474v323.368421c-20.48 0-39.936-11.264-40.016842-11.317895l-27.728842 46.214737c3.206737 1.940211 32.660211 18.997895 67.745684 18.997895 30.746947 0 53.894737-23.147789 53.894737-53.894737V269.473684h-215.578948v538.947369h53.894737V323.368421z m-107.789473 242.526316v-242.526316h-53.894737v196.904421l-107.789474 40.421053v-243.927579l169.094737-48.316632-14.821053-51.819789L269.473684 276.102737v304.801684l-36.405895 13.662316 18.917053 50.472421 178.741895-67.018105c-5.039158 69.928421-55.269053 106.981053-165.133474 122.933894l7.733895 53.328842C325.712842 746.657684 485.052632 723.536842 485.052632 565.894737z&quot; fill=&quot;#231F20&quot; &gt;&lt;/path&gt;&lt;/symbol&gt;&lt;symbol id=&quot;icon-rabbit&quot; viewBox=&quot;0 0 1024 1024&quot;&gt;&lt;path d=&quot;M680.96 488.744421a1666.667789 1666.667789 0 0 0-54.433684-23.95621c-16.006737 12.234105-33.899789 20.264421-60.631579 20.264421h-80.842105c-36.810105 0-83.644632 30.396632-104.394106 67.772631-42.819368 77.123368-53.409684 117.813895-11.021473 201.701053C397.096421 808.879158 431.157895 876.409263 431.157895 970.105263h338.539789l68.338527-138.859789c20.129684-40.96 24.252632-73.701053 24.252631-110.349474 0.026947-57.397895-25.061053-159.717053-181.328842-232.151579z&quot; fill=&quot;#FFBDD8&quot; &gt;&lt;/path&gt;&lt;path d=&quot;M862.315789 720.896c0 36.621474-4.122947 69.389474-24.252631 110.349474L769.697684 970.105263H485.052632v-53.894737h48.370526C507.877053 880.074105 485.052632 833.509053 485.052632 781.473684c0-59.418947 24.171789-113.313684 63.218526-152.360421l38.103579 38.103579A161.091368 161.091368 0 0 0 538.947368 781.473684c0 54.784 35.381895 104.043789 63.514948 134.736842h133.712842l53.490526-108.759579c15.710316-31.851789 18.755368-55.834947 18.755369-86.554947 0-80.976842-63.434105-150.096842-178.607158-195.503158-17.542737 8.138105-38.292211 13.554526-63.919158 13.554526h-80.842105c-13.958737 0-43.924211 15.979789-57.290106 40.016843l-47.104-26.165895C401.408 515.449263 448.242526 485.052632 485.052632 485.052632h80.842105c37.268211 0 57.478737-15.440842 79.090526-36.45979C625.367579 336.195368 549.753263 269.473684 485.052632 269.473684h-107.789474a21.288421 21.288421 0 0 0-5.955369 2.021053A683.762526 683.762526 0 0 0 302.187789 194.021053c-35.84-34.223158-61.763368-58.933895-94.908631-79.440842A42.442105 42.442105 0 0 0 185.478737 107.789474a22.824421 22.824421 0 0 0-17.381053 7.194947c-10.913684 11.425684-6.063158 28.240842 1.428211 39.181474 21.989053 32.121263 47.912421 56.858947 83.752421 91.109052 20.614737 19.671579 49.259789 43.169684 77.392842 63.08379C281.007158 367.400421 215.578947 484.432842 215.578947 592.842105c0 74.482526 24.791579 124.065684 51.065264 176.586106C294.534737 825.209263 323.368421 882.903579 323.368421 970.105263h-53.894737c0-74.482526-24.791579-124.065684-51.065263-176.586105C190.517895 737.738105 161.684211 680.043789 161.684211 592.842105c0-90.866526 42.226526-197.685895 93.453473-274.485894a803.759158 803.759158 0 0 1-39.046737-34.115369C177.852632 247.754105 150.231579 221.399579 125.035789 184.616421c-24.441263-35.759158-22.797474-78.686316 4.069053-106.819368 26.300632-27.567158 70.898526-31.043368 106.522947-9.000421 37.941895 23.444211 65.562947 49.798737 103.774316 86.258526 9.970526 9.512421 33.037474 32.309895 56.93979 60.550737h68.634947c-27.621053-37.780211-60.416-72.730947-88.522105-99.543579-28.833684-27.540211-54.730105-52.116211-84.533895-74.024421L326.305684 0.296421c31.232 23.228632 57.802105 48.532211 87.309474 76.719158 53.840842 51.388632 94.450526 100.594526 121.74821 146.83621 82.836211 26.650947 150.042947 116.870737 165.025685 230.750316l1.724631 13.177263-9.404631 9.404632c-3.772632 3.772632-7.706947 7.653053-11.802948 11.587368C837.227789 561.178947 862.315789 663.498105 862.315789 720.896zM309.463579 754.526316c3.934316 8.057263 7.895579 16.087579 11.991579 24.144842C348.887579 832.970105 377.263158 889.128421 377.263158 970.105263h53.894737c0-93.696-34.061474-161.226105-61.520842-215.578947h-60.173474z m597.90821 53.894737c-3.422316 9.404632-7.814737 19.806316-13.770105 31.959579L829.790316 970.105263h60.065684l52.143158-105.957052c10.778947-21.935158 17.515789-40.016842 21.90821-55.727158h-56.535579zM514.694737 390.736842c0-34.223158-13.231158-44.463158-29.642105-44.463158s-29.642105 10.24-29.642106 44.463158c0 34.250105 13.231158 44.463158 29.642106 44.463158s29.642105-10.213053 29.642105-44.463158z&quot; fill=&quot;#231F20&quot; &gt;&lt;/path&gt;&lt;/symbol&gt;&lt;symbol id=&quot;icon-rat_zi&quot; viewBox=&quot;0 0 1024 1024&quot;&gt;&lt;path d=&quot;M512 512m-296.421053 0a296.421053 296.421053 0 1 0 592.842106 0 296.421053 296.421053 0 1 0-592.842106 0Z&quot; fill=&quot;#85C3DE&quot; &gt;&lt;/path&gt;&lt;path d=&quot;M970.105263 512c0 224.983579-163.166316 412.186947-377.263158 450.533053v-54.460632C777.135158 870.507789 916.210526 707.206737 916.210526 512c0-222.881684-181.328842-404.210526-404.210526-404.210526S107.789474 289.118316 107.789474 512s181.328842 404.210526 404.210526 404.210526c9.081263 0 18.000842-0.754526 26.947368-1.374315v53.894736c-8.973474 0.538947-17.866105 1.374316-26.947368 1.374316-252.604632 0-458.105263-205.500632-458.105263-458.105263S259.395368 53.894737 512 53.894737s458.105263 205.500632 458.105263 458.105263z m-431.157895 188.631579v-215.578947h269.473685v-53.894737H538.947368v-39.585684c26.543158-18.081684 94.585263-65.050947 177.852632-127.488L700.631579 215.578947H323.368421v53.894737h295.316211a4221.008842 4221.008842 0 0 1-121.640421 85.369263l-11.991579 8.003369V431.157895H242.526316v53.894737h242.526316v215.578947c0 48.343579-13.850947 53.894737-134.736843 53.894737v53.894737c105.391158 0 188.631579 0 188.631579-107.789474z&quot; fill=&quot;#231F20&quot; &gt;&lt;/path&gt;&lt;/symbol&gt;&lt;symbol id=&quot;icon-rat&quot; viewBox=&quot;0 0 1024 1024&quot;&gt;&lt;path d=&quot;M727.659789 431.157895c-132.581053 0-220.348632 47.454316-285.803789 154.354526-19.779368 32.309895-15.845053 76.503579-9.404632 96.579368 3.260632 10.159158 7.760842 18.647579 12.422737 25.546106C464.761263 737.010526 499.927579 754.526316 538.947368 754.526316h66.829474c1.158737 17.893053-1.967158 34.762105-15.144421 53.975579-12.692211 18.539789-37.807158 40.151579-56.32 54.810947 25.249684-0.673684 52.709053-0.997053 83.240421-0.997053C877.487158 862.315789 970.105263 711.922526 970.105263 571.176421 936.421053 512 882.364632 431.157895 727.659789 431.157895z&quot; fill=&quot;#85C3DE&quot; &gt;&lt;/path&gt;&lt;path d=&quot;M210.432 1012.897684l-43.573895-31.690105c106.954105-147.051789 185.317053-171.196632 423.828211-172.705684 21.396211-31.258947 16.249263-56.266105 9.377684-89.70779-3.557053-17.138526-7.221895-34.842947-7.221895-54.433684 0-68.958316 25.330526-104.636632 63.407158-136.973474l34.896842 41.040842c-29.453474 25.061053-44.409263 46.780632-44.409263 95.932632 0 14.093474 2.937263 28.402526 6.063158 43.546947 5.901474 28.510316 12.8 62.032842-1.131789 99.462737 166.373053-10.24 264.542316-96.902737 264.542315-236.193684C916.210526 418.330947 827.580632 323.368421 684.921263 323.368421c-83.644632 0-153.303579 29.696-174.187789 39.612632a224.875789 224.875789 0 0 1-20.533895 31.339789l-41.741474-34.115368 20.884211 17.057684-20.911158-16.976842C448.781474 359.828211 485.052632 314.287158 485.052632 262.736842c0-34.816-8.946526-60.766316-26.570106-77.069474-17.515789-16.249263-44.786526-24.602947-81.219368-24.953263V323.368421h-53.894737V109.783579l24.872421-1.913263c64.700632-4.931368 114.095158 7.895579 146.863158 38.238316C524.207158 173.056 538.947368 212.291368 538.947368 262.736842c0 11.102316-1.131789 21.908211-3.072 32.202105 37.268211-12.584421 89.842526-25.465263 149.045895-25.465263C858.165895 269.473684 970.105263 387.907368 970.105263 571.176421 970.105263 711.922526 877.487158 862.315789 617.552842 862.315789c-258.667789 0-311.942737 19.698526-407.120842 150.581895z m19.105684-256.835368c-12.045474 0-24.387368-0.565895-37.025684-1.64379l-22.096842-1.859368-2.425263-22.016C167.747368 728.144842 161.684211 672.444632 161.684211 631.026526c0-103.585684 21.450105-178.903579 53.894736-259.045052V107.789474h53.894737v274.782315l-2.021052 4.904422C235.439158 465.758316 215.578947 533.800421 215.578947 631.026526c0 22.878316 2.101895 51.442526 3.826527 70.979369 99.678316 2.802526 172.813474-35.408842 222.450526-116.493474l48.020211 24.090947c-11.237053 28.133053-11.371789 51.577263-0.377264 67.853474 9.701053 14.282105 28.645053 23.174737 49.448421 23.174737v53.894737c-39.019789 0-74.186105-17.515789-94.073263-46.888421a100.244211 100.244211 0 0 1-12.422737-25.546106c-53.221053 49.178947-121.128421 73.943579-202.913684 73.970527zM379.957895 525.473684c0-34.223158-13.231158-44.463158-29.642106-44.463158s-29.642105 10.24-29.642105 44.463158c0 34.250105 13.231158 44.463158 29.642105 44.463158s29.642105-10.213053 29.642106-44.463158z&quot; fill=&quot;#231F20&quot; &gt;&lt;/path&gt;&lt;/symbol&gt;&lt;symbol id=&quot;icon-rooster_you&quot; viewBox=&quot;0 0 1024 1024&quot;&gt;&lt;path d=&quot;M512 512m-296.421053 0a296.421053 296.421053 0 1 0 592.842106 0 296.421053 296.421053 0 1 0-592.842106 0Z&quot; fill=&quot;#BBC4C9&quot; &gt;&lt;/path&gt;&lt;path d=&quot;M970.105263 512c0 224.983579-163.166316 412.186947-377.263158 450.533053v-54.460632C777.135158 870.507789 916.210526 707.206737 916.210526 512c0-222.881684-181.328842-404.210526-404.210526-404.210526S107.789474 289.118316 107.789474 512s181.328842 404.210526 404.210526 404.210526c9.081263 0 18.000842-0.754526 26.947368-1.374315v53.894736c-8.973474 0.538947-17.866105 1.374316-26.947368 1.374316-252.604632 0-458.105263-205.500632-458.105263-458.105263S259.395368 53.894737 512 53.894737s458.105263 205.500632 458.105263 458.105263z m-215.578947-188.631579h-161.684211v-26.947368h161.684211V242.526316H269.473684v53.894737h161.684211v26.947368h-161.684211v485.052632h53.894737v-53.894737h377.263158v53.894737h53.894737V323.368421zM323.368421 646.736842h377.263158v53.894737H323.368421v-53.894737z m0-269.473684h107.789474c0 103.316211-72.784842 107.654737-81.084632 107.789474L350.315789 538.947368c46.592 0 134.736842-33.792 134.736843-161.68421h53.894736v107.789474c0 29.722947 24.171789 53.894737 53.894737 53.894736h107.789474v53.894737H323.368421v-215.578947z m377.263158 0v107.789474h-107.789474v-107.789474h107.789474z m-215.578947-80.842105h53.894736v26.947368h-53.894736v-26.947368z&quot; fill=&quot;#231F20&quot; &gt;&lt;/path&gt;&lt;/symbol&gt;&lt;symbol id=&quot;icon-rooster&quot; viewBox=&quot;0 0 1024 1024&quot;&gt;&lt;path d=&quot;M891.688421 506.421895C877.244632 455.033263 862.315789 401.893053 862.315789 323.368421V116.224l-323.368421 195.745684V323.368421c0 78.524632 14.928842 131.664842 29.372632 183.053474 12.611368 44.894316 24.522105 87.282526 24.522105 140.314947 0 101.618526-77.931789 176.693895-168.286316 203.991579l5.416422 11.587368h215.578947c24.333474 0 43.385263-0.242526 58.556631-2.128842C811.52 846.821053 916.210526 764.550737 916.210526 646.736842c0-53.032421-11.910737-95.420632-24.522105-140.314947z&quot; fill=&quot;#FF8787&quot; &gt;&lt;/path&gt;&lt;path d=&quot;M673.684211 354.357895c-16.384 0-29.642105-10.213053-29.642106-44.463158 0-34.223158 13.231158-44.463158 29.642106-44.463158s29.642105 10.24 29.642105 44.463158c0 34.250105-13.258105 44.463158-29.642105 44.463158zM540.106105 970.105263l-50.58021-107.789474h156.05221l50.607158 107.789474h59.553684l-51.60421-109.918316C811.52 846.821053 916.210526 764.550737 916.210526 646.736842c0-53.032421-11.910737-95.420632-24.522105-140.314947C877.244632 455.033263 862.315789 401.893053 862.315789 323.368421V107.789474c0-59.445895-48.343579-107.789474-107.789473-107.789474a107.924211 107.924211 0 0 0-107.789474 106.172632 100.890947 100.890947 0 0 0-24.117895-3.314527 88.710737 88.710737 0 0 0-88.602947 88.602948c0 20.668632 5.227789 39.720421 10.671158 53.921684l-99.489684 59.688421 93.749894 14.470737V377.263158c0 14.416842-5.901474 21.692632-33.360842 49.152l-11.129263 11.129263C398.228211 326.521263 324.985263 269.473684 215.740632 269.473684 96.768 269.473684 0 366.241684 0 485.214316V646.736842h53.894737v-161.522526A162.007579 162.007579 0 0 1 215.740632 323.368421c82.081684 0 140.422737 36.244211 240.64 152.252632l-38.615579 38.615579C367.804632 461.285053 323.098947 431.157895 259.584 431.157895A151.983158 151.983158 0 0 0 107.789474 582.952421V754.526316h53.894737v-171.573895A98.007579 98.007579 0 0 1 259.584 485.052632c46.322526 0 79.629474 20.911158 137.027368 86.016l18.970948 21.530947 128.080842-128.080842C572.200421 435.981474 592.842105 415.366737 592.842105 377.263158v-97.926737l23.309474-14.120421-13.662316-23.04c-0.161684-0.242526-14.578526-24.899368-14.578526-50.688 0-19.132632 15.575579-34.708211 34.70821-34.708211 5.093053 0 26.785684 3.179789 39.558737 18.647579l26.327579 46.026106 39.774316-24.090948-20.372211-49.367579C704.754526 140.449684 700.631579 117.517474 700.631579 107.789474c0-29.722947 24.171789-53.894737 53.894737-53.894737s53.894737 24.171789 53.894737 53.894737v215.578947c0 85.935158 16.680421 145.300211 31.366736 197.632C851.887158 564.008421 862.315789 601.141895 862.315789 646.736842c0 95.285895-99.408842 161.684211-188.631578 161.684211h-209.461895l-68.419369-145.704421C375.242105 618.954105 338.108632 592.842105 296.448 592.842105A80.976842 80.976842 0 0 0 215.578947 673.711158V862.315789h53.894737v-188.604631c0-14.874947 12.099368-26.974316 26.974316-26.974316 20.533895 0 38.965895 14.147368 50.553263 38.858105L480.579368 970.105263h59.526737z&quot; fill=&quot;#231F20&quot; &gt;&lt;/path&gt;&lt;/symbol&gt;&lt;symbol id=&quot;icon-snake_si&quot; viewBox=&quot;0 0 1024 1024&quot;&gt;&lt;path d=&quot;M512 512m-296.421053 0a296.421053 296.421053 0 1 0 592.842106 0 296.421053 296.421053 0 1 0-592.842106 0Z&quot; fill=&quot;#FF8787&quot; &gt;&lt;/path&gt;&lt;path d=&quot;M970.105263 512c0 224.983579-163.166316 412.186947-377.263158 450.533053v-54.460632C777.135158 870.507789 916.210526 707.206737 916.210526 512c0-222.881684-181.328842-404.210526-404.210526-404.210526S107.789474 289.118316 107.789474 512s181.328842 404.210526 404.210526 404.210526c9.081263 0 18.000842-0.754526 26.947368-1.374315v53.894736c-8.973474 0.538947-17.866105 1.374316-26.947368 1.374316-252.604632 0-458.105263-205.500632-458.105263-458.105263S259.395368 53.894737 512 53.894737s458.105263 205.500632 458.105263 458.105263z m-242.041263 180.762947l-52.116211-13.797052C657.219368 749.864421 651.425684 754.526316 619.789474 754.526316h-242.526316V485.052632h269.473684v53.894736h53.894737V215.578947H323.368421v538.947369c0 29.722947 24.171789 53.894737 53.894737 53.894737h242.526316c77.689263 0 91.189895-51.065263 108.274526-115.658106zM377.263158 269.473684h269.473684v161.684211H377.263158v-161.684211z&quot; fill=&quot;#231F20&quot; &gt;&lt;/path&gt;&lt;/symbol&gt;&lt;symbol id=&quot;icon-tiger_yin&quot; viewBox=&quot;0 0 1024 1024&quot;&gt;&lt;path d=&quot;M512 512m-296.421053 0a296.421053 296.421053 0 1 0 592.842106 0 296.421053 296.421053 0 1 0-592.842106 0Z&quot; fill=&quot;#7DD47F&quot; &gt;&lt;/path&gt;&lt;path d=&quot;M970.105263 512c0 224.983579-163.166316 412.186947-377.263158 450.533053v-54.460632C777.135158 870.507789 916.210526 707.206737 916.210526 512c0-222.881684-181.328842-404.210526-404.210526-404.210526S107.789474 289.118316 107.789474 512s181.328842 404.210526 404.210526 404.210526c9.081263 0 18.000842-0.754526 26.947368-1.374315v53.894736c-8.973474 0.538947-17.866105 1.374316-26.947368 1.374316-252.604632 0-458.105263-205.500632-458.105263-458.105263S259.395368 53.894737 512 53.894737s458.105263 205.500632 458.105263 458.105263z m-257.42821 299.250526l-107.789474-53.894737-24.117895 48.208843 107.789474 53.894736 24.117895-48.208842z m-269.473685-5.658947l-24.117894-48.208842-107.789474 53.894737 24.117895 48.208842 107.789473-53.894737zM700.631579 431.157895h-161.684211v-53.894737h107.789474v-53.894737H377.263158v53.894737h107.789474v53.894737h-161.684211v323.368421h53.894737v-53.894737h269.473684v53.894737h53.894737V431.157895z m-161.684211 161.68421h107.789474v53.894737h-107.789474v-53.894737z m-161.68421 0h107.789474v53.894737h-107.789474v-53.894737z m161.68421-107.789473h107.789474v53.894736h-107.789474v-53.894736z m-161.68421 0h107.789474v53.894736h-107.789474v-53.894736zM754.526316 215.578947h-223.097263l-20.803369-62.410105-51.119158 17.057684L474.624 215.578947H269.473684v107.789474h53.894737v-53.894737h377.263158v53.894737h53.894737V215.578947z&quot; fill=&quot;#231F20&quot; &gt;&lt;/path&gt;&lt;/symbol&gt;&lt;symbol id=&quot;icon-snake&quot; viewBox=&quot;0 0 1024 1024&quot;&gt;&lt;path d=&quot;M107.789474 790.474105c0-72.434526 67.880421-91.513263 121.451789-91.513263 74.401684 0 153.815579 34.438737 237.891369 70.925474 50.580211 21.935158 104.609684 45.325474 162.250105 63.083789-52.412632 44.786526-118.784 74.347789-195.152842 83.078737-143.171368 16.357053-326.440421 7.006316-326.440421-125.574737zM377.263158 215.578947c-15.575579 0-30.288842 3.449263-43.654737 9.377685A250.691368 250.691368 0 0 0 323.368421 296.421053c0 115.550316 76.422737 169.391158 137.83579 212.614736 8.138105 5.712842 16.141474 11.371789 23.848421 17.057685V323.368421a107.789474 107.789474 0 0 0-107.789474-107.789474z&quot; fill=&quot;#C3D686&quot; &gt;&lt;/path&gt;&lt;path d=&quot;M671.528421 788.857263c44.328421 11.964632 89.626947 19.563789 136.892632 19.56379 89.168842 0 161.684211-60.442947 161.68421-134.736842s-72.515368-134.736842-161.68421-134.736843c-19.078737 0-37.025684 1.509053-54.218106 4.015158-0.754526-101.402947-38.211368-172.355368-79.413894-219.648L673.684211 323.368421a1749.962105 1749.962105 0 0 1-79.036632-1.751579c45.702737 35.866947 108.705684 107.870316 105.984 232.367158 0 0.431158-0.080842 0.808421-0.10779 1.239579-34.923789 10.994526-66.155789 26.731789-95.097263 45.190737a163.085474 163.085474 0 0 0-15.845052-42.388211c-21.557895-39.639579-60.065684-66.775579-97.360842-93.022316C433.098105 423.343158 377.263158 384 377.263158 296.421053c0-130.290526 108.274526-188.631579 215.578947-188.631579 64.134737 0 132.715789 12.045474 214.366316 37.807158C802.330947 180.250947 780.099368 209.381053 700.631579 214.635789V161.684211h-53.894737v53.679157c-63.272421-1.024-104.528842-5.200842-104.986947-5.254736l-5.578106 53.598315C538.408421 263.949474 592.357053 269.473684 673.684211 269.473684c125.170526 0 188.631579-48.128 188.631578-143.063579V106.981053l-18.432-6.144C747.789474 68.823579 668.025263 53.894737 592.842105 53.894737c-158.666105 0-269.473684 99.732211-269.473684 242.526316 0 115.550316 76.422737 169.391158 137.83579 212.614736 33.684211 23.713684 65.509053 46.106947 81.003789 74.698106 9.539368 17.542737 13.285053 33.414737 12.341895 47.750737 21.153684 9.108211 42.118737 17.839158 62.949052 25.977263C671.151158 620.193684 729.977263 592.842105 808.421053 592.842105c59.445895 0 107.789474 36.271158 107.789473 80.842106s-48.343579 80.842105-107.789473 80.842105c-105.472 0-203.237053-42.388211-297.768421-83.429053-94.800842-41.094737-184.346947-79.952842-281.411369-79.952842C122.718316 591.171368 53.894737 644.715789 53.894737 727.578947c0 79.063579 67.098947 136.434526 159.555368 136.434527 142.174316 0 230.426947-66.883368 306.79579-129.886316 31.420632 13.419789 62.787368 26.058105 94.450526 37.133474-47.077053 49.637053-110.969263 82.566737-186.610526 91.270736l5.066105 53.625264c93.453474-7.006316 143.144421 9.350737 195.718737 26.543157 46.457263 15.225263 94.127158 30.854737 169.822316 30.854737 19.994947 0 41.957053-1.077895 66.344421-3.557052l-5.416421-53.625263c-105.283368 10.778947-158.100211-6.548211-213.935158-24.872422-22.150737-7.275789-44.624842-14.632421-70.305684-20.345263a334.848 334.848 0 0 0 96.14821-82.297263z m-458.078316 21.261474C162.573474 810.118737 107.789474 784.276211 107.789474 727.578947c0-60.847158 62.733474-82.539789 121.451789-82.539789 77.850947 0 154.731789 30.288842 235.250526 64.943158-66.263579 52.924632-139.722105 100.136421-251.041684 100.136421z&quot; fill=&quot;#231F20&quot; &gt;&lt;/path&gt;&lt;/symbol&gt;&lt;symbol id=&quot;icon-tiger&quot; viewBox=&quot;0 0 1024 1024&quot;&gt;&lt;path d=&quot;M431.157895 162.250105V134.736842c0-41.552842-39.289263-80.842105-80.842106-80.842105-28.833684 0-57.128421 4.661895-58.314105 4.850526L269.473684 62.490947v83.887158C144.788211 223.824842 89.222737 346.839579 66.991158 431.157895h266.051368c240.747789 0 415.851789 107.789474 415.85179 269.473684-14.848-25.114947-43.924211-53.894737-88.68379-53.894737-67.988211 0-121.263158 71.033263-121.263158 161.684211 0 66.802526 30.477474 119.888842 60.712421 156.16 12.638316 15.171368 36.055579 37.726316 59.014737 58.88 5.066105 0.107789 9.781895 0.538947 15.009685 0.538947 219.297684 0 350.315789-191.811368 350.315789-377.263158C1024 327.545263 679.855158 172.813474 431.157895 162.250105z&quot; fill=&quot;#F7C768&quot; &gt;&lt;/path&gt;&lt;path d=&quot;M673.684211 1024c-114.768842 0-188.820211-33.333895-254.167579-62.787368-53.625263-24.144842-99.974737-45.002105-161.28-45.002106-40.448 0-83.590737 23.255579-103.639579 45.16379l-39.747369-36.432842C142.497684 894.787368 199.168 862.315789 258.236632 862.315789c68.392421 0 119.861895 21.288421 172.921263 45.056V673.684211c0-35.166316-17.542737-64.107789-30.639158-80.815158-15.198316 9.835789-32.067368 18.890105-50.741895 26.947368l-21.342316-49.475368C469.800421 509.413053 485.052632 377.317053 485.052632 323.368421V221.642105A597.827368 597.827368 0 0 0 404.210526 215.578947h-26.947368V134.736842c0-12.099368-14.848-26.947368-26.947369-26.947368-9.377684 0-18.836211 0.592842-26.947368 1.347368V269.473684h-53.894737V211.671579c-136.030316 102.912-158.450526 266.886737-161.306947 295.882105 9.135158 9.108211 38.992842 25.061053 71.976421 38.669474l38.103579-59.365053 12.449684-1.589894C321.212632 473.653895 377.263158 392.192 377.263158 323.368421h53.894737c0 88.333474-68.796632 192.242526-180.870737 213.342316l-48.397474 75.398737-20.291368-7.437474C53.894737 557.756632 53.894737 523.317895 53.894737 512c0-50.041263 37.025684-254.733474 215.578947-365.621895V62.490947l22.528-3.745684C293.187368 58.556632 321.482105 53.894737 350.315789 53.894737c41.552842 0 80.842105 39.289263 80.842106 80.842105v27.513263c248.697263 10.563368 592.842105 165.295158 592.842105 484.486737 0 185.451789-131.018105 377.263158-350.315789 377.263158z m-13.473685-323.368421c-36.513684 0-67.368421 49.367579-67.368421 107.789474 0 85.746526 68.096 145.084632 89.465263 161.549473 91.540211-2.533053 164.378947-45.487158 213.827369-107.654737H700.631579v-53.894736h230.238316c8.919579-17.273263 16.357053-35.354947 22.285473-53.894737h-239.885473l-6.467369-17.650527C706.290526 735.582316 692.439579 700.631579 660.210526 700.631579zM485.052632 931.112421c33.926737 14.066526 70.521263 26.597053 114.607157 33.468632C569.424842 928.309895 538.947368 875.223579 538.947368 808.421053c0-90.650947 53.274947-161.684211 121.263158-161.684211 44.759579 0 73.835789 28.779789 88.68379 53.894737h217.007158c2.775579-17.866105 4.203789-35.920842 4.203789-53.894737 0-38.938947-5.658947-74.752-15.925895-107.627789l-126.706526 126.679579-38.103579-38.103579L932.001684 485.052632a367.939368 367.939368 0 0 0-57.775158-81.596632l-154.543158 154.543158-38.103579-38.103579 153.573053-153.573053a537.869474 537.869474 0 0 0-82.593684-56.751158l-140.665263 140.638316-38.103579-38.103579 128.134737-128.134737A794.731789 794.731789 0 0 0 538.947368 231.046737V323.368421c0 50.149053-11.102316 156.698947-95.932631 236.328421 18.378105 23.417263 42.037895 63.407158 42.037895 113.987369v257.42821zM215.578947 431.157895v-53.894737c39.774316 0 53.894737-29.022316 53.894737-53.894737h53.894737c0 53.571368-37.025684 107.789474-107.789474 107.789474z&quot; fill=&quot;#231F20&quot; &gt;&lt;/path&gt;&lt;/symbol&gt;&lt;symbol id=&quot;icon-boar&quot; viewBox=&quot;0 0 1024 1024&quot;&gt;&lt;path d=&quot;M732.079158 377.263158c-107.789474 0-186.421895 31.393684-281.869474 126.841263L180.331789 773.982316C257.724632 807.909053 348.725895 808.421053 485.052632 808.421053h96.013473c55.834947-34.411789 133.551158-53.894737 227.354948-53.894737h121.344L970.105263 680.555789V572.631579c0-94.315789-130.236632-195.368421-238.026105-195.368421z&quot; fill=&quot;#FFBDD8&quot; &gt;&lt;/path&gt;&lt;path d=&quot;M808.421053 700.631579v53.894737c-196.446316 0-323.368421 84.641684-323.368421 215.578947h-53.894737c0-163.705263 148.075789-269.473684 377.263158-269.473684z m-323.368421 107.789474v-53.894737c-158.342737 0-245.598316 0-319.649685-49.367579L158.612211 700.631579H80.842105c-21.692632 0-26.624-14.821053-26.947368-26.947368v-82.620632c84.156632-11.183158 161.684211-74.913684 161.68421-186.853053V215.578947H161.684211v161.684211H134.736842c-66.964211 0-134.736842 37.025684-134.736842 107.789474h53.894737c0-42.630737 52.870737-53.894737 80.842105-53.894737h24.629895C147.132632 504.912842 85.153684 538.947368 26.947368 538.947368H0v134.736843c0 32.498526 21.530947 80.842105 80.842105 80.842105h61.682527c32.687158 20.506947 67.125895 33.145263 105.957052 41.013895A232.879158 232.879158 0 0 0 215.578947 916.210526h53.894737c0-41.930105 14.012632-80.303158 39.424-112.505263C358.885053 808.151579 415.959579 808.421053 485.052632 808.421053z m-72.946527-342.420211L323.368421 554.738526V431.157895h-53.894737v253.682526l180.736-180.736-38.103579-38.103579zM323.368421 161.684211h-53.894737v190.032842a769.536 769.536 0 0 1 53.894737-49.098106V161.684211z m323.368421-53.894737c-72.623158 0-146.809263 23.336421-215.578947 58.637473V107.789474h-53.894737v154.138947C458.832842 205.392842 555.331368 161.684211 646.736842 161.684211c148.587789 0 269.473684 120.885895 269.473684 269.473684v235.654737L809.579789 862.315789h61.359158L970.105263 680.555789V431.157895c0-178.310737-145.057684-323.368421-323.368421-323.368421z&quot; fill=&quot;#231F20&quot; &gt;&lt;/path&gt;&lt;/symbol&gt;&lt;symbol id=&quot;icon-boar_hai&quot; viewBox=&quot;0 0 1024 1024&quot;&gt;&lt;path d=&quot;M512 512m-296.421053 0a296.421053 296.421053 0 1 0 592.842106 0 296.421053 296.421053 0 1 0-592.842106 0Z&quot; fill=&quot;#85C3DE&quot; &gt;&lt;/path&gt;&lt;path d=&quot;M309.975579 804.756211l-27.136-46.592c103.073684-60.011789 183.026526-132.473263 241.475368-219.24379H350.315789l-13.473684-50.283789c58.88-33.980632 99.435789-117.571368 118.703158-165.295158H242.526316v-53.894737h538.947368v53.894737h-268.18021c-12.395789 34.088421-42.469053 106.603789-90.435369 161.68421h134.009263a680.555789 680.555789 0 0 0 46.349474-107.708631l51.092211 17.057684c-58.421895 175.265684-171.034947 309.490526-344.333474 410.381474z m192.350316-2.937264L467.806316 760.454737c88.414316-73.728 154.516211-158.773895 202.105263-259.907369l48.801684 22.959158a797.372632 797.372632 0 0 1-82.351158 137.781895c32.741053 15.009684 83.456 44.867368 137.647158 101.591579l-38.938947 37.268211c-57.236211-59.877053-109.325474-85.557895-133.766737-95.178106a850.997895 850.997895 0 0 1-98.977684 96.848842z m48.613052-536.872421l-80.842105-53.894737 29.884632-44.840421 80.842105 53.894737-29.884632 44.840421zM512 53.894737C259.395368 53.894737 53.894737 259.395368 53.894737 512s205.500632 458.105263 458.105263 458.105263c9.081263 0 17.973895-0.835368 26.947368-1.374316v-53.894736c-8.946526 0.619789-17.866105 1.374316-26.947368 1.374315-222.881684 0-404.210526-181.328842-404.210526-404.210526S289.118316 107.789474 512 107.789474s404.210526 181.328842 404.210526 404.210526c0 195.206737-139.075368 358.507789-323.368421 396.045474v54.460631c214.096842-38.346105 377.263158-225.549474 377.263158-450.533052C970.105263 259.395368 764.604632 53.894737 512 53.894737z&quot; fill=&quot;#231F20&quot; &gt;&lt;/path&gt;&lt;/symbol&gt;&lt;symbol id=&quot;icon-bilibili1&quot; viewBox=&quot;0 0 1129 1024&quot;&gt;&lt;path d=&quot;M234.909 9.656a80.468 80.468 0 0 1 68.398 0 167.374 167.374 0 0 1 41.843 30.578l160.937 140.82h115.07l160.936-140.82a168.983 168.983 0 0 1 41.843-30.578A80.468 80.468 0 0 1 930.96 76.445a80.468 80.468 0 0 1-17.703 53.914 449.818 449.818 0 0 1-35.406 32.187 232.553 232.553 0 0 1-22.531 18.508h100.585a170.593 170.593 0 0 1 118.289 53.109 171.397 171.397 0 0 1 53.914 118.288v462.693a325.897 325.897 0 0 1-4.024 70.007 178.64 178.64 0 0 1-80.468 112.656 173.007 173.007 0 0 1-92.539 25.75H212.377a341.186 341.186 0 0 1-72.421-4.024A177.835 177.835 0 0 1 28.91 939.065a172.202 172.202 0 0 1-27.36-92.539V388.662a360.498 360.498 0 0 1 0-66.789A177.03 177.03 0 0 1 162.487 178.64h105.414c-16.899-12.07-31.383-26.555-46.672-39.43a80.468 80.468 0 0 1-25.75-65.984 80.468 80.468 0 0 1 39.43-63.57M216.4 321.873a80.468 80.468 0 0 0-63.57 57.937 108.632 108.632 0 0 0 0 30.578v380.615a80.468 80.468 0 0 0 55.523 80.469 106.218 106.218 0 0 0 34.601 5.632h654.208a80.468 80.468 0 0 0 76.444-47.476 112.656 112.656 0 0 0 8.047-53.109v-354.06a135.187 135.187 0 0 0 0-38.625 80.468 80.468 0 0 0-52.304-54.719 129.554 129.554 0 0 0-49.89-7.242H254.22a268.764 268.764 0 0 0-37.82 0z m0 0&quot; fill=&quot;#20B0E3&quot; &gt;&lt;/path&gt;&lt;path d=&quot;M348.369 447.404a80.468 80.468 0 0 1 55.523 18.507 80.468 80.468 0 0 1 28.164 59.547v80.468a80.468 80.468 0 0 1-16.094 51.5 80.468 80.468 0 0 1-131.968-9.656 104.609 104.609 0 0 1-10.46-54.719v-80.468a80.468 80.468 0 0 1 70.007-67.593z m416.02 0a80.468 80.468 0 0 1 86.102 75.64v80.468a94.148 94.148 0 0 1-12.07 53.11 80.468 80.468 0 0 1-132.773 0 95.757 95.757 0 0 1-12.875-57.133V519.02a80.468 80.468 0 0 1 70.007-70.812z m0 0&quot; fill=&quot;#20B0E3&quot; &gt;&lt;/path&gt;&lt;/symbol&gt;&lt;symbol id=&quot;icon-yinle&quot; viewBox=&quot;0 0 1024 1024&quot;&gt;&lt;path d=&quot;M512.2976 0a531.2 531.2 0 0 0-512 548.48V960h128V548.48a398.72 398.72 0 0 1 384-411.52 398.72 398.72 0 0 1 384 411.52V960h128V548.48A531.2 531.2 0 0 0 512.2976 0z&quot; fill=&quot;#5c8add&quot; &gt;&lt;/path&gt;&lt;path d=&quot;M64.2976 576l256 0 0 448-256 0 0-448Z&quot; fill=&quot;#5c8add&quot; &gt;&lt;/path&gt;&lt;path d=&quot;M704.2976 576l256 0 0 448-256 0 0-448Z&quot; fill=&quot;#5c8add&quot; &gt;&lt;/path&gt;&lt;/symbol&gt;&lt;symbol id=&quot;icon-icon-test-copy&quot; viewBox=&quot;0 0 1024 1024&quot;&gt;&lt;path d=&quot;M512 512m-229.517241 0a229.517241 229.517241 0 1 0 459.034482 0 229.517241 229.517241 0 1 0-459.034482 0Z&quot; fill=&quot;#5c8add&quot; &gt;&lt;/path&gt;&lt;path d=&quot;M512 1024A512 512 0 1 1 1024 512 512 512 0 0 1 512 1024z m0-141.241379A370.758621 370.758621 0 1 0 141.241379 512 370.758621 370.758621 0 0 0 512 882.758621z&quot; fill=&quot;#5c8add&quot; &gt;&lt;/path&gt;&lt;/symbol&gt;&lt;symbol id=&quot;icon-V&quot; viewBox=&quot;0 0 1024 1024&quot;&gt;&lt;path d=&quot;M1012.47774251 492.58192592L544.94137566 87.22962963a49.96686561 49.96686561 0 0 0-65.88275132 0L11.63784127 492.6975097c-21.03624691 18.26223633-23.3479224 49.93219048-5.08568606 70.96843739 18.03106878 21.03624691 49.93219048 23.3479224 70.96843738 5.08568607L512 191.83294532l434.71057495 376.91868784c9.47786949 8.20644797 21.26741446 12.25188008 32.82579189 12.13629629 14.10122046 0 27.97127337-5.77918871 38.02706173-17.33756613 18.14665256-20.92066314 15.95056084-52.70620106-5.08568606-70.9684374z&quot; fill=&quot;#5c8add&quot; &gt;&lt;/path&gt;&lt;path d=&quot;M109.30613051 567.59579541V896.89396825c0 42.53482892 34.90629982 77.44112875 77.44112875 77.44112875h220.76500882V666.30433862c0-25.54401411 20.92066314-46.46467725 46.46467724-46.46467724h116.16169313c25.54401411 0 46.46467725 20.92066314 46.46467725 46.46467724V974.335097h220.76500882c42.53482892 0 77.44112875-34.90629982 77.44112874-77.44112875l0.11558377-329.29817284L512 218.18604586 109.30613051 567.59579541zM848.00203175 197.49655027h-63.91782716c-12.82979894 0-23.23233862 10.40253968-23.23233863 23.23233862v24.27259259l110.49808818 95.70336508V220.72888889h-0.11558377c0-12.82979894-10.40253968-23.23233862-23.23233862-23.23233862zM905.44716754 83.18419754s-34.90629982 56.86721693-89.11508994 100.32671603c152.68616579 13.98563668 127.83565432-133.26809171 127.83565432-133.2680917-134.07717813-10.28695591-132.92134039 102.29164021-131.072 127.83565432 20.92066314-20.92066314 49.70102293-62.64640564 92.35143562-94.89427865zM798.53217637 174.61096297c-19.64924162-16.52847972-40.56990476-43.45949912-51.203612-53.97762258 0 0 32.94137566 20.57391182 56.40488184 49.3542716 2.42725926-18.37782011 6.47269135-93.3916896-93.16052205-85.3008254 0 0-13.98563668 104.71889947 87.95925221 89.92417638z&quot; fill=&quot;#5c8add&quot; &gt;&lt;/path&gt;&lt;/symbol&gt;&lt;symbol id=&quot;icon-zhifeiji&quot; viewBox=&quot;0 0 1167 1024&quot;&gt;&lt;path d=&quot;M41.201759 463.52493L1110.665064 30.117647c10.32605-4.159104 21.942857 0.860504 26.101961 11.043137 1.434174 3.728852 1.864426 7.744538 1.003921 11.616807L949.033691 978.823529c-2.151261 10.89972-12.764146 17.927171-23.663865 15.632493-2.72493-0.573669-5.306443-1.721008-7.601121-3.298599L634.80624 789.79944l-163.065546 133.951821c-16.492997 13.62465-40.87395 11.186555-54.498599-5.306443-3.011765-3.728852-5.306443-7.887955-6.884034-12.477311l-102.973669-313.080112-265.178712-91.787115c-10.469468-3.585434-16.062745-15.058824-12.333893-25.528291 1.864426-5.44986 6.023529-9.895798 11.329972-12.047059z&quot; fill=&quot;#FCFDFC&quot; &gt;&lt;/path&gt;&lt;path d=&quot;M929.385512 1023.569748c-3.155182 0-6.453782-0.286835-9.752381-1.003922-6.740616-1.434174-12.907563-4.015686-18.50084-8.031372L635.953579 825.940616l-146.142297 120.040336c-13.911485 11.473389-31.408403 16.779832-49.335574 15.058824-17.927171-1.721008-34.133333-10.32605-45.463305-24.237535-5.306443-6.453782-9.322129-13.768067-11.903642-21.79944l-98.527731-299.598879-251.697479-87.19776c-12.333894-4.302521-22.229692-13.05098-27.966386-24.811204s-6.453782-24.954622-2.151261-37.288515c4.589356-13.337815 14.771989-23.9507 27.82297-29.257143L1099.908761 3.585434c24.954622-10.039216 53.351261 2.007843 63.533894 26.819048 3.585434 8.891877 4.445938 18.644258 2.581513 28.109804L977.143495 984.560224c-4.732773 23.090196-25.098039 39.009524-47.757983 39.009524z m-294.579272-233.770308l282.962465 201.357983c2.294678 1.577591 4.87619 2.72493 7.601121 3.298599 10.89972 2.151261 21.512605-4.87619 23.663865-15.632493L1137.914364 52.777591c0.860504-3.872269 0.430252-7.887955-1.003922-11.616807-4.159104-10.32605-15.919328-15.202241-26.101961-11.043137L41.201759 463.52493c-5.306443 2.151261-9.465546 6.597199-11.47339 12.047059-1.721008 5.019608-1.434174 10.469468 0.860505 15.345658 2.294678 4.87619 6.453782 8.461625 11.473389 10.182633l265.178711 91.787115L410.214644 905.967507c1.434174 4.589356 3.872269 8.748459 6.884033 12.477311 6.597199 8.031373 15.919328 12.907563 26.101961 13.911485 10.32605 1.003922 20.365266-2.007843 28.396639-8.605042l163.208963-133.951821z&quot; fill=&quot;#4A4A4A&quot; &gt;&lt;/path&gt;&lt;path d=&quot;M307.097557 592.743978l105.698599 316.091876c6.310364 18.787675 26.532213 28.970308 45.319888 22.659944 4.159104-1.434174 7.887955-3.442017 11.186555-6.166946l164.786555-133.951821-165.360224-118.892997c297.017367-287.982073 447.462185-433.980952 451.191036-437.853222 0.573669-0.573669 2.581513-3.442017 0.430252-7.027451-1.290756-1.577591-3.298599-3.298599-7.027451-2.15126-202.218487 120.327171-404.293557 242.805602-606.22521 367.291877z&quot; fill=&quot;#CAE0EE&quot; &gt;&lt;/path&gt;&lt;path d=&quot;M446.786072 934.794398c-5.736695 0-11.329972-1.290756-16.636414-3.872269-8.891877-4.445938-15.632493-12.047059-18.787675-21.512605L305.376549 592.313725l1.003921-0.573669C507.308201 467.684034 711.391114 344.058263 912.60568 224.161345l0.286835-0.143418c3.585434-1.147339 6.310364-0.286835 8.605042 2.581513l0.143417 0.143417c2.438095 4.015686 0.573669 7.457703-0.573669 8.74846-3.872269 4.015686-155.177591 150.87507-450.043698 436.705882l165.503642 119.036414-166.220728 135.09916c-3.442017 2.868347-7.457703 5.019608-11.760225 6.453782-3.728852 1.290756-7.744538 2.007843-11.760224 2.007843z m-137.967507-341.333334l105.268348 314.944538c2.868347 8.748459 9.035294 15.77591 17.210084 19.935014 8.17479 4.159104 17.496919 4.732773 26.245378 1.864426 3.872269-1.290756 7.60112-3.298599 10.756302-5.880112l163.352381-132.804482L466.434252 672.627451l1.290756-1.147339C763.308201 384.932213 915.043775 237.642577 918.772627 233.626891c0 0 2.007843-2.294678 0.286835-5.306443-1.003922-1.290756-2.438095-2.438095-5.306443-1.577591-200.784314 119.610084-404.293557 242.94902-604.934454 366.718207z&quot; fill=&quot;#CAE0EE&quot; &gt;&lt;/path&gt;&lt;path d=&quot;M460.840974 924.898599l7.457703-253.561904 165.933894 119.896918-168.658824 135.959664c-1.290756 1.003922-3.011765 0.860504-4.015686-0.430252-0.430252-0.430252-0.717087-1.147339-0.717087-1.864426z&quot; fill=&quot;#94C3E2&quot; &gt;&lt;/path&gt;&lt;path d=&quot;M463.709322 929.344538c-1.290756 0-2.438095-0.573669-3.2986-1.577591-0.573669-0.860504-1.003922-1.864426-1.003921-2.868348l7.60112-256.286834 169.519328 122.621848-1.434174 1.147339-168.658823 135.959664c-0.860504 0.717087-1.721008 1.003922-2.72493 1.003922z m6.023529-255.282913l-7.457703 250.836974c0 0.286835 0.143417 0.717087 0.286835 1.003922 0.430252 0.573669 1.434174 0.717087 2.007843 0.286835l167.22465-134.812325-162.061625-117.315406z&quot; fill=&quot;#94C3E2&quot; &gt;&lt;/path&gt;&lt;/symbol&gt;&lt;symbol id=&quot;icon-lianjie&quot; viewBox=&quot;0 0 1079 1024&quot;&gt;&lt;path d=&quot;M695.355535 432.666896c-0.553495-1.10699-0.885592-2.186305-1.383737-3.265619-0.193723-0.193723-0.193723-0.359772-0.359771-0.719543-12.508983-26.318678-39.436506-43.366319-69.325226-41.013966-39.076734 3.265619-68.439634 39.021384-65.312388 79.841627 0.857917 10.516401 3.653066 20.147211 7.998 28.83708 19.78744 46.659613 11.097571 103.448181-25.377737 141.750022l-191.094085 199.950001a118.088119 118.088119 0 0 1-171.998513 0c-47.434506-49.537786-47.434506-130.098956 0-179.636742l71.234782-74.389703-0.52582-0.553494a75.911814 75.911814 0 0 0 24.326097-61.880721c-3.127246-40.820243-37.3609-71.51153-76.437634-68.24591a69.463599 69.463599 0 0 0-46.908685 23.966325l-0.166049-0.193723-72.618519 75.856464c-103.226783 107.793115-103.226783 282.36538 0 390.158495 103.171433 107.793115 270.299193 107.793115 373.498301 0l191.619904-200.1714c80.256748-83.992838 97.636485-208.307773 52.83108-310.289193z&quot; fill=&quot;#5c8add&quot; &gt;&lt;/path&gt;&lt;path d=&quot;M1002.047012 80.865592c-103.226783-107.82079-270.382217-107.82079-373.581325 0l-191.619905 200.199075c-80.284423 83.854464-97.66416 208.197074-52.997128 310.233843 0.52582 1.079315 0.857917 2.15863 1.383737 3.26562 0.166048 0.166048 0.166048 0.359772 0.332097 0.719543 12.536658 26.291004 39.46418 43.366319 69.3529 41.013966 39.076734-3.265619 68.439634-39.021384 65.312388-79.869302a78.679288 78.679288 0 0 0-7.998-28.864755c-19.78744-46.631938-11.097571-103.448181 25.377737-141.750022l191.287808-199.839302a118.088119 118.088119 0 0 1 172.026188 0c47.434506 49.537786 47.434506 130.126631 0 179.692091l-71.234782 74.417378 0.52582 0.553495a75.939489 75.939489 0 0 0-24.353772 61.88072c3.15492 40.847917 37.3609 71.51153 76.465309 68.245911a69.463599 69.463599 0 0 0 46.908685-23.938651l0.166049 0.166048 72.646194-75.856464c103.03306-107.82079 103.03306-282.642127 0-390.269194z&quot; fill=&quot;#5c8add&quot; &gt;&lt;/path&gt;&lt;/symbol&gt;&lt;symbol id=&quot;icon-liaotian&quot; viewBox=&quot;0 0 1171 1024&quot;&gt;&lt;path d=&quot;M1068.71699 0.243751H102.193768C46.228437 0.243751 0.500666 45.045267 0.500666 99.74309v696.251622c0 54.697824 45.727771 99.450589 101.693102 99.450589h329.113198l120.851966 114.465677a48.652788 48.652788 0 0 0 66.641644 0l120.851966-114.465677h329.064448c55.965331 0 101.741852-44.752765 101.741852-99.450589V99.74309C1170.458842 45.045267 1124.682321 0.243751 1068.71699 0.243751z m-439.776354 596.849784h-370.989696c-27.933915 0-50.846551-22.425133-50.846551-49.774045 0-27.348912 22.912636-49.725294 50.846551-49.725294h370.989696c27.933915 0 50.846551 22.376382 50.846551 49.725294 0 27.348912-22.912636 49.774045-50.846551 49.774045z m287.18795-211.381252H254.782171a50.456549 50.456549 0 0 1-50.846551-49.725294c0-27.397662 22.912636-49.774045 50.846551-49.774045h661.346415c27.933915 0 50.846551 22.376382 50.846551 49.774045 0 27.348912-22.912636 49.725294-50.846551 49.725294z&quot; fill=&quot;#5C8ADD&quot; &gt;&lt;/path&gt;&lt;/symbol&gt;&lt;symbol id=&quot;icon-xinfeng&quot; viewBox=&quot;0 0 1400 1024&quot;&gt;&lt;path d=&quot;M1301.63733163 214.78520234a207.81921797 207.81921797 0 0 1 7.02423018 52.42036465v489.73590176a205.10753818 205.10753818 0 0 1-205.05853125 205.05853125H283.05853124A205.15654424 205.15654424 0 0 1 77.99999999 756.79444971V267.20556699a201.36672685 201.36672685 0 0 1 7.02423106-52.42036465L586.24393329 562.1905874c69.44187217 51.96297217 146.36536612 49.13694404 214.1736961 0zM1103.60303056 62.0000167H283.05853124A204.50312753 204.50312753 0 0 0 106.37462518 163.41030547l489.71956641 335.75823018c62.43397646 50.77048623 127.85733457 50.31309463 194.62019765 0L1280.28693749 163.41030547A204.68281729 204.68281729 0 0 0 1103.60303056 62.0000167z m0 0&quot; fill=&quot;#5c8add&quot; &gt;&lt;/path&gt;&lt;/symbol&gt;&lt;symbol id=&quot;icon-QQ1&quot; viewBox=&quot;0 0 1024 1024&quot;&gt;&lt;path d=&quot;M0 512a512 512 0 1 0 1024 0A512 512 0 1 0 0 512z&quot; fill=&quot;#18ACFC&quot; &gt;&lt;/path&gt;&lt;path d=&quot;M500.113 228.39c118.396-1.518 178.924 61.004 201 156 3.497 15.048 0.15 34.807 0 50 27.143 5.682 33.087 60.106 10 75v1h1c8.26 14.33 19.04 28.125 26 44 7.332 16.723 9.306 35.16 14 55 4.024 17.01-2.287 51.505-10 57-0.771 0.683-2.231 1.312-3 2-14.601-3.016-30.377-16.865-38-27-3.065-4.074-5.275-9.672-10-12-0.395 21.568-12.503 41.15-22 55-3.514 5.123-14.073 13.217-14 18 3.691 2.836 8.305 2.956 13 5 10.513 4.577 25.449 13.168 32 22 2.334 3.146 5.548 7.555 7 11 16.193 38.414-36.527 48.314-63 54-27.185 5.839-77.818-10.224-92-19-8.749-5.414-16.863-18.573-29-19-3.666 2.389-14.438 1.132-20 1-16.829 32.804-101.913 47.868-148 31-14.061-5.146-43.398-17.695-38-40 4.437-18.327 19.947-29.224 35-37 5.759-2.975 18.915-4.419 22-10-13.141-8.988-24.521-28.659-31-44-3.412-8.077-4.193-25.775-9-32-7.789 12.245-32.097 36.91-52 33-3.071-4.553-7.213-9.097-9-15-4.792-15.835-1.81-40.379 2-54 8.117-29.02 16.965-50.623 32-72 4.672-6.643 11.425-12.135 16-19-8.945-9.733-6.951-37.536-1-49 4.002-7.709 9.701-7.413 10-20-1.92-3.022-0.071-8.604-1-13-4.383-20.75 3.273-47.552 9-63 19.8-53.421 53.712-90.466 105-112 11.986-5.033 25.833-7.783 39-11 5.322-1.3 11.969 0.518 16-2z&quot; fill=&quot;#FFFFFF&quot; &gt;&lt;/path&gt;&lt;/symbol&gt;&lt;symbol id=&quot;icon-rss&quot; viewBox=&quot;0 0 1024 1024&quot;&gt;&lt;path d=&quot;M749.61196492 908.06119793C749.61196492 560.41848146 463.58151854 274.36328126 115.93880207 274.36328126V115.93880207c434.50388795 0 792.12239584 357.61850789 792.12239586 792.12239586zM224.55858562 690.72261555a108.91682943 108.91682943 0 0 1 108.69404499 108.74355267C333.25263061 859.29616292 284.24005737 908.06119793 224.31104736 908.06119793 164.48105265 908.06119793 115.96355592 859.41993206 115.96355592 799.46616822s48.69077351-108.71879883 108.61978351-108.74355267zM641.01693522 908.06119793h-153.96879069c0-203.60020956-167.50913289-371.13409627-371.10934246-371.13409629v-153.96879068c288.03550619 0 525.07813313 237.11688843 525.07813315 525.10288697z&quot; fill=&quot;#FFA500&quot; &gt;&lt;/path&gt;&lt;/symbol&gt;&lt;symbol id=&quot;icon-youxiang&quot; viewBox=&quot;0 0 1024 1024&quot;&gt;&lt;path d=&quot;M583.60666667 972h-68.08c-8.43333333 0-15.33333333-6.9-15.33333334-15.33333333V609.52c0-8.43333333 6.9-15.33333333 15.33333334-15.33333333h68.08c8.43333333 0 15.33333333 6.9 15.33333333 15.33333333V956.66666667c0 8.43333333-6.9 15.33333333-15.33333333 15.33333333z&quot; fill=&quot;#629FF9&quot; &gt;&lt;/path&gt;&lt;path d=&quot;M294.42 167c-113.62 0-205.77333333 92-205.77333333 205.31333333v336.72h411.39333333V372.31333333c0.15333333-113.31333333-92-205.31333333-205.62-205.31333333z&quot; fill=&quot;#2166CC&quot; &gt;&lt;/path&gt;&lt;path d=&quot;M519.97333333 627H216.98666667c-25.45333333 0-46-20.54666667-46-46V393.78c0-25.45333333 20.54666667-46 46-46h302.98666666c25.45333333 0 46 20.54666667 46 46V581c0 25.45333333-20.54666667 46-46 46z&quot; fill=&quot;#D2E4FF&quot; &gt;&lt;/path&gt;&lt;path d=&quot;M565.97333333 397a49.22 49.22 0 0 0-49.37333333-49.22H220.36c-27.29333333 0-49.37333333 22.08-49.37333333 49.22v10.27333333l179.4 94.60666667c11.34666667 5.98 24.84 5.98 36.18666666 0l179.4-94.60666667v-10.27333333z&quot; fill=&quot;#FFFFFF&quot; &gt;&lt;/path&gt;&lt;path d=&quot;M730.5 167h-427.8v0.46c109.78666667 4.29333333 197.49333333 94.3 197.49333333 205.00666667v336.72h411.39333334c27.29333333 0 49.37333333-22.08 49.37333333-49.22V397c0-126.96-103.19333333-230-230.46-230z&quot; fill=&quot;#4E8DF6&quot; &gt;&lt;/path&gt;&lt;path d=&quot;M845.80666667 52H681.12666667c-9.04666667 0-16.40666667 7.36-16.40666667 16.40666667v336.72a24.67133333 24.67133333 0 1 0 49.37333333 0V134.18666667h131.71333334c9.04666667 0 16.40666667-7.36 16.40666666-16.40666667V68.40666667c0-9.04666667-7.36-16.40666667-16.40666666-16.40666667z&quot; fill=&quot;#2166CC&quot; &gt;&lt;/path&gt;&lt;path d=&quot;M896.25333333 659.81333333h-35.11333333c-8.43333333 0-15.33333333-6.9-15.33333333-15.33333333v-35.11333333c0-8.43333333 6.9-15.33333333 15.33333333-15.33333334h35.11333333c8.43333333 0 15.33333333 6.9 15.33333334 15.33333334v35.11333333c0 8.58666667-6.9 15.33333333-15.33333334 15.33333333z&quot; fill=&quot;#FFFFFF&quot; &gt;&lt;/path&gt;&lt;path d=&quot;M88.8 709.18666667l-24.22666667 131.40666666c-9.66 54.43333333 26.83333333 98.59333333 81.26666667 98.59333334h213.9c54.58666667 0 106.56666667-44.16 116.22666667-98.59333334l23.15333333-131.40666666H88.8z&quot; fill=&quot;#2974CE&quot; &gt;&lt;/path&gt;&lt;/symbol&gt;&lt;symbol id=&quot;icon-gitHub&quot; viewBox=&quot;0 0 1049 1024&quot;&gt;&lt;path d=&quot;M523.6581816 52C262.83923907 52 52 262.8401375 52 523.6581816c0 208.49703047 135.09433812 384.97758117 322.50789391 447.44906532 23.42658172 4.68531653 32.01647887-10.15136894 32.01647796-22.64584583 0-10.93210574-0.78163433-48.41463703-0.78163433-87.45953855-131.18885996 28.11189824-158.5200223-56.22379738-158.52002231-56.22379739-21.08437312-54.66232469-52.3201152-68.71827336-52.3201152-68.71827335-42.94858371-28.89353348 3.12384382-28.89353348 3.12384384-28.89353348 47.63479867 3.12384382 72.62285398 48.41643391 72.62285398 48.4164339 42.16784782 71.84121875 110.10538527 51.53758242 137.43654672 39.04400399 3.90457972-30.45500618 16.3990566-51.5393793 29.67427028-63.25222094-104.64023039-10.93300418-214.74561566-51.53848086-214.74561657-232.70524742 0-51.53848086 18.74126609-93.70632867 48.4164339-126.50444187-4.68621496-11.71284164-21.08527156-60.12837711 4.6844181-124.94207075 0 0 39.82563922-12.49447688 129.62738726 48.41463704 37.48253129-10.15136894 78.08980484-15.61742227 117.91454562-15.61742137s80.43201433 5.46605242 117.91454473 15.61742137c89.80264648-60.90911391 129.62828571-48.41463703 129.62828571-48.41463704 25.76879122 64.81369363 9.37063305 113.22922911 4.68531651 124.94207075 30.45410773 32.79721477 48.41463703 74.96506258 48.41463703 126.50444187 0 181.16676656-110.10538527 220.99150644-215.52545401 232.70524742 17.1797934 14.83668547 32.01647887 42.94858371 32.01647886 87.45953946 0 63.25222094-0.78163433 114.009965-0.78163523 129.62738636 0 12.49447688 8.59079468 27.33116234 32.01737731 22.64584583 187.41265734-62.4705866 322.50699547-238.95203574 322.50699546-447.44996375C995.31636231 262.8401375 783.69369203 52 523.6581816 52z&quot; fill=&quot;#663399&quot; &gt;&lt;/path&gt;&lt;path d=&quot;M230.82365863 729.03136735c-0.7807359 2.34310703-4.68531653 3.12384382-7.80916035 1.56237113s-5.46605242-4.68531653-3.90368129-7.02842356c0.7807359-2.34220859 4.68531653-3.12384382 7.80826192-1.56147269s4.68531653 4.68531653 3.90457972 7.02752512z m18.7412661 21.08437312c-2.34220859 2.34220859-7.02752512 0.78163433-9.37063305-2.34310703-3.12294539-3.12294539-3.90457972-7.80826192-1.5614727-10.15136894 2.34220859-2.34220859 6.24678922-0.7807359 9.37063305 2.34310702 3.12384382 3.90457972 3.90457972 8.58899782 1.5614727 10.15136895zM268.30618992 777.44690281c-3.12294539 2.34220859-7.80826192 0-10.15136895-3.90457972-3.12384382-3.90457972-3.12384382-9.37063305 0-10.93210574 3.12384382-2.34310703 7.80916035 0 10.15226739 3.90457972 3.12294539 3.90368129 3.12294539 8.58899782 0 10.93210574z m25.76968965 26.55042555c-2.34220859 3.12294539-7.80916035 2.34220859-12.49447688-1.56237113-3.90457972-3.90368129-5.46605242-9.37063305-2.34220859-11.71284164 2.34220859-3.12384382 7.80826192-2.34310703 12.49447687 1.56147269 3.90368129 3.12384382 4.68531653 8.58989625 2.3422086 11.71374008z m35.1403227 14.83668637c-0.78163433 3.90457972-6.24768766 5.46605242-11.71374008 3.90457972-5.46605242-1.5614727-8.58899782-6.24768766-7.80916036-9.37063305 0.78163433-3.90457972 6.24768766-5.46605242 11.71374009-3.90457972 5.46605242 1.5614727 8.58899782 5.46605242 7.80916035 9.37063305z m38.26416562 3.12384382c0 3.90457972-4.68621496 7.02752512-10.15226738 7.02752512-5.46605242 0-10.15226738-3.12294539-10.15226739-7.02752512s4.68621496-7.02842356 10.15226739-7.02842445c5.46605242 0 10.15226738 3.12384382 10.15226738 7.02842445z m35.92016106-6.24768766c0.78163433 3.90457972-3.12384382 7.80916035-8.58899872 8.58989625-5.46695086 0.78163433-10.15226738-1.5614727-10.93390172-5.46605241-0.77983747-3.90457972 3.12384382-7.80916035 8.5907947-8.58899872 5.46605242-0.78163433 10.15136894 1.56057426 10.93210574 5.46515488z m0 0&quot; fill=&quot;#663399&quot; &gt;&lt;/path&gt;&lt;/symbol&gt;&lt;symbol id=&quot;icon-bilibili&quot; viewBox=&quot;0 0 1024 1024&quot;&gt;&lt;path d=&quot;M832.61667555 181.33447111h-164.32545185l74.45617778-74.45617778c12.84020148-12.84020148 12.84020148-30.8140563 0-43.65425778-12.84020148-12.84020148-30.8140563-12.84020148-43.65425778 0L573.2882963 189.04101925H450.04420741L324.2272237 63.23617185c-10.26730667-12.84020148-25.68040297-15.40096-41.08136295-7.70654815-2.57289482 0-2.57289482 2.57289482-5.13365334 5.13365333-12.84020148 12.84020148-12.84020148 30.8140563 0 43.65425779l77.02907259 77.02907259h-164.32545185c-89.86927408 0-164.32545185 74.45617778-164.32545185 164.32545184v408.24073483c0 87.29637925 74.45617778 161.75255703 164.32545185 161.75255703h25.68040296c0 30.8140563 25.68040297 53.92156445 53.92156444 53.92156444s53.92156445-25.68040297 53.92156445-53.92156444H704.23893333c2.57289482 30.8140563 28.24116148 53.92156445 59.05521778 51.34866964 28.24116148-2.57289482 48.78791111-23.10750815 51.34866964-51.34866964h20.53461333c89.86927408 0 164.32545185-74.45617778 164.32545184-164.32545186V343.09916445c-2.56075852-89.86927408-77.02907259-161.76469333-166.88621037-161.76469334z m-5.13365333 634.19429926H200.99527111c-33.37481482 0-59.05521778-28.24116148-61.61597629-61.61597629l-2.57289482-415.94728297c0-33.37481482 28.24116148-61.6159763 61.6159763-61.61597629h626.48775111c33.37481482 0 59.05521778 28.24116148 61.61597629 61.61597629l2.57289482 415.94728297c-2.57289482 35.93557333-28.24116148 61.6159763-61.6159763 61.61597629z&quot; fill=&quot;#ff7299&quot; &gt;&lt;/path&gt;&lt;path d=&quot;M403.82919111 417.55534222l15.40096 77.0290726-205.40681481 38.50846815-15.40096-77.0290726 205.40681481-38.50846815z m197.70026667 77.0290726l15.40096-77.0290726 205.40681481 38.50846815-15.40096 77.0290726-205.40681481-38.50846815z m41.08136297 161.75255703c0 2.57289482 0 7.70654815-2.57289483 10.26730667-12.84020148 28.24116148-41.08136297 46.2150163-74.45617777 48.78791111-20.53461333 0-41.08136297-10.26730667-53.92156445-25.68040296-15.40096 15.40096-33.37481482 25.68040297-53.92156445 25.68040296-30.8140563-2.57289482-59.05521778-20.53461333-74.45617777-48.78791111 0-2.57289482-2.57289482-5.13365333-2.57289481-10.26730667 0-10.26730667 7.70654815-17.97385482 17.97385481-20.53461333h2.57289482c7.70654815 0 12.84020148 2.57289482 15.40096 10.26730666 0 0 20.53461333 28.24116148 38.50846815 28.24116149 35.94770963 0 35.94770963-30.8140563 56.48232296-53.92156445 23.10750815 25.68040297 23.10750815 53.92156445 56.48232296 53.92156445 23.10750815 0 38.50846815-28.24116148 38.50846815-28.24116149 2.57289482-5.13365333 10.26730667-10.26730667 15.40096-10.26730666 10.26730667-2.57289482 17.97385482 5.13365333 20.53461333 15.40096v5.13365333h0.0364089z&quot; fill=&quot;#ff7299&quot; &gt;&lt;/path&gt;&lt;/symbol&gt;&lt;/svg&gt;&#x27;</span>,</span><br><span class="line">    o = (o = <span class="variable language_">document</span>.<span class="title function_">getElementsByTagName</span>(<span class="string">&quot;script&quot;</span>))[o.<span class="property">length</span> - <span class="number">1</span>].<span class="title function_">getAttribute</span>(<span class="string">&quot;data-injectcss&quot;</span>),</span><br><span class="line">    p = <span class="keyword">function</span> (<span class="params">c, l</span>) &#123;</span><br><span class="line">      l.<span class="property">parentNode</span>.<span class="title function_">insertBefore</span>(c, l);</span><br><span class="line">    &#125;;</span><br><span class="line">  <span class="keyword">if</span> (o &amp;&amp; !c.<span class="property">__iconfont__svg__cssinject__</span>) &#123;</span><br><span class="line">    c.<span class="property">__iconfont__svg__cssinject__</span> = !<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">      <span class="variable language_">document</span>.<span class="title function_">write</span>(</span><br><span class="line">        <span class="string">&quot;&lt;style&gt;.svgfont &#123;display: inline-block;width: 1em;height: 1em;fill: currentColor;vertical-align: -0.1em;font-size:16px;&#125;&lt;/style&gt;&quot;</span></span><br><span class="line">      );</span><br><span class="line">    &#125; <span class="keyword">catch</span> (c) &#123;</span><br><span class="line">      <span class="variable language_">console</span> &amp;&amp; <span class="variable language_">console</span>.<span class="title function_">log</span>(c);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">function</span> <span class="title function_">d</span>(<span class="params"></span>) &#123;</span><br><span class="line">    i || ((i = !<span class="number">0</span>), <span class="title function_">a</span>());</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">function</span> <span class="title function_">m</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">      t.<span class="property">documentElement</span>.<span class="title function_">doScroll</span>(<span class="string">&quot;left&quot;</span>);</span><br><span class="line">    &#125; <span class="keyword">catch</span> (c) &#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="keyword">void</span> <span class="built_in">setTimeout</span>(m, <span class="number">50</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="title function_">d</span>();</span><br><span class="line">  &#125;</span><br><span class="line">  (l = <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">var</span> c,</span><br><span class="line">      l = <span class="variable language_">document</span>.<span class="title function_">createElement</span>(<span class="string">&quot;div&quot;</span>);</span><br><span class="line">    (l.<span class="property">innerHTML</span> = v),</span><br><span class="line">      (v = <span class="literal">null</span>),</span><br><span class="line">      (l = l.<span class="title function_">getElementsByTagName</span>(<span class="string">&quot;svg&quot;</span>)[<span class="number">0</span>]) &amp;&amp;</span><br><span class="line">        (l.<span class="title function_">setAttribute</span>(<span class="string">&quot;aria-hidden&quot;</span>, <span class="string">&quot;true&quot;</span>),</span><br><span class="line">        (l.<span class="property">style</span>.<span class="property">position</span> = <span class="string">&quot;absolute&quot;</span>),</span><br><span class="line">        (l.<span class="property">style</span>.<span class="property">width</span> = <span class="number">0</span>),</span><br><span class="line">        (l.<span class="property">style</span>.<span class="property">height</span> = <span class="number">0</span>),</span><br><span class="line">        (l.<span class="property">style</span>.<span class="property">overflow</span> = <span class="string">&quot;hidden&quot;</span>),</span><br><span class="line">        (l = l),</span><br><span class="line">        (c = <span class="variable language_">document</span>.<span class="property">body</span>).<span class="property">firstChild</span> ? <span class="title function_">p</span>(l, c.<span class="property">firstChild</span>) : c.<span class="title function_">appendChild</span>(l));</span><br><span class="line">  &#125;),</span><br><span class="line">    <span class="variable language_">document</span>.<span class="property">addEventListener</span></span><br><span class="line">      ? ~[<span class="string">&quot;complete&quot;</span>, <span class="string">&quot;loaded&quot;</span>, <span class="string">&quot;interactive&quot;</span>].<span class="title function_">indexOf</span>(<span class="variable language_">document</span>.<span class="property">readyState</span>)</span><br><span class="line">        ? <span class="built_in">setTimeout</span>(l, <span class="number">0</span>)</span><br><span class="line">        : ((h = <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">            <span class="variable language_">document</span>.<span class="title function_">removeEventListener</span>(<span class="string">&quot;DOMContentLoaded&quot;</span>, h, !<span class="number">1</span>), <span class="title function_">l</span>();</span><br><span class="line">          &#125;),</span><br><span class="line">          <span class="variable language_">document</span>.<span class="title function_">addEventListener</span>(<span class="string">&quot;DOMContentLoaded&quot;</span>, h, !<span class="number">1</span>))</span><br><span class="line">      : <span class="variable language_">document</span>.<span class="property">attachEvent</span> &amp;&amp;</span><br><span class="line">        ((a = l),</span><br><span class="line">        (t = c.<span class="property">document</span>),</span><br><span class="line">        (i = !<span class="number">1</span>),</span><br><span class="line">        <span class="title function_">m</span>(),</span><br><span class="line">        (t.<span class="property">onreadystatechange</span> = <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">          <span class="string">&quot;complete&quot;</span> == t.<span class="property">readyState</span> &amp;&amp; ((t.<span class="property">onreadystatechange</span> = <span class="literal">null</span>), <span class="title function_">d</span>());</span><br><span class="line">        &#125;));</span><br><span class="line">&#125;)(<span class="variable language_">window</span>);</span><br></pre></td></tr></table></figure><p>执行以下命令:</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># https://www.npmjs.com/package/hexo-butterfly-tag-plugins-plus</span></span><br><span class="line">npm install hexo-butterfly-tag-plugins-plus --save</span><br><span class="line"></span><br><span class="line">npm uninstall hexo-renderer-marked --save</span><br><span class="line">npm install hexo-renderer-kramed --save</span><br></pre></td></tr></table></figure><p>添加配置项</p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># tag-plugins-plus</span></span><br><span class="line"><span class="comment"># see https://akilar.top/posts/615e2dec/</span></span><br><span class="line"><span class="attr">tag_plugins:</span></span><br><span class="line">  <span class="attr">enable:</span> <span class="literal">true</span> <span class="comment"># 开关</span></span><br><span class="line">  <span class="attr">priority:</span> <span class="number">5</span> <span class="comment">#过滤器优先权</span></span><br><span class="line">  <span class="attr">issues:</span> <span class="literal">false</span> <span class="comment">#issues标签开关</span></span><br><span class="line">  <span class="attr">link:</span></span><br><span class="line">    <span class="attr">placeholder:</span> <span class="string">/img/siteicon/64.png</span> <span class="comment">#link_card标签默认的图标图片</span></span><br><span class="line">  <span class="attr">CDN:</span></span><br><span class="line">    <span class="attr">anima:</span> <span class="string">https://cdn.cbd.int/hexo-butterfly-tag-plugins-plus@latest/lib/assets/font-awesome-animation.min.css</span> <span class="comment">#动画标签anima的依赖</span></span><br><span class="line">    <span class="attr">jquery:</span> <span class="string">https://cdn.cbd.int/jquery@latest/dist/jquery.min.js</span> <span class="comment">#issues标签依赖</span></span><br><span class="line">    <span class="attr">issues:</span> <span class="string">https://cdn.cbd.int/hexo-butterfly-tag-plugins-plus@latest/lib/assets/issues.js</span> <span class="comment">#issues标签依赖</span></span><br><span class="line">    <span class="attr">iconfont:</span> <span class="string">/js/ali_font.js</span> <span class="comment">#参看https://akilar.top/posts/d2ebecef/</span></span><br><span class="line">    <span class="attr">carousel:</span> <span class="string">https://cdn.cbd.int/hexo-butterfly-tag-plugins-plus@latest/lib/assets/carousel-touch.js</span></span><br><span class="line">    <span class="attr">tag_plugins_css:</span> <span class="string">https://cdn.cbd.int/hexo-butterfly-tag-plugins-plus@latest/lib/tag_plugins.css</span></span><br></pre></td></tr></table></figure>              </div>            </details><h2 id="添加-wowjs-特效"><a href="#添加-wowjs-特效" class="headerlink" title="添加 wowjs 特效"></a>添加 wowjs 特效</h2><p>参考：<a href="https://akilar.top/posts/abab51cf/">wowjs 特效</a></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install hexo-butterfly-wowjs --save</span><br></pre></td></tr></table></figure><p>添加配置项</p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># wowjs</span></span><br><span class="line"><span class="comment"># see https://www.npmjs.com/package/hexo-butterfly-wowjs</span></span><br><span class="line"><span class="attr">wowjs:</span></span><br><span class="line">  <span class="attr">enable:</span> <span class="literal">true</span> <span class="comment">#控制动画开关。true是打开，false是关闭</span></span><br><span class="line">  <span class="attr">priority:</span> <span class="number">10</span> <span class="comment">#过滤器优先级</span></span><br><span class="line">  <span class="attr">mobile:</span> <span class="literal">false</span> <span class="comment">#移动端是否启用，默认移动端禁用</span></span><br><span class="line">  <span class="attr">animateitem:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">class:</span> <span class="string">recent-post-item</span> <span class="comment">#必填项，需要添加动画的元素的class</span></span><br><span class="line">      <span class="attr">style:</span> <span class="string">animate__zoomIn</span> <span class="comment">#必填项，需要添加的动画</span></span><br><span class="line">      <span class="attr">duration:</span> <span class="number">1.</span><span class="string">5s</span> <span class="comment">#选填项，动画持续时间，单位可以是ms也可以是s。例如3s，700ms。</span></span><br><span class="line">      <span class="attr">delay:</span> <span class="string">200ms</span> <span class="comment">#选填项，动画开始的延迟时间，单位可以是ms也可以是s。例如3s，700ms。</span></span><br><span class="line">      <span class="attr">offset:</span> <span class="number">30</span> <span class="comment">#选填项，开始动画的距离（相对浏览器底部）</span></span><br><span class="line">      <span class="attr">iteration:</span> <span class="number">1</span> <span class="comment">#选填项，动画重复的次数</span></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">class:</span> <span class="string">card-widget</span></span><br><span class="line">      <span class="attr">style:</span> <span class="string">animate__zoomIn</span></span><br><span class="line">      <span class="attr">delay:</span> <span class="string">200ms</span></span><br><span class="line">    <span class="comment"># - class: flink-list-card</span></span><br><span class="line">    <span class="comment">#   style: wowpanels</span></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">class:</span> <span class="string">flink-list-card</span></span><br><span class="line">      <span class="attr">style:</span> <span class="string">animate__flipInY</span></span><br><span class="line">      <span class="attr">duration:</span> <span class="string">3s</span></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">class:</span> <span class="string">flink-list-card</span></span><br><span class="line">      <span class="attr">style:</span> <span class="string">animate__animated</span></span><br><span class="line">      <span class="attr">duration:</span> <span class="string">3s</span></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">class:</span> <span class="string">article-sort-item</span></span><br><span class="line">      <span class="attr">style:</span> <span class="string">animate__slideInRight</span></span><br><span class="line">      <span class="attr">duration:</span> <span class="number">1.</span><span class="string">5s</span></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">class:</span> <span class="string">site-card</span></span><br><span class="line">      <span class="attr">style:</span> <span class="string">animate__flipInY</span></span><br><span class="line">      <span class="attr">duration:</span> <span class="string">3s</span></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">class:</span> <span class="string">site-card</span></span><br><span class="line">      <span class="attr">style:</span> <span class="string">animate__animated</span></span><br><span class="line">      <span class="attr">duration:</span> <span class="string">3s</span></span><br><span class="line">  <span class="attr">animate_css:</span> <span class="string">https://cdn.cbd.int/hexo-butterfly-wowjs/lib/animate.min.css</span></span><br><span class="line">  <span class="attr">wow_js:</span> <span class="string">https://cdn.cbd.int/hexo-butterfly-wowjs/lib/wow.min.js</span></span><br><span class="line">  <span class="attr">wow_init_js:</span> <span class="string">https://cdn.cbd.int/hexo-butterfly-wowjs/lib/wow_init.js</span></span><br></pre></td></tr></table></figure><h2 id="留言板：薇尔莉特信封"><a href="#留言板：薇尔莉特信封" class="headerlink" title="留言板：薇尔莉特信封"></a>留言板：薇尔莉特信封</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install hexo-butterfly-envelope --save</span><br></pre></td></tr></table></figure><p>添加配置项</p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># envelope_comment</span></span><br><span class="line"><span class="comment"># see https://akilar.top/posts/e2d3c450/</span></span><br><span class="line"><span class="comment"># envelope_comment</span></span><br><span class="line"><span class="comment"># see https://akilar.top/posts/e2d3c450/</span></span><br><span class="line"><span class="attr">envelope_comment:</span></span><br><span class="line">  <span class="attr">enable:</span> <span class="literal">true</span> <span class="comment">#控制开关</span></span><br><span class="line">  <span class="attr">custom_pic:</span></span><br><span class="line">    <span class="attr">cover:</span> <span class="string">https://cdn.cbd.int//hexo-butterfly-envelope/lib/violet.jpg</span> <span class="comment">#信笺头部图片</span></span><br><span class="line">    <span class="attr">line:</span> <span class="string">https://cdn.cbd.int/hexo-butterfly-envelope/lib/line.png</span> <span class="comment">#信笺底部图片</span></span><br><span class="line">    <span class="attr">beforeimg:</span> <span class="string">https://cdn.cbd.int/hexo-butterfly-envelope/lib/before.png</span> <span class="comment"># 信封前半部分</span></span><br><span class="line">    <span class="attr">afterimg:</span> <span class="string">https://cdn.cbd.int/hexo-butterfly-envelope/lib/after.png</span> <span class="comment"># 信封后半部分</span></span><br><span class="line">  <span class="attr">message:</span> <span class="comment">#信笺正文，多行文本，写法如下</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">有什么想问的？</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">有什么想说的？</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">有什么想吐槽的？</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">哪怕是有什么想吃的，都可以告诉我哦~</span></span><br><span class="line">  <span class="attr">bottom:</span> <span class="string">自动书记人偶竭诚为您服务！</span> <span class="comment">#仅支持单行文本</span></span><br><span class="line">  <span class="attr">height:</span> <span class="comment">#1050px，信封划出的高度</span></span><br><span class="line">  <span class="attr">path:</span> <span class="comment">#【可选】comments 的路径名称。默认为 comments，生成的页面为 comments/index.html</span></span><br><span class="line">  <span class="attr">front_matter:</span> <span class="comment">#【可选】comments页面的 front_matter 配置</span></span><br><span class="line">    <span class="attr">title:</span> <span class="string">留言板</span></span><br><span class="line">    <span class="attr">comments:</span> <span class="literal">true</span></span><br></pre></td></tr></table></figure><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">留言板:</span> <span class="string">/comments/</span> <span class="string">||</span> <span class="string">fas</span> <span class="string">fa-envelope</span></span><br></pre></td></tr></table></figure><h2 id="页脚-github-徽标和计时器"><a href="#页脚-github-徽标和计时器" class="headerlink" title="页脚 github 徽标和计时器"></a>页脚 github 徽标和计时器</h2><p>参考: <a href="https://www.npmjs.com/package/hexo-butterfly-footer-beautify">https://www.npmjs.com/package/hexo-butterfly-footer-beautify</a></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install hexo-butterfly-footer-beautify --save</span><br></pre></td></tr></table></figure><p>添加配置项</p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># footer_beautify</span></span><br><span class="line"><span class="comment"># 页脚计时器：[Native JS Timer](https://akilar.top/posts/b941af/)</span></span><br><span class="line"><span class="comment"># 页脚徽标：[Add Github Badge](https://akilar.top/posts/e87ad7f8/)</span></span><br><span class="line"><span class="attr">footer_beautify:</span></span><br><span class="line">  <span class="attr">enable:</span></span><br><span class="line">    <span class="attr">timer:</span> <span class="literal">true</span> <span class="comment"># 计时器开关</span></span><br><span class="line">    <span class="attr">bdage:</span> <span class="literal">true</span> <span class="comment"># 徽标开关</span></span><br><span class="line">  <span class="attr">priority:</span> <span class="number">5</span> <span class="comment">#过滤器优先权</span></span><br><span class="line">  <span class="attr">enable_page:</span> <span class="string">all</span> <span class="comment"># 应用页面</span></span><br><span class="line">  <span class="attr">exclude:</span></span><br><span class="line">    <span class="comment"># - /posts/</span></span><br><span class="line">    <span class="comment"># - /about/</span></span><br><span class="line">  <span class="attr">layout:</span> <span class="comment"># 挂载容器类型</span></span><br><span class="line">    <span class="attr">type:</span> <span class="string">id</span></span><br><span class="line">    <span class="attr">name:</span> <span class="string">footer-wrap</span></span><br><span class="line">    <span class="attr">index:</span> <span class="number">0</span></span><br><span class="line">  <span class="comment"># 计时器部分配置项</span></span><br><span class="line">  <span class="attr">runtime_js:</span> <span class="string">https://npm.elemecdn.com/anzhiyu-blog@2.0.4/js/runtime/runtime.min.js</span></span><br><span class="line">  <span class="attr">runtime_css:</span> <span class="string">https://npm.elemecdn.com/anzhiyu-blog@2.0.4/css/runtime/runtime.min.css</span></span><br><span class="line">  <span class="comment"># 徽标部分配置项</span></span><br><span class="line">  <span class="attr">swiperpara:</span> <span class="number">0</span> <span class="comment">#若非0，则开启轮播功能，每行徽标个数</span></span><br><span class="line">  <span class="attr">bdageitem:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">link:</span> <span class="string">https://hexo.io/</span> <span class="comment">#徽标指向网站链接</span></span><br><span class="line">      <span class="attr">shields:</span> <span class="string">https://img.shields.io/badge/Frame-Hexo-blue?style=flat&amp;logo=hexo</span> <span class="comment">#徽标API</span></span><br><span class="line">      <span class="attr">message:</span> <span class="string">博客框架为Hexo_v5.4.0</span> <span class="comment">#徽标提示语</span></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">link:</span> <span class="string">https://butterfly.js.org/</span></span><br><span class="line">      <span class="attr">shields:</span> <span class="string">https://img.shields.io/badge/Theme-Butterfly-6513df?style=flat&amp;logo=bitdefender</span></span><br><span class="line">      <span class="attr">message:</span> <span class="string">主题版本Butterfly_v4.2.2</span></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">link:</span> <span class="string">https://www.jsdelivr.com/</span></span><br><span class="line">      <span class="attr">shields:</span> <span class="string">https://img.shields.io/badge/CDN-jsDelivr-orange?style=flat&amp;logo=jsDelivr</span></span><br><span class="line">      <span class="attr">message:</span> <span class="string">本站使用JsDelivr为静态资源提供CDN加速</span></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">link:</span> <span class="string">https://beian.miit.gov.cn/#/Integrated/index</span></span><br><span class="line">      <span class="attr">shields:</span> <span class="string">https://img.shields.io/badge/湘ICP备-2022004213号-e1d492?style=flat&amp;logo=data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAdCAYAAAC9pNwMAAABS2lUWHRYTUw6Y29tLmFkb2JlLnhtcAAAAAAAPD94cGFja2V0IGJlZ2luPSLvu78iIGlkPSJXNU0wTXBDZWhpSHpyZVN6TlRjemtjOWQiPz4KPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0az0iQWRvYmUgWE1QIENvcmUgNS42LWMxNDIgNzkuMTYwOTI0LCAyMDE3LzA3LzEzLTAxOjA2OjM5ICAgICAgICAiPgogPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4KICA8cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0iIi8+CiA8L3JkZjpSREY+CjwveDp4bXBtZXRhPgo8P3hwYWNrZXQgZW5kPSJyIj8+nhxg7wAACNlJREFUSInF1mmMVeUdx/Hv2e+5+519mJWBYQZkGxZZxLKJqBXGoLS1iXWrmihotFXaJiTWWlsbl6q1aetWd5u0VkKjNG4YEJSlOCibDLMwM8x679z9nnPP1jcVJUxf+7z6J8+LT37/Z4VvaQhfFS8+sBXbctCDGrVTKlBUH4mxAbI9Hfj0IJLsp6paJ5/tmn20N/D0wKDRMq9F/c3M2U1/V0vDfWMFh+tv/Ig1zYPMabDImPJ52OaXO87W580KggCiiOsJOJ6I3wcNFaaeNKxrt72f2fLGu4FpJ/sDQABRzD22fH7/Yze069vGc6mrDLNIJCDik10sxz2by3VdPM87xzkP9jwPTZFRVI1YUJKH+oy7n3tbvv/P2wW/UQxRWe6w4ZJRptYLHDoCuz8v5cP92XbI762O+h6UVWHnUFbPpU0fEb2A60mMJ7MUi9b/b7UgKhiZMaIxm8YLplLMDPz8hl/EH+rs8TNlUpFf32uyZJGLPDwCiTGUyTWodTN49eUCdz2YwXb9NNcObp1X98WDoufynzMVCEKGn27ayPTWBi5ad8P5iQUkJEnFLjqM9Z+hrVX0vfDe6K2dPRWsW2bwyp9EUifSJB84gdxrkR0eRgv1o/3I4fbbprJ6scqamzVO9pffec1S5ZWY2Nfz5qEy/FqOC2Y3s3j53HMSi18VRjFPwSwg+1RfVbl115vvJrsfej7UGIsYPPGgQ7JXoO+Xx5B3dHEomyJ9x1qiQozkr95h5937aFnVyouPlgJK+Ss7Fxz64OTSxSX+LHYxT2IsRW5kbGI4oHcR0jqoqTjV9se3I7/f8rS/ClS23GxSXhph6L5d9Akm7qqZhHWBQGUJ+CWGFzcg7e7m6D3/ZuW1Ea5YKdA3EojuONi813TqNi+YPYOKUhXDtCeGL26/hakLLiEcdsaHRkRAoLRc4fJrmhnekyF0apgZowWSwwkaa+rw3f8WA1GZZsPP5JEChX8dhZTN6iU6kAcs5s+dHd183SJ0VVKL57pfw6YdRQw23aeWTns47DPTALWlRTR7kMLew6hGgYqUhWXYFFUdPZ6lUBahLA8hVcOftckfi7No7VRAAQqsX1dybfvG1qwriM9mM5mJ4e4jO5Cc01dPqixbr8tWGBQUL4vjGigEEShi+xUmZ2RiR/sJ1pbS8NkgZrKAGw0TsgQsQyFaF/nfYTGprAlMFysbA1pI3mhkR6snhGsaymYGvPyFEb9IdbUE2AzFFTwpRqCtBY0wmdER+hZW4j63gcJj38V+/ErSUZXsYBfjIZHIRW0c2Z8BskCAqN+CbBJBFnyyKjR+Ez57nBxLqpfMUeSISElMBFz6x2Q6OxzWrYjyxWVzEewioU3LCS5vQY6nMUrLwNaxXvoQ59IloFSx54PPAZtQLExVZZDxsVE8J4dn6v4JYatgbSjk0owPw7RGH2ADMo88Z7L20ip8f7gC7fAo0q4+0rt7kEQDvaghVZbiPHUHcyeXcfLjT3jmpR7AYsnSScya3UR8bARVMck7Y/cB75/X6rDf3Fg2dw2jKZm5dXGm1LuAzO5DCo9v6aT0ibco5kzOvLOP+NGTFJtDpPYeZKijk/Rn3QxsfZV7txwhX7ABiZUXBsGvIvguQApNQQva9RMmTvZ2dpVUls+tX/UD7GN/Y8Ws05w6rQF+9vyzg1vZjbvMRJhXiRSU8DpTFFe0QE8S6SfPkOkZoktrB2oAhZWrwljxOPmchiSMYOWNoxNuruFU5vWeXdsojiUon345113dBBQBmTYlTimgdB8nfPo4WjaNFgN9OMEkJ02dnadVt5ki54Esqy+bzKJltVhSPbI3iN2zCyMTeXNCuG7Omm2Zok7PR2+R7jvD8ouruHhmCrB5jVZeYxLdrTP4sr4Vtd9g4MA4qc4c+6cu5NPamfw4P59t2WrA4YdXKkASf7SFivo6PDdEPmf1fRM++zp1bH/0r4I1dD1ODtOWaW4IsvPjL7nqXhloQiSPwjjgMYkMASyGEBkjhISCQwkwzve/18AbT+pk8pVY4UacQi9y+gyZ0eRAw4qHa89LXEx1LXMSPfhDJYRb59BtlLKg2WPT2l6qYl1svtGkrLYckyA1S+t5+2ATm37WCui0LSynsckDNH5zTxAchbQtkx08hDHYiW6NgC0enHBzEZ102UDH8QORdEckjEzZrNWkRydzyx17uGnDXqbUnGZ6dRPjSY91q2TqwjFuvTxLo5Zn5Qo/pumRSFcTLQtybEhGE0fQrDhhJ0VvH2lTnnHPhGtsmWan469apERjI2MH3qN7+7MEfH6ql29CbV7PvsMG32k6yU2XDhEKyZw66eJaRdrXR7CzCcqUNC3zwgymPJRCH4KRRLINimpL14A5Y4GDeOqbsPRVcfuN7Xj44pav/hFfrNT2kr2rsqf2Ibp5pEA14ZIImUyW3t5REkkTXRGQ/DGGhtLginhqCWknQDE5hKf5UFSF9Lj020Q2ul5V1AR2hr+8vuP8Vlc2zMPRxoSjnx7XBC14sDoydahSGq7KdO/HFyrBchxCVfX4fDKp4T7SCQejYODZLrYgIqgKFsNIgQqEYob8mW6yiUyb7Z64LVK/+B85xznnJ3AWzqTzuIX46mr5wLs+UUTyIriBCjRNxguHMJIFDLEEvXEOVRWnSJ0+jCd4CJoGjoedM1CLcXQziW3nMV2TSMBeOx7vWZvPt1r+cMPzE8KunaUkFn0vNrvtqXj34c1W6gzxlEQ6naIoBahtnkMwoFMwIVzSRNguMt53Aj2s4nkSlgPoGqLkICsRNF0gl8rYWuP8+11/w/OOJDEhHPKLCIpOXmi+M9AgP+maiesLifF2T1Rn5ZNj5Lo/Qc/GcPMmhdoqlEgIGzCK4PiCmJKK68p4KfF3qYGuF0qCRUkJTzleUbvQyWRTuE5xYthxQbBs7EISAbkzUFG3VfXXbK2YFi3X/eryfKKnqVBItNjJxDzH8erddC4SqWwcN5WyTtlyO1RP/Lh3eHD76MB40swmiDVJyDLYRhpc5+ub6tse/wWKbvSQEAw1awAAAABJRU5ErkJggg==</span></span><br><span class="line">      <span class="attr">message:</span> <span class="string">本站已在湘进行备案</span></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">link:</span> <span class="string">https://github.com/</span></span><br><span class="line">      <span class="attr">shields:</span> <span class="string">https://img.shields.io/badge/Source-Github-d021d6?style=flat&amp;logo=GitHub</span></span><br><span class="line">      <span class="attr">message:</span> <span class="string">本站项目由Github托管</span></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">link:</span> <span class="string">http://creativecommons.org/licenses/by-nc-sa/4.0/</span></span><br><span class="line">      <span class="attr">shields:</span> <span class="string">https://img.shields.io/badge/Copyright-BY--NC--SA%204.0-d42328?style=flat&amp;logo=Claris</span></span><br><span class="line">      <span class="attr">message:</span> <span class="string">本站采用知识共享署名-非商业性使用-相同方式共享4.0国际许可协议进行许可</span></span><br><span class="line"></span><br><span class="line">  <span class="comment"># swiper_css: https://cdn.cbd.int/hexo-butterfly-swiper/lib/swiper.min.css</span></span><br><span class="line">  <span class="comment"># swiper_js: https://cdn.cbd.int/hexo-butterfly-swiper/lib/swiper.min.js</span></span><br><span class="line">  <span class="comment"># swiperbdage_init_js: https://cdn.cbd.int/hexo-butterfly-footer-beautify/lib/swiperbdage_init.min.js</span></span><br></pre></td></tr></table></figure><p>添加在js文件夹下创建runtime文件夹下创建runtime.js</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> now = <span class="keyword">new</span> <span class="title class_">Date</span>();</span><br><span class="line"><span class="keyword">function</span> <span class="title function_">createtime</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">var</span> grt = <span class="keyword">new</span> <span class="title class_">Date</span>(<span class="string">&quot;04/01/2021 00:00:00&quot;</span>);</span><br><span class="line">  now.<span class="title function_">setTime</span>(now.<span class="title function_">getTime</span>() + <span class="number">250</span>);</span><br><span class="line">  <span class="keyword">var</span> days = (now - grt) / <span class="number">1e3</span> / <span class="number">60</span> / <span class="number">60</span> / <span class="number">24</span>,</span><br><span class="line">    dnum = <span class="title class_">Math</span>.<span class="title function_">floor</span>(days),</span><br><span class="line">    hours = (now - grt) / <span class="number">1e3</span> / <span class="number">60</span> / <span class="number">60</span> - <span class="number">24</span> * dnum,</span><br><span class="line">    hnum = <span class="title class_">Math</span>.<span class="title function_">floor</span>(hours);</span><br><span class="line">  <span class="number">1</span> == <span class="title class_">String</span>(hnum).<span class="property">length</span> &amp;&amp; (hnum = <span class="string">&quot;0&quot;</span> + hnum);</span><br><span class="line">  <span class="keyword">var</span> minutes = (now - grt) / <span class="number">1e3</span> / <span class="number">60</span> - <span class="number">1440</span> * dnum - <span class="number">60</span> * hnum,</span><br><span class="line">    mnum = <span class="title class_">Math</span>.<span class="title function_">floor</span>(minutes);</span><br><span class="line">  <span class="number">1</span> == <span class="title class_">String</span>(mnum).<span class="property">length</span> &amp;&amp; (mnum = <span class="string">&quot;0&quot;</span> + mnum);</span><br><span class="line">  <span class="keyword">var</span> seconds = (now - grt) / <span class="number">1e3</span> - <span class="number">86400</span> * dnum - <span class="number">3600</span> * hnum - <span class="number">60</span> * mnum,</span><br><span class="line">    snum = <span class="title class_">Math</span>.<span class="title function_">round</span>(seconds);</span><br><span class="line">  <span class="number">1</span> == <span class="title class_">String</span>(snum).<span class="property">length</span> &amp;&amp; (snum = <span class="string">&quot;0&quot;</span> + snum);</span><br><span class="line">  <span class="keyword">let</span> currentTimeHtml = <span class="string">&quot;&quot;</span>;</span><br><span class="line">  (currentTimeHtml =</span><br><span class="line">    hnum &lt; <span class="number">18</span> &amp;&amp; hnum &gt;= <span class="number">9</span></span><br><span class="line">      ? <span class="string">`&lt;img class=&#x27;boardsign&#x27; src=&#x27;https://npm.elemecdn.com/anzhiyu-blog@2.0.4/img/badge/安知鱼-上班摸鱼中.svg&#x27; title=&#x27;距离月入25k也就还差一个大佬带我~&#x27;&gt;&lt;span class=&#x27;textTip&#x27;&gt; &lt;br&gt; 本站居然运行了 <span class="subst">$&#123;dnum&#125;</span> 天&lt;/span&gt;&lt;span id=&#x27;runtime&#x27;&gt; <span class="subst">$&#123;hnum&#125;</span> 小时 <span class="subst">$&#123;mnum&#125;</span> 分 <span class="subst">$&#123;snum&#125;</span> 秒 &lt;/span&gt; &lt;i class=&#x27;fas fa-heartbeat&#x27; style=&#x27;color:red&#x27;&gt;&lt;/i&gt;`</span></span><br><span class="line">      : <span class="string">`&lt;img class=&#x27;boardsign&#x27; src=&#x27;https://npm.elemecdn.com/anzhiyu-blog@2.0.4/img/badge/安知鱼-下班啦.svg&#x27; title=&#x27;下班了就该开开心心的玩耍，嘿嘿~&#x27;&gt;&lt;span class=&#x27;textTip&#x27;&gt; &lt;br&gt; 本站居然运行了 <span class="subst">$&#123;dnum&#125;</span> 天&lt;/span&gt;&lt;span id=&#x27;runtime&#x27;&gt; <span class="subst">$&#123;hnum&#125;</span> 小时 <span class="subst">$&#123;mnum&#125;</span> 分 <span class="subst">$&#123;snum&#125;</span> 秒 &lt;/span&gt; &lt;i class=&#x27;fas fa-heartbeat&#x27; style=&#x27;color:red&#x27;&gt;&lt;/i&gt;`</span>),</span><br><span class="line">    <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&quot;workboard&quot;</span>) &amp;&amp; (<span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&quot;workboard&quot;</span>).<span class="property">innerHTML</span> = currentTimeHtml);</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">setInterval</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="title function_">createtime</span>();</span><br><span class="line">&#125;, <span class="number">250</span>);</span><br></pre></td></tr></table></figure><h2 id="hexo-butterfly-categories-card"><a href="#hexo-butterfly-categories-card" class="headerlink" title="hexo-butterfly-categories-card"></a>hexo-butterfly-categories-card</h2><details class="folding-tag" ><summary> 查看教程 </summary>              <div class='content'>              <div class="tabs"><div class="nav-tabs"><button type="button" class="tab active">安装依赖</button><button type="button" class="tab">配置项</button></div><div class="tab-contents"><div class="tab-item-content active"><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install hexo-butterfly-categories-card --save</span><br></pre></td></tr></table></figure></div><div class="tab-item-content"><p>在<code>_config.butterfly.yml</code>加入以下配置项</p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># hexo-butterfly-categories-card</span></span><br><span class="line"><span class="comment"># see https://akilar.top/posts/a9131002/</span></span><br><span class="line"><span class="attr">categoryBar:</span></span><br><span class="line">  <span class="attr">enable:</span> <span class="literal">true</span> <span class="comment"># 开关</span></span><br><span class="line">  <span class="attr">priority:</span> <span class="number">5</span> <span class="comment">#过滤器优先权</span></span><br><span class="line">  <span class="attr">enable_page:</span> <span class="string">/</span> <span class="comment"># 应用页面</span></span><br><span class="line">  <span class="attr">layout:</span> <span class="comment"># 挂载容器类型</span></span><br><span class="line">    <span class="attr">type:</span> <span class="string">id</span></span><br><span class="line">    <span class="attr">name:</span> <span class="string">recent-posts</span></span><br><span class="line">    <span class="attr">index:</span> <span class="number">0</span></span><br><span class="line">  <span class="attr">column:</span> <span class="string">odd</span> <span class="comment"># odd：3列 | even：4列</span></span><br><span class="line">  <span class="attr">row:</span> <span class="number">1</span> <span class="comment">#显示行数，默认两行，超过行数切换为滚动显示</span></span><br><span class="line">  <span class="attr">message:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">descr:</span> <span class="string">大学学习史</span></span><br><span class="line">      <span class="attr">cover:</span> <span class="string">https://cdn.cbd.int/akilar-candyassets@1.0.36/image/cover1.webp</span></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">descr:</span> <span class="string">前端成长历程</span></span><br><span class="line">      <span class="attr">cover:</span> <span class="string">https://cdn.cbd.int/akilar-candyassets@1.0.36/image/cover2.webp</span></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">descr:</span> <span class="string">生活欢乐多</span></span><br><span class="line">      <span class="attr">cover:</span> <span class="string">https://cdn.cbd.int/akilar-candyassets@1.0.36/image/cover3.webp</span></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">descr:</span></span><br><span class="line">      <span class="attr">cover:</span> <span class="string">https://cdn.cbd.int/akilar-candyassets@1.0.36/image/cover4.webp</span></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">descr:</span></span><br><span class="line">      <span class="attr">cover:</span> <span class="string">https://cdn.cbd.int/akilar-candyassets@1.0.36/image/cover5.webp</span></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">descr:</span></span><br><span class="line">      <span class="attr">cover:</span> <span class="string">https://cdn.cbd.int/akilar-candyassets@1.0.36/image/cover6.webp</span></span><br><span class="line">  <span class="attr">custom_css:</span> <span class="string">https://cdn.cbd.int/hexo-butterfly-categories-card@1.0.0/lib/categorybar.css</span></span><br></pre></td></tr></table></figure></div></div><div class="tab-to-top"><button type="button" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div>              </div>            </details><h2 id="魔改友人帐"><a href="#魔改友人帐" class="headerlink" title="魔改友人帐"></a>魔改友人帐</h2><p>参考: <a href="https://blog.anheyu.com/posts/292d.html">https://blog.anheyu.com/posts/292d.html</a></p><h2 id="引入阿里图标"><a href="#引入阿里图标" class="headerlink" title="引入阿里图标"></a>引入阿里图标</h2><details class="folding-tag" ><summary> 查看教程 </summary>              <div class='content'>              <p>注意 ⚠️ 先自行引入<code>ali_font.js</code></p><p>添加外挂标签，在<code>[Blogroot]\themes\butterfly\scripts\tag\</code>目录下新建<code>iconfont.js</code>，打开<code>[Blogroot]\themes\butterfly\scripts\tag\iconfont.js</code>,输入</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&quot;use strict&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">iconFont</span>(<span class="params">args</span>) &#123;</span><br><span class="line">  args = args.<span class="title function_">join</span>(<span class="string">&quot; &quot;</span>).<span class="title function_">split</span>(<span class="string">&quot;,&quot;</span>);</span><br><span class="line">  <span class="keyword">let</span> p0 = args[<span class="number">0</span>];</span><br><span class="line">  <span class="keyword">let</span> p1 = args[<span class="number">1</span>] ? args[<span class="number">1</span>] : <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">return</span> <span class="string">`&lt;svg class=&quot;icon&quot; style=&quot;width:<span class="subst">$&#123;p1&#125;</span>em; height:<span class="subst">$&#123;p1&#125;</span>em&quot; aria-hidden=&quot;true&quot;&gt;&lt;use xlink:href=&quot;#<span class="subst">$&#123;p0&#125;</span>&quot;&gt;&lt;/use&gt;&lt;/svg&gt;`</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">hexo.<span class="property">extend</span>.<span class="property">tag</span>.<span class="title function_">register</span>(<span class="string">&quot;icon&quot;</span>, iconFont);</span><br></pre></td></tr></table></figure><div class="tabs"><div class="nav-tabs"><button type="button" class="tab active">语法实例</button><button type="button" class="tab">参数释义</button><button type="button" class="tab">示例源码</button></div><div class="tab-contents"><div class="tab-item-content active"><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;% icon [icon-xxxx],[font-size] %&#125;</span><br></pre></td></tr></table></figure></div><div class="tab-item-content"><ol><li><code>icon-xxxx</code>：表示图标<code>font-class</code>,可以在自己的阿里矢量图标库项目的<code>font-class</code>引用方案内查询并复制。</li><li><code>font-size</code>：表示图标大小，直接填写数字即可，单位为<code>em</code>。图标大小默认值为<code>1em</code>。</li></ol></div><div class="tab-item-content"><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">&#123;% icon icon-rat_zi %&#125;&#123;% icon icon-rat,2 %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% icon icon-ox_chou,3 %&#125;&#123;% icon icon-ox,4 %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% icon icon-tiger_yin,5 %&#125;&#123;% icon icon-tiger,6 %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% icon icon-rabbit_mao,1 %&#125;&#123;% icon icon-rabbit,2 %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% icon icon-dragon_chen,3 %&#125;&#123;% icon icon-dragon,4 %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% icon icon-snake_si,5 %&#125;&#123;% icon icon-snake,6 %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% icon icon-horse_wu %&#125;&#123;% icon icon-horse,2 %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% icon icon-goat_wei,3 %&#125;&#123;% icon icon-goat,4 %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% icon icon-monkey_shen,5 %&#125;&#123;% icon icon-monkey,6 %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% icon icon-rooster_you %&#125;&#123;% icon icon-rooster,2 %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% icon icon-dog_xu,3 %&#125;&#123;% icon icon-dog,4 %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% icon icon-boar_hai,5 %&#125;&#123;% icon icon-boar,6 %&#125;</span><br></pre></td></tr></table></figure></div></div><div class="tab-to-top"><button type="button" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div>              </div>            </details><h2 id="站点动态-title"><a href="#站点动态-title" class="headerlink" title="站点动态 title"></a>站点动态 title</h2><p>添加自定义<code>title.js</code>，然后主题配置文件<code>inject</code>引入即可.</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//动态标题</span></span><br><span class="line"><span class="keyword">var</span> <span class="title class_">OriginTitile</span> = <span class="variable language_">document</span>.<span class="property">title</span>;</span><br><span class="line"><span class="keyword">var</span> titleTime;</span><br><span class="line"><span class="variable language_">document</span>.<span class="title function_">addEventListener</span>(<span class="string">&quot;visibilitychange&quot;</span>, <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">if</span> (<span class="variable language_">document</span>.<span class="property">hidden</span>) &#123;</span><br><span class="line">    <span class="comment">//离开当前页面时标签显示内容</span></span><br><span class="line">    <span class="variable language_">document</span>.<span class="property">title</span> = <span class="string">&quot;w(ﾟДﾟ)w 不要走！再看看嘛！&quot;</span>;</span><br><span class="line">    <span class="built_in">clearTimeout</span>(titleTime);</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="comment">//返回当前页面时标签显示内容</span></span><br><span class="line">    <span class="variable language_">document</span>.<span class="property">title</span> = <span class="string">&quot;♪(^∇^*)欢迎肥来！&quot;</span> + <span class="title class_">OriginTitile</span>;</span><br><span class="line">    <span class="comment">//两秒后变回正常标题</span></span><br><span class="line">    titleTime = <span class="built_in">setTimeout</span>(<span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">      <span class="variable language_">document</span>.<span class="property">title</span> = <span class="title class_">OriginTitile</span>;</span><br><span class="line">    &#125;, <span class="number">2000</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><h2 id="菜单栏多色图标配置教程"><a href="#菜单栏多色图标配置教程" class="headerlink" title="菜单栏多色图标配置教程"></a>菜单栏多色图标配置教程</h2><ol><li>配置项</li></ol><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Inject</span></span><br><span class="line"><span class="comment"># Insert the code to head (before &#x27;&lt;/head&gt;&#x27; tag) and the bottom (before &#x27;&lt;/body&gt;&#x27; tag)</span></span><br><span class="line"><span class="comment"># 插入代码到头部 &lt;/head&gt; 之前 和 底部 &lt;/body&gt; 之前</span></span><br><span class="line"><span class="attr">inject:</span></span><br><span class="line">  <span class="attr">head:</span></span><br><span class="line">    <span class="comment"># 公共css</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">&lt;link</span> <span class="string">rel=&quot;stylesheet&quot;</span> <span class="string">href=&quot;/css/custom.css&quot;&quot;&gt;</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">&lt;link</span> <span class="string">rel=&quot;stylesheet&quot;</span> <span class="string">href=&quot;https://cdn.cbd.int/qweather-icons@1.1.1/font/qweather-icons.css&quot;&gt;</span></span><br><span class="line">    <span class="comment"># - &lt;link rel=&quot;stylesheet&quot; href=&quot;/css/custom.css&quot; media=&quot;defer&quot; onload=&quot;this.media=&#x27;all&#x27;&quot;&gt;</span></span><br><span class="line">  <span class="attr">bottom:</span></span><br><span class="line">    <span class="comment"># 控制台打印消息</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">&lt;script</span> <span class="string">async</span> <span class="string">rel=&quot;prefetch&quot;</span> <span class="string">src=&quot;/js/console.js&quot;&gt;&lt;/script&gt;</span></span><br><span class="line">    <span class="comment"># 标题卖萌</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">&lt;script</span> <span class="string">async</span> <span class="string">src=&quot;/js/diytitle.js&quot;&gt;&lt;/script&gt;</span></span><br><span class="line">    <span class="comment"># 站点公祭日自动变灰判定</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">&lt;script</span> <span class="string">async</span> <span class="string">src=&quot;/js/grayscale.js&quot;&gt;&lt;/script&gt;</span></span><br><span class="line">    <span class="comment"># 浮动动画特效</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">&lt;script</span> <span class="string">async</span> <span class="string">data-pjax</span> <span class="string">src=&quot;/js/floatpanel.js&quot;&gt;&lt;/script&gt;</span></span><br><span class="line">    <span class="comment"># aplayer音乐</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">&lt;div</span> <span class="string">class=&quot;aplayer</span> <span class="literal">no</span><span class="string">-destroy&quot;</span> <span class="string">data-id=&quot;8152976493&quot;</span> <span class="string">data-server=&quot;netease&quot;</span> <span class="string">data-type=&quot;playlist&quot;</span>   <span class="string">data-order=&quot;list&quot;</span> <span class="string">data-fixed=&quot;true&quot;</span> <span class="string">data-preload=&quot;auto&quot;</span> <span class="string">data-autoplay=&quot;false&quot;</span> <span class="string">data-mutex=&quot;true&quot;</span> <span class="string">&gt;&lt;/div&gt;</span></span><br></pre></td></tr></table></figure><ol><li>替换全部内容修改<code>[Blogroot]\themes\butterfly\layout\includes\header\menu_item.pug</code>,本方案默认使用观感最佳的悬停父元素触发子元素动画效果。默认动画为<code>faa-tada</code>。</li></ol><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line">if theme.menu</span><br><span class="line">  //- for mobile sidebar</span><br><span class="line">  - let sidebarChildHide = theme.hide_sidebar_menu_child ? &#x27;hide&#x27; : &#x27;&#x27;</span><br><span class="line"></span><br><span class="line">  .menus_items</span><br><span class="line">    each value, label in theme.menu</span><br><span class="line">      if typeof value !== &#x27;object&#x27;</span><br><span class="line">        .menus_item</span><br><span class="line">          a.site-page.faa-parent.animated-hover(href=url_for(trim(value.split(&#x27;||&#x27;)[0])))</span><br><span class="line">            if value.split(&#x27;||&#x27;)[1]</span><br><span class="line">              - var icon_value = trim(value.split(&#x27;||&#x27;)[1])</span><br><span class="line">              - var anima_value = value.split(&#x27;||&#x27;)[2] ? trim(value.split(&#x27;||&#x27;)[2]) : &#x27;faa-tada&#x27;</span><br><span class="line">              if icon_value.substring(0,2)==&quot;fa&quot;</span><br><span class="line">                i.fa-fw(class=icon_value + &#x27; &#x27; + anima_value)</span><br><span class="line">              else if icon_value.substring(0,4)==&quot;icon&quot;</span><br><span class="line">                svg.icon(aria-hidden=&quot;true&quot; class=anima_value)</span><br><span class="line">                  use(xlink:href=`#`+ icon_value)</span><br><span class="line">            span=&#x27; &#x27;+label</span><br><span class="line">      else</span><br><span class="line">        .menus_item</span><br><span class="line">          a.site-page.faa-parent.animated-hover(href=&#x27;javascript:void(0);&#x27;)</span><br><span class="line">            if label.split(&#x27;||&#x27;)[1]</span><br><span class="line">              - var icon_label = trim(label.split(&#x27;||&#x27;)[1])</span><br><span class="line">              - var anima_label = label.split(&#x27;||&#x27;)[2] ? trim(label.split(&#x27;||&#x27;)[2]) : &#x27;faa-tada&#x27;</span><br><span class="line">              if icon_label.substring(0,2)==&quot;fa&quot;</span><br><span class="line">                i.fa-fw(class=icon_label + &#x27; &#x27; + anima_label)</span><br><span class="line">              else if icon_label.substring(0,4)==&quot;icon&quot;</span><br><span class="line">                svg.icon(aria-hidden=&quot;true&quot; class=anima_label)</span><br><span class="line">                  use(xlink:href=`#`+ icon_label)</span><br><span class="line">            span=&#x27; &#x27;+ trim(label.split(&#x27;||&#x27;)[0])</span><br><span class="line">            i.fas.fa-chevron-down.expand(class=sidebarChildHide)</span><br><span class="line">          ul.menus_item_child</span><br><span class="line">            each val,lab in value</span><br><span class="line">              li</span><br><span class="line">                a.site-page.child.faa-parent.animated-hover(href=url_for(trim(val.split(&#x27;||&#x27;)[0])))</span><br><span class="line">                  if val.split(&#x27;||&#x27;)[1]</span><br><span class="line">                    - var icon_val = trim(val.split(&#x27;||&#x27;)[1])</span><br><span class="line">                    - var anima_val = val.split(&#x27;||&#x27;)[2] ? trim(val.split(&#x27;||&#x27;)[2]) : &#x27;faa-tada&#x27;</span><br><span class="line">                    if icon_val.substring(0,2)==&quot;fa&quot;</span><br><span class="line">                      i.fa-fw(class=icon_val + &#x27; &#x27; + anima_val)</span><br><span class="line">                    else if icon_val.substring(0,4)==&quot;icon&quot;</span><br><span class="line">                      svg.icon(aria-hidden=&quot;true&quot; class=anima_val)</span><br><span class="line">                        use(xlink:href=`#`+ icon_val)</span><br><span class="line">                  span=&#x27; &#x27;+ lab</span><br></pre></td></tr></table></figure><ol><li>修改配置项</li></ol><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">menu:</span></span><br><span class="line">  <span class="string">首页:</span> <span class="string">/</span> <span class="string">||</span> <span class="string">fas</span> <span class="string">fa-home</span> <span class="string">||</span> <span class="string">faa-tada</span></span><br><span class="line">  <span class="string">时间轴:</span> <span class="string">/archives/</span> <span class="string">||</span> <span class="string">fas</span> <span class="string">fa-archive</span></span><br><span class="line">  <span class="string">闲言碎语:</span> <span class="string">/artitalk/</span> <span class="string">||</span> <span class="string">fas</span> <span class="string">fa-comment-dots</span></span><br><span class="line">  <span class="string">音乐馆:</span> <span class="string">/music/</span> <span class="string">||</span> <span class="string">fas</span> <span class="string">fa-music</span></span><br><span class="line">  <span class="string">分类:</span> <span class="string">/categories/</span> <span class="string">||</span> <span class="string">fas</span> <span class="string">fa-folder-open</span></span><br><span class="line">  <span class="comment"># List||fas fa-list:</span></span><br><span class="line">  <span class="comment">#   Music: /music/ || fas fa-music</span></span><br><span class="line">  <span class="comment">#   Movie: /movies/ || fas fa-video</span></span><br><span class="line"></span><br><span class="line">  <span class="string">朋友圈:</span> <span class="string">/fcircle/</span> <span class="string">||</span> <span class="string">fab</span> <span class="string">fa-artstation</span></span><br><span class="line">  <span class="string">留言板:</span> <span class="string">/comments/</span> <span class="string">||</span> <span class="string">fas</span> <span class="string">fa-envelope</span></span><br><span class="line">  <span class="string">友人帐:</span> <span class="string">/link/</span> <span class="string">||</span> <span class="string">fas</span> <span class="string">fa-link</span></span><br><span class="line">  <span class="comment"># 闲言碎语: /hpptalk/ || fas fa-comment-dots</span></span><br><span class="line">  <span class="string">追番:</span> <span class="string">/bangumis/</span> <span class="string">||</span> <span class="string">icon-bilibili1</span></span><br><span class="line">  <span class="string">关于:</span> <span class="string">/about/</span> <span class="string">||</span> <span class="string">icon-zhifeiji</span></span><br></pre></td></tr></table></figure><h2 id="Social-卡片彩色图标引入"><a href="#Social-卡片彩色图标引入" class="headerlink" title="Social 卡片彩色图标引入"></a>Social 卡片彩色图标引入</h2><ol><li>重写<code>[Blogroot]\themes\butterfly\layout\includes\header\social.pug</code>,替换为以下代码：</li></ol><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">each value, title in theme.social</span><br><span class="line">  a.social-icon.faa-parent.animated-hover(href=url_for(trim(value.split(&#x27;||&#x27;)[0])) target=&quot;_blank&quot; title=title === undefined ? &#x27;&#x27; : trim(title))</span><br><span class="line">    if value.split(&#x27;||&#x27;)[1]</span><br><span class="line">      - var icon_value = trim(value.split(&#x27;||&#x27;)[1])</span><br><span class="line">      - var anima_value = value.split(&#x27;||&#x27;)[2] ? trim(value.split(&#x27;||&#x27;)[2]) : &#x27;faa-tada&#x27;</span><br><span class="line">      if icon_value.substring(0,2)==&quot;fa&quot;</span><br><span class="line">        i.fa-fw(class=icon_value + &#x27; &#x27; + anima_value)</span><br><span class="line">      else if icon_value.substring(0,4)==&quot;icon&quot;</span><br><span class="line">        svg.icon(aria-hidden=&quot;true&quot; class=anima_value)</span><br><span class="line">          use(xlink:href=`#`+ icon_value)</span><br></pre></td></tr></table></figure><ol><li>以下为对应的<code>social</code>配置项。写法沿用<code>menu_item</code>的写法示例。修改<code>[Blogroot]\_config.butterfly.yml</code>的<code>social</code>配置项。</li></ol><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># social settings (社交图标设置)</span></span><br><span class="line"><span class="comment"># formal:</span></span><br><span class="line"><span class="comment">#   icon: link || the description</span></span><br><span class="line"><span class="attr">social:</span></span><br><span class="line">  <span class="attr">Github:</span> <span class="string">https://github.com/anzhiyu-c</span> <span class="string">||</span> <span class="string">icon-gitHub</span> <span class="string">||</span> <span class="string">faa-tada</span></span><br><span class="line">  <span class="attr">Email:</span> <span class="string">https://mail.qq.com/cgi-bin/qm_share?t=qm_mailme&amp;email=2268025923@qq.com</span> <span class="string">||</span> <span class="string">icon-youxiang</span> <span class="string">||</span> <span class="string">faa-tada</span></span><br><span class="line">  <span class="attr">RSS:</span> <span class="string">atom.xml</span> <span class="string">||</span> <span class="string">icon-rss</span> <span class="string">||</span> <span class="string">faa-tada</span></span><br><span class="line">  <span class="attr">BiliBili:</span> <span class="string">https://space.bilibili.com/372204786</span> <span class="string">||</span> <span class="string">icon-bilibili</span> <span class="string">||</span> <span class="string">faa-tada</span></span><br><span class="line">  <span class="attr">QQ:</span> <span class="string">tencent://Message/?Uin=2268025923&amp;amp;websiteName=local.edu.com:8888=&amp;amp;Menu=yes</span> <span class="string">||</span> <span class="string">icon-QQ1</span> <span class="string">||</span> <span class="string">faa-tada</span></span><br></pre></td></tr></table></figure><h2 id="鼠标样式更改"><a href="#鼠标样式更改" class="headerlink" title="鼠标样式更改"></a>鼠标样式更改</h2><p>在custom.css添加</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* 鼠标样式 */</span></span><br><span class="line"><span class="selector-id">#cursor</span> &#123;</span><br><span class="line">  <span class="attribute">position</span>: fixed;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">16px</span>;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">16px</span>;</span><br><span class="line">  <span class="comment">/* 这里改变跟随的底色 */</span></span><br><span class="line">  <span class="attribute">background</span>: <span class="built_in">rgb</span>(<span class="number">234</span>, <span class="number">255</span>, <span class="number">5</span>);</span><br><span class="line">  <span class="attribute">border-radius</span>: <span class="number">8px</span>;</span><br><span class="line">  <span class="attribute">opacity</span>: <span class="number">0.25</span>;</span><br><span class="line">  <span class="attribute">z-index</span>: <span class="number">10086</span>;</span><br><span class="line">  <span class="attribute">pointer-events</span>: none;</span><br><span class="line">  <span class="attribute">transition</span>: <span class="number">0.2s</span> ease-in-out;</span><br><span class="line">  <span class="attribute">transition-property</span>: background, opacity, transform;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-id">#cursor</span><span class="selector-class">.hidden</span> &#123;</span><br><span class="line">  <span class="attribute">opacity</span>: <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-id">#cursor</span><span class="selector-class">.hover</span> &#123;</span><br><span class="line">  <span class="attribute">opacity</span>: <span class="number">0.1</span>;</span><br><span class="line">  <span class="attribute">transform</span>: <span class="built_in">scale</span>(<span class="number">2.5</span>);</span><br><span class="line">  -webkit-<span class="attribute">transform</span>: <span class="built_in">scale</span>(<span class="number">2.5</span>);</span><br><span class="line">  -moz-<span class="attribute">transform</span>: <span class="built_in">scale</span>(<span class="number">2.5</span>);</span><br><span class="line">  -ms-<span class="attribute">transform</span>: <span class="built_in">scale</span>(<span class="number">2.5</span>);</span><br><span class="line">  -o-<span class="attribute">transform</span>: <span class="built_in">scale</span>(<span class="number">2.5</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-id">#cursor</span><span class="selector-class">.active</span> &#123;</span><br><span class="line">  <span class="attribute">opacity</span>: <span class="number">0.5</span>;</span><br><span class="line">  <span class="attribute">transform</span>: <span class="built_in">scale</span>(<span class="number">0.5</span>);</span><br><span class="line">  -webkit-<span class="attribute">transform</span>: <span class="built_in">scale</span>(<span class="number">0.5</span>);</span><br><span class="line">  -moz-<span class="attribute">transform</span>: <span class="built_in">scale</span>(<span class="number">0.5</span>);</span><br><span class="line">  -ms-<span class="attribute">transform</span>: <span class="built_in">scale</span>(<span class="number">0.5</span>);</span><br><span class="line">  -o-<span class="attribute">transform</span>: <span class="built_in">scale</span>(<span class="number">0.5</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>创建cursor.js</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> <span class="variable constant_">CURSOR</span>;</span><br><span class="line"></span><br><span class="line"><span class="title class_">Math</span>.<span class="property">lerp</span> = <span class="function">(<span class="params">a, b, n</span>) =&gt;</span> (<span class="number">1</span> - n) * a + n * b;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">getStyle</span> = (<span class="params">el, attr</span>) =&gt; &#123;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">window</span>.<span class="property">getComputedStyle</span></span><br><span class="line">            ? <span class="variable language_">window</span>.<span class="title function_">getComputedStyle</span>(el)[attr]</span><br><span class="line">            : el.<span class="property">currentStyle</span>[attr];</span><br><span class="line">    &#125; <span class="keyword">catch</span> (e) &#123;&#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;&quot;</span>;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Cursor</span> &#123;</span><br><span class="line">    <span class="title function_">constructor</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">pos</span> = &#123;<span class="attr">curr</span>: <span class="literal">null</span>, <span class="attr">prev</span>: <span class="literal">null</span>&#125;;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">pt</span> = [];</span><br><span class="line">        <span class="variable language_">this</span>.<span class="title function_">create</span>();</span><br><span class="line">        <span class="variable language_">this</span>.<span class="title function_">init</span>();</span><br><span class="line">        <span class="variable language_">this</span>.<span class="title function_">render</span>();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="title function_">move</span>(<span class="params">left, top</span>) &#123;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">cursor</span>.<span class="property">style</span>[<span class="string">&quot;left&quot;</span>] = <span class="string">`<span class="subst">$&#123;left&#125;</span>px`</span>;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">cursor</span>.<span class="property">style</span>[<span class="string">&quot;top&quot;</span>] = <span class="string">`<span class="subst">$&#123;top&#125;</span>px`</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="title function_">create</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (!<span class="variable language_">this</span>.<span class="property">cursor</span>) &#123;</span><br><span class="line">            <span class="variable language_">this</span>.<span class="property">cursor</span> = <span class="variable language_">document</span>.<span class="title function_">createElement</span>(<span class="string">&quot;div&quot;</span>);</span><br><span class="line">            <span class="variable language_">this</span>.<span class="property">cursor</span>.<span class="property">id</span> = <span class="string">&quot;cursor&quot;</span>;</span><br><span class="line">            <span class="variable language_">this</span>.<span class="property">cursor</span>.<span class="property">classList</span>.<span class="title function_">add</span>(<span class="string">&quot;hidden&quot;</span>);</span><br><span class="line">            <span class="variable language_">document</span>.<span class="property">body</span>.<span class="title function_">append</span>(<span class="variable language_">this</span>.<span class="property">cursor</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">var</span> el = <span class="variable language_">document</span>.<span class="title function_">getElementsByTagName</span>(<span class="string">&#x27;*&#x27;</span>);</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; el.<span class="property">length</span>; i++)</span><br><span class="line">            <span class="keyword">if</span> (<span class="title function_">getStyle</span>(el[i], <span class="string">&quot;cursor&quot;</span>) == <span class="string">&quot;pointer&quot;</span>)</span><br><span class="line">                <span class="variable language_">this</span>.<span class="property">pt</span>.<span class="title function_">push</span>(el[i].<span class="property">outerHTML</span>);</span><br><span class="line"></span><br><span class="line">        <span class="variable language_">document</span>.<span class="property">body</span>.<span class="title function_">appendChild</span>((<span class="variable language_">this</span>.<span class="property">scr</span> = <span class="variable language_">document</span>.<span class="title function_">createElement</span>(<span class="string">&quot;style&quot;</span>)));</span><br><span class="line">        <span class="comment">// 这里改变鼠标指针的颜色 由svg生成</span></span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">scr</span>.<span class="property">innerHTML</span> = <span class="string">`* &#123;cursor: url(&quot;data:image/svg+xml,&lt;svg xmlns=&#x27;http://www.w3.org/2000/svg&#x27; viewBox=&#x27;0 0 8 8&#x27; width=&#x27;8px&#x27; height=&#x27;8px&#x27;&gt;&lt;circle cx=&#x27;4&#x27; cy=&#x27;4&#x27; r=&#x27;4&#x27; opacity=&#x27;.5&#x27;/&gt;&lt;/svg&gt;&quot;) 4 4, auto&#125;`</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="title function_">refresh</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">scr</span>.<span class="title function_">remove</span>();</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">cursor</span>.<span class="property">classList</span>.<span class="title function_">remove</span>(<span class="string">&quot;hover&quot;</span>);</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">cursor</span>.<span class="property">classList</span>.<span class="title function_">remove</span>(<span class="string">&quot;active&quot;</span>);</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">pos</span> = &#123;<span class="attr">curr</span>: <span class="literal">null</span>, <span class="attr">prev</span>: <span class="literal">null</span>&#125;;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">pt</span> = [];</span><br><span class="line"></span><br><span class="line">        <span class="variable language_">this</span>.<span class="title function_">create</span>();</span><br><span class="line">        <span class="variable language_">this</span>.<span class="title function_">init</span>();</span><br><span class="line">        <span class="variable language_">this</span>.<span class="title function_">render</span>();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="title function_">init</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="variable language_">document</span>.<span class="property">onmouseover</span>  = <span class="function"><span class="params">e</span> =&gt;</span> <span class="variable language_">this</span>.<span class="property">pt</span>.<span class="title function_">includes</span>(e.<span class="property">target</span>.<span class="property">outerHTML</span>) &amp;&amp; <span class="variable language_">this</span>.<span class="property">cursor</span>.<span class="property">classList</span>.<span class="title function_">add</span>(<span class="string">&quot;hover&quot;</span>);</span><br><span class="line">        <span class="variable language_">document</span>.<span class="property">onmouseout</span>   = <span class="function"><span class="params">e</span> =&gt;</span> <span class="variable language_">this</span>.<span class="property">pt</span>.<span class="title function_">includes</span>(e.<span class="property">target</span>.<span class="property">outerHTML</span>) &amp;&amp; <span class="variable language_">this</span>.<span class="property">cursor</span>.<span class="property">classList</span>.<span class="title function_">remove</span>(<span class="string">&quot;hover&quot;</span>);</span><br><span class="line">        <span class="variable language_">document</span>.<span class="property">onmousemove</span>  = <span class="function"><span class="params">e</span> =&gt;</span> &#123;(<span class="variable language_">this</span>.<span class="property">pos</span>.<span class="property">curr</span> == <span class="literal">null</span>) &amp;&amp; <span class="variable language_">this</span>.<span class="title function_">move</span>(e.<span class="property">clientX</span> - <span class="number">8</span>, e.<span class="property">clientY</span> - <span class="number">8</span>); <span class="variable language_">this</span>.<span class="property">pos</span>.<span class="property">curr</span> = &#123;<span class="attr">x</span>: e.<span class="property">clientX</span> - <span class="number">8</span>, <span class="attr">y</span>: e.<span class="property">clientY</span> - <span class="number">8</span>&#125;; <span class="variable language_">this</span>.<span class="property">cursor</span>.<span class="property">classList</span>.<span class="title function_">remove</span>(<span class="string">&quot;hidden&quot;</span>);&#125;;</span><br><span class="line">        <span class="variable language_">document</span>.<span class="property">onmouseenter</span> = <span class="function"><span class="params">e</span> =&gt;</span> <span class="variable language_">this</span>.<span class="property">cursor</span>.<span class="property">classList</span>.<span class="title function_">remove</span>(<span class="string">&quot;hidden&quot;</span>);</span><br><span class="line">        <span class="variable language_">document</span>.<span class="property">onmouseleave</span> = <span class="function"><span class="params">e</span> =&gt;</span> <span class="variable language_">this</span>.<span class="property">cursor</span>.<span class="property">classList</span>.<span class="title function_">add</span>(<span class="string">&quot;hidden&quot;</span>);</span><br><span class="line">        <span class="variable language_">document</span>.<span class="property">onmousedown</span>  = <span class="function"><span class="params">e</span> =&gt;</span> <span class="variable language_">this</span>.<span class="property">cursor</span>.<span class="property">classList</span>.<span class="title function_">add</span>(<span class="string">&quot;active&quot;</span>);</span><br><span class="line">        <span class="variable language_">document</span>.<span class="property">onmouseup</span>    = <span class="function"><span class="params">e</span> =&gt;</span> <span class="variable language_">this</span>.<span class="property">cursor</span>.<span class="property">classList</span>.<span class="title function_">remove</span>(<span class="string">&quot;active&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="title function_">render</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="property">pos</span>.<span class="property">prev</span>) &#123;</span><br><span class="line">            <span class="variable language_">this</span>.<span class="property">pos</span>.<span class="property">prev</span>.<span class="property">x</span> = <span class="title class_">Math</span>.<span class="title function_">lerp</span>(<span class="variable language_">this</span>.<span class="property">pos</span>.<span class="property">prev</span>.<span class="property">x</span>, <span class="variable language_">this</span>.<span class="property">pos</span>.<span class="property">curr</span>.<span class="property">x</span>, <span class="number">0.15</span>);</span><br><span class="line">            <span class="variable language_">this</span>.<span class="property">pos</span>.<span class="property">prev</span>.<span class="property">y</span> = <span class="title class_">Math</span>.<span class="title function_">lerp</span>(<span class="variable language_">this</span>.<span class="property">pos</span>.<span class="property">prev</span>.<span class="property">y</span>, <span class="variable language_">this</span>.<span class="property">pos</span>.<span class="property">curr</span>.<span class="property">y</span>, <span class="number">0.15</span>);</span><br><span class="line">            <span class="variable language_">this</span>.<span class="title function_">move</span>(<span class="variable language_">this</span>.<span class="property">pos</span>.<span class="property">prev</span>.<span class="property">x</span>, <span class="variable language_">this</span>.<span class="property">pos</span>.<span class="property">prev</span>.<span class="property">y</span>);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="variable language_">this</span>.<span class="property">pos</span>.<span class="property">prev</span> = <span class="variable language_">this</span>.<span class="property">pos</span>.<span class="property">curr</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="title function_">requestAnimationFrame</span>(<span class="function">() =&gt;</span> <span class="variable language_">this</span>.<span class="title function_">render</span>());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="variable constant_">CURSOR</span> = <span class="keyword">new</span> <span class="title class_">Cursor</span>();</span><br><span class="line">    <span class="comment">// 需要重新获取列表时，使用 CURSOR.refresh()</span></span><br><span class="line">&#125;)();</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>在_config.butterfly.yml的inject引入js</p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">inject:</span></span><br><span class="line">  <span class="attr">head:</span></span><br><span class="line">    <span class="comment"># 魔改css</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">&lt;link</span> <span class="string">rel=&quot;stylesheet&quot;</span> <span class="string">href=&quot;/css/custom.css&quot;</span> <span class="string">media=&quot;defer&quot;</span> <span class="string">onload=&quot;this.media=&#x27;all&#x27;&quot;&gt;</span></span><br><span class="line">  <span class="attr">bottom:</span></span><br><span class="line">    <span class="comment"># aplayer音乐</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">&lt;div</span> <span class="string">class=&quot;aplayer</span> <span class="literal">no</span><span class="string">-destroy&quot;</span> <span class="string">data-id=&quot;2954824359&quot;</span> <span class="string">data-server=&quot;netease&quot;</span> <span class="string">data-type=&quot;playlist&quot;</span>   <span class="string">data-order=&quot;list&quot;</span> <span class="string">data-fixed=&quot;true&quot;</span> <span class="string">data-preload=&quot;auto&quot;</span> <span class="string">data-autoplay=&quot;false&quot;</span> <span class="string">data-mutex=&quot;true&quot;</span> <span class="string">&gt;&lt;/div&gt;</span></span><br><span class="line">    <span class="comment">#鼠标样式</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">&lt;script</span> <span class="string">defer</span> <span class="string">src=&quot;/js/cursor.js&quot;&gt;&lt;/script&gt;</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">&lt;script</span> <span class="string">defer</span> <span class="string">src=&quot;/js/title.js&quot;&gt;&lt;/script&gt;</span></span><br></pre></td></tr></table></figure>]]></content>
    
    
    <summary type="html">使用butterfly主题美化博客</summary>
    
    
    
    <category term="博客" scheme="https://stack2005.github.io/categories/%E5%8D%9A%E5%AE%A2/"/>
    
    
    <category term="Hexo" scheme="https://stack2005.github.io/tags/Hexo/"/>
    
  </entry>
  
  <entry>
    <title>Linux基本语法</title>
    <link href="https://stack2005.github.io/posts/0.html"/>
    <id>https://stack2005.github.io/posts/0.html</id>
    <published>2025-02-20T16:00:00.000Z</published>
    <updated>2025-02-28T14:06:10.849Z</updated>
    
    <content type="html"><![CDATA[<h2 id="配置"><a href="#配置" class="headerlink" title="配置"></a>配置</h2><ul><li>基于windows的WSL功能简洁创建Linux子系统</li><li>基于虚拟机安装Linux系统</li></ul><h2 id="虚拟机快照"><a href="#虚拟机快照" class="headerlink" title="虚拟机快照"></a>虚拟机快照</h2><p>基于快照来恢复以前状态,关机状态时进行快照</p><h2 id="目录结构"><a href="#目录结构" class="headerlink" title="目录结构"></a>目录结构</h2><h3 id="目录结构-1"><a href="#目录结构-1" class="headerlink" title="目录结构"></a>目录结构</h3><p>Linux的目录结构是<strong>一个</strong>树型结构,没有盘符的概念,只有一个根目录<code>/</code>,所有文件都在它下面</p><h4 id="HOME目录和工作目录"><a href="#HOME目录和工作目录" class="headerlink" title="HOME目录和工作目录"></a>HOME目录和工作目录</h4><p>Linux系统的命令行终端,在启动时,默认加载:</p><ul><li><p>当前登录用户的HOME目录作为当前的工作目录,所以ls命令本身列出的是HOME目录本身的内容</p></li><li><p>HOME目录:每个Linux操作用户在Linux系统的个人账户目录，路径在:<code>/home/用户名</code>。</p><p>如，图中的Linux用户是itheima,其HOME目录是:/home/itheima</p></li></ul><h3 id="路径描述方式"><a href="#路径描述方式" class="headerlink" title="路径描述方式"></a>路径描述方式</h3><ul><li>在Linux系统中,路径之间的层级关系,使用<code>/</code>来表示</li><li>在Windows系统中,路径之间的层级关系,使用<code>\</code>来表示</li></ul><p>如:</p><p><strong>Windows:</strong></p><p><code>D:\data\work\hello.txt</code></p><ul><li><code>D:</code>表示D盘</li><li><code>\</code>表示层级关系</li></ul><p><strong>Linux:</strong></p><p><code>/data/work/hello.txt</code></p><ul><li>开头前的<code>/</code>表示根目录</li><li>后面的<code>/</code>表示层级关系</li></ul><h4 id="相对路径和绝对路径"><a href="#相对路径和绝对路径" class="headerlink" title="相对路径和绝对路径"></a>相对路径和绝对路径</h4><p><strong>绝对路径</strong>:以根目录为起点，描述路径的一种写法，路径描述<strong>以/开头</strong></p><p><strong>相对路径</strong>:以当前目录为起点，描述路径的一种写法，路径描述<strong>无需以/开头</strong></p><h2 id="Linux-命令"><a href="#Linux-命令" class="headerlink" title="Linux 命令"></a>Linux 命令</h2><h3 id="命令基础"><a href="#命令基础" class="headerlink" title="命令基础"></a>命令基础</h3><h4 id="命令基础格式"><a href="#命令基础格式" class="headerlink" title="命令基础格式"></a>命令基础格式</h4><p>命令的通用格式:</p><p><code>command [-options] [parameter]</code></p><ul><li><code>command</code>:命令本身</li><li><code>-options</code>:[可选,非必填]命令的一些选项,可以通过选项控制命令的行为细节</li><li><code>parameter</code>:[可选,非必填]命令的参数,多数用于命令的指向目标</li></ul><p><strong><em>[]中均为可选选项</em></strong></p><p>示例:</p><ul><li><p><code>ls -l/home/itheima</code>,<code>ls</code>是命令本身,<code>-l</code>是选项,<code>/home/itheima</code>是参数</p><ul><li><strong>意思是以列表的形式,显示/home/itheima目录的内容</strong></li></ul></li><li><p><code>cp -r test1 test2</code> , <code>cp</code>是命令本身，<code>-r</code>是选项,<code>test1</code>和<code>test2</code>是参数</p><ul><li><strong>意思是复制文件夹test1成为test2</strong></li></ul></li></ul><h4 id="命令入门"><a href="#命令入门" class="headerlink" title="命令入门"></a>命令入门</h4><h5 id="ls命令"><a href="#ls命令" class="headerlink" title="ls命令"></a>ls命令</h5><p><strong>ls命令的作用是列出目录下的内容</strong></p><p><code>ls [-a -l -h] [Linux路径]</code></p><ul><li><p>当不使用选项和参数,直接使用ls命令本体,以平铺形式,列出当前工作目录下的内容</p></li><li><p><code>-a</code>表示all的意思,即列出全部文件(包含隐藏的文件/文件夹)</p></li><li><p><code>-l</code>表示以列表(竖向排列)的形式展示内容,并展示更多信息</p></li><li><p><code>-h</code>表示以易于阅读的形式，列出文件大小，如K、M、G</p><p><code>-h</code>选项必须要搭配<code>-l</code>起使用</p></li></ul><p>*混合使用:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">ls -l -a</span><br><span class="line">ls -la</span><br><span class="line">ls -al</span><br></pre></td></tr></table></figure><h5 id="cd命令"><a href="#cd命令" class="headerlink" title="cd命令"></a>cd命令</h5><p>当Linux终端（命令行）打开的时候，会默认以用户的HOME目录作为当前的工作目录</p><p>我们可以通过cd命令，<strong>更改当前所在的工作目录</strong>。</p><p>语法: <code>cd [Linux路径]</code></p><ul><li>cd命令无需选项，只有参数，表示要切换到哪个目录下</li><li>cd命令直接执行，不写参数，表示回到用户的HOME目录</li></ul><h5 id="pwd命令"><a href="#pwd命令" class="headerlink" title="pwd命令"></a>pwd命令</h5><p>通过ls来验证当前的工作目录，其实是不恰当的。我们可以通过pwd命令，来查看当前所在的工作目录。</p><p>pwd命令来自: Print work Directory</p><p>pwd命令，无选项，无参数，直接输入pwd即可</p><h5 id="mkdir命令"><a href="#mkdir命令" class="headerlink" title="mkdir命令"></a>mkdir命令</h5><p><strong>通过mkdir命令可以创建新的目录（文件夹)</strong></p><p>mkdir来自英文:Make Directory</p><p>语法:</p><p><code>mkdir [-p] Linux路径</code></p><ul><li>参数<strong>必填</strong>，表示Linux路径，即要创建的文件夹的路径，相对路径或绝对路径均可</li><li>-p选项可选，表示自动创建不存在的父目录，适用于创建连续多层级的目录</li></ul><p>如果想要一次性创建多个层级的目录,需使用<code>-p</code>,否则将报错</p><p><strong>注意︰创建文件夹需要修改权限</strong>﹐请确保操作均在HOME目录内，不要在HOME外操作涉及到权限问题，HOME外无法成功</p><h5 id="文件操作命令"><a href="#文件操作命令" class="headerlink" title="文件操作命令"></a>文件操作命令</h5><h6 id="touch命令"><a href="#touch命令" class="headerlink" title="touch命令"></a>touch命令</h6><p><strong>可以通过touch命令创建文件</strong></p><p>语法:</p><p><code>touch Linux路径</code></p><ul><li>touch命令无选项，参数必填，表示要创建的文件路径，相对、绝对、特殊路径符均可以使用</li></ul><h6 id="cat命令"><a href="#cat命令" class="headerlink" title="cat命令"></a>cat命令</h6><p><strong>查看文件内容</strong></p><p>语法:</p><p><code>cat Linux路径</code></p><ul><li>cat同样没有选项，只有必填参数，参数表示:被查看的文件路径</li></ul><h6 id="more-命令"><a href="#more-命令" class="headerlink" title="more 命令"></a>more 命令</h6><p><strong>查看文件内容</strong></p><p>more命令同样可以查看文件内容，同cat不同的是:</p><ul><li><p>cat是直接将内容全部显示出来</p></li><li><p>more支持翻页，如果文件内容过多，可以一页页的展示</p><p>语法: <code>more Linux路径</code></p></li><li><p>同样没有选项，只有必填参数，参数表示:被查看的文件路径，相对、绝对、特殊路径符都可以使用</p></li><li><p>在查看的过程中，通过空格翻页</p></li><li>通过q退出查看</li></ul><h6 id="cp命令"><a href="#cp命令" class="headerlink" title="cp命令"></a>cp命令</h6><p><strong>cp命令可以用于复制文件\文件夹</strong>，cp命令来自英文单词:copy</p><p>语法: <code>cp [-r] 参数1 参数2</code></p><ul><li>-r选项，可选，用于复制文件夹使用，表示递归</li><li><p>参数1，Linux路径，表示被复制的文件或文件夹</p></li><li><p>参数2，Linux路径，表示要复制去的地方</p></li></ul><h6 id="mv命令"><a href="#mv命令" class="headerlink" title="mv命令"></a>mv命令</h6><p><strong>mv命令可以用于移动文件\文件夹</strong>，mv命令来自英文单词:move</p><p>语法: <code>mv 参数1参数2</code></p><ul><li><p>参数1,Linux路径，表示被移动的文件或文件夹</p></li><li><p>参数2，Linux路径，表示要移动去的地方，如果目标不存在，则进行改名，确保目标存在</p></li></ul><h6 id="rm命令"><a href="#rm命令" class="headerlink" title="rm命令"></a>rm命令</h6><p><strong>rm命令可用于删除文件,文件夹</strong></p><p>语法:<code>rm [-r -f] 参数1参数2 ......参数N</code></p><ul><li><p>同cp命令一样，-r选项用于删除文件夹</p></li><li><p>-f表示force，强制删除（不会弹出提示确认信息)  </p><ul><li>普通用户删除内容不会弹出提示，只有root管理员用户删除内容会有提示</li><li>所以一般普通用户用不到-f选项</li></ul></li><li><p>可以通过<code>su -root</code>,并输入密码,临时切换到root用户体验</p><ul><li>通过输入<code>exit</code>命令,退回普通用户</li></ul></li><li><p>参数1、参数2、……、参数N表示要删除的文件或文件夹路径，按照空格隔开</p></li></ul><p><strong>rm命令支持通配符*，用来做模糊匹配</strong></p><p>符号<code>*</code>表示通配符，即匹配任意内容（包含空)，示例:</p><ul><li><code>test*</code>，表示匹配任何以test开头的内容</li><li><code>*test</code>，表示匹配任何以test结尾的内容. </li><li><code>*test*</code>，表示匹配任何包含test的内容</li></ul><h5 id="查找命令"><a href="#查找命令" class="headerlink" title="查找命令"></a>查找命令</h5><h6 id="which命令"><a href="#which命令" class="headerlink" title="which命令"></a>which命令</h6><p>我们在前面学习的Linux命令，其实它们的本体就是一个个的二进制可执行程序。和windows系统中的.exe文件，是一个意思。</p><p>我们可以通过which命令，<strong>查看所使用的一系列命令的程序文件存放在哪里</strong></p><p>语法: <code>which 要查找的命令</code></p><h6 id="find命令"><a href="#find命令" class="headerlink" title="find命令"></a>find命令</h6><p>在Linux系统中，我们可以通过find命令去<strong>搜索指定的文件</strong>。</p><p>语法:<code>find 起始路径 -name &quot;被查找文件名&quot;</code></p><p>语法: <code>find起始路径 -size +|-n[kMG]</code></p><ul><li>+、-表示大于和小于</li><li>n表示大小数字</li><li>kMG表示大小单位，<strong>k(小写字母)</strong>表示kb，M表示MB，G表示GB</li></ul><p>示例:</p><ul><li>查找小于10KB的文件: <code>find / -size -10k</code></li><li>查找大于100MB的文件: <code>find / -size +100M</code></li><li>查找大于1GB的文件: <code>find / -size +1G</code></li></ul><h5 id="grep命令"><a href="#grep命令" class="headerlink" title="grep命令"></a>grep命令</h5><p>可以通过grep命令，<strong>从文件中通过关键字过滤文件行。</strong></p><p>语法:<code>grep [-n] 关键字 文件路径</code></p><ul><li>选项-n，可选，表示在结果中显示匹配的行的行号。</li><li>参数，关键字，必填，表示过滤的关键字，带有空格或其它特殊符号，建议使用””将关键字包围起来</li><li>参数，文件路径，必填，表示要过滤内容的文件路径，<strong>可作为内容输入端口</strong></li></ul><h5 id="wc命令"><a href="#wc命令" class="headerlink" title="wc命令"></a>wc命令</h5><p>可以通过wc命令<strong>统计文件的行数、单词数量等</strong></p><p>语法:<code>wc [-c -m -1 -w] 文件路径</code></p><ul><li>选项，-c，统计bytes数量</li><li>选项，-m，统计字符数量</li><li>选项，-l，统计行数</li><li>选项，-w，统计单词数量</li><li>参数，文件路径，被统计的文件，<strong>可作为内容输入端口</strong></li><li>如果什么选项都不加,从左到右为: 行数 单词数 字节数’</li></ul><h5 id="echo命令"><a href="#echo命令" class="headerlink" title="echo命令"></a>echo命令</h5><p><strong>在命令行内输出指定内容</strong></p><p>语法:<code>echo 输出的内容</code></p><ul><li>无需选项,只有一个参数,表示要输出的内容</li><li>带有空格或\等特殊符号，建议使用双引号包围<br>因为不包围的话，空格后很容易被识别为参数2，尽管echo不受影响，但是要养成习惯)</li></ul><h5 id="tail命令"><a href="#tail命令" class="headerlink" title="tail命令"></a>tail命令</h5><p>使用tail命令，<strong>可以查看文件尾部内容，跟踪文件的最新更改</strong>，语法如下:</p><p><code>tail [-f -num] Linux路径</code></p><ul><li>参数，Linux路径，表示被跟踪的文件路径</li><li>选项，-f，表示持续跟踪</li><li>选项,-num，表示，查看尾部多少行，不填默认10行</li></ul><h4 id="特殊符号"><a href="#特殊符号" class="headerlink" title="特殊符号"></a>特殊符号</h4><h5 id="反引号"><a href="#反引号" class="headerlink" title="反引号`"></a>反引号`</h5><p>**被反引号包围的内容,会被作为命令执行,而非普通字符</p><p>如<code>echo pwd</code>本意是想,输出当前的工作路径,但是却输出了pwd三个字符</p><p>将pwd用反引号包围可被视为命令执行</p><h5 id="管道符"><a href="#管道符" class="headerlink" title="管道符"></a>管道符</h5><p><code>|</code>含义:将管道符左边命令的结果,作为右边命令的输入</p><p>示例:</p><p><code>cat test.txt | grep hello</code></p><p>即<code>cat test.txt</code>的输出结果(文件内容)作为右边<code>grep</code>命令的输入</p><h5 id="重定向符"><a href="#重定向符" class="headerlink" title="重定向符"></a>重定向符</h5><ul><li><code>&gt;</code>:将左侧命令的结果,<strong>覆盖</strong>写入到符号右侧指定的文件</li><li><code>&gt;&gt;</code>:将左侧命令的结果,<strong>追加</strong>写入到符号右侧指定的文件中</li></ul><h4 id="特殊路径符"><a href="#特殊路径符" class="headerlink" title="特殊路径符"></a>特殊路径符</h4><p><em><code>.</code></em>  :表示当前目录，比如<code>cd ./Desktop</code>表示切换到当前目录下的Desktop目录内，和cd Desktop效果一致</p><p><code>..</code> :表示上一级目录，比如: <code>cd ..</code>即可切换到上一级目录，<code>cd ../ ..</code>切换到上二级的目录</p><p><code>~</code> :表示HOME目录，比如: <code>cd~</code>即可切换到HOME目录或<code>cd ~/Desktop</code>，切换到HOME内的Desktop路径.</p><h4 id="快捷方式"><a href="#快捷方式" class="headerlink" title="快捷方式"></a>快捷方式</h4><ul><li><code>ctrl+L</code>表示”清空”当前命令行页面</li><li><code>ctrl+c</code>表示强制停止命令运行</li></ul><h4 id="vi-vim编辑器介绍"><a href="#vi-vim编辑器介绍" class="headerlink" title="vi\vim编辑器介绍"></a>vi\vim编辑器介绍</h4><p>vi\vim是visual interface的简称,是Linux中最经典的文本编辑器</p><p>同图形化界面中的文本编辑器一样，vi是命令行下对文本文件进行编辑的绝佳选择。<br>vim是vi的加强版本，兼容vi的所有指令，不仅能编辑文本，而且还具有shell程序编辑的功能，可以不同颜色的字体来辨别语法的正确性，极大方便了程序的设计和编辑性。</p><h5 id="三种工作模式"><a href="#三种工作模式" class="headerlink" title="三种工作模式"></a>三种工作模式</h5><ul><li><p><strong><em>命令模式(Command mode)</em></strong></p><p>命令模式下,所敲的按键编辑器都理解为命令,以命令驱动执行不同的功能.不能自由进行文本编辑</p><p>如果需要通过vi/vim编辑器编辑文件，请通过如下命令:</p><p><code>vi 文件路径</code><br><code>vim 文件路径</code><br>vim兼容全部的vi功能，后续全部使用vim命令</p><ul><li>如果文件路径表示的文件不存在，那么此命令会用于<strong>编辑新文件</strong></li><li>如果文件路径表示的文件存在，那么此命令用于<strong>编辑已有文件</strong></li></ul><p>在命令模式下输入<code>:wq</code>退出vim工作</p></li><li><p><strong><em>输入模式(insert mode)</em></strong></p><p>编辑文本</p><p><strong>命令模式下</strong>输入 <code>iao</code>进入输入模式,在输入模式下ESC键返回到<strong>命令模式下</strong></p></li><li><p><strong><em>底线命令模式(Last line mode)</em></strong></p><p>以:开始,通常用于文件的保存,退出</p><p><strong>命令模式下</strong>输入 <code>:</code>进入底线命令模式,在此模式下回车结束运行</p></li></ul><h5 id="命令模式快捷键"><a href="#命令模式快捷键" class="headerlink" title="命令模式快捷键"></a>命令模式快捷键</h5><div class="table-container"><table><thead><tr><th></th><th></th><th></th></tr></thead><tbody><tr><td>命令模式</td><td>i</td><td>在当前光标位置进入 输入模式</td></tr><tr><td>命令模式</td><td>a</td><td>在当前光标位置 之后 进入 输入模式</td></tr><tr><td>命令模式</td><td>I</td><td>在当前行的开头,进入 输入模式</td></tr><tr><td>命令模式</td><td>A</td><td>在当前行的结尾,进入 输入模式</td></tr><tr><td>命令模式</td><td>o</td><td>在当前光标下一行进入 输入模式</td></tr><tr><td>命令模式</td><td>O</td><td>在当前光标上一行进入 输入模式</td></tr><tr><td>命令模式</td><td>esc</td><td>任何情况下输入esc都能回到命令模式</td></tr></tbody></table></div>]]></content>
    
    
    <summary type="html">some simple tips for Linux</summary>
    
    
    
    <category term="编程基础" scheme="https://stack2005.github.io/categories/%E7%BC%96%E7%A8%8B%E5%9F%BA%E7%A1%80/"/>
    
    
    <category term="Linux" scheme="https://stack2005.github.io/tags/Linux/"/>
    
  </entry>
  
</feed>
